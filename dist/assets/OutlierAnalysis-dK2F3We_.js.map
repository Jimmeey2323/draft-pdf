{"version":3,"file":"OutlierAnalysis-dK2F3We_.js","sources":["../../src/hooks/useOutlierMonthAnalytics.ts","../../src/components/dashboard/OutlierDrillDownModal.tsx","../../src/components/dashboard/OutlierMonthDetail.tsx","../../src/components/dashboard/OutlierAnalysisSection.tsx","../../src/pages/OutlierAnalysis.tsx"],"sourcesContent":["import { useMemo } from 'react';\nimport { SalesData, NewClientData } from '@/types/dashboard';\nimport { CheckinData } from './useCheckinsData';\n\nexport interface DailyAnalytics {\n  date: string;\n  revenue: number;\n  newClientRevenue: number;\n  existingClientRevenue: number;\n  activeMembershipRevenue: number;\n  transactions: number;\n  newClients: number;\n  existingClients: number;\n  renewals: number;\n  upgrades: number;\n  downgrades: number;\n  stacking: number;\n}\n\nexport interface MembershipAnalytics {\n  membershipName: string;\n  cleanedCategory: string;\n  revenue: number;\n  count: number;\n  avgPrice: number;\n  newClients: number;\n  existingClients: number;\n  renewals: number;\n  upgrades: number;\n  downgrades: number;\n}\n\nexport interface SpenderData {\n  memberId: string;\n  customerName: string;\n  customerEmail: string;\n  totalSpent: number;\n  transactions: number;\n  avgTransaction: number;\n  firstPurchaseDate: string;\n  lastPurchaseDate: string;\n  isNew: boolean;\n  lastMembershipName?: string;\n  lastMembershipEndDate?: string;\n  membershipStatus?: 'Active' | 'Expired' | 'Frozen' | 'None';\n  totalDiscountReceived?: number;\n  rawTransactions?: SalesData[]; // Add raw transaction data for drill-down\n}\n\nexport interface LapsedMemberData {\n  memberId: string;\n  customerName: string;\n  customerEmail: string;\n  lastMembershipEndDate: string;\n  daysSinceLapsed: number;\n  lastMembershipType: string;\n  totalLifetimeValue: number;\n  lastPurchaseAmount: number;\n  rawTransactions?: SalesData[]; // Add raw transaction data for drill-down\n}\n\nexport interface StackedMembershipDetail {\n  membershipName: string;\n  endDate: string;\n  amountPaid: number;\n  purchaseDate: string;\n  category: string;\n  discountAmount?: number;\n}\n\nexport interface StackedMemberData {\n  memberId: string;\n  customerName: string;\n  customerEmail: string;\n  totalMemberships: number;\n  totalAmountPaid: number;\n  memberships: StackedMembershipDetail[];\n}\n\nexport interface TransactionDetail {\n  transactionId: string;\n  memberId: string;\n  customerName: string;\n  customerEmail: string;\n  paymentDate: string;\n  paymentValue: number;\n  product: string;\n  category: string;\n  isNew: boolean;\n  isStacked: boolean;\n  discountAmount: number;\n  discountPercentage: number;\n  mrpPreTax?: number;\n  mrpPostTax?: number;\n  discountType?: string;\n  savings?: number; // MRP - Actual Paid\n  location: string;\n  membershipEndDate?: string;\n}\n\nexport interface OutlierMonthAnalytics {\n  // Overall metrics\n  totalRevenue: number;\n  newClientRevenue: number;\n  existingClientRevenue: number;\n  activeMembershipRevenue: number;\n  \n  // Detailed Revenue Split Metrics\n  newCustomerMetrics: {\n    revenue: number;\n    unitsSold: number;\n    transactions: number;\n    uniqueMembers: number;\n    atv: number; // Average Transaction Value\n    discountedRevenue: number;\n    nonDiscountedRevenue: number;\n    discountedTransactions: number;\n    nonDiscountedTransactions: number;\n    totalDiscountAmount: number;\n    avgDiscountPercentage: number;\n  };\n  repeatCustomerMetrics: {\n    revenue: number;\n    unitsSold: number;\n    transactions: number;\n    uniqueMembers: number;\n    atv: number;\n    discountedRevenue: number;\n    nonDiscountedRevenue: number;\n    discountedTransactions: number;\n    nonDiscountedTransactions: number;\n    totalDiscountAmount: number;\n    avgDiscountPercentage: number;\n  };\n  \n  // Client counts\n  totalClients: number;\n  newClients: number;\n  existingClients: number;\n  clientsWithActiveMembers: number;\n  clientsWithMultipleMemberships: number;\n  \n  // Membership behavior\n  renewals: number;\n  upgrades: number;\n  downgrades: number;\n  stackingMembers: number;\n  stackedMembersDetails: StackedMemberData[]; // Detailed list of members with stacked memberships\n  \n  // Daily breakdown\n  dailyAnalytics: DailyAnalytics[];\n  \n  // Membership breakdown\n  membershipAnalytics: MembershipAnalytics[];\n  \n  // Spenders - bifurcated by new/repeat\n  topNewSpenders: SpenderData[];\n  topRepeatSpenders: SpenderData[];\n  bottomNewSpenders: SpenderData[];\n  bottomRepeatSpenders: SpenderData[];\n  topSpenders: SpenderData[]; // Keep for compatibility\n  bottomSpenders: SpenderData[]; // Keep for compatibility\n  \n  // Lapsed members\n  lapsedMembers: LapsedMemberData[];\n  \n  // Discount analytics\n  totalDiscountGiven: number;\n  transactionsWithDiscount: number;\n  avgDiscountPercentage: number;\n  \n  // Visit patterns (from checkins)\n  totalVisits: number;\n  avgVisitsPerClient: number;\n  visitToRevenueRatio: number;\n  \n  // Transaction-level details for drill-down\n  newTransactions: TransactionDetail[];\n  repeatTransactions: TransactionDetail[];\n  allTransactions: SalesData[]; // Raw sales data for the month\n}\n\nexport const useOutlierMonthAnalytics = (\n  salesData: SalesData[],\n  checkinsData: CheckinData[],\n  newClientData: NewClientData[],\n  month: 'april' | 'august',\n  location?: string\n) => {\n  return useMemo(() => {\n    // Determine month parameters\n    const monthConfig = month === 'april' \n      ? { year: 2025, monthIndex: 3, monthName: 'April' }\n      : { year: 2025, monthIndex: 7, monthName: 'August' };\n    \n    // Define today for membership status calculations\n    const today = new Date();\n    today.setHours(0, 0, 0, 0); // Normalize to start of day\n    \n    // Filter sales data for the specific month and location\n    const monthSalesData = salesData.filter(item => {\n      if (!item.paymentDate) return false;\n      const date = new Date(item.paymentDate);\n      const matchesMonth = date.getFullYear() === monthConfig.year && date.getMonth() === monthConfig.monthIndex;\n      const matchesLocation = !location || item.calculatedLocation === location;\n      return matchesMonth && matchesLocation && item.paymentStatus === 'succeeded';\n    });\n\n    // Build a global customer first purchase map (across ALL data)\n    const customerFirstPurchaseMap = new Map<string, Date>();\n    salesData.forEach(item => {\n      const customerId = item.memberId || item.customerEmail;\n      if (!customerId || !item.paymentDate || item.paymentStatus !== 'succeeded') return;\n      \n      const purchaseDate = new Date(item.paymentDate);\n      const existing = customerFirstPurchaseMap.get(customerId);\n      if (!existing || purchaseDate < existing) {\n        customerFirstPurchaseMap.set(customerId, purchaseDate);\n      }\n    });\n\n    // Determine if a customer is new based on FIRST TRANSACTION EVER\n    // A customer is considered \"new\" if their first-ever purchase is in this month\n    // ALL purchases by that customer in this month are then attributed to \"new\"\n    const isNewCustomer = (customerId: string, purchaseDate: Date): boolean => {\n      const firstPurchase = customerFirstPurchaseMap.get(customerId);\n      if (!firstPurchase) return true; // If no record, consider new\n      \n      // Check if their first purchase is in the same month and year as this purchase\n      const firstPurchaseMonth = firstPurchase.getMonth();\n      const firstPurchaseYear = firstPurchase.getFullYear();\n      const currentMonth = purchaseDate.getMonth();\n      const currentYear = purchaseDate.getFullYear();\n      \n      // If first purchase was in this month, consider all purchases in this month as \"new\"\n      if (firstPurchaseMonth === monthConfig.monthIndex && firstPurchaseYear === monthConfig.year) {\n        return true;\n      }\n      \n      // Otherwise, check if this is the very first purchase\n      return firstPurchase.getTime() === purchaseDate.getTime() ||\n             (firstPurchase.toDateString() === purchaseDate.toDateString());\n    };\n\n    // Check if membership is stacked: Sec. Membership End Date is NOT BEFORE the purchase date\n    // This means the member had an active membership when they purchased a new one\n    const hasStackedMembership = (item: SalesData): boolean => {\n      if (!item.secMembershipEndDate || !item.paymentDate) return false;\n      \n      const membershipEndDate = new Date(item.secMembershipEndDate);\n      const purchaseDate = new Date(item.paymentDate);\n      \n      // Normalize dates to start of day for comparison\n      membershipEndDate.setHours(0, 0, 0, 0);\n      purchaseDate.setHours(0, 0, 0, 0);\n      \n      // Stacked if membership end date is NOT before purchase date (i.e., >= purchase date)\n      return membershipEndDate >= purchaseDate;\n    };\n\n    // Build customer purchase history in this month\n    const customerPurchases = new Map<string, SalesData[]>();\n    monthSalesData.forEach(item => {\n      const customerId = item.memberId || item.customerEmail;\n      if (!customerId) return;\n      \n      if (!customerPurchases.has(customerId)) {\n        customerPurchases.set(customerId, []);\n      }\n      customerPurchases.get(customerId)!.push(item);\n    });\n\n    // Calculate overall metrics\n    const totalRevenue = monthSalesData.reduce((sum, item) => sum + (item.paymentValue || 0), 0);\n    \n    let newClientRevenue = 0;\n    let existingClientRevenue = 0;\n    let activeMembershipRevenue = 0;\n    const newClientIds = new Set<string>();\n    const existingClientIds = new Set<string>();\n    const clientsWithStackedMemberships = new Set<string>();\n    \n    monthSalesData.forEach(item => {\n      const customerId = item.memberId || item.customerEmail;\n      if (!customerId) return;\n      \n      const purchaseDate = new Date(item.paymentDate);\n      const isNew = isNewCustomer(customerId, purchaseDate);\n      \n      if (isNew) {\n        newClientRevenue += item.paymentValue || 0;\n        newClientIds.add(customerId);\n      } else {\n        existingClientRevenue += item.paymentValue || 0;\n        existingClientIds.add(customerId);\n      }\n      \n      // Check if membership was stacked (purchased while having active membership)\n      if (hasStackedMembership(item)) {\n        activeMembershipRevenue += item.paymentValue || 0;\n        clientsWithStackedMemberships.add(customerId);\n      }\n    });\n\n    // Calculate detailed metrics for NEW customers (discounted vs non-discounted)\n    const newCustomerMetrics = {\n      revenue: 0,\n      unitsSold: 0,\n      transactions: 0,\n      uniqueMembers: new Set<string>(),\n      atv: 0,\n      discountedRevenue: 0,\n      nonDiscountedRevenue: 0,\n      discountedTransactions: 0,\n      nonDiscountedTransactions: 0,\n      totalDiscountAmount: 0,\n      totalDiscountPercentage: 0,\n      discountCount: 0,\n      avgDiscountPercentage: 0\n    };\n\n    // Calculate detailed metrics for REPEAT customers (discounted vs non-discounted)\n    const repeatCustomerMetrics = {\n      revenue: 0,\n      unitsSold: 0,\n      transactions: 0,\n      uniqueMembers: new Set<string>(),\n      atv: 0,\n      discountedRevenue: 0,\n      nonDiscountedRevenue: 0,\n      discountedTransactions: 0,\n      nonDiscountedTransactions: 0,\n      totalDiscountAmount: 0,\n      totalDiscountPercentage: 0,\n      discountCount: 0,\n      avgDiscountPercentage: 0\n    };\n\n    monthSalesData.forEach(item => {\n      const customerId = item.memberId || item.customerEmail;\n      if (!customerId) return;\n      \n      const purchaseDate = new Date(item.paymentDate);\n      const isNew = isNewCustomer(customerId, purchaseDate);\n      const hasDiscount = (item.discountAmount && item.discountAmount > 0) || \n                         (item.discountPercentage && item.discountPercentage > 0);\n      \n      const metrics = isNew ? newCustomerMetrics : repeatCustomerMetrics;\n      \n      metrics.revenue += item.paymentValue || 0;\n      metrics.unitsSold += 1;\n      metrics.transactions += 1;\n      metrics.uniqueMembers.add(customerId);\n      \n      if (hasDiscount) {\n        metrics.discountedRevenue += item.paymentValue || 0;\n        metrics.discountedTransactions += 1;\n        metrics.totalDiscountAmount += item.discountAmount || 0;\n        if (item.discountPercentage && item.discountPercentage > 0) {\n          metrics.totalDiscountPercentage += item.discountPercentage;\n          metrics.discountCount += 1;\n        }\n      } else {\n        metrics.nonDiscountedRevenue += item.paymentValue || 0;\n        metrics.nonDiscountedTransactions += 1;\n      }\n    });\n\n    // Calculate averages\n    newCustomerMetrics.atv = newCustomerMetrics.transactions > 0 \n      ? newCustomerMetrics.revenue / newCustomerMetrics.transactions \n      : 0;\n    newCustomerMetrics.avgDiscountPercentage = newCustomerMetrics.discountCount > 0\n      ? newCustomerMetrics.totalDiscountPercentage / newCustomerMetrics.discountCount\n      : 0;\n    \n    repeatCustomerMetrics.atv = repeatCustomerMetrics.transactions > 0 \n      ? repeatCustomerMetrics.revenue / repeatCustomerMetrics.transactions \n      : 0;\n    repeatCustomerMetrics.avgDiscountPercentage = repeatCustomerMetrics.discountCount > 0\n      ? repeatCustomerMetrics.totalDiscountPercentage / repeatCustomerMetrics.discountCount\n      : 0;\n\n\n    // Membership behavior analysis\n    const customerMembershipHistory = new Map<string, {\n      memberships: string[];\n      prices: number[];\n      dates: Date[];\n    }>();\n\n    // Excluded membership types for stacking calculation\n    const excludedStackingTypes = ['studio single class', 'private class', 'money-credits'];\n    \n    monthSalesData\n      .filter(item => ['subscription', 'pack'].includes(item.paymentCategory))\n      .forEach(item => {\n        const customerId = item.memberId || item.customerEmail;\n        if (!customerId) return;\n        \n        if (!customerMembershipHistory.has(customerId)) {\n          customerMembershipHistory.set(customerId, {\n            memberships: [],\n            prices: [],\n            dates: []\n          });\n        }\n        \n        const history = customerMembershipHistory.get(customerId)!;\n        history.memberships.push(item.cleanedProduct || item.paymentItem);\n        history.prices.push(item.paymentValue || 0);\n        history.dates.push(new Date(item.paymentDate));\n      });\n\n    let renewals = 0;\n    let upgrades = 0;\n    let downgrades = 0;\n    \n    customerMembershipHistory.forEach((history, customerId) => {\n      // Sort by date\n      const sorted = history.memberships.map((m, i) => ({\n        membership: m,\n        price: history.prices[i],\n        date: history.dates[i]\n      })).sort((a, b) => a.date.getTime() - b.date.getTime());\n\n      for (let i = 1; i < sorted.length; i++) {\n        const prev = sorted[i - 1];\n        const curr = sorted[i];\n        \n        // Same membership = renewal\n        if (prev.membership === curr.membership) {\n          renewals++;\n        }\n        // Higher price = upgrade\n        else if (curr.price > prev.price) {\n          upgrades++;\n        }\n        // Lower price = downgrade\n        else if (curr.price < prev.price) {\n          downgrades++;\n        }\n      }\n    });\n\n    // Stacking (multiple memberships per customer) - with detailed information\n    const stackedMembersDetails: StackedMemberData[] = [];\n    \n    Array.from(customerMembershipHistory.entries()).forEach(([customerId, history]) => {\n      if (history.memberships.length > 1) {\n        // This customer has multiple memberships\n        const customerTransactions = monthSalesData.filter(item => \n          (item.memberId || item.customerEmail) === customerId\n        );\n        \n        // Filter out excluded membership types and categories\n        const validMemberships = customerTransactions.filter(item => {\n          const productName = (item.cleanedProduct || item.paymentItem || '').toLowerCase();\n          const category = (item.cleanedCategory || '').toLowerCase();\n          \n          // Exclude by product name\n          const excludedByName = excludedStackingTypes.some(excluded => productName.includes(excluded));\n          \n          // Exclude by category\n          const excludedByCategory = ['product', 'event', 'money-credits'].includes(category);\n          \n          return !excludedByName && !excludedByCategory;\n        });\n        \n        // Only count as stacking if they have 2+ valid memberships\n        if (validMemberships.length > 1) {\n          const memberships: StackedMembershipDetail[] = validMemberships.map(item => ({\n            membershipName: item.cleanedProduct || item.paymentItem || 'Unknown',\n            endDate: item.secMembershipEndDate || '',\n            amountPaid: item.paymentValue || 0,\n            purchaseDate: item.paymentDate || '',\n            category: item.cleanedCategory || '',\n            discountAmount: item.discountAmount || 0\n          }));\n          \n          stackedMembersDetails.push({\n            memberId: customerId,\n            customerName: validMemberships[0]?.customerName || 'Unknown',\n            customerEmail: validMemberships[0]?.customerEmail || '',\n            totalMemberships: validMemberships.length,\n            totalAmountPaid: validMemberships.reduce((sum, t) => sum + (t.paymentValue || 0), 0),\n            memberships: memberships\n          });\n        }\n      }\n    });\n    \n    const stackingMembers = stackedMembersDetails.length;\n\n    // Daily analytics\n    const dailyMap = new Map<string, {\n      revenue: number;\n      newRevenue: number;\n      existingRevenue: number;\n      activeRevenue: number;\n      transactions: number;\n      newClients: Set<string>;\n      existingClients: Set<string>;\n      renewals: number;\n      upgrades: number;\n      downgrades: number;\n      stacking: Set<string>;\n    }>();\n\n    monthSalesData.forEach(item => {\n      const dateKey = new Date(item.paymentDate).toISOString().split('T')[0];\n      if (!dailyMap.has(dateKey)) {\n        dailyMap.set(dateKey, {\n          revenue: 0,\n          newRevenue: 0,\n          existingRevenue: 0,\n          activeRevenue: 0,\n          transactions: 0,\n          newClients: new Set(),\n          existingClients: new Set(),\n          renewals: 0,\n          upgrades: 0,\n          downgrades: 0,\n          stacking: new Set()\n        });\n      }\n      \n      const day = dailyMap.get(dateKey)!;\n      day.revenue += item.paymentValue || 0;\n      day.transactions++;\n      \n      const customerId = item.memberId || item.customerEmail;\n      if (customerId) {\n        const purchaseDate = new Date(item.paymentDate);\n        if (isNewCustomer(customerId, purchaseDate)) {\n          day.newRevenue += item.paymentValue || 0;\n          day.newClients.add(customerId);\n        } else {\n          day.existingRevenue += item.paymentValue || 0;\n          day.existingClients.add(customerId);\n        }\n        \n        if (hasStackedMembership(item)) {\n          day.activeRevenue += item.paymentValue || 0;\n        }\n        \n        const purchases = customerPurchases.get(customerId) || [];\n        if (purchases.length > 1) {\n          day.stacking.add(customerId);\n        }\n      }\n    });\n\n    const dailyAnalytics: DailyAnalytics[] = Array.from(dailyMap.entries())\n      .map(([date, data]) => ({\n        date,\n        revenue: data.revenue,\n        newClientRevenue: data.newRevenue,\n        existingClientRevenue: data.existingRevenue,\n        activeMembershipRevenue: data.activeRevenue,\n        transactions: data.transactions,\n        newClients: data.newClients.size,\n        existingClients: data.existingClients.size,\n        renewals: data.renewals,\n        upgrades: data.upgrades,\n        downgrades: data.downgrades,\n        stacking: data.stacking.size\n      }))\n      .sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());\n\n    // Membership analytics by product and category\n    const membershipMap = new Map<string, {\n      category: string;\n      revenue: number;\n      count: number;\n      newClients: Set<string>;\n      existingClients: Set<string>;\n      renewals: number;\n      upgrades: number;\n      downgrades: number;\n    }>();\n\n    monthSalesData.forEach(item => {\n      const key = item.cleanedProduct || item.paymentItem || 'Unknown';\n      if (!membershipMap.has(key)) {\n        membershipMap.set(key, {\n          category: item.cleanedCategory || 'Other',\n          revenue: 0,\n          count: 0,\n          newClients: new Set(),\n          existingClients: new Set(),\n          renewals: 0,\n          upgrades: 0,\n          downgrades: 0\n        });\n      }\n      \n      const membership = membershipMap.get(key)!;\n      membership.revenue += item.paymentValue || 0;\n      membership.count++;\n      \n      const customerId = item.memberId || item.customerEmail;\n      if (customerId) {\n        const purchaseDate = new Date(item.paymentDate);\n        if (isNewCustomer(customerId, purchaseDate)) {\n          membership.newClients.add(customerId);\n        } else {\n          membership.existingClients.add(customerId);\n        }\n      }\n    });\n\n    const membershipAnalytics: MembershipAnalytics[] = Array.from(membershipMap.entries())\n      .map(([name, data]) => ({\n        membershipName: name,\n        cleanedCategory: data.category,\n        revenue: data.revenue,\n        count: data.count,\n        avgPrice: data.count > 0 ? data.revenue / data.count : 0,\n        newClients: data.newClients.size,\n        existingClients: data.existingClients.size,\n        renewals: data.renewals,\n        upgrades: data.upgrades,\n        downgrades: data.downgrades\n      }))\n      .sort((a, b) => b.revenue - a.revenue);\n\n    // Top and bottom spenders with raw transaction data\n    const spenderMap = new Map<string, {\n      name: string;\n      email: string;\n      total: number;\n      transactions: number;\n      firstDate: Date;\n      lastDate: Date;\n      isNew: boolean;\n      rawTransactions: SalesData[];\n      lastMembershipName?: string;\n      lastMembershipEndDate?: Date;\n      isFrozen?: boolean;\n      totalDiscountReceived: number;\n    }>();\n\n    monthSalesData.forEach(item => {\n      const customerId = item.memberId || item.customerEmail;\n      if (!customerId) return;\n      \n      if (!spenderMap.has(customerId)) {\n        const purchaseDate = new Date(item.paymentDate);\n        spenderMap.set(customerId, {\n          name: item.customerName,\n          email: item.customerEmail,\n          total: 0,\n          transactions: 0,\n          firstDate: purchaseDate,\n          lastDate: purchaseDate,\n          isNew: isNewCustomer(customerId, purchaseDate),\n          rawTransactions: [],\n          totalDiscountReceived: 0\n        });\n      }\n      \n      const spender = spenderMap.get(customerId)!;\n      spender.total += item.paymentValue || 0;\n      spender.transactions++;\n      spender.rawTransactions.push(item); // Store raw transaction\n      spender.totalDiscountReceived += item.discountAmount || 0;\n      \n      const itemDate = new Date(item.paymentDate);\n      if (itemDate < spender.firstDate) spender.firstDate = itemDate;\n      if (itemDate > spender.lastDate) spender.lastDate = itemDate;\n      \n      // Track latest membership info\n      if (item.secMembershipEndDate) {\n        const endDate = new Date(item.secMembershipEndDate);\n        if (!spender.lastMembershipEndDate || endDate > spender.lastMembershipEndDate) {\n          spender.lastMembershipName = item.cleanedProduct || item.paymentItem;\n          spender.lastMembershipEndDate = endDate;\n          spender.isFrozen = item.secMembershipIsFreezed === true || \n                            item.secMembershipIsFreezed === 'TRUE' ||\n                            item.secMembershipIsFreezed === 'true';\n        }\n      }\n    });\n\n    const allSpenders: SpenderData[] = Array.from(spenderMap.entries())\n      .map(([id, data]) => {\n        // Determine membership status\n        let membershipStatus: 'Active' | 'Expired' | 'Frozen' | 'None' = 'None';\n        if (data.lastMembershipEndDate) {\n          if (data.isFrozen) {\n            membershipStatus = 'Frozen';\n          } else if (data.lastMembershipEndDate >= today) {\n            membershipStatus = 'Active';\n          } else {\n            membershipStatus = 'Expired';\n          }\n        }\n        \n        return {\n          memberId: id,\n          customerName: data.name,\n          customerEmail: data.email,\n          totalSpent: data.total,\n          transactions: data.transactions,\n          avgTransaction: data.transactions > 0 ? data.total / data.transactions : 0,\n          firstPurchaseDate: data.firstDate.toISOString().split('T')[0],\n          lastPurchaseDate: data.lastDate.toISOString().split('T')[0],\n          isNew: data.isNew,\n          lastMembershipName: data.lastMembershipName,\n          lastMembershipEndDate: data.lastMembershipEndDate?.toISOString().split('T')[0],\n          membershipStatus,\n          totalDiscountReceived: data.totalDiscountReceived,\n          rawTransactions: data.rawTransactions\n        };\n      })\n      .sort((a, b) => b.totalSpent - a.totalSpent);\n\n    const topSpenders = allSpenders.slice(0, 20);\n    const bottomSpenders = allSpenders.filter(s => s.totalSpent > 0).slice(-20).reverse();\n    \n    // Bifurcate spenders into new and repeat\n    const newSpenders = allSpenders.filter(s => s.isNew);\n    const repeatSpenders = allSpenders.filter(s => !s.isNew);\n    \n    const topNewSpenders = newSpenders.slice(0, 20);\n    const topRepeatSpenders = repeatSpenders.slice(0, 20);\n    const bottomNewSpenders = newSpenders.filter(s => s.totalSpent > 0).slice(-20).reverse();\n    const bottomRepeatSpenders = repeatSpenders.filter(s => s.totalSpent > 0).slice(-20).reverse();\n\n\n    // Lapsed members analysis - only show members whose membership has ACTUALLY expired (before today)\n    const lapsedMembers: LapsedMemberData[] = [];\n    \n    const membershipEndMap = new Map<string, {\n      endDate: Date;\n      membershipType: string;\n      lastAmount: number;\n      isFrozen?: boolean; // Track if membership is frozen\n    }>();\n\n    // Build membership end dates from ALL sales data to get most recent membership\n    salesData.forEach(item => {\n      const customerId = item.memberId || item.customerEmail;\n      if (!customerId || !item.secMembershipEndDate || item.paymentStatus !== 'succeeded') return;\n      \n      const endDate = new Date(item.secMembershipEndDate);\n      endDate.setHours(0, 0, 0, 0); // Normalize to start of day\n      const existing = membershipEndMap.get(customerId);\n      \n      // Keep track of the LATEST membership end date\n      if (!existing || endDate > existing.endDate) {\n        // Check if membership is frozen (treat TRUE/'TRUE' as frozen)\n        const isFrozen = item.secMembershipIsFreezed === true || \n                        item.secMembershipIsFreezed === 'TRUE' ||\n                        item.secMembershipIsFreezed === 'true';\n        \n        membershipEndMap.set(customerId, {\n          endDate,\n          membershipType: item.cleanedProduct || item.paymentItem,\n          lastAmount: item.paymentValue || 0,\n          isFrozen // Track freeze status\n        });\n      }\n    });\n\n    // Find lapsed members - membership end date is BEFORE today (truly expired)\n    // BUT exclude frozen memberships (they are considered active)\n    membershipEndMap.forEach((data, customerId) => {\n      // Skip if membership is frozen (considered active)\n      if (data.isFrozen) return;\n      \n      // Only include if membership end date is in the past (before today)\n      if (data.endDate < today) {\n        const daysSince = Math.floor((today.getTime() - data.endDate.getTime()) / (1000 * 60 * 60 * 24));\n        \n        // Calculate lifetime value from sales data and get all transactions\n        const customerSales = salesData.filter(s => \n          (s.memberId || s.customerEmail) === customerId &&\n          s.paymentStatus === 'succeeded'\n        );\n        const ltv = customerSales.reduce((sum, s) => sum + (s.paymentValue || 0), 0);\n        \n        const memberData = customerSales[0];\n        if (memberData) {\n          lapsedMembers.push({\n            memberId: customerId,\n            customerName: memberData.customerName,\n            customerEmail: memberData.customerEmail,\n            lastMembershipEndDate: data.endDate.toISOString().split('T')[0],\n            daysSinceLapsed: daysSince,\n            lastMembershipType: data.membershipType,\n            totalLifetimeValue: ltv,\n            lastPurchaseAmount: data.lastAmount,\n            rawTransactions: customerSales // Include all transactions for drill-down\n          });\n        }\n      }\n    });\n\n    // Sort lapsed members by LTV (highest first)\n    lapsedMembers.sort((a, b) => b.totalLifetimeValue - a.totalLifetimeValue);\n\n    // Discount analytics\n    const discountData = monthSalesData.filter(item => (item.discountAmount || 0) > 0);\n    const totalDiscountGiven = discountData.reduce((sum, item) => sum + (item.discountAmount || 0), 0);\n    const avgDiscountPercentage = discountData.length > 0\n      ? discountData.reduce((sum, item) => sum + (item.discountPercentage || 0), 0) / discountData.length\n      : 0;\n\n    // Visit patterns from checkins\n    const monthCheckins = checkinsData.filter(checkin => {\n      if (!checkin.dateIST) return false;\n      const date = new Date(checkin.dateIST);\n      return date.getFullYear() === monthConfig.year && \n             date.getMonth() === monthConfig.monthIndex &&\n             (!location || checkin.location === location) &&\n             checkin.checkedIn;\n    });\n\n    const totalVisits = monthCheckins.length;\n    const uniqueVisitors = new Set(monthCheckins.map(c => c.memberId || c.email)).size;\n    const avgVisitsPerClient = uniqueVisitors > 0 ? totalVisits / uniqueVisitors : 0;\n    const visitToRevenueRatio = totalRevenue > 0 ? totalVisits / (totalRevenue / 1000) : 0;\n\n    // Build detailed transaction arrays for new vs repeat with full drill-down data\n    const newTransactions: TransactionDetail[] = [];\n    const repeatTransactions: TransactionDetail[] = [];\n    \n    monthSalesData.forEach(item => {\n      const customerId = item.memberId || item.customerEmail;\n      if (!customerId) return;\n      \n      const purchaseDate = new Date(item.paymentDate);\n      const isNew = isNewCustomer(customerId, purchaseDate);\n      const isStacked = hasStackedMembership(item);\n      \n      // Calculate savings if MRP exists\n      const mrp = item.mrpPostTax || item.mrpPreTax || 0;\n      const savings = mrp > 0 ? mrp - (item.paymentValue || 0) : 0;\n      \n      const transaction: TransactionDetail = {\n        transactionId: item.saleItemId || item.transactionId || '',\n        memberId: customerId,\n        customerName: item.customerName || '',\n        customerEmail: item.customerEmail || '',\n        paymentDate: item.paymentDate || '',\n        paymentValue: item.paymentValue || 0,\n        product: item.cleanedProduct || item.paymentItem || '',\n        category: item.cleanedCategory || '',\n        isNew,\n        isStacked,\n        discountAmount: item.discountAmount || 0,\n        discountPercentage: item.discountPercentage || 0,\n        mrpPreTax: item.mrpPreTax,\n        mrpPostTax: item.mrpPostTax,\n        discountType: item.discountType,\n        savings,\n        location: item.calculatedLocation || '',\n        membershipEndDate: item.secMembershipEndDate\n      };\n      \n      if (isNew) {\n        newTransactions.push(transaction);\n      } else {\n        repeatTransactions.push(transaction);\n      }\n    });\n\n    return {\n      totalRevenue,\n      newClientRevenue,\n      existingClientRevenue,\n      activeMembershipRevenue,\n      \n      // Detailed metrics with discount bifurcation\n      newCustomerMetrics: {\n        revenue: newCustomerMetrics.revenue,\n        unitsSold: newCustomerMetrics.unitsSold,\n        transactions: newCustomerMetrics.transactions,\n        uniqueMembers: newCustomerMetrics.uniqueMembers.size,\n        atv: newCustomerMetrics.atv,\n        discountedRevenue: newCustomerMetrics.discountedRevenue,\n        nonDiscountedRevenue: newCustomerMetrics.nonDiscountedRevenue,\n        discountedTransactions: newCustomerMetrics.discountedTransactions,\n        nonDiscountedTransactions: newCustomerMetrics.nonDiscountedTransactions,\n        totalDiscountAmount: newCustomerMetrics.totalDiscountAmount,\n        avgDiscountPercentage: newCustomerMetrics.avgDiscountPercentage\n      },\n      repeatCustomerMetrics: {\n        revenue: repeatCustomerMetrics.revenue,\n        unitsSold: repeatCustomerMetrics.unitsSold,\n        transactions: repeatCustomerMetrics.transactions,\n        uniqueMembers: repeatCustomerMetrics.uniqueMembers.size,\n        atv: repeatCustomerMetrics.atv,\n        discountedRevenue: repeatCustomerMetrics.discountedRevenue,\n        nonDiscountedRevenue: repeatCustomerMetrics.nonDiscountedRevenue,\n        discountedTransactions: repeatCustomerMetrics.discountedTransactions,\n        nonDiscountedTransactions: repeatCustomerMetrics.nonDiscountedTransactions,\n        totalDiscountAmount: repeatCustomerMetrics.totalDiscountAmount,\n        avgDiscountPercentage: repeatCustomerMetrics.avgDiscountPercentage\n      },\n      \n      totalClients: newClientIds.size + existingClientIds.size,\n      newClients: newClientIds.size,\n      existingClients: existingClientIds.size,\n      clientsWithActiveMembers: clientsWithStackedMemberships.size,\n      clientsWithMultipleMemberships: stackedMembersDetails.length,\n      renewals,\n      upgrades,\n      downgrades,\n      stackingMembers,\n      stackedMembersDetails,\n      dailyAnalytics,\n      membershipAnalytics,\n      \n      // Bifurcated spenders\n      topNewSpenders,\n      topRepeatSpenders,\n      bottomNewSpenders,\n      bottomRepeatSpenders,\n      topSpenders, // Keep for compatibility\n      bottomSpenders, // Keep for compatibility\n      \n      lapsedMembers: lapsedMembers.slice(0, 50), // Top 50 lapsed by LTV\n      totalDiscountGiven,\n      transactionsWithDiscount: discountData.length,\n      avgDiscountPercentage,\n      totalVisits,\n      avgVisitsPerClient,\n      visitToRevenueRatio,\n      newTransactions,\n      repeatTransactions,\n      allTransactions: monthSalesData // Include all raw sales data\n    } as OutlierMonthAnalytics;\n  }, [salesData, checkinsData, newClientData, month, location]);\n};\n","import React, { useState } from 'react';\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { Badge } from '@/components/ui/badge';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { ScrollArea } from '@/components/ui/scroll-area';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { formatCurrency, formatNumber, formatPercentage } from '@/utils/formatters';\nimport { X, TrendingUp, Calendar, DollarSign, Tag, MapPin, Percent, ShoppingCart } from 'lucide-react';\nimport { SpenderData, LapsedMemberData, TransactionDetail } from '@/hooks/useOutlierMonthAnalytics';\nimport { SalesData } from '@/types/dashboard';\n\ninterface OutlierDrillDownModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  data: {\n    type: 'spender' | 'lapsed' | 'new-transactions' | 'repeat-transactions' | 'membership';\n    title: string;\n    spenderData?: SpenderData;\n    lapsedData?: LapsedMemberData;\n    transactions?: TransactionDetail[];\n    membershipTransactions?: SalesData[];\n    membershipName?: string;\n  };\n}\n\nexport const OutlierDrillDownModal: React.FC<OutlierDrillDownModalProps> = ({\n  isOpen,\n  onClose,\n  data\n}) => {\n  const [activeTab, setActiveTab] = useState('overview');\n\n  if (!data) return null;\n\n  const renderSpenderDetails = (spender: SpenderData) => (\n    <div className=\"space-y-6\">\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <div className=\"text-2xl font-bold text-blue-600\">{formatCurrency(spender.totalSpent)}</div>\n            <div className=\"text-sm text-gray-600\">Total Spent</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <div className=\"text-2xl font-bold text-green-600\">{formatNumber(spender.transactions)}</div>\n            <div className=\"text-sm text-gray-600\">Transactions</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <div className=\"text-2xl font-bold text-purple-600\">{formatCurrency(spender.avgTransaction)}</div>\n            <div className=\"text-sm text-gray-600\">Avg Transaction</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <div className=\"text-2xl font-bold text-orange-600\">{formatCurrency(spender.totalDiscountReceived || 0)}</div>\n            <div className=\"text-sm text-gray-600\">Total Discounts</div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-gray-600\">Status:</span>\n              <Badge variant={spender.isNew ? 'default' : 'secondary'} className=\"text-sm\">\n                {spender.isNew ? 'New Client' : 'Repeat Client'}\n              </Badge>\n            </div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-gray-600\">Membership Status:</span>\n              <Badge \n                variant={spender.membershipStatus === 'Active' ? 'default' : 'outline'}\n                className={`text-sm ${\n                  spender.membershipStatus === 'Active' ? 'bg-green-100 text-green-700' :\n                  spender.membershipStatus === 'Frozen' ? 'bg-blue-100 text-blue-700' :\n                  spender.membershipStatus === 'Expired' ? 'bg-red-100 text-red-700' :\n                  'bg-gray-100 text-gray-700'\n                }`}\n              >\n                {spender.membershipStatus || 'None'}\n              </Badge>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {spender.lastMembershipName && (\n        <Card className=\"bg-blue-50 border-blue-200\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-start gap-3\">\n              <Tag className=\"w-5 h-5 text-blue-600 mt-1\" />\n              <div className=\"flex-1\">\n                <div className=\"font-semibold text-gray-900\">{spender.lastMembershipName}</div>\n                <div className=\"text-sm text-gray-700 mt-1\">\n                  End Date: {spender.lastMembershipEndDate ? new Date(spender.lastMembershipEndDate).toLocaleDateString() : 'N/A'}\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <ShoppingCart className=\"w-5 h-5 text-blue-500\" />\n            Transaction History\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <ScrollArea className=\"h-96\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Date</TableHead>\n                  <TableHead>Product</TableHead>\n                  <TableHead>MRP</TableHead>\n                  <TableHead>Amount</TableHead>\n                  <TableHead>Discount</TableHead>\n                  <TableHead>Savings</TableHead>\n                  <TableHead>Location</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {spender.rawTransactions?.map((txn, index) => {\n                  const mrp = txn.mrpPostTax || txn.mrpPreTax || 0;\n                  const savings = mrp > 0 ? mrp - (txn.paymentValue || 0) : 0;\n                  return (\n                    <TableRow key={index}>\n                      <TableCell>{new Date(txn.paymentDate).toLocaleDateString()}</TableCell>\n                      <TableCell className=\"max-w-xs truncate\">{txn.cleanedProduct || txn.paymentItem}</TableCell>\n                      <TableCell className=\"text-gray-500\">\n                        {mrp > 0 ? formatCurrency(mrp) : '-'}\n                      </TableCell>\n                      <TableCell className=\"font-semibold\">{formatCurrency(txn.paymentValue || 0)}</TableCell>\n                      <TableCell>\n                        {(txn.discountAmount || 0) > 0 ? (\n                          <span className=\"text-green-600\">\n                            {formatCurrency(txn.discountAmount || 0)} ({formatPercentage(txn.discountPercentage || 0)})\n                          </span>\n                        ) : '-'}\n                      </TableCell>\n                      <TableCell>\n                        {savings > 0 ? (\n                          <span className=\"text-emerald-600 font-medium\">\n                            {formatCurrency(savings)}\n                          </span>\n                        ) : '-'}\n                      </TableCell>\n                      <TableCell>{txn.calculatedLocation}</TableCell>\n                    </TableRow>\n                  );\n                })}\n              </TableBody>\n            </Table>\n          </ScrollArea>\n        </CardContent>\n      </Card>\n    </div>\n  );\n\n  const renderLapsedDetails = (lapsed: LapsedMemberData) => (\n    <div className=\"space-y-6\">\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <div className=\"text-2xl font-bold text-red-600\">{lapsed.daysSinceLapsed}</div>\n            <div className=\"text-sm text-gray-600\">Days Lapsed</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <div className=\"text-2xl font-bold text-blue-600\">{formatCurrency(lapsed.totalLifetimeValue)}</div>\n            <div className=\"text-sm text-gray-600\">Lifetime Value</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <div className=\"text-2xl font-bold text-purple-600\">{formatCurrency(lapsed.lastPurchaseAmount)}</div>\n            <div className=\"text-sm text-gray-600\">Last Purchase</div>\n          </CardContent>\n        </Card>\n        <Card>\n          <CardContent className=\"p-4 text-center\">\n            <div className=\"text-sm font-semibold text-gray-900\">{lapsed.lastMembershipType}</div>\n            <div className=\"text-xs text-gray-600\">Last Membership</div>\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card className=\"bg-amber-50 border-amber-200\">\n        <CardContent className=\"p-4\">\n          <div className=\"flex items-start gap-3\">\n            <Calendar className=\"w-5 h-5 text-amber-600 mt-1\" />\n            <div>\n              <div className=\"font-semibold text-gray-900\">Membership Ended</div>\n              <div className=\"text-sm text-gray-700\">\n                {new Date(lapsed.lastMembershipEndDate).toLocaleDateString()} - {lapsed.daysSinceLapsed} days ago\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <ShoppingCart className=\"w-5 h-5 text-blue-500\" />\n            Purchase History\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <ScrollArea className=\"h-96\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Date</TableHead>\n                  <TableHead>Product</TableHead>\n                  <TableHead>Amount</TableHead>\n                  <TableHead>Membership End</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {lapsed.rawTransactions?.map((txn, index) => (\n                  <TableRow key={index}>\n                    <TableCell>{new Date(txn.paymentDate).toLocaleDateString()}</TableCell>\n                    <TableCell className=\"max-w-xs truncate\">{txn.cleanedProduct || txn.paymentItem}</TableCell>\n                    <TableCell className=\"font-semibold\">{formatCurrency(txn.paymentValue || 0)}</TableCell>\n                    <TableCell>\n                      {txn.secMembershipEndDate ? new Date(txn.secMembershipEndDate).toLocaleDateString() : '-'}\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          </ScrollArea>\n        </CardContent>\n      </Card>\n    </div>\n  );\n\n  const renderTransactionList = (transactions: TransactionDetail[]) => {\n    const totalRevenue = transactions.reduce((sum, t) => sum + t.paymentValue, 0);\n    const totalDiscount = transactions.reduce((sum, t) => sum + t.discountAmount, 0);\n    const totalMRP = transactions.reduce((sum, t) => sum + (t.mrpPostTax || t.mrpPreTax || 0), 0);\n    const totalSavings = transactions.reduce((sum, t) => sum + (t.savings || 0), 0);\n    const stackedCount = transactions.filter(t => t.isStacked).length;\n    const avgAtv = transactions.length > 0 ? totalRevenue / transactions.length : 0;\n\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"grid grid-cols-2 md:grid-cols-5 gap-4\">\n          <Card>\n            <CardContent className=\"p-4 text-center\">\n              <div className=\"text-2xl font-bold text-blue-600\">{formatCurrency(totalRevenue)}</div>\n              <div className=\"text-sm text-gray-600\">Total Revenue</div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4 text-center\">\n              <div className=\"text-2xl font-bold text-green-600\">{formatNumber(transactions.length)}</div>\n              <div className=\"text-sm text-gray-600\">Transactions</div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4 text-center\">\n              <div className=\"text-2xl font-bold text-purple-600\">{formatCurrency(avgAtv)}</div>\n              <div className=\"text-sm text-gray-600\">Avg ATV</div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4 text-center\">\n              <div className=\"text-2xl font-bold text-orange-600\">{formatCurrency(totalDiscount)}</div>\n              <div className=\"text-sm text-gray-600\">Total Discounts</div>\n            </CardContent>\n          </Card>\n          <Card>\n            <CardContent className=\"p-4 text-center\">\n              <div className=\"text-2xl font-bold text-emerald-600\">{formatCurrency(totalSavings)}</div>\n              <div className=\"text-sm text-gray-600\">Total Savings</div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Transaction Details</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <ScrollArea className=\"h-[500px]\">\n              <Table>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>Date</TableHead>\n                    <TableHead>Customer</TableHead>\n                    <TableHead>Product</TableHead>\n                    <TableHead>MRP</TableHead>\n                    <TableHead>Amount</TableHead>\n                    <TableHead>Discount</TableHead>\n                    <TableHead>Savings</TableHead>\n                    <TableHead>Status</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {transactions.map((txn, index) => {\n                    const mrp = txn.mrpPostTax || txn.mrpPreTax || 0;\n                    const savings = txn.savings || (mrp > 0 ? mrp - txn.paymentValue : 0);\n                    return (\n                      <TableRow key={index}>\n                        <TableCell>{new Date(txn.paymentDate).toLocaleDateString()}</TableCell>\n                        <TableCell className=\"max-w-xs truncate\">{txn.customerName}</TableCell>\n                        <TableCell className=\"max-w-xs truncate\">{txn.product}</TableCell>\n                        <TableCell className=\"text-gray-500\">\n                          {mrp > 0 ? formatCurrency(mrp) : '-'}\n                        </TableCell>\n                        <TableCell className=\"font-semibold\">{formatCurrency(txn.paymentValue)}</TableCell>\n                        <TableCell>\n                          {txn.discountAmount > 0 ? (\n                            <span className=\"text-green-600\">\n                              {formatCurrency(txn.discountAmount)} ({formatPercentage(txn.discountPercentage)})\n                            </span>\n                          ) : '-'}\n                        </TableCell>\n                        <TableCell>\n                          {savings > 0 ? (\n                            <span className=\"text-emerald-600 font-medium\">\n                              {formatCurrency(savings)}\n                            </span>\n                          ) : '-'}\n                        </TableCell>\n                        <TableCell>\n                          <div className=\"flex gap-1\">\n                            {txn.isNew && <Badge variant=\"default\" className=\"text-xs\">New</Badge>}\n                            {txn.isStacked && <Badge variant=\"secondary\" className=\"text-xs\">Stacked</Badge>}\n                          </div>\n                        </TableCell>\n                      </TableRow>\n                    );\n                  })}\n                </TableBody>\n              </Table>\n            </ScrollArea>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"max-w-6xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center justify-between\">\n            <span className=\"flex items-center gap-2\">\n              <TrendingUp className=\"w-5 h-5\" />\n              {data.title}\n            </span>\n            <button\n              onClick={onClose}\n              className=\"p-2 hover:bg-gray-100 rounded-full transition-colors\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          </DialogTitle>\n        </DialogHeader>\n\n        <div className=\"mt-4\">\n          {data.type === 'spender' && data.spenderData && renderSpenderDetails(data.spenderData)}\n          {data.type === 'lapsed' && data.lapsedData && renderLapsedDetails(data.lapsedData)}\n          {(data.type === 'new-transactions' || data.type === 'repeat-transactions') && data.transactions && renderTransactionList(data.transactions)}\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n};\n","import React, { useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { motion } from 'framer-motion';\nimport {\n  TrendingUp, Users, DollarSign, Target, Calendar,\n  Building2, Activity, ShoppingCart, Sparkles, AlertCircle,\n  BarChart3, PieChart, Zap, Award, ArrowUpRight, ArrowDownRight,\n  UserPlus, UserCheck, RefreshCw, TrendingDown, Layers, Percent\n} from 'lucide-react';\nimport { OutlierMonthAnalytics, SpenderData, LapsedMemberData, TransactionDetail } from '@/hooks/useOutlierMonthAnalytics';\nimport { formatCurrency, formatNumber, formatPercentage } from '@/utils/formatters';\nimport {\n  BarChart, Bar, LineChart, Line, PieChart as RechartsPieChart, Pie, Cell,\n  XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer\n} from 'recharts';\nimport { OutlierDrillDownModal } from './OutlierDrillDownModal';\nimport { SalesData } from '@/types/dashboard';\nimport { StackedMemberData } from '@/hooks/useOutlierMonthAnalytics';\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\n\ninterface OutlierMonthDetailProps {\n  analytics: OutlierMonthAnalytics;\n  monthName: string;\n  locationName: string;\n}\n\nconst COLORS = ['#3b82f6', '#8b5cf6', '#ec4899', '#f59e0b', '#10b981', '#06b6d4', '#6366f1'];\n\nexport const OutlierMonthDetail: React.FC<OutlierMonthDetailProps> = ({\n  analytics,\n  monthName,\n  locationName\n}) => {\n  const [chartView, setChartView] = useState<'daily' | 'membership'>('daily');\n  const [selectedStackedMember, setSelectedStackedMember] = useState<StackedMemberData | null>(null);\n  const [modalData, setModalData] = useState<{\n    isOpen: boolean;\n    type: 'spender' | 'lapsed' | 'new-transactions' | 'repeat-transactions' | 'membership';\n    title: string;\n    spenderData?: SpenderData;\n    lapsedData?: LapsedMemberData;\n    transactions?: TransactionDetail[];\n    membershipTransactions?: SalesData[];\n    membershipName?: string;\n  }>({\n    isOpen: false,\n    type: 'new-transactions',\n    title: ''\n  });\n\n  // Calculate percentages\n  const newClientPercentage = analytics.totalRevenue > 0 \n    ? (analytics.newClientRevenue / analytics.totalRevenue) * 100 \n    : 0;\n  const existingClientPercentage = 100 - newClientPercentage;\n  const activePercentage = analytics.totalRevenue > 0\n    ? (analytics.activeMembershipRevenue / analytics.totalRevenue) * 100\n    : 0;\n\n  // Prepare chart data\n  const dailyChartData = analytics.dailyAnalytics.map(day => ({\n    date: new Date(day.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),\n    'Total Revenue': day.revenue,\n    'New Client Revenue': day.newClientRevenue,\n    'Existing Client Revenue': day.existingClientRevenue,\n    'Transactions': day.transactions\n  }));\n\n  const membershipChartData = analytics.membershipAnalytics.slice(0, 10).map(m => ({\n    name: m.membershipName.length > 30 ? m.membershipName.substring(0, 30) + '...' : m.membershipName,\n    revenue: m.revenue,\n    count: m.count\n  }));\n\n  const revenueDistribution = [\n    { name: 'New Clients', value: analytics.newClientRevenue },\n    { name: 'Existing Clients', value: analytics.existingClientRevenue }\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Key Metrics Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        {/* Total Revenue */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.4 }}\n        >\n          <Card className=\"bg-gradient-to-br from-blue-50 to-white border-blue-200 hover:shadow-lg transition-shadow\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <DollarSign className=\"w-8 h-8 text-blue-600\" />\n                <Badge variant=\"secondary\" className=\"bg-blue-100 text-blue-700\">Total</Badge>\n              </div>\n              <div className=\"text-3xl font-bold text-gray-900\">\n                {formatCurrency(analytics.totalRevenue)}\n              </div>\n              <p className=\"text-sm text-gray-600 mt-1\">Total Revenue</p>\n              <div className=\"mt-3 pt-3 border-t border-blue-100\">\n                <div className=\"text-xs text-gray-500\">\n                  {formatNumber(analytics.dailyAnalytics.length)} days tracked\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* New Client Revenue */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.4, delay: 0.1 }}\n          onClick={() => setModalData({\n            isOpen: true,\n            type: 'new-transactions',\n            title: `${monthName} - New Client Transactions (${locationName})`,\n            transactions: analytics.newTransactions\n          })}\n          className=\"cursor-pointer\"\n        >\n          <Card className=\"bg-gradient-to-br from-emerald-50 to-white border-emerald-200 hover:shadow-lg transition-shadow\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <UserPlus className=\"w-8 h-8 text-emerald-600\" />\n                <Badge variant=\"secondary\" className=\"bg-emerald-100 text-emerald-700\">\n                  {formatPercentage(newClientPercentage)}\n                </Badge>\n              </div>\n              <div className=\"text-3xl font-bold text-gray-900\">\n                {formatCurrency(analytics.newClientRevenue)}\n              </div>\n              <p className=\"text-sm text-gray-600 mt-1\">New Client Revenue</p>\n              <div className=\"mt-3 pt-3 border-t border-emerald-100\">\n                <div className=\"text-xs text-gray-500\">\n                  {formatNumber(analytics.newClients)} new clients  Click for details\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Existing Client Revenue */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.4, delay: 0.2 }}\n          onClick={() => setModalData({\n            isOpen: true,\n            type: 'repeat-transactions',\n            title: `${monthName} - Repeat Client Transactions (${locationName})`,\n            transactions: analytics.repeatTransactions\n          })}\n          className=\"cursor-pointer\"\n        >\n          <Card className=\"bg-gradient-to-br from-purple-50 to-white border-purple-200 hover:shadow-lg transition-shadow\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <UserCheck className=\"w-8 h-8 text-purple-600\" />\n                <Badge variant=\"secondary\" className=\"bg-purple-100 text-purple-700\">\n                  {formatPercentage(existingClientPercentage)}\n                </Badge>\n              </div>\n              <div className=\"text-3xl font-bold text-gray-900\">\n                {formatCurrency(analytics.existingClientRevenue)}\n              </div>\n              <p className=\"text-sm text-gray-600 mt-1\">Existing Client Revenue</p>\n              <div className=\"mt-3 pt-3 border-t border-purple-100\">\n                <div className=\"text-xs text-gray-500\">\n                  {formatNumber(analytics.existingClients)} returning clients  Click for details\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Active Membership Revenue */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.4, delay: 0.3 }}\n        >\n          <Card className=\"bg-gradient-to-br from-amber-50 to-white border-amber-200 hover:shadow-lg transition-shadow\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between mb-2\">\n                <Activity className=\"w-8 h-8 text-amber-600\" />\n                <Badge variant=\"secondary\" className=\"bg-amber-100 text-amber-700\">\n                  {formatPercentage(activePercentage)}\n                </Badge>\n              </div>\n              <div className=\"text-3xl font-bold text-gray-900\">\n                {formatCurrency(analytics.activeMembershipRevenue)}\n              </div>\n              <p className=\"text-sm text-gray-600 mt-1\">Active Member Purchases</p>\n              <div className=\"mt-3 pt-3 border-t border-amber-100\">\n                <div className=\"text-xs text-gray-500\">\n                  {formatNumber(analytics.clientsWithActiveMembers)} active members\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      </div>\n\n      {/* Comprehensive Revenue Split Metrics */}\n      {analytics.newCustomerMetrics && analytics.repeatCustomerMetrics && (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          {/* New Customer Metrics */}\n          <motion.div\n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ duration: 0.5 }}\n          >\n          <Card className=\"border-emerald-200 shadow-lg\">\n            <CardHeader className=\"bg-gradient-to-r from-emerald-50 to-green-50\">\n              <CardTitle className=\"flex items-center gap-2\">\n                <UserPlus className=\"w-5 h-5 text-emerald-600\" />\n                New Customer Detailed Metrics\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"pt-6\">\n              <div className=\"grid grid-cols-2 gap-4 mb-6\">\n                <div className=\"bg-emerald-50 p-4 rounded-lg\">\n                  <div className=\"text-xs text-gray-600 mb-1\">Revenue</div>\n                  <div className=\"text-2xl font-bold text-emerald-600\">\n                    {formatCurrency(analytics.newCustomerMetrics.revenue)}\n                  </div>\n                </div>\n                <div className=\"bg-emerald-50 p-4 rounded-lg\">\n                  <div className=\"text-xs text-gray-600 mb-1\">Units Sold</div>\n                  <div className=\"text-2xl font-bold text-emerald-600\">\n                    {formatNumber(analytics.newCustomerMetrics.unitsSold)}\n                  </div>\n                </div>\n                <div className=\"bg-green-50 p-4 rounded-lg\">\n                  <div className=\"text-xs text-gray-600 mb-1\">Transactions</div>\n                  <div className=\"text-2xl font-bold text-green-600\">\n                    {formatNumber(analytics.newCustomerMetrics.transactions)}\n                  </div>\n                </div>\n                <div className=\"bg-green-50 p-4 rounded-lg\">\n                  <div className=\"text-xs text-gray-600 mb-1\">Unique Members</div>\n                  <div className=\"text-2xl font-bold text-green-600\">\n                    {formatNumber(analytics.newCustomerMetrics.uniqueMembers)}\n                  </div>\n                </div>\n                <div className=\"col-span-2 bg-teal-50 p-4 rounded-lg\">\n                  <div className=\"text-xs text-gray-600 mb-1\">Average Transaction Value (ATV)</div>\n                  <div className=\"text-2xl font-bold text-teal-600\">\n                    {formatCurrency(analytics.newCustomerMetrics.atv)}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"pt-4 border-t border-emerald-100\">\n                <h4 className=\"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2\">\n                  <Percent className=\"w-4 h-4 text-orange-500\" />\n                  Discount Analysis\n                </h4>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div \n                    className=\"bg-orange-50 p-3 rounded-lg cursor-pointer hover:bg-orange-100 transition-colors\"\n                    onClick={() => setModalData({\n                      isOpen: true,\n                      type: 'new-transactions',\n                      title: `${monthName} - New Customer Discounted Transactions`,\n                      transactions: analytics.newTransactions.filter(t => t.discountAmount > 0)\n                    })}\n                  >\n                    <div className=\"text-xs text-gray-600\">Discounted Revenue</div>\n                    <div className=\"text-lg font-bold text-orange-600\">\n                      {formatCurrency(analytics.newCustomerMetrics.discountedRevenue)}\n                    </div>\n                    <div className=\"text-xs text-gray-500 mt-1\">\n                      {formatNumber(analytics.newCustomerMetrics.discountedTransactions)} txns\n                    </div>\n                  </div>\n                  <div className=\"bg-gray-50 p-3 rounded-lg\">\n                    <div className=\"text-xs text-gray-600\">Non-Discounted</div>\n                    <div className=\"text-lg font-bold text-gray-700\">\n                      {formatCurrency(analytics.newCustomerMetrics.nonDiscountedRevenue)}\n                    </div>\n                    <div className=\"text-xs text-gray-500 mt-1\">\n                      {formatNumber(analytics.newCustomerMetrics.nonDiscountedTransactions)} txns\n                    </div>\n                  </div>\n                  <div className=\"col-span-2 bg-red-50 p-3 rounded-lg\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-xs text-gray-600\">Total Discounts Given</span>\n                      <span className=\"text-lg font-bold text-red-600\">\n                        {formatCurrency(analytics.newCustomerMetrics.totalDiscountAmount)}\n                      </span>\n                    </div>\n                    <div className=\"text-xs text-gray-500 mt-1\">\n                      Avg: {formatPercentage(analytics.newCustomerMetrics.avgDiscountPercentage)}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Repeat Customer Metrics */}\n        <motion.div\n          initial={{ opacity: 0, x: 20 }}\n          animate={{ opacity: 1, x: 0 }}\n          transition={{ duration: 0.5 }}\n        >\n          <Card className=\"border-purple-200 shadow-lg\">\n            <CardHeader className=\"bg-gradient-to-r from-purple-50 to-indigo-50\">\n              <CardTitle className=\"flex items-center gap-2\">\n                <UserCheck className=\"w-5 h-5 text-purple-600\" />\n                Repeat Customer Detailed Metrics\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"pt-6\">\n              <div className=\"grid grid-cols-2 gap-4 mb-6\">\n                <div className=\"bg-purple-50 p-4 rounded-lg\">\n                  <div className=\"text-xs text-gray-600 mb-1\">Revenue</div>\n                  <div className=\"text-2xl font-bold text-purple-600\">\n                    {formatCurrency(analytics.repeatCustomerMetrics.revenue)}\n                  </div>\n                </div>\n                <div className=\"bg-purple-50 p-4 rounded-lg\">\n                  <div className=\"text-xs text-gray-600 mb-1\">Units Sold</div>\n                  <div className=\"text-2xl font-bold text-purple-600\">\n                    {formatNumber(analytics.repeatCustomerMetrics.unitsSold)}\n                  </div>\n                </div>\n                <div className=\"bg-indigo-50 p-4 rounded-lg\">\n                  <div className=\"text-xs text-gray-600 mb-1\">Transactions</div>\n                  <div className=\"text-2xl font-bold text-indigo-600\">\n                    {formatNumber(analytics.repeatCustomerMetrics.transactions)}\n                  </div>\n                </div>\n                <div className=\"bg-indigo-50 p-4 rounded-lg\">\n                  <div className=\"text-xs text-gray-600 mb-1\">Unique Members</div>\n                  <div className=\"text-2xl font-bold text-indigo-600\">\n                    {formatNumber(analytics.repeatCustomerMetrics.uniqueMembers)}\n                  </div>\n                </div>\n                <div className=\"col-span-2 bg-violet-50 p-4 rounded-lg\">\n                  <div className=\"text-xs text-gray-600 mb-1\">Average Transaction Value (ATV)</div>\n                  <div className=\"text-2xl font-bold text-violet-600\">\n                    {formatCurrency(analytics.repeatCustomerMetrics.atv)}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"pt-4 border-t border-purple-100\">\n                <h4 className=\"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2\">\n                  <Percent className=\"w-4 h-4 text-orange-500\" />\n                  Discount Analysis\n                </h4>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <div \n                    className=\"bg-orange-50 p-3 rounded-lg cursor-pointer hover:bg-orange-100 transition-colors\"\n                    onClick={() => setModalData({\n                      isOpen: true,\n                      type: 'repeat-transactions',\n                      title: `${monthName} - Repeat Customer Discounted Transactions`,\n                      transactions: analytics.repeatTransactions.filter(t => t.discountAmount > 0)\n                    })}\n                  >\n                    <div className=\"text-xs text-gray-600\">Discounted Revenue</div>\n                    <div className=\"text-lg font-bold text-orange-600\">\n                      {formatCurrency(analytics.repeatCustomerMetrics.discountedRevenue)}\n                    </div>\n                    <div className=\"text-xs text-gray-500 mt-1\">\n                      {formatNumber(analytics.repeatCustomerMetrics.discountedTransactions)} txns\n                    </div>\n                  </div>\n                  <div className=\"bg-gray-50 p-3 rounded-lg\">\n                    <div className=\"text-xs text-gray-600\">Non-Discounted</div>\n                    <div className=\"text-lg font-bold text-gray-700\">\n                      {formatCurrency(analytics.repeatCustomerMetrics.nonDiscountedRevenue)}\n                    </div>\n                    <div className=\"text-xs text-gray-500 mt-1\">\n                      {formatNumber(analytics.repeatCustomerMetrics.nonDiscountedTransactions)} txns\n                    </div>\n                  </div>\n                  <div className=\"col-span-2 bg-red-50 p-3 rounded-lg\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-xs text-gray-600\">Total Discounts Given</span>\n                      <span className=\"text-lg font-bold text-red-600\">\n                        {formatCurrency(analytics.repeatCustomerMetrics.totalDiscountAmount)}\n                      </span>\n                    </div>\n                    <div className=\"text-xs text-gray-500 mt-1\">\n                      Avg: {formatPercentage(analytics.repeatCustomerMetrics.avgDiscountPercentage)}\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n        </div>\n      )}\n\n      {/* Membership Behavior Metrics */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <RefreshCw className=\"w-5 h-5 text-blue-600\" />\n            Membership Behavior Analytics\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n            <div className=\"text-center p-4 bg-blue-50 rounded-lg\">\n              <div className=\"text-3xl font-bold text-blue-600\">{formatNumber(analytics.renewals)}</div>\n              <div className=\"text-sm text-gray-600 mt-1\">Renewals</div>\n              <div className=\"text-xs text-gray-500 mt-1\">Same membership repurchased</div>\n            </div>\n            <div className=\"text-center p-4 bg-emerald-50 rounded-lg\">\n              <div className=\"text-3xl font-bold text-emerald-600\">{formatNumber(analytics.upgrades)}</div>\n              <div className=\"text-sm text-gray-600 mt-1\">Upgrades</div>\n              <div className=\"text-xs text-gray-500 mt-1\">Higher value purchase</div>\n            </div>\n            <div className=\"text-center p-4 bg-orange-50 rounded-lg\">\n              <div className=\"text-3xl font-bold text-orange-600\">{formatNumber(analytics.downgrades)}</div>\n              <div className=\"text-sm text-gray-600 mt-1\">Downgrades</div>\n              <div className=\"text-xs text-gray-500 mt-1\">Lower value purchase</div>\n            </div>\n            <div className=\"text-center p-4 bg-purple-50 rounded-lg\">\n              <div className=\"text-3xl font-bold text-purple-600\">{formatNumber(analytics.stackingMembers)}</div>\n              <div className=\"text-sm text-gray-600 mt-1\">Stacking Members</div>\n              <div className=\"text-xs text-gray-500 mt-1\">Multiple memberships</div>\n            </div>\n          </div>\n          <div className=\"mt-4 p-4 bg-blue-50 rounded-lg\">\n            <div className=\"flex items-start gap-2\">\n              <AlertCircle className=\"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm text-gray-700\">\n                <strong>Key Insight:</strong> {analytics.renewals > analytics.upgrades + analytics.downgrades \n                  ? `High renewal rate (${formatNumber(analytics.renewals)}) indicates strong membership satisfaction and loyalty. Members prefer to maintain their current membership level.`\n                  : analytics.upgrades > analytics.renewals \n                  ? `Strong upgrade activity (${formatNumber(analytics.upgrades)}) suggests members are expanding their commitment and engagement with higher-tier offerings.`\n                  : `Balanced membership behavior with ${formatNumber(analytics.renewals)} renewals and ${formatNumber(analytics.upgrades + analytics.downgrades)} tier changes indicates a healthy mix of satisfied members and those adjusting their commitments.`\n                }\n                {analytics.stackingMembers > analytics.totalClients * 0.1 && ` Notable stacking activity (${formatNumber(analytics.stackingMembers)} members) indicates high engagement and willingness to invest in multiple offerings.`}\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Stacked Members Detail Table */}\n      {analytics.stackedMembersDetails && analytics.stackedMembersDetails.length > 0 && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <Layers className=\"w-5 h-5 text-purple-600\" />\n              Stacked Memberships - Detailed Breakdown\n            </CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full\">\n                <thead className=\"bg-purple-50\">\n                  <tr>\n                    <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Customer</th>\n                    <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Email</th>\n                    <th className=\"text-center p-3 text-sm font-semibold text-gray-700\">Total Memberships</th>\n                    <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Total Paid</th>\n                    <th className=\"text-center p-3 text-sm font-semibold text-gray-700\">Actions</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {analytics.stackedMembersDetails.map((member, index) => (\n                    <tr key={index} className=\"border-t hover:bg-purple-50\">\n                      <td className=\"p-3 text-sm text-gray-900 font-medium\">{member.customerName}</td>\n                      <td className=\"p-3 text-sm text-gray-600\">{member.customerEmail}</td>\n                      <td className=\"p-3 text-sm text-center\">\n                        <Badge className=\"bg-purple-100 text-purple-700\">\n                          {member.totalMemberships} Memberships\n                        </Badge>\n                      </td>\n                      <td className=\"p-3 text-sm text-gray-900 text-right font-semibold\">\n                        {formatCurrency(member.totalAmountPaid)}\n                      </td>\n                      <td className=\"p-3 text-sm text-center\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => setSelectedStackedMember(member)}\n                          className=\"text-purple-600 hover:text-purple-700 hover:bg-purple-50\"\n                        >\n                          View Details\n                        </Button>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n            <div className=\"mt-4 p-4 bg-purple-50 rounded-lg\">\n              <div className=\"flex items-start gap-2\">\n                <Sparkles className=\"w-5 h-5 text-purple-600 mt-0.5 flex-shrink-0\" />\n                <div className=\"text-sm text-gray-700\">\n                  <strong>Stacking Insight:</strong> {analytics.stackedMembersDetails.length} members purchased multiple memberships in {monthName}. \n                  Average stacking value: {formatCurrency(analytics.stackedMembersDetails.reduce((sum, m) => sum + m.totalAmountPaid, 0) / analytics.stackedMembersDetails.length)}.\n                  These highly engaged members represent {formatPercentage((analytics.stackedMembersDetails.length / analytics.totalClients) * 100)} of total clients\n                  but contribute {formatPercentage((analytics.stackedMembersDetails.reduce((sum, m) => sum + m.totalAmountPaid, 0) / analytics.totalRevenue) * 100)} of total revenue.\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Revenue Distribution Chart */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <CardTitle className=\"flex items-center gap-2\">\n              <PieChart className=\"w-5 h-5 text-blue-600\" />\n              Revenue Distribution: New vs Existing Clients\n            </CardTitle>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <div className=\"h-80\">\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\n              <RechartsPieChart>\n                <Pie\n                  data={revenueDistribution}\n                  cx=\"50%\"\n                  cy=\"50%\"\n                  labelLine={false}\n                  label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(1)}%`}\n                  outerRadius={120}\n                  fill=\"#8884d8\"\n                  dataKey=\"value\"\n                >\n                  {revenueDistribution.map((entry, index) => (\n                    <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                  ))}\n                </Pie>\n                <Tooltip formatter={(value: number) => formatCurrency(value)} />\n                <Legend />\n              </RechartsPieChart>\n            </ResponsiveContainer>\n          </div>\n          <div className=\"mt-4 p-4 bg-emerald-50 rounded-lg\">\n            <div className=\"flex items-start gap-2\">\n              <AlertCircle className=\"w-5 h-5 text-emerald-600 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm text-gray-700\">\n                <strong>Revenue Composition Analysis:</strong> {newClientPercentage > 50\n                  ? `New client revenue dominates at ${formatPercentage(newClientPercentage)}, indicating strong acquisition momentum but potential dependency on new customer acquisition. Focus on retention strategies to balance revenue sources.`\n                  : `Existing client revenue is ${formatPercentage(existingClientPercentage)} of total, demonstrating strong client retention and loyalty. This creates a stable revenue foundation while new client acquisition contributes ${formatPercentage(newClientPercentage)}.`\n                }\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Daily Trends Chart */}\n      <Card>\n        <CardHeader>\n          <div className=\"flex items-center justify-between\">\n            <CardTitle className=\"flex items-center gap-2\">\n              <BarChart3 className=\"w-5 h-5 text-blue-600\" />\n              Daily Revenue Trends\n            </CardTitle>\n            <div className=\"flex gap-2\">\n              <button\n                onClick={() => setChartView('daily')}\n                className={`px-3 py-1 rounded-lg text-sm font-medium transition ${\n                  chartView === 'daily' \n                    ? 'bg-blue-600 text-white' \n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                }`}\n              >\n                Daily View\n              </button>\n              <button\n                onClick={() => setChartView('membership')}\n                className={`px-3 py-1 rounded-lg text-sm font-medium transition ${\n                  chartView === 'membership' \n                    ? 'bg-blue-600 text-white' \n                    : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                }`}\n              >\n                By Membership\n              </button>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          {chartView === 'daily' ? (\n            <>\n              <div className=\"h-80\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <BarChart data={dailyChartData}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis dataKey=\"date\" />\n                    <YAxis />\n                    <Tooltip formatter={(value: number) => formatCurrency(value)} />\n                    <Legend />\n                    <Bar dataKey=\"New Client Revenue\" fill=\"#10b981\" />\n                    <Bar dataKey=\"Existing Client Revenue\" fill=\"#8b5cf6\" />\n                  </BarChart>\n                </ResponsiveContainer>\n              </div>\n              <div className=\"mt-4 p-4 bg-blue-50 rounded-lg\">\n                <div className=\"flex items-start gap-2\">\n                  <AlertCircle className=\"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-sm text-gray-700\">\n                    <strong>Daily Performance Pattern:</strong> Revenue tracked across {analytics.dailyAnalytics.length} days. \n                    Average daily revenue: {formatCurrency(analytics.totalRevenue / analytics.dailyAnalytics.length)}. \n                    Peak performance days and consistent patterns indicate operational efficiency and strong demand during this period.\n                  </div>\n                </div>\n              </div>\n            </>\n          ) : (\n            <>\n              <div className=\"h-80\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <BarChart data={membershipChartData} layout=\"horizontal\">\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis type=\"number\" />\n                    <YAxis dataKey=\"name\" type=\"category\" width={150} />\n                    <Tooltip formatter={(value: number) => formatCurrency(value)} />\n                    <Legend />\n                    <Bar dataKey=\"revenue\" fill=\"#3b82f6\" name=\"Revenue\" />\n                  </BarChart>\n                </ResponsiveContainer>\n              </div>\n              <div className=\"mt-4 p-4 bg-purple-50 rounded-lg\">\n                <div className=\"flex items-start gap-2\">\n                  <AlertCircle className=\"w-5 h-5 text-purple-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-sm text-gray-700\">\n                    <strong>Top Performing Memberships:</strong> The top membership generated {formatCurrency(analytics.membershipAnalytics[0]?.revenue || 0)} \n                    with {formatNumber(analytics.membershipAnalytics[0]?.count || 0)} purchases. \n                    This concentration indicates clear product-market fit and customer preference for specific offerings.\n                  </div>\n                </div>\n              </div>\n            </>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Membership Breakdown Table */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Layers className=\"w-5 h-5 text-blue-600\" />\n            Membership Performance by Product & Category\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Membership</th>\n                  <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Category</th>\n                  <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Revenue</th>\n                  <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Count</th>\n                  <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Avg Price</th>\n                  <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">New</th>\n                  <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Existing</th>\n                </tr>\n              </thead>\n              <tbody>\n                {analytics.membershipAnalytics.map((membership, index) => (\n                  <tr key={index} className=\"border-t hover:bg-gray-50\">\n                    <td className=\"p-3 text-sm text-gray-900 font-medium\">{membership.membershipName}</td>\n                    <td className=\"p-3 text-sm text-gray-600\">\n                      <Badge variant=\"outline\">{membership.cleanedCategory}</Badge>\n                    </td>\n                    <td className=\"p-3 text-sm text-gray-900 text-right font-semibold\">\n                      {formatCurrency(membership.revenue)}\n                    </td>\n                    <td className=\"p-3 text-sm text-gray-600 text-right\">{formatNumber(membership.count)}</td>\n                    <td className=\"p-3 text-sm text-gray-600 text-right\">{formatCurrency(membership.avgPrice)}</td>\n                    <td className=\"p-3 text-sm text-emerald-600 text-right font-medium\">{formatNumber(membership.newClients)}</td>\n                    <td className=\"p-3 text-sm text-purple-600 text-right font-medium\">{formatNumber(membership.existingClients)}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n          <div className=\"mt-4 p-4 bg-amber-50 rounded-lg\">\n            <div className=\"flex items-start gap-2\">\n              <AlertCircle className=\"w-5 h-5 text-amber-600 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm text-gray-700\">\n                <strong>Product Performance Insight:</strong> Tracking {analytics.membershipAnalytics.length} unique products. \n                Top category is {analytics.membershipAnalytics[0]?.cleanedCategory || 'N/A'}. \n                The mix of new vs existing client purchases across products reveals which offerings attract new clients versus those that drive retention among current members.\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Detailed Transactions Table - Bifurcated by New/Repeat */}\n      {analytics.newTransactions && analytics.repeatTransactions && (\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <ShoppingCart className=\"w-5 h-5 text-indigo-600\" />\n            Detailed Transaction History\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Tabs defaultValue=\"new\" className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-2\">\n              <TabsTrigger value=\"new\" className=\"flex items-center gap-2\">\n                <UserPlus className=\"w-4 h-4\" />\n                New Customer Transactions ({analytics.newTransactions?.length || 0})\n              </TabsTrigger>\n              <TabsTrigger value=\"repeat\" className=\"flex items-center gap-2\">\n                <UserCheck className=\"w-4 h-4\" />\n                Repeat Customer Transactions ({analytics.repeatTransactions?.length || 0})\n              </TabsTrigger>\n            </TabsList>\n\n            {/* New Customer Transactions */}\n            <TabsContent value=\"new\">\n              <div className=\"overflow-x-auto max-h-[600px] overflow-y-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-emerald-50 sticky top-0\">\n                    <tr>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Date</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Customer</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Product</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Category</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">MRP</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Paid</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Discount</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Savings</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Location</th>\n                      <th className=\"text-center p-3 text-sm font-semibold text-gray-700\">Type</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {analytics.newTransactions.slice(0, 100).map((transaction, index) => (\n                      <tr \n                        key={`new-${transaction.transactionId}-${index}`}\n                        className=\"border-t hover:bg-emerald-50 cursor-pointer transition-colors\"\n                        onClick={() => setModalData({\n                          isOpen: true,\n                          type: 'spender',\n                          title: `${transaction.customerName} - Transaction History`,\n                          spenderData: {\n                            memberId: transaction.memberId,\n                            customerName: transaction.customerName,\n                            customerEmail: transaction.customerEmail,\n                            totalSpent: transaction.paymentValue,\n                            transactions: 1,\n                            avgTransaction: transaction.paymentValue,\n                            firstPurchaseDate: transaction.paymentDate,\n                            lastPurchaseDate: transaction.paymentDate,\n                            isNew: true,\n                            rawTransactions: [transaction as any]\n                          }\n                        })}\n                      >\n                        <td className=\"p-3 text-sm text-gray-600\">\n                          {new Date(transaction.paymentDate).toLocaleDateString()}\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-900 font-medium\">\n                          <div>{transaction.customerName}</div>\n                          <div className=\"text-xs text-gray-500\">{transaction.customerEmail}</div>\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-900\">\n                          <div className=\"max-w-xs truncate\" title={transaction.product}>\n                            {transaction.product}\n                          </div>\n                          {transaction.membershipEndDate && (\n                            <div className=\"text-xs text-gray-500\">\n                              Expires: {new Date(transaction.membershipEndDate).toLocaleDateString()}\n                            </div>\n                          )}\n                        </td>\n                        <td className=\"p-3 text-sm\">\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            {transaction.category}\n                          </Badge>\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-900 text-right font-medium\">\n                          {transaction.mrpPostTax ? formatCurrency(transaction.mrpPostTax) : '-'}\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-900 text-right font-semibold\">\n                          {formatCurrency(transaction.paymentValue)}\n                        </td>\n                        <td className=\"p-3 text-sm text-right\">\n                          {transaction.discountAmount > 0 ? (\n                            <span className=\"text-orange-600 font-medium\">\n                              {formatCurrency(transaction.discountAmount)}\n                              {transaction.discountPercentage > 0 && (\n                                <span className=\"text-xs block\">\n                                  ({formatPercentage(transaction.discountPercentage)})\n                                </span>\n                              )}\n                            </span>\n                          ) : (\n                            <span className=\"text-gray-400\">-</span>\n                          )}\n                        </td>\n                        <td className=\"p-3 text-sm text-right\">\n                          {transaction.savings && transaction.savings > 0 ? (\n                            <span className=\"text-green-600 font-medium\">\n                              {formatCurrency(transaction.savings)}\n                            </span>\n                          ) : (\n                            <span className=\"text-gray-400\">-</span>\n                          )}\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-600\">\n                          {transaction.location}\n                        </td>\n                        <td className=\"p-3 text-sm text-center\">\n                          <div className=\"flex flex-col gap-1 items-center\">\n                            {transaction.isStacked && (\n                              <Badge className=\"bg-purple-100 text-purple-700 text-xs\">\n                                Stacked\n                              </Badge>\n                            )}\n                            {transaction.discountType && (\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                {transaction.discountType}\n                              </Badge>\n                            )}\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              {analytics.newTransactions.length > 100 && (\n                <div className=\"mt-3 text-sm text-gray-500 text-center\">\n                  Showing first 100 of {analytics.newTransactions.length} transactions\n                </div>\n              )}\n              <div className=\"mt-4 p-4 bg-emerald-50 rounded-lg\">\n                <div className=\"flex items-start gap-2\">\n                  <Sparkles className=\"w-5 h-5 text-emerald-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-sm text-gray-700\">\n                    <strong>New Customer Transaction Insights:</strong> {analytics.newTransactions.length} transactions from new customers. \n                    Avg transaction value: {formatCurrency(analytics.newCustomerMetrics.atv)}. \n                    {analytics.newCustomerMetrics.discountedTransactions > 0 && (\n                      <> {formatPercentage((analytics.newCustomerMetrics.discountedTransactions / analytics.newCustomerMetrics.transactions) * 100)} of transactions included discounts.</>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </TabsContent>\n\n            {/* Repeat Customer Transactions */}\n            <TabsContent value=\"repeat\">\n              <div className=\"overflow-x-auto max-h-[600px] overflow-y-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-purple-50 sticky top-0\">\n                    <tr>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Date</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Customer</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Product</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Category</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">MRP</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Paid</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Discount</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Savings</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Location</th>\n                      <th className=\"text-center p-3 text-sm font-semibold text-gray-700\">Type</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {analytics.repeatTransactions.slice(0, 100).map((transaction, index) => (\n                      <tr \n                        key={`repeat-${transaction.transactionId}-${index}`}\n                        className=\"border-t hover:bg-purple-50 cursor-pointer transition-colors\"\n                        onClick={() => setModalData({\n                          isOpen: true,\n                          type: 'spender',\n                          title: `${transaction.customerName} - Transaction History`,\n                          spenderData: {\n                            memberId: transaction.memberId,\n                            customerName: transaction.customerName,\n                            customerEmail: transaction.customerEmail,\n                            totalSpent: transaction.paymentValue,\n                            transactions: 1,\n                            avgTransaction: transaction.paymentValue,\n                            firstPurchaseDate: transaction.paymentDate,\n                            lastPurchaseDate: transaction.paymentDate,\n                            isNew: false,\n                            rawTransactions: [transaction as any]\n                          }\n                        })}\n                      >\n                        <td className=\"p-3 text-sm text-gray-600\">\n                          {new Date(transaction.paymentDate).toLocaleDateString()}\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-900 font-medium\">\n                          <div>{transaction.customerName}</div>\n                          <div className=\"text-xs text-gray-500\">{transaction.customerEmail}</div>\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-900\">\n                          <div className=\"max-w-xs truncate\" title={transaction.product}>\n                            {transaction.product}\n                          </div>\n                          {transaction.membershipEndDate && (\n                            <div className=\"text-xs text-gray-500\">\n                              Expires: {new Date(transaction.membershipEndDate).toLocaleDateString()}\n                            </div>\n                          )}\n                        </td>\n                        <td className=\"p-3 text-sm\">\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            {transaction.category}\n                          </Badge>\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-900 text-right font-medium\">\n                          {transaction.mrpPostTax ? formatCurrency(transaction.mrpPostTax) : '-'}\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-900 text-right font-semibold\">\n                          {formatCurrency(transaction.paymentValue)}\n                        </td>\n                        <td className=\"p-3 text-sm text-right\">\n                          {transaction.discountAmount > 0 ? (\n                            <span className=\"text-orange-600 font-medium\">\n                              {formatCurrency(transaction.discountAmount)}\n                              {transaction.discountPercentage > 0 && (\n                                <span className=\"text-xs block\">\n                                  ({formatPercentage(transaction.discountPercentage)})\n                                </span>\n                              )}\n                            </span>\n                          ) : (\n                            <span className=\"text-gray-400\">-</span>\n                          )}\n                        </td>\n                        <td className=\"p-3 text-sm text-right\">\n                          {transaction.savings && transaction.savings > 0 ? (\n                            <span className=\"text-green-600 font-medium\">\n                              {formatCurrency(transaction.savings)}\n                            </span>\n                          ) : (\n                            <span className=\"text-gray-400\">-</span>\n                          )}\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-600\">\n                          {transaction.location}\n                        </td>\n                        <td className=\"p-3 text-sm text-center\">\n                          <div className=\"flex flex-col gap-1 items-center\">\n                            {transaction.isStacked && (\n                              <Badge className=\"bg-purple-100 text-purple-700 text-xs\">\n                                Stacked\n                              </Badge>\n                            )}\n                            {transaction.discountType && (\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                {transaction.discountType}\n                              </Badge>\n                            )}\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              {analytics.repeatTransactions.length > 100 && (\n                <div className=\"mt-3 text-sm text-gray-500 text-center\">\n                  Showing first 100 of {analytics.repeatTransactions.length} transactions\n                </div>\n              )}\n              <div className=\"mt-4 p-4 bg-purple-50 rounded-lg\">\n                <div className=\"flex items-start gap-2\">\n                  <RefreshCw className=\"w-5 h-5 text-purple-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-sm text-gray-700\">\n                    <strong>Repeat Customer Transaction Insights:</strong> {analytics.repeatTransactions.length} transactions from repeat customers. \n                    Avg transaction value: {formatCurrency(analytics.repeatCustomerMetrics.atv)}. \n                    {analytics.repeatCustomerMetrics.discountedTransactions > 0 && (\n                      <> {formatPercentage((analytics.repeatCustomerMetrics.discountedTransactions / analytics.repeatCustomerMetrics.transactions) * 100)} of transactions included discounts.</>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </TabsContent>\n          </Tabs>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Top Spenders Table - Bifurcated by New/Repeat */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Award className=\"w-5 h-5 text-amber-600\" />\n            Top 20 Spenders - New vs Repeat Customers\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Tabs defaultValue=\"new\" className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-2\">\n              <TabsTrigger value=\"new\" className=\"flex items-center gap-2\">\n                <UserPlus className=\"w-4 h-4\" />\n                New Customers ({analytics.topNewSpenders?.length || 0})\n              </TabsTrigger>\n              <TabsTrigger value=\"repeat\" className=\"flex items-center gap-2\">\n                <UserCheck className=\"w-4 h-4\" />\n                Repeat Customers ({analytics.topRepeatSpenders?.length || 0})\n              </TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"new\" className=\"mt-4\">\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-emerald-50\">\n                    <tr>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Rank</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Customer</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Email</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Total Spent</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Transactions</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Discounts</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Membership</th>\n                      <th className=\"text-center p-3 text-sm font-semibold text-gray-700\">Status</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {analytics.topNewSpenders.map((spender, index) => (\n                      <tr \n                        key={index} \n                        className=\"border-t hover:bg-emerald-50 cursor-pointer transition-colors\"\n                        onClick={() => setModalData({\n                          isOpen: true,\n                          type: 'spender',\n                          title: `${spender.customerName} - Transaction History`,\n                          spenderData: spender\n                        })}\n                      >\n                        <td className=\"p-3 text-sm text-gray-600\">#{index + 1}</td>\n                        <td className=\"p-3 text-sm text-gray-900 font-medium\">{spender.customerName}</td>\n                        <td className=\"p-3 text-sm text-gray-600\">{spender.customerEmail}</td>\n                        <td className=\"p-3 text-sm text-gray-900 text-right font-semibold\">\n                          {formatCurrency(spender.totalSpent)}\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-600 text-right\">{formatNumber(spender.transactions)}</td>\n                        <td className=\"p-3 text-sm text-orange-600 text-right font-medium\">\n                          {formatCurrency(spender.totalDiscountReceived || 0)}\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-600\">\n                          <div>\n                            <div className=\"font-medium truncate max-w-xs\">{spender.lastMembershipName || 'N/A'}</div>\n                            {spender.lastMembershipEndDate && (\n                              <div className=\"text-xs text-gray-500\">\n                                Ends: {new Date(spender.lastMembershipEndDate).toLocaleDateString()}\n                              </div>\n                            )}\n                          </div>\n                        </td>\n                        <td className=\"p-3 text-center\">\n                          <Badge \n                            variant=\"default\"\n                            className={`text-xs ${\n                              spender.membershipStatus === 'Active' ? 'bg-green-100 text-green-700' :\n                              spender.membershipStatus === 'Frozen' ? 'bg-blue-100 text-blue-700' :\n                              spender.membershipStatus === 'Expired' ? 'bg-red-100 text-red-700' :\n                              'bg-gray-100 text-gray-700'\n                            }`}\n                          >\n                            {spender.membershipStatus || 'None'}\n                          </Badge>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              <div className=\"mt-4 p-4 bg-emerald-50 rounded-lg\">\n                <div className=\"flex items-start gap-2\">\n                  <AlertCircle className=\"w-5 h-5 text-emerald-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-sm text-gray-700\">\n                    <strong>New Customer High-Value Analysis:</strong> Top {analytics.topNewSpenders.length} new customer spenders contributed {formatCurrency(analytics.topNewSpenders.reduce((sum, s) => sum + s.totalSpent, 0))}, \n                    demonstrating strong initial engagement. Average spending: {formatCurrency(analytics.topNewSpenders.reduce((sum, s) => sum + s.totalSpent, 0) / Math.max(analytics.topNewSpenders.length, 1))} per customer.\n                    Total discounts given: {formatCurrency(analytics.topNewSpenders.reduce((sum, s) => sum + (s.totalDiscountReceived || 0), 0))}.\n                  </div>\n                </div>\n              </div>\n            </TabsContent>\n\n            <TabsContent value=\"repeat\" className=\"mt-4\">\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-purple-50\">\n                    <tr>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Rank</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Customer</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Email</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Total Spent</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Transactions</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Discounts</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Membership</th>\n                      <th className=\"text-center p-3 text-sm font-semibold text-gray-700\">Status</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {analytics.topRepeatSpenders.map((spender, index) => (\n                      <tr \n                        key={index} \n                        className=\"border-t hover:bg-purple-50 cursor-pointer transition-colors\"\n                        onClick={() => setModalData({\n                          isOpen: true,\n                          type: 'spender',\n                          title: `${spender.customerName} - Transaction History`,\n                          spenderData: spender\n                        })}\n                      >\n                        <td className=\"p-3 text-sm text-gray-600\">#{index + 1}</td>\n                        <td className=\"p-3 text-sm text-gray-900 font-medium\">{spender.customerName}</td>\n                        <td className=\"p-3 text-sm text-gray-600\">{spender.customerEmail}</td>\n                        <td className=\"p-3 text-sm text-gray-900 text-right font-semibold\">\n                          {formatCurrency(spender.totalSpent)}\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-600 text-right\">{formatNumber(spender.transactions)}</td>\n                        <td className=\"p-3 text-sm text-orange-600 text-right font-medium\">\n                          {formatCurrency(spender.totalDiscountReceived || 0)}\n                        </td>\n                        <td className=\"p-3 text-sm text-gray-600\">\n                          <div>\n                            <div className=\"font-medium truncate max-w-xs\">{spender.lastMembershipName || 'N/A'}</div>\n                            {spender.lastMembershipEndDate && (\n                              <div className=\"text-xs text-gray-500\">\n                                Ends: {new Date(spender.lastMembershipEndDate).toLocaleDateString()}\n                              </div>\n                            )}\n                          </div>\n                        </td>\n                        <td className=\"p-3 text-center\">\n                          <Badge \n                            variant=\"default\"\n                            className={`text-xs ${\n                              spender.membershipStatus === 'Active' ? 'bg-green-100 text-green-700' :\n                              spender.membershipStatus === 'Frozen' ? 'bg-blue-100 text-blue-700' :\n                              spender.membershipStatus === 'Expired' ? 'bg-red-100 text-red-700' :\n                              'bg-gray-100 text-gray-700'\n                            }`}\n                          >\n                            {spender.membershipStatus || 'None'}\n                          </Badge>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              <div className=\"mt-4 p-4 bg-purple-50 rounded-lg\">\n                <div className=\"flex items-start gap-2\">\n                  <AlertCircle className=\"w-5 h-5 text-purple-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-sm text-gray-700\">\n                    <strong>Repeat Customer High-Value Analysis:</strong> Top {analytics.topRepeatSpenders.length} repeat customer spenders contributed {formatCurrency(analytics.topRepeatSpenders.reduce((sum, s) => sum + s.totalSpent, 0))}, \n                    representing {formatPercentage((analytics.topRepeatSpenders.reduce((sum, s) => sum + s.totalSpent, 0) / analytics.totalRevenue) * 100)} of total revenue.\n                    These loyal customers demonstrate consistent engagement with average: {formatCurrency(analytics.topRepeatSpenders.reduce((sum, s) => sum + s.totalSpent, 0) / Math.max(analytics.topRepeatSpenders.length, 1))} per customer.\n                  </div>\n                </div>\n              </div>\n            </TabsContent>\n          </Tabs>\n        </CardContent>\n      </Card>\n\n      {/* Bottom Spenders (Low Value) - Bifurcated */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <TrendingDown className=\"w-5 h-5 text-gray-600\" />\n            Bottom 20 Spenders - New vs Repeat Customers\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Tabs defaultValue=\"new\" className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-2\">\n              <TabsTrigger value=\"new\">New Customers ({analytics.bottomNewSpenders?.length || 0})</TabsTrigger>\n              <TabsTrigger value=\"repeat\">Repeat Customers ({analytics.bottomRepeatSpenders?.length || 0})</TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"new\" className=\"mt-4\">\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-gray-50\">\n                    <tr>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Customer</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Email</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Total Spent</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Transactions</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Membership</th>\n                      <th className=\"text-center p-3 text-sm font-semibold text-gray-700\">Status</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {analytics.bottomNewSpenders.map((spender, index) => (\n                      <tr \n                        key={index} \n                        className=\"border-t hover:bg-gray-50 cursor-pointer transition-colors\"\n                        onClick={() => setModalData({\n                          isOpen: true,\n                          type: 'spender',\n                          title: `${spender.customerName} - Transaction History`,\n                          spenderData: spender\n                        })}\n                      >\n                        <td className=\"p-3 text-sm text-gray-900 font-medium\">{spender.customerName}</td>\n                        <td className=\"p-3 text-sm text-gray-600\">{spender.customerEmail}</td>\n                        <td className=\"p-3 text-sm text-gray-900 text-right\">{formatCurrency(spender.totalSpent)}</td>\n                        <td className=\"p-3 text-sm text-gray-600 text-right\">{formatNumber(spender.transactions)}</td>\n                        <td className=\"p-3 text-sm text-gray-600 truncate max-w-xs\">{spender.lastMembershipName || 'N/A'}</td>\n                        <td className=\"p-3 text-center\">\n                          <Badge \n                            variant=\"default\"\n                            className={`text-xs ${\n                              spender.membershipStatus === 'Active' ? 'bg-green-100 text-green-700' :\n                              spender.membershipStatus === 'Frozen' ? 'bg-blue-100 text-blue-700' :\n                              spender.membershipStatus === 'Expired' ? 'bg-red-100 text-red-700' :\n                              'bg-gray-100 text-gray-700'\n                            }`}\n                          >\n                            {spender.membershipStatus || 'None'}\n                          </Badge>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n                <div className=\"flex items-start gap-2\">\n                  <AlertCircle className=\"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-sm text-gray-700\">\n                    <strong>New Customer Growth Opportunity:</strong> These new customers represent upselling potential through targeted engagement. \n                    Many may be trial or single-purchase customers discovering your offerings. Nurture campaigns could convert them into higher-value relationships.\n                  </div>\n                </div>\n              </div>\n            </TabsContent>\n\n            <TabsContent value=\"repeat\" className=\"mt-4\">\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-gray-50\">\n                    <tr>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Customer</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Email</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Total Spent</th>\n                      <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Transactions</th>\n                      <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Membership</th>\n                      <th className=\"text-center p-3 text-sm font-semibold text-gray-700\">Status</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {analytics.bottomRepeatSpenders.map((spender, index) => (\n                      <tr \n                        key={index} \n                        className=\"border-t hover:bg-gray-50 cursor-pointer transition-colors\"\n                        onClick={() => setModalData({\n                          isOpen: true,\n                          type: 'spender',\n                          title: `${spender.customerName} - Transaction History`,\n                          spenderData: spender\n                        })}\n                      >\n                        <td className=\"p-3 text-sm text-gray-900 font-medium\">{spender.customerName}</td>\n                        <td className=\"p-3 text-sm text-gray-600\">{spender.customerEmail}</td>\n                        <td className=\"p-3 text-sm text-gray-900 text-right\">{formatCurrency(spender.totalSpent)}</td>\n                        <td className=\"p-3 text-sm text-gray-600 text-right\">{formatNumber(spender.transactions)}</td>\n                        <td className=\"p-3 text-sm text-gray-600 truncate max-w-xs\">{spender.lastMembershipName || 'N/A'}</td>\n                        <td className=\"p-3 text-center\">\n                          <Badge \n                            variant=\"default\"\n                            className={`text-xs ${\n                              spender.membershipStatus === 'Active' ? 'bg-green-100 text-green-700' :\n                              spender.membershipStatus === 'Frozen' ? 'bg-blue-100 text-blue-700' :\n                              spender.membershipStatus === 'Expired' ? 'bg-red-100 text-red-700' :\n                              'bg-gray-100 text-gray-700'\n                            }`}\n                          >\n                            {spender.membershipStatus || 'None'}\n                          </Badge>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              <div className=\"mt-4 p-4 bg-gray-50 rounded-lg\">\n                <div className=\"flex items-start gap-2\">\n                  <AlertCircle className=\"w-5 h-5 text-gray-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-sm text-gray-700\">\n                    <strong>Repeat Customer Retention Insight:</strong> These lower-value repeat customers show continued loyalty despite modest spending. \n                    Re-engagement campaigns and personalized offers could help increase their lifetime value while maintaining the relationship.\n                  </div>\n                </div>\n              </div>\n            </TabsContent>\n          </Tabs>\n        </CardContent>\n      </Card>\n\n      {/* Lapsed Members Analysis */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <AlertCircle className=\"w-5 h-5 text-red-600\" />\n            Lapsed Members (Top 50 by Lifetime Value)\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Customer</th>\n                  <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Email</th>\n                  <th className=\"text-left p-3 text-sm font-semibold text-gray-700\">Last Membership</th>\n                  <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Lapsed Date</th>\n                  <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Days Since</th>\n                  <th className=\"text-right p-3 text-sm font-semibold text-gray-700\">Lifetime Value</th>\n                </tr>\n              </thead>\n              <tbody>\n                {analytics.lapsedMembers.slice(0, 50).map((member, index) => (\n                  <tr \n                    key={index} \n                    className=\"border-t hover:bg-red-50 cursor-pointer transition-colors\"\n                    onClick={() => setModalData({\n                      isOpen: true,\n                      type: 'lapsed',\n                      title: `${member.customerName} - Lapsed Member Details`,\n                      lapsedData: member\n                    })}\n                  >\n                    <td className=\"p-3 text-sm text-gray-900 font-medium\">{member.customerName}</td>\n                    <td className=\"p-3 text-sm text-gray-600\">{member.customerEmail}</td>\n                    <td className=\"p-3 text-sm text-gray-600\">{member.lastMembershipType}</td>\n                    <td className=\"p-3 text-sm text-gray-600 text-right\">{member.lastMembershipEndDate}</td>\n                    <td className=\"p-3 text-sm text-red-600 text-right font-medium\">{formatNumber(member.daysSinceLapsed)}</td>\n                    <td className=\"p-3 text-sm text-gray-900 text-right font-semibold\">\n                      {formatCurrency(member.totalLifetimeValue)}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n          <div className=\"mt-4 p-4 bg-red-50 rounded-lg\">\n            <div className=\"flex items-start gap-2\">\n              <AlertCircle className=\"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm text-gray-700\">\n                <strong>Critical Churn Risk:</strong> {analytics.lapsedMembers.length} high-value members have lapsed memberships. \n                Combined lifetime value: {formatCurrency(analytics.lapsedMembers.reduce((sum, m) => sum + m.totalLifetimeValue, 0))}. \n                These are proven customers with significant historical spend - immediate win-back campaigns targeting these members could recover substantial revenue. \n                Prioritize those lapsed within 30-60 days for highest conversion probability.\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Discount Analytics */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Percent className=\"w-5 h-5 text-orange-600\" />\n            Discount & Promotion Analytics\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">\n            <div className=\"text-center p-4 bg-orange-50 rounded-lg\">\n              <div className=\"text-3xl font-bold text-orange-600\">\n                {formatCurrency(analytics.totalDiscountGiven)}\n              </div>\n              <div className=\"text-sm text-gray-600 mt-1\">Total Discounts Given</div>\n            </div>\n            <div className=\"text-center p-4 bg-orange-50 rounded-lg\">\n              <div className=\"text-3xl font-bold text-orange-600\">\n                {formatNumber(analytics.transactionsWithDiscount)}\n              </div>\n              <div className=\"text-sm text-gray-600 mt-1\">Transactions with Discount</div>\n            </div>\n            <div className=\"text-center p-4 bg-orange-50 rounded-lg\">\n              <div className=\"text-3xl font-bold text-orange-600\">\n                {formatPercentage(analytics.avgDiscountPercentage)}\n              </div>\n              <div className=\"text-sm text-gray-600 mt-1\">Average Discount %</div>\n            </div>\n          </div>\n          <div className=\"mt-4 p-4 bg-orange-50 rounded-lg\">\n            <div className=\"flex items-start gap-2\">\n              <AlertCircle className=\"w-5 h-5 text-orange-600 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm text-gray-700\">\n                <strong>Promotion Impact:</strong> {formatPercentage((analytics.transactionsWithDiscount / analytics.dailyAnalytics.reduce((sum, d) => sum + d.transactions, 0)) * 100)} of transactions \n                used discounts, resulting in {formatCurrency(analytics.totalDiscountGiven)} in revenue reduction. \n                Average discount of {formatPercentage(analytics.avgDiscountPercentage)} suggests {analytics.avgDiscountPercentage > 15 ? 'aggressive' : 'moderate'} promotional activity. \n                Monitor discount dependency to ensure long-term profitability while maintaining customer acquisition momentum.\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Visit Analytics */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Calendar className=\"w-5 h-5 text-blue-600\" />\n            Visit & Engagement Analytics\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">\n            <div className=\"text-center p-4 bg-blue-50 rounded-lg\">\n              <div className=\"text-3xl font-bold text-blue-600\">\n                {formatNumber(analytics.totalVisits)}\n              </div>\n              <div className=\"text-sm text-gray-600 mt-1\">Total Check-ins</div>\n            </div>\n            <div className=\"text-center p-4 bg-blue-50 rounded-lg\">\n              <div className=\"text-3xl font-bold text-blue-600\">\n                {analytics.avgVisitsPerClient.toFixed(1)}\n              </div>\n              <div className=\"text-sm text-gray-600 mt-1\">Avg Visits per Client</div>\n            </div>\n            <div className=\"text-center p-4 bg-blue-50 rounded-lg\">\n              <div className=\"text-3xl font-bold text-blue-600\">\n                {analytics.visitToRevenueRatio.toFixed(2)}\n              </div>\n              <div className=\"text-sm text-gray-600 mt-1\">Visits per 1K Revenue</div>\n            </div>\n          </div>\n          <div className=\"mt-4 p-4 bg-blue-50 rounded-lg\">\n            <div className=\"flex items-start gap-2\">\n              <AlertCircle className=\"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0\" />\n              <div className=\"text-sm text-gray-700\">\n                <strong>Engagement Pattern:</strong> {analytics.totalVisits} check-ins demonstrate strong facility utilization. \n                Average of {analytics.avgVisitsPerClient.toFixed(1)} visits per client indicates {analytics.avgVisitsPerClient > 8 ? 'high' : analytics.avgVisitsPerClient > 4 ? 'moderate' : 'low'} engagement levels. \n                The visit-to-revenue ratio of {analytics.visitToRevenueRatio.toFixed(2)} helps benchmark operational efficiency and pricing adequacy relative to usage patterns.\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Drill Down Modal */}\n      <OutlierDrillDownModal\n        isOpen={modalData.isOpen}\n        onClose={() => setModalData({ ...modalData, isOpen: false })}\n        data={modalData}\n      />\n\n      {/* Stacked Member Details Modal */}\n      <Dialog open={!!selectedStackedMember} onOpenChange={() => setSelectedStackedMember(null)}>\n        <DialogContent className=\"max-w-3xl max-h-[80vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Layers className=\"w-5 h-5 text-purple-600\" />\n              Stacked Memberships Details\n            </DialogTitle>\n            <DialogDescription>\n              {selectedStackedMember && (\n                <>\n                  <div className=\"text-base font-semibold text-gray-900 mt-2\">\n                    {selectedStackedMember.customerName}\n                  </div>\n                  <div className=\"text-sm text-gray-600\">{selectedStackedMember.customerEmail}</div>\n                </>\n              )}\n            </DialogDescription>\n          </DialogHeader>\n          \n          {selectedStackedMember && (\n            <div className=\"space-y-4 mt-4\">\n              {/* Summary Stats */}\n              <div className=\"grid grid-cols-2 gap-4 p-4 bg-purple-50 rounded-lg\">\n                <div>\n                  <div className=\"text-sm text-gray-600\">Total Memberships</div>\n                  <div className=\"text-2xl font-bold text-purple-600\">\n                    {selectedStackedMember.totalMemberships}\n                  </div>\n                </div>\n                <div>\n                  <div className=\"text-sm text-gray-600\">Total Amount Paid</div>\n                  <div className=\"text-2xl font-bold text-purple-600\">\n                    {formatCurrency(selectedStackedMember.totalAmountPaid)}\n                  </div>\n                </div>\n              </div>\n\n              {/* Membership Details */}\n              <div>\n                <h4 className=\"font-semibold text-gray-900 mb-3\">Membership Breakdown</h4>\n                <div className=\"space-y-3\">\n                  {selectedStackedMember.memberships.map((membership, idx) => (\n                    <div key={idx} className=\"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow\">\n                      <div className=\"flex justify-between items-start mb-3\">\n                        <div className=\"flex-1\">\n                          <h5 className=\"font-semibold text-gray-900 text-lg\">\n                            {membership.membershipName}\n                          </h5>\n                          <Badge variant=\"outline\" className=\"mt-1\">\n                            {membership.category}\n                          </Badge>\n                        </div>\n                        <div className=\"text-right\">\n                          <div className=\"text-2xl font-bold text-gray-900\">\n                            {formatCurrency(membership.amountPaid)}\n                          </div>\n                          {membership.discountAmount && membership.discountAmount > 0 && (\n                            <div className=\"text-sm text-orange-600 font-medium mt-1\">\n                              Save {formatCurrency(membership.discountAmount)}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                      \n                      <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                        <div>\n                          <div className=\"text-gray-500\">Purchase Date</div>\n                          <div className=\"font-medium text-gray-900\">\n                            {new Date(membership.purchaseDate).toLocaleDateString('en-US', {\n                              year: 'numeric',\n                              month: 'long',\n                              day: 'numeric'\n                            })}\n                          </div>\n                        </div>\n                        {membership.endDate && (\n                          <div>\n                            <div className=\"text-gray-500\">Expiry Date</div>\n                            <div className=\"font-medium text-gray-900\">\n                              {new Date(membership.endDate).toLocaleDateString('en-US', {\n                                year: 'numeric',\n                                month: 'long',\n                                day: 'numeric'\n                              })}\n                            </div>\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              </div>\n\n              {/* Insights */}\n              <div className=\"p-4 bg-blue-50 rounded-lg\">\n                <div className=\"flex items-start gap-2\">\n                  <Sparkles className=\"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0\" />\n                  <div className=\"text-sm text-gray-700\">\n                    <strong>Member Value:</strong> This customer purchased {selectedStackedMember.totalMemberships} memberships \n                    for a total of {formatCurrency(selectedStackedMember.totalAmountPaid)}, \n                    averaging {formatCurrency(selectedStackedMember.totalAmountPaid / selectedStackedMember.totalMemberships)} per membership. \n                    {selectedStackedMember.memberships.some(m => m.discountAmount && m.discountAmount > 0) && (\n                      <> They saved a total of {formatCurrency(selectedStackedMember.memberships.reduce((sum, m) => sum + (m.discountAmount || 0), 0))} through discounts.</>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n};\n","import React, { useState, useMemo } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Badge } from '@/components/ui/badge';\nimport { motion } from 'framer-motion';\nimport { Calendar, Building2, Sparkles } from 'lucide-react';\nimport { SalesData, NewClientData } from '@/types/dashboard';\nimport { CheckinData } from '@/hooks/useCheckinsData';\nimport { formatCurrency, formatNumber, formatPercentage } from '@/utils/formatters';\nimport { useOutlierMonthAnalytics } from '@/hooks/useOutlierMonthAnalytics';\nimport { OutlierMonthDetail } from '@/components/dashboard/OutlierMonthDetail';\nimport { InfoPopover } from '@/components/ui/InfoSidebar';\n\ninterface OutlierAnalysisSectionProps {\n  salesData: SalesData[];\n  sessionsData?: any[];\n  checkinsData?: CheckinData[];\n  expirationsData?: any[];\n  leadsData?: any[];\n  newClientData?: NewClientData[];\n}\n\nexport const OutlierAnalysisSection: React.FC<OutlierAnalysisSectionProps> = ({\n  salesData,\n  checkinsData = [],\n  newClientData = []\n}) => {\n  const [activeMonth, setActiveMonth] = useState<'april' | 'august'>('april');\n  const [activeLocation, setActiveLocation] = useState<string>('kwality');\n\n  const availableLocations = useMemo(() => {\n    const monthConfig = activeMonth === 'april' \n      ? { year: 2025, monthIndex: 3 }\n      : { year: 2025, monthIndex: 7 };\n    \n    const monthData = salesData.filter(item => {\n      if (!item.paymentDate) return false;\n      const date = new Date(item.paymentDate);\n      return date.getFullYear() === monthConfig.year && \n             date.getMonth() === monthConfig.monthIndex &&\n             item.paymentStatus === 'succeeded';\n    });\n\n    const locations = new Set(monthData.map(item => item.calculatedLocation || 'Unknown'));\n    return ['all', ...Array.from(locations).sort()];\n  }, [salesData, activeMonth]);\n\n  const aprilAllAnalytics = useOutlierMonthAnalytics(salesData, checkinsData, newClientData, 'april', undefined);\n  const augustAllAnalytics = useOutlierMonthAnalytics(salesData, checkinsData, newClientData, 'august', undefined);\n  const aprilLocationAnalytics = useOutlierMonthAnalytics(salesData, checkinsData, newClientData, 'april', activeLocation !== 'all' ? activeLocation : undefined);\n  const augustLocationAnalytics = useOutlierMonthAnalytics(salesData, checkinsData, newClientData, 'august', activeLocation !== 'all' ? activeLocation : undefined);\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n        <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.4 }}>\n          <Card className=\"bg-gradient-to-br from-blue-50 to-white border-blue-200 hover:shadow-xl transition-shadow\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                <span className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-5 h-5 text-blue-600\" />\n                  April 2025\n                </span>\n                <Badge className=\"bg-blue-100 text-blue-700\">\n                  {formatNumber(aprilAllAnalytics.totalClients)} Clients\n                </Badge>\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-sm text-gray-600\">Total Revenue</span>\n                <span className=\"text-2xl font-bold text-blue-600\">{formatCurrency(aprilAllAnalytics.totalRevenue)}</span>\n              </div>\n              <div className=\"grid grid-cols-2 gap-3\">\n                <div className=\"bg-emerald-50 p-3 rounded-lg\">\n                  <div className=\"text-xs text-gray-600\">New Clients</div>\n                  <div className=\"text-lg font-bold text-emerald-600\">{formatCurrency(aprilAllAnalytics.newClientRevenue)}</div>\n                  <div className=\"text-xs text-gray-500\">{formatPercentage((aprilAllAnalytics.newClientRevenue / aprilAllAnalytics.totalRevenue) * 100)}</div>\n                </div>\n                <div className=\"bg-purple-50 p-3 rounded-lg\">\n                  <div className=\"text-xs text-gray-600\">Existing</div>\n                  <div className=\"text-lg font-bold text-purple-600\">{formatCurrency(aprilAllAnalytics.existingClientRevenue)}</div>\n                  <div className=\"text-xs text-gray-500\">{formatPercentage((aprilAllAnalytics.existingClientRevenue / aprilAllAnalytics.totalRevenue) * 100)}</div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        <motion.div initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} transition={{ duration: 0.4, delay: 0.1 }}>\n          <Card className=\"bg-gradient-to-br from-purple-50 to-white border-purple-200 hover:shadow-xl transition-shadow\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center justify-between\">\n                <span className=\"flex items-center gap-2\">\n                  <Calendar className=\"w-5 h-5 text-purple-600\" />\n                  August 2025\n                </span>\n                <Badge className=\"bg-purple-100 text-purple-700\">\n                  {formatNumber(augustAllAnalytics.totalClients)} Clients\n                </Badge>\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-3\">\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-sm text-gray-600\">Total Revenue</span>\n                <span className=\"text-2xl font-bold text-purple-600\">{formatCurrency(augustAllAnalytics.totalRevenue)}</span>\n              </div>\n              <div className=\"grid grid-cols-2 gap-3\">\n                <div className=\"bg-emerald-50 p-3 rounded-lg\">\n                  <div className=\"text-xs text-gray-600\">New Clients</div>\n                  <div className=\"text-lg font-bold text-emerald-600\">{formatCurrency(augustAllAnalytics.newClientRevenue)}</div>\n                  <div className=\"text-xs text-gray-500\">{formatPercentage((augustAllAnalytics.newClientRevenue / augustAllAnalytics.totalRevenue) * 100)}</div>\n                </div>\n                <div className=\"bg-purple-50 p-3 rounded-lg\">\n                  <div className=\"text-xs text-gray-600\">Existing</div>\n                  <div className=\"text-lg font-bold text-purple-600\">{formatCurrency(augustAllAnalytics.existingClientRevenue)}</div>\n                  <div className=\"text-xs text-gray-500\">{formatPercentage((augustAllAnalytics.existingClientRevenue / augustAllAnalytics.totalRevenue) * 100)}</div>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n      </div>\n\n      <Card className=\"bg-gradient-to-br from-amber-50 to-white border-amber-200\">\n        <CardContent className=\"p-6\">\n          <div className=\"flex items-start gap-3\">\n            <Sparkles className=\"w-6 h-6 text-amber-600 mt-1 flex-shrink-0\" />\n            <div>\n              <div className=\"font-semibold text-lg text-gray-900 mb-2\">Month-over-Month Comparison</div>\n              <div className=\"text-sm text-gray-700 space-y-1\">\n                <p><strong>Revenue Difference:</strong> {augustAllAnalytics.totalRevenue > aprilAllAnalytics.totalRevenue ? 'August' : 'April'} generated {formatCurrency(Math.abs(augustAllAnalytics.totalRevenue - aprilAllAnalytics.totalRevenue))} more ({formatPercentage(Math.abs((augustAllAnalytics.totalRevenue - aprilAllAnalytics.totalRevenue) / aprilAllAnalytics.totalRevenue) * 100)} change).</p>\n                <p><strong>Client Acquisition:</strong> April brought in {formatNumber(aprilAllAnalytics.newClients)} new clients vs August's {formatNumber(augustAllAnalytics.newClients)}.</p>\n                <p><strong>Member Behavior:</strong> April saw {formatNumber(aprilAllAnalytics.renewals + aprilAllAnalytics.upgrades)} renewals/upgrades, while August had {formatNumber(augustAllAnalytics.renewals + augustAllAnalytics.upgrades)}.</p>\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n\n      <Tabs value={activeMonth} onValueChange={(value) => setActiveMonth(value as 'april' | 'august')} className=\"w-full\">\n        <TabsList className=\"bg-white/90 backdrop-blur-sm p-2 rounded-2xl shadow-xl border-0 grid grid-cols-2 gap-3 w-full max-w-md mx-auto\">\n          <TabsTrigger value=\"april\" className=\"relative rounded-xl px-6 py-3 font-semibold text-base w-full justify-center min-h-[48px] data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-600 data-[state=active]:to-cyan-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50 flex items-center gap-2\">\n            <Calendar className=\"w-4 h-4\" />\n            April 2025\n          </TabsTrigger>\n          <TabsTrigger value=\"august\" className=\"relative rounded-xl px-6 py-3 font-semibold text-base w-full justify-center min-h-[48px] data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-600 data-[state=active]:to-pink-600 data-[state=active]:text-white data-[state=active]:shadow-lg hover:bg-gray-50 flex items-center gap-2\">\n            <Calendar className=\"w-4 h-4\" />\n            August 2025\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"april\" className=\"mt-8 space-y-6\">\n          <Tabs value={activeLocation} onValueChange={setActiveLocation} className=\"w-full\">\n            <div className=\"mb-4\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"flex items-center gap-2\">\n                  <Building2 className=\"w-5 h-5 text-blue-600\" />\n                  <h3 className=\"text-lg font-semibold text-gray-900\">Select Location</h3>\n                </div>\n                <InfoPopover context=\"outlier-analysis-overview\" locationId={activeLocation === 'all' ? 'all' : activeLocation} />\n              </div>\n              <TabsList className=\"bg-gray-100 p-1 rounded-lg inline-flex flex-wrap gap-2\">\n                {availableLocations.map((location) => (\n                  <TabsTrigger key={location} value={location} className=\"px-4 py-2 rounded-md text-sm font-medium data-[state=active]:bg-blue-600 data-[state=active]:text-white hover:bg-gray-200\">\n                    {location === 'all' ? 'All Locations' : location}\n                  </TabsTrigger>\n                ))}\n              </TabsList>\n            </div>\n            {availableLocations.map((location) => (\n              <TabsContent key={location} value={location} className=\"mt-6\">\n                <OutlierMonthDetail analytics={location === 'all' ? aprilAllAnalytics : aprilLocationAnalytics} monthName=\"April 2025\" locationName={location === 'all' ? 'All Locations' : location} />\n              </TabsContent>\n            ))}\n          </Tabs>\n        </TabsContent>\n\n        <TabsContent value=\"august\" className=\"mt-8 space-y-6\">\n          <Tabs value={activeLocation} onValueChange={setActiveLocation} className=\"w-full\">\n            <div className=\"mb-4\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"flex items-center gap-2\">\n                  <Building2 className=\"w-5 h-5 text-purple-600\" />\n                  <h3 className=\"text-lg font-semibold text-gray-900\">Select Location</h3>\n                </div>\n                <InfoPopover context=\"outlier-analysis-overview\" locationId={activeLocation === 'all' ? 'all' : activeLocation} />\n              </div>\n              <TabsList className=\"bg-gray-100 p-1 rounded-lg inline-flex flex-wrap gap-2\">\n                {availableLocations.map((location) => (\n                  <TabsTrigger key={location} value={location} className=\"px-4 py-2 rounded-md text-sm font-medium data-[state=active]:bg-purple-600 data-[state=active]:text-white hover:bg-gray-200\">\n                    {location === 'all' ? 'All Locations' : location}\n                  </TabsTrigger>\n                ))}\n              </TabsList>\n            </div>\n            {availableLocations.map((location) => (\n              <TabsContent key={location} value={location} className=\"mt-6\">\n                <OutlierMonthDetail analytics={location === 'all' ? augustAllAnalytics : augustLocationAnalytics} monthName=\"August 2025\" locationName={location === 'all' ? 'All Locations' : location} />\n              </TabsContent>\n            ))}\n          </Tabs>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n};\n","import React, { useMemo, useEffect } from 'react';\nimport { Footer } from '@/components/ui/footer';\nimport DashboardMotionHero from '@/components/ui/DashboardMotionHero';\nimport { useGoogleSheets } from '@/hooks/useGoogleSheets';\nimport { useSessionsData } from '@/hooks/useSessionsData';\nimport { useCheckinsData } from '@/hooks/useCheckinsData';\nimport { useExpirationsData } from '@/hooks/useExpirationsData';\nimport { useLeadsData } from '@/hooks/useLeadsData';\nimport { useNewClientData } from '@/hooks/useNewClientData';\nimport { formatNumber, formatCurrency } from '@/utils/formatters';\nimport { useGlobalLoading } from '@/hooks/useGlobalLoading';\nimport { OutlierAnalysisSection } from '@/components/dashboard/OutlierAnalysisSection';\nimport { LoadingSkeleton } from '@/components/ui/LoadingSkeleton';\nimport { GlobalFiltersProvider } from '@/contexts/GlobalFiltersContext';\n\nconst OutlierAnalysisContent = () => {\n  const { data: salesData, loading: salesLoading, error: salesError, refetch } = useGoogleSheets();\n  const { data: sessionsData, loading: sessionsLoading } = useSessionsData();\n  const { data: checkinsData, loading: checkinsLoading } = useCheckinsData();\n  const { data: expirationsData, loading: expirationsLoading } = useExpirationsData();\n  const { data: leadsData, loading: leadsLoading } = useLeadsData();\n  const { data: newClientData, loading: newClientLoading } = useNewClientData();\n  const { setLoading } = useGlobalLoading();\n\n  const loading = salesLoading || sessionsLoading || checkinsLoading || expirationsLoading || leadsLoading || newClientLoading;\n  const error = salesError;\n\n  const handleReady = React.useCallback(() => {\n    // Hide any global loader immediately when content is ready\n    setLoading(false);\n  }, [setLoading]);\n\n  // Tie the global loader to the loading state\n  useEffect(() => {\n    setLoading(loading, 'Loading outlier analysis data...');\n  }, [loading, setLoading]);\n\n  const heroMetrics = useMemo(() => {\n    if (!salesData || salesData.length === 0) return [];\n\n    const april2025Data = salesData.filter(item => {\n      if (!item.paymentDate) return false;\n      const date = new Date(item.paymentDate);\n      const year = date.getFullYear();\n      const month = date.getMonth();\n      return year === 2025 && month === 3; // April = month 3 (0-indexed)\n    });\n\n    const august2025Data = salesData.filter(item => {\n      if (!item.paymentDate) return false;\n      const date = new Date(item.paymentDate);\n      const year = date.getFullYear();\n      const month = date.getMonth();\n      return year === 2025 && month === 7; // August = month 7 (0-indexed)\n    });\n\n    const aprilRevenue = april2025Data.reduce((sum, item) => sum + (item.paymentValue || 0), 0);\n    const augustRevenue = august2025Data.reduce((sum, item) => sum + (item.paymentValue || 0), 0);\n    \n    const aprilTransactions = april2025Data.length;\n    const augustTransactions = august2025Data.length;\n\n    const aprilNewClients = new Set(\n      april2025Data\n        .filter(item => {\n          const product = (item.cleanedProduct || item.paymentItem || '').toLowerCase();\n          return product.includes('intro') || product.includes('new client') || product.includes('trial') || product.includes('first time');\n        })\n        .map(item => item.memberId || item.customerEmail)\n    ).size;\n\n    const augustNewClients = new Set(\n      august2025Data\n        .filter(item => {\n          const product = (item.cleanedProduct || item.paymentItem || '').toLowerCase();\n          return product.includes('intro') || product.includes('new client') || product.includes('trial') || product.includes('first time');\n        })\n        .map(item => item.memberId || item.customerEmail)\n    ).size;\n\n    return [\n      { location: 'April 2025', label: 'Total Revenue', value: formatCurrency(aprilRevenue), subValue: `${formatNumber(aprilTransactions)} transactions` },\n      { location: 'August 2025', label: 'Total Revenue', value: formatCurrency(augustRevenue), subValue: `${formatNumber(augustTransactions)} transactions` },\n      { location: 'April 2025', label: 'New Clients', value: formatNumber(aprilNewClients), subValue: 'First-time purchases' },\n      { location: 'August 2025', label: 'New Clients', value: formatNumber(augustNewClients), subValue: 'First-time purchases' }\n    ];\n  }, [salesData]);\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-white relative overflow-hidden\">\n        {/* Enhanced Background Elements */}\n        <div className=\"absolute inset-0 overflow-hidden\">\n          <div className=\"absolute top-20 left-10 w-96 h-96 bg-gradient-to-r from-indigo-500/10 to-purple-500/10 rounded-full floating-animation stagger-1\"></div>\n          <div className=\"absolute bottom-20 right-10 w-80 h-80 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-full floating-animation stagger-3\"></div>\n          <div className=\"absolute top-1/2 left-1/3 w-72 h-72 bg-gradient-to-r from-cyan-500/10 to-teal-500/10 rounded-full morph-shape stagger-2\"></div>\n        </div>\n        \n        <div className=\"relative z-10\">\n          <div className=\"container mx-auto px-6 py-10\">\n            <LoadingSkeleton type=\"full-page\" />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-white relative overflow-hidden\">\n        {/* Enhanced Background Elements */}\n        <div className=\"absolute inset-0 overflow-hidden\">\n          <div className=\"absolute top-20 left-10 w-96 h-96 bg-gradient-to-r from-indigo-500/10 to-purple-500/10 rounded-full floating-animation stagger-1\"></div>\n          <div className=\"absolute bottom-20 right-10 w-80 h-80 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-full floating-animation stagger-3\"></div>\n        </div>\n        \n        <div className=\"relative z-10\">\n          <div className=\"container mx-auto px-6 py-10\">\n            <div className=\"bg-red-50 border border-red-200 text-red-800 p-6 rounded-2xl shadow-sm\">\n              <div className=\"font-semibold text-lg mb-1\">Failed to load outlier analysis data</div>\n              <div className=\"text-sm opacity-90 mb-4\">{String(error)}</div>\n              <button \n                onClick={refetch} \n                className=\"px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 transition\"\n              >\n                Retry\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-white relative overflow-hidden\">\n      {/* Enhanced Background Elements */}\n      <div className=\"absolute inset-0 overflow-hidden\">\n        <div className=\"absolute top-20 left-10 w-96 h-96 bg-gradient-to-r from-indigo-500/10 to-purple-500/10 rounded-full floating-animation stagger-1\"></div>\n        <div className=\"absolute bottom-20 right-10 w-80 h-80 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-full floating-animation stagger-3\"></div>\n        <div className=\"absolute top-1/2 left-1/3 w-72 h-72 bg-gradient-to-r from-cyan-500/10 to-teal-500/10 rounded-full morph-shape stagger-2\"></div>\n      </div>\n      \n      <div className=\"relative z-10\">\n        <div className=\"bg-white text-slate-800 slide-in-from-left\">\n          <DashboardMotionHero \n            title=\"Outlier Analysis: April & August 2025\"\n            subtitle=\"Deep dive into performance drivers, client acquisition patterns, and revenue composition for exceptional months\"\n            metrics={heroMetrics}\n            onExportClick={() => {}}\n          />\n          <div className=\"container mx-auto px-6 py-8\">\n            <OutlierAnalysisSection \n              salesData={salesData || []}\n              sessionsData={sessionsData || []}\n              checkinsData={checkinsData || []}\n              expirationsData={expirationsData || []}\n              leadsData={leadsData || []}\n              newClientData={newClientData || []}\n            />\n          </div>\n        </div>\n        <Footer />\n      </div>\n    </div>\n  );\n};\n\nconst OutlierAnalysis = () => {\n  return (\n    <GlobalFiltersProvider>\n      <OutlierAnalysisContent />\n    </GlobalFiltersProvider>\n  );\n};\n\nexport default OutlierAnalysis;\n"],"names":["useOutlierMonthAnalytics","salesData","checkinsData","newClientData","month","location","useMemo","monthConfig","today","monthSalesData","item","date","matchesMonth","matchesLocation","customerFirstPurchaseMap","customerId","purchaseDate","existing","isNewCustomer","firstPurchase","firstPurchaseMonth","firstPurchaseYear","hasStackedMembership","membershipEndDate","customerPurchases","totalRevenue","sum","newClientRevenue","existingClientRevenue","activeMembershipRevenue","newClientIds","existingClientIds","clientsWithStackedMemberships","newCustomerMetrics","repeatCustomerMetrics","isNew","hasDiscount","metrics","customerMembershipHistory","excludedStackingTypes","history","renewals","upgrades","downgrades","sorted","m","i","a","b","prev","curr","stackedMembersDetails","validMemberships","productName","category","excludedByName","excluded","excludedByCategory","memberships","t","stackingMembers","dailyMap","dateKey","day","dailyAnalytics","data","membershipMap","key","membership","membershipAnalytics","name","spenderMap","spender","itemDate","endDate","allSpenders","id","membershipStatus","topSpenders","bottomSpenders","newSpenders","repeatSpenders","topNewSpenders","topRepeatSpenders","bottomNewSpenders","bottomRepeatSpenders","lapsedMembers","membershipEndMap","isFrozen","daysSince","customerSales","s","ltv","memberData","discountData","totalDiscountGiven","avgDiscountPercentage","monthCheckins","checkin","totalVisits","uniqueVisitors","c","avgVisitsPerClient","visitToRevenueRatio","newTransactions","repeatTransactions","isStacked","mrp","savings","transaction","OutlierDrillDownModal","isOpen","onClose","activeTab","setActiveTab","useState","renderSpenderDetails","jsxs","jsx","Card","CardContent","formatCurrency","formatNumber","Badge","Tag","CardHeader","CardTitle","ShoppingCart","ScrollArea","Table","TableHeader","TableRow","TableHead","TableBody","txn","index","TableCell","formatPercentage","renderLapsedDetails","lapsed","Calendar","renderTransactionList","transactions","totalDiscount","totalSavings","avgAtv","Dialog","DialogContent","DialogHeader","DialogTitle","TrendingUp","X","COLORS","OutlierMonthDetail","analytics","monthName","locationName","chartView","setChartView","selectedStackedMember","setSelectedStackedMember","modalData","setModalData","newClientPercentage","existingClientPercentage","activePercentage","dailyChartData","membershipChartData","revenueDistribution","motion","DollarSign","UserPlus","UserCheck","Activity","Percent","RefreshCw","AlertCircle","Layers","member","Button","Sparkles","PieChart","ResponsiveContainer","RechartsPieChart","Pie","percent","entry","Cell","Tooltip","value","Legend","BarChart3","Fragment","BarChart","CartesianGrid","XAxis","YAxis","Bar","Tabs","TabsList","TabsTrigger","TabsContent","Award","TrendingDown","d","DialogDescription","idx","OutlierAnalysisSection","activeMonth","setActiveMonth","activeLocation","setActiveLocation","availableLocations","monthData","locations","aprilAllAnalytics","augustAllAnalytics","aprilLocationAnalytics","augustLocationAnalytics","Building2","InfoPopover","OutlierAnalysisContent","salesLoading","salesError","refetch","useGoogleSheets","sessionsData","sessionsLoading","useSessionsData","checkinsLoading","useCheckinsData","expirationsData","expirationsLoading","useExpirationsData","leadsData","leadsLoading","useLeadsData","newClientLoading","useNewClientData","setLoading","useGlobalLoading","loading","error","React","useEffect","heroMetrics","april2025Data","year","august2025Data","aprilRevenue","augustRevenue","aprilTransactions","augustTransactions","aprilNewClients","product","augustNewClients","LoadingSkeleton","DashboardMotionHero","Footer","OutlierAnalysis","GlobalFiltersProvider"],"mappings":"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"}