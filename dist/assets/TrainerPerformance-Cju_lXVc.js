import{i as Ve,h as X,y as rs,z as _s,r as L,j as e,A as K,E as _,F as H,I as W,w as Hs,f as Q,B as he,D as bs,n as js,o as Ws,q as Us,s as Vs,X as ms,C as V,c as q,a as ae,b as re,J as ys,S as qs,d as Js}from"./index-Bm67KBkU.js";import{T as vs,a as fs,b as oe,c as ye}from"./tabs-BTrhdLSC.js";import{u as Os}from"./usePayrollData-DIt-ymzP.js";import{u as Qs}from"./useSessionsData-CuS9CUZY.js";import{u as Zs}from"./useCheckinsData-DGPJRptq.js";import{T as qe,g as hs,a as Xs}from"./TrainerAvatar-B3vSnngB.js";import{a as Ke}from"./ModernTableWrapper-bhf1DsXx.js";import{a as B,f as U,B as se,d as Qe}from"./index-DkD_C-d1.js";import{T as te,C as ns}from"./googleAuth-BGo8ElRc.js";import{T as ve}from"./trending-down-B5K1omnR.js";import{C as _e,D as ge}from"./dollar-sign-CKqx8kbC.js";import{U as et}from"./user-check-CLHYCjic.js";import{A as xe}from"./activity-CeUP9h5f.js";import{U as be}from"./users-7Ku-1TDB.js";import{T as fe}from"./target-BmxdxojS.js";import{Z as os}from"./zap-IfyovFNW.js";import{C as st}from"./clock-BP1BFskn.js";import{A as $e}from"./award-D0x2LQSI.js";import{T as tt,a as at,b as Ze,c as Ye,d as rt,e as je}from"./table-DhXofKdS.js";import{C as Ns}from"./CopyTableButton-Blm2CDq4.js";import{S as xs}from"./star-qy423-d6.js";import{C as nt,a as ot}from"./chevron-right-CbIMR3DA.js";import{c as lt,a as it,M as ws,D as Ss}from"./SalesMotionHero-sGphstF2.js";import{P as ct}from"./progress-BPRqleTC.js";import{S as Cs}from"./scroll-area-BKnEh-kP.js";import{C as Pe}from"./circle-alert-bpasmovd.js";import{M as Ys,S as dt}from"./StudioLocationTabs-BSKYatd_.js";import{S as Rs}from"./sparkles-C_y1-6_w.js";import{f as Fe,p as He,i as Xe,D as mt,c as ds,A as ht,d as es,e as xt,g as ut,G as pt,h as ks,l as gt,j as Ms,k as vt,m as ft,R as ke,C as bt,T as Me,B as us,a as Te,X as Ee,Y as Ae,L as As,b as Ge}from"./BarChart-o5Oeg9Jb.js";import{b as jt,c as zs,d as Ls,P as yt,a as Nt}from"./PieChart-slnvMcDg.js";import{C as Ds}from"./circle-x-DIh1Phs9.js";import{D as wt}from"./dumbbell-reskvc3q.js";import{A as St,a as Ct}from"./AreaChart-DQtaPzLK.js";import{L as Bs,a as ls}from"./LineChart-BWKGpJsm.js";import{M as Rt}from"./minus-BzN8XxOo.js";import{F as Ps,I as ze,S as Le,d as De,e as Be,g as Ie,h as Ce}from"./select-CM-Birqk.js";import{L as Re}from"./label-fD3fdNwH.js";import{U as kt}from"./user-izuMblv0.js";import{A as ss}from"./AdvancedExportButton-kiFhlv4f.js";import{R as Ts}from"./rotate-ccw-DYMOD-zv.js";import{C as Mt}from"./crown-Bf6tWe5C.js";import{T as At}from"./trophy-ChiyFqMe.js";import{M as Pt}from"./medal-BdYY0bn6.js";import{F as Tt}from"./footer-BTvMjyAb.js";import{D as Et}from"./DashboardMotionHero-C2yuh4RF.js";import"./tableStyles-BJWvDwDQ.js";import"./percent-BAS2Szsf.js";import"./package-C0br8ACw.js";import"./dropdown-menu-B9zQ9u84.js";import"./file-text-DChZNHsM.js";import"./index-BdQq_4o_.js";import"./checkbox-ByePFv7I.js";import"./BrandSpinner-CGFi2e0U.js";import"./useAdvancedExport-luHYyrc4.js";const Ft=Ve("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);const $t=Ve("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);const Ot=Ve("Bike",[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]]);const ps=Ve("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const Yt=Ve("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);var zt=["cx","cy","innerRadius","outerRadius","gridType","radialLines"];function We(n){"@babel/helpers - typeof";return We=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},We(n)}function Lt(n,i){if(n==null)return{};var a=Dt(n,i),o,m;if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(n);for(m=0;m<w.length;m++)o=w[m],!(i.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(n,o)&&(a[o]=n[o])}return a}function Dt(n,i){if(n==null)return{};var a={};for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){if(i.indexOf(o)>=0)continue;a[o]=n[o]}return a}function we(){return we=Object.assign?Object.assign.bind():function(n){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},we.apply(this,arguments)}function Es(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);i&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(n,m).enumerable})),a.push.apply(a,o)}return a}function Ue(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?Es(Object(a),!0).forEach(function(o){Bt(n,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Es(Object(a)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(a,o))})}return n}function Bt(n,i,a){return i=It(i),i in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,n}function It(n){var i=Gt(n,"string");return We(i)=="symbol"?i:i+""}function Gt(n,i){if(We(n)!="object"||!n)return n;var a=n[Symbol.toPrimitive];if(a!==void 0){var o=a.call(n,i);if(We(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(n)}var Kt=function(i,a,o,m){var w="";return m.forEach(function(x,f){var h=He(a,o,i,x);f?w+="L ".concat(h.x,",").concat(h.y):w+="M ".concat(h.x,",").concat(h.y)}),w+="Z",w},_t=function(i){var a=i.cx,o=i.cy,m=i.innerRadius,w=i.outerRadius,x=i.polarAngles,f=i.radialLines;if(!x||!x.length||!f)return null;var h=Ue({stroke:"#ccc"},Fe(i,!1));return X.createElement("g",{className:"recharts-polar-grid-angle"},x.map(function(s){var t=He(a,o,m,s),u=He(a,o,w,s);return X.createElement("line",we({},h,{key:"line-".concat(s),x1:t.x,y1:t.y,x2:u.x,y2:u.y}))}))},Ht=function(i){var a=i.cx,o=i.cy,m=i.radius,w=i.index,x=Ue(Ue({stroke:"#ccc"},Fe(i,!1)),{},{fill:"none"});return X.createElement("circle",we({},x,{className:rs("recharts-polar-grid-concentric-circle",i.className),key:"circle-".concat(w),cx:a,cy:o,r:m}))},Wt=function(i){var a=i.radius,o=i.index,m=Ue(Ue({stroke:"#ccc"},Fe(i,!1)),{},{fill:"none"});return X.createElement("path",we({},m,{className:rs("recharts-polar-grid-concentric-polygon",i.className),key:"path-".concat(o),d:Kt(a,i.cx,i.cy,i.polarAngles)}))},Ut=function(i){var a=i.polarRadius,o=i.gridType;return!a||!a.length?null:X.createElement("g",{className:"recharts-polar-grid-concentric"},a.map(function(m,w){var x=w;return o==="circle"?X.createElement(Ht,we({key:x},i,{radius:m,index:w})):X.createElement(Wt,we({key:x},i,{radius:m,index:w}))}))},Is=function(i){var a=i.cx,o=a===void 0?0:a,m=i.cy,w=m===void 0?0:m,x=i.innerRadius,f=x===void 0?0:x,h=i.outerRadius,s=h===void 0?0:h,t=i.gridType,u=t===void 0?"polygon":t,p=i.radialLines,k=p===void 0?!0:p,T=Lt(i,zt);return s<=0?null:X.createElement("g",{className:"recharts-polar-grid"},X.createElement(_t,we({cx:o,cy:w,innerRadius:f,outerRadius:s,gridType:u,radialLines:k},T)),X.createElement(Ut,we({cx:o,cy:w,innerRadius:f,outerRadius:s,gridType:u,radialLines:k},T)))};Is.displayName="PolarGrid";function Vt(n){return n&&n.length?n[0]:void 0}var qt=Vt,Jt=qt;const Qt=_s(Jt);var Zt=["key"];function Oe(n){"@babel/helpers - typeof";return Oe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},Oe(n)}function Xt(n,i){if(n==null)return{};var a=ea(n,i),o,m;if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(n);for(m=0;m<w.length;m++)o=w[m],!(i.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(n,o)&&(a[o]=n[o])}return a}function ea(n,i){if(n==null)return{};var a={};for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){if(i.indexOf(o)>=0)continue;a[o]=n[o]}return a}function is(){return is=Object.assign?Object.assign.bind():function(n){for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},is.apply(this,arguments)}function Fs(n,i){var a=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);i&&(o=o.filter(function(m){return Object.getOwnPropertyDescriptor(n,m).enumerable})),a.push.apply(a,o)}return a}function de(n){for(var i=1;i<arguments.length;i++){var a=arguments[i]!=null?arguments[i]:{};i%2?Fs(Object(a),!0).forEach(function(o){Ne(n,o,a[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(a)):Fs(Object(a)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(a,o))})}return n}function sa(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}function $s(n,i){for(var a=0;a<i.length;a++){var o=i[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(n,Ks(o.key),o)}}function ta(n,i,a){return i&&$s(n.prototype,i),a&&$s(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n}function aa(n,i,a){return i=cs(i),ra(n,Gs()?Reflect.construct(i,a||[],cs(n).constructor):i.apply(n,a))}function ra(n,i){if(i&&(Oe(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return na(n)}function na(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Gs(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Gs=function(){return!!n})()}function cs(n){return cs=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},cs(n)}function oa(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),i&&gs(n,i)}function gs(n,i){return gs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,m){return o.__proto__=m,o},gs(n,i)}function Ne(n,i,a){return i=Ks(i),i in n?Object.defineProperty(n,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[i]=a,n}function Ks(n){var i=la(n,"string");return Oe(i)=="symbol"?i:i+""}function la(n,i){if(Oe(n)!="object"||!n)return n;var a=n[Symbol.toPrimitive];if(a!==void 0){var o=a.call(n,i);if(Oe(o)!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}var Je=function(n){function i(){var a;sa(this,i);for(var o=arguments.length,m=new Array(o),w=0;w<o;w++)m[w]=arguments[w];return a=aa(this,i,[].concat(m)),Ne(a,"state",{isAnimationFinished:!1}),Ne(a,"handleAnimationEnd",function(){var x=a.props.onAnimationEnd;a.setState({isAnimationFinished:!0}),Xe(x)&&x()}),Ne(a,"handleAnimationStart",function(){var x=a.props.onAnimationStart;a.setState({isAnimationFinished:!1}),Xe(x)&&x()}),Ne(a,"handleMouseEnter",function(x){var f=a.props.onMouseEnter;f&&f(a.props,x)}),Ne(a,"handleMouseLeave",function(x){var f=a.props.onMouseLeave;f&&f(a.props,x)}),a}return oa(i,n),ta(i,[{key:"renderDots",value:function(o){var m=this.props,w=m.dot,x=m.dataKey,f=Fe(this.props,!1),h=Fe(w,!0),s=o.map(function(t,u){var p=de(de(de({key:"dot-".concat(u),r:3},f),h),{},{dataKey:x,cx:t.x,cy:t.y,index:u,payload:t});return i.renderDotItem(w,p)});return X.createElement(ds,{className:"recharts-radar-dots"},s)}},{key:"renderPolygonStatically",value:function(o){var m=this.props,w=m.shape,x=m.dot,f=m.isRange,h=m.baseLinePoints,s=m.connectNulls,t;return X.isValidElement(w)?t=X.cloneElement(w,de(de({},this.props),{},{points:o})):Xe(w)?t=w(de(de({},this.props),{},{points:o})):t=X.createElement(jt,is({},Fe(this.props,!0),{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,points:o,baseLinePoints:f?h:null,connectNulls:s})),X.createElement(ds,{className:"recharts-radar-polygon"},t,x?this.renderDots(o):null)}},{key:"renderPolygonWithAnimation",value:function(){var o=this,m=this.props,w=m.points,x=m.isAnimationActive,f=m.animationBegin,h=m.animationDuration,s=m.animationEasing,t=m.animationId,u=this.state.prevPoints;return X.createElement(ht,{begin:f,duration:h,isActive:x,easing:s,from:{t:0},to:{t:1},key:"radar-".concat(t),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(p){var k=p.t,T=u&&u.length/w.length,b=w.map(function(C,g){var c=u&&u[Math.floor(g*T)];if(c){var M=es(c.x,C.x),A=es(c.y,C.y);return de(de({},C),{},{x:M(k),y:A(k)})}var j=es(C.cx,C.x),O=es(C.cy,C.y);return de(de({},C),{},{x:j(k),y:O(k)})});return o.renderPolygonStatically(b)})}},{key:"renderPolygon",value:function(){var o=this.props,m=o.points,w=o.isAnimationActive,x=o.isRange,f=this.state.prevPoints;return w&&m&&m.length&&!x&&(!f||!xt(f,m))?this.renderPolygonWithAnimation():this.renderPolygonStatically(m)}},{key:"render",value:function(){var o=this.props,m=o.hide,w=o.className,x=o.points,f=o.isAnimationActive;if(m||!x||!x.length)return null;var h=this.state.isAnimationFinished,s=rs("recharts-radar",w);return X.createElement(ds,{className:s},this.renderPolygon(),(!f||h)&&ut.renderCallByParent(this.props,x))}}],[{key:"getDerivedStateFromProps",value:function(o,m){return o.animationId!==m.prevAnimationId?{prevAnimationId:o.animationId,curPoints:o.points,prevPoints:m.curPoints}:o.points!==m.curPoints?{curPoints:o.points}:null}},{key:"renderDotItem",value:function(o,m){var w;if(X.isValidElement(o))w=X.cloneElement(o,m);else if(Xe(o))w=o(m);else{var x=m.key,f=Xt(m,Zt);w=X.createElement(mt,is({},f,{key:x,className:rs("recharts-radar-dot",typeof o!="boolean"?o.className:"")}))}return w}}])}(L.PureComponent);Ne(Je,"displayName","Radar");Ne(Je,"defaultProps",{angleAxisId:0,radiusAxisId:0,hide:!1,activeDot:!0,dot:!1,legendType:"rect",isAnimationActive:!pt.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Ne(Je,"getComposedData",function(n){var i=n.radiusAxis,a=n.angleAxis,o=n.displayedData,m=n.dataKey,w=n.bandSize,x=a.cx,f=a.cy,h=!1,s=[],t=a.type!=="number"?w??0:0;o.forEach(function(p,k){var T=ks(p,a.dataKey,k),b=ks(p,m),C=a.scale(T)+t,g=Array.isArray(b)?gt(b):b,c=Ms(g)?void 0:i.scale(g);Array.isArray(b)&&b.length>=2&&(h=!0),s.push(de(de({},He(x,f,c,C)),{},{name:T,value:b,cx:x,cy:f,radius:c,angle:C,payload:p}))});var u=[];return h&&s.forEach(function(p){if(Array.isArray(p.value)){var k=Qt(p.value),T=Ms(k)?void 0:i.scale(k);u.push(de(de({},p),{},{radius:T},He(x,f,T,p.angle)))}else u.push(p)}),{points:s,isRange:h,baseLinePoints:u}});var ia=vt({chartName:"RadarChart",GraphicalChild:Je,axisComponents:[{axisType:"angleAxis",AxisComp:zs},{axisType:"radiusAxis",AxisComp:Ls}],formatAxisMap:ft,defaultProps:{layout:"centric",startAngle:90,endAngle:-270,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const ca=({data:n,onRowClick:i})=>{const[a,o]=L.useState({key:"revenueGrowth",direction:"desc"}),m=L.useMemo(()=>{const s=new Date().getFullYear(),t=s-1,u=n.reduce((p,k)=>{const T=k.monthLabel||k.monthYear||"";let b=NaN;if(k.monthKey&&k.monthKey.includes("-"))b=parseInt(k.monthKey.split("-")[0]);else{const g=T.replace("-"," ").split(" ").filter(Boolean);b=parseInt(g[1])}const C=k.trainerName;if(!isNaN(b)&&(b===s||b===t)){p[C]||(p[C]={trainerName:k.trainerName,location:k.location,currentYear:{sessions:0,revenue:0,customers:0,monthsActive:0},previousYear:{sessions:0,revenue:0,customers:0,monthsActive:0}});const g=b===s?p[C].currentYear:p[C].previousYear;g.sessions+=k.totalSessions,g.revenue+=k.totalPaid,g.customers+=k.totalCustomers,g.monthsActive+=1}return p},{});return Object.values(u).map(p=>{const k=p.currentYear.sessions>0?p.currentYear.customers/p.currentYear.sessions:0,T=p.previousYear.sessions>0?p.previousYear.customers/p.previousYear.sessions:0,b=p.currentYear.sessions>0?p.currentYear.revenue/p.currentYear.sessions:0,C=p.previousYear.sessions>0?p.previousYear.revenue/p.previousYear.sessions:0;return{trainerName:p.trainerName,location:p.location,currentSessions:p.currentYear.sessions,previousSessions:p.previousYear.sessions,sessionsGrowth:p.previousYear.sessions>0?(p.currentYear.sessions-p.previousYear.sessions)/p.previousYear.sessions*100:0,currentRevenue:p.currentYear.revenue,previousRevenue:p.previousYear.revenue,revenueGrowth:p.previousYear.revenue>0?(p.currentYear.revenue-p.previousYear.revenue)/p.previousYear.revenue*100:0,currentCustomers:p.currentYear.customers,previousCustomers:p.previousYear.customers,customersGrowth:p.previousYear.customers>0?(p.currentYear.customers-p.previousYear.customers)/p.previousYear.customers*100:0,currentAvgClassSize:k,previousAvgClassSize:T,classSizeGrowth:T>0?(k-T)/T*100:0,currentRevenuePerSession:b,previousRevenuePerSession:C,revenuePerSessionGrowth:C>0?(b-C)/C*100:0,currentMonthsActive:p.currentYear.monthsActive,previousMonthsActive:p.previousYear.monthsActive}}).filter(p=>p.currentSessions>0||p.previousSessions>0).sort((p,k)=>k.revenueGrowth-p.revenueGrowth)},[n]),w=L.useMemo(()=>{const s=[...m],t=a.key;return s.sort((u,p)=>{const k=u[t]??0,T=p[t]??0;return typeof k=="string"||typeof T=="string"?a.direction==="asc"?String(k).localeCompare(String(T)):String(T).localeCompare(String(k)):a.direction==="asc"?k-T:T-k})},[m,a]),x=s=>{o(t=>({key:s,direction:t.key===s&&t.direction==="desc"?"asc":"desc"}))},f=s=>{i&&i(s.trainerName,{...s,monthYear:s.monthYear||"",location:s.location||"",type:"year-on-year-comparison"})},h=[{key:"trainerName",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Trainer"}),e.jsx(W,{children:"Trainer name"})]})}),className:"min-w-[240px]",sortable:!0,render:(s,t)=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(qe,{name:s,className:"text-nowrap"}),e.jsx("div",{className:"text-xs text-slate-500 ml-10",children:t.location})]})},{key:"currentSessions",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:`${new Date().getFullYear()} Sessions`}),e.jsx(W,{children:"Total sessions conducted this year"})]})}),align:"center",sortable:!0,render:s=>e.jsx("span",{className:"font-medium text-slate-800 text-sm ",children:B(s)})},{key:"previousSessions",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:`${new Date().getFullYear()-1} Sessions`}),e.jsx(W,{children:"Total sessions conducted last year"})]})}),align:"center",sortable:!0,render:s=>e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:B(s)})},{key:"sessionsGrowth",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Sessions Growth"}),e.jsx(W,{children:"Year-over-year change in sessions"})]})}),align:"center",sortable:!0,render:s=>e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s>0?e.jsx(te,{className:"w-3 h-3 text-green-500"}):s<0?e.jsx(ve,{className:"w-3 h-3 text-red-500"}):null,e.jsxs("span",{className:`font-semibold text-sm ${s>0?"text-green-600":s<0?"text-red-600":"text-slate-600"}`,children:[s.toFixed(1),"%"]})]})},{key:"currentRevenue",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:`${new Date().getFullYear()} Revenue`}),e.jsx(W,{children:"Total revenue generated this year"})]})}),align:"center",sortable:!0,render:s=>e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:U(s)})},{key:"previousRevenue",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:`${new Date().getFullYear()-1} Revenue`}),e.jsx(W,{children:"Total revenue generated last year"})]})}),align:"center",sortable:!0,render:s=>e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:U(s)})},{key:"revenueGrowth",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Revenue Growth"}),e.jsx(W,{children:"Year-over-year change in revenue"})]})}),align:"center",sortable:!0,render:s=>e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s>0?e.jsx(te,{className:"w-3 h-3 text-green-500"}):s<0?e.jsx(ve,{className:"w-3 h-3 text-red-500"}):null,e.jsxs("span",{className:`font-semibold text-sm ${s>0?"text-green-600":s<0?"text-red-600":"text-slate-600"}`,children:[s.toFixed(1),"%"]})]})},{key:"currentAvgClassSize",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:`${new Date().getFullYear()} Avg Size`}),e.jsx(W,{children:"Average customers per session this year"})]})}),align:"center",sortable:!0,render:s=>e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:s.toFixed(1)})},{key:"previousAvgClassSize",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:`${new Date().getFullYear()-1} Avg Size`}),e.jsx(W,{children:"Average customers per session last year"})]})}),align:"center",sortable:!0,render:s=>e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:s.toFixed(1)})},{key:"classSizeGrowth",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Size Growth"}),e.jsx(W,{children:"Year-over-year change in average class size"})]})}),align:"center",sortable:!0,render:s=>e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s>0?e.jsx(te,{className:"w-3 h-3 text-green-500"}):s<0?e.jsx(ve,{className:"w-3 h-3 text-red-500"}):null,e.jsxs("span",{className:`font-semibold text-sm ${s>0?"text-green-600":s<0?"text-red-600":"text-slate-600"}`,children:[s.toFixed(1),"%"]})]})}];return m.reduce((s,t)=>s+t.currentSessions,0),m.reduce((s,t)=>s+t.previousSessions,0),m.reduce((s,t)=>s+t.currentRevenue,0),m.reduce((s,t)=>s+t.previousRevenue,0),m.reduce((s,t)=>s+t.currentCustomers,0),m.reduce((s,t)=>s+t.previousCustomers,0),e.jsx(Ke,{title:"Trainer Year-on-Year Performance Comparison",description:`Performance comparison for ${w.length} trainers: ${new Date().getFullYear()} vs ${new Date().getFullYear()-1}`,icon:e.jsx(_e,{className:"w-5 h-5"}),totalItems:w.length,children:e.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-emerald-600 via-emerald-700 to-teal-600 text-white",children:e.jsx("tr",{children:h.map((s,t)=>e.jsx("th",{className:`px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider whitespace-nowrap cursor-pointer hover:bg-white/10 transition-colors ${s.className||""} ${s.align==="center"?"text-center":s.align==="right"?"text-right":"text-left"}`,onClick:()=>s.sortable!==!1&&x(s.key),style:{height:"40px"},children:e.jsxs("div",{className:"flex items-center gap-1",children:[s.header,a.key===s.key&&(a.direction==="asc"?e.jsx(te,{className:"w-3 h-3"}):e.jsx(ve,{className:"w-3 h-3"}))]})},s.key))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map((s,t)=>e.jsx("tr",{className:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>f(s),style:{height:"40px"},children:h.map(u=>e.jsx("td",{className:`px-4 py-2 text-sm whitespace-nowrap ${u.align==="center"?"text-center":u.align==="right"?"text-right":"text-left"}`,children:u.render?u.render(s[u.key],s):s[u.key]},u.key))},t))})]})})})})},da=({data:n,onRowClick:i})=>{const[a,o]=L.useState({key:"totalRevenue",direction:"desc"}),m=L.useMemo(()=>{const h=n.reduce((s,t)=>{const u=t.trainerName;return s[u]||(s[u]={trainerName:t.trainerName,location:t.location,totalSessions:0,totalCustomers:0,totalRevenue:0,cycleSessions:0,barreSessions:0,strengthSessions:0,cycleRevenue:0,barreRevenue:0,strengthRevenue:0,avgClassSize:0,fillRate:0,utilizationRate:0,conversionRate:0,retentionRate:0,monthsActive:0,revenuePerSession:0,revenuePerCustomer:0,consistencyScore:0,performanceRating:"Excellent",topFormat:"Cycle",growthTrend:0}),s[u].totalSessions+=t.totalSessions,s[u].totalCustomers+=t.totalCustomers,s[u].totalRevenue+=t.totalPaid,s[u].cycleSessions+=t.cycleSessions,s[u].barreSessions+=t.barreSessions,s[u].strengthSessions+=t.strengthSessions,s[u].cycleRevenue+=t.cycleRevenue,s[u].barreRevenue+=t.barreRevenue,s[u].strengthRevenue+=t.strengthRevenue,s[u].monthsActive+=1,s},{});return Object.values(h).map(s=>{s.avgClassSize=s.totalSessions>0?s.totalCustomers/s.totalSessions:0,s.revenuePerSession=s.totalSessions>0?s.totalRevenue/s.totalSessions:0,s.revenuePerCustomer=s.totalCustomers>0?s.totalRevenue/s.totalCustomers:0;const t=n.filter(y=>y.trainerName===s.trainerName),u=t.reduce((y,l)=>y+(l.totalSessions||0),0),p=t.reduce((y,l)=>y+(l.nonEmptySessions||0),0),k=t.reduce((y,l)=>y+(l.totalCustomers||0),0),b=u*20;s.fillRate=b>0?k/b*100:0,s.utilizationRate=u>0?p/u*100:0;const C=t.reduce((y,l)=>y+(l.newMembers||0),0),g=t.reduce((y,l)=>y+(l.convertedMembers||0),0),c=t.reduce((y,l)=>y+(l.retainedMembers||0),0);s.conversionRate=C>0?g/C*100:0,s.retentionRate=C>0?c/C*100:0;const M=t.map(y=>y.totalSessions||0);if(M.length>1){const y=M.reduce((E,F)=>E+F,0)/M.length,l=M.reduce((E,F)=>E+Math.pow(F-y,2),0)/M.length,Y=Math.sqrt(l);s.consistencyScore=y>0?Math.max(0,100-Y/y*100):100}else s.consistencyScore=100;const A=[...t].sort((y,l)=>(y.monthKey||"").localeCompare(l.monthKey||"")),j=A[A.length-1]?.totalSessions||0,O=A[A.length-2]?.totalSessions||0;s.growthTrend=O>0?(j-O)/O*100:j>0?100:0;const S={Cycle:s.cycleRevenue,Barre:s.barreRevenue,Strength:s.strengthRevenue};return s.topFormat=Object.entries(S).reduce((y,l)=>S[y[0]]>S[l[0]]?y:l)[0],s.totalRevenue>=5e4?s.performanceRating="Excellent":s.totalRevenue>=3e4?s.performanceRating="Good":s.totalRevenue>=15e3?s.performanceRating="Average":s.performanceRating="Needs Improvement",s}).sort((s,t)=>{if(a.key==="trainerName")return a.direction==="asc"?s.trainerName.localeCompare(t.trainerName):t.trainerName.localeCompare(s.trainerName);const u=s[a.key]||0,p=t[a.key]||0;return a.direction==="asc"?u-p:p-u})},[n,a]),w=h=>{i&&i(h.trainerName,{...h,monthYear:h.monthYear||h.month||"",location:h.location||"",type:"trainer-performance"})},x=[{key:"trainerName",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Trainer"}),e.jsx(W,{children:"Trainer name and location"})]})}),className:"min-w-[180px]",render:(h,s)=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(qe,{name:h,className:"text-nowrap"}),e.jsx("div",{className:"text-xs text-slate-500 ml-10",children:s.location})]})},{key:"totalSessions",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Sessions"}),e.jsx(W,{children:"Total sessions across selected period"})]})}),sortable:!0,align:"center",render:h=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:B(h)}),e.jsx(xe,{className:"w-3 h-3 text-slate-400 mt-0.5"})]})},{key:"totalCustomers",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Customers"}),e.jsx(W,{children:"Total check-ins across sessions"})]})}),sortable:!0,align:"center",render:h=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:B(h)}),e.jsx(be,{className:"w-3 h-3 text-slate-400 mt-0.5"})]})},{key:"totalRevenue",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Revenue"}),e.jsx(W,{children:"Total revenue across selected period"})]})}),sortable:!0,align:"center",render:h=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:U(h)}),e.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:"Total"})]})},{key:"avgClassSize",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Avg Class Size"}),e.jsx(W,{children:"Customers per session on average"})]})}),sortable:!0,align:"center",render:h=>e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:h.toFixed(1)})},{key:"revenuePerSession",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Revenue/Session"}),e.jsx(W,{children:"Average revenue per session"})]})}),sortable:!0,align:"center",render:h=>e.jsx("span",{className:"font-medium text-slate-800 text-sm",children:U(h)})},{key:"topFormat",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Top Format"}),e.jsx(W,{children:"Format with highest revenue for the trainer"})]})}),align:"center",render:(h,s)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(se,{className:`
            ${h==="Cycle"?"bg-blue-100 text-blue-800":h==="Barre"?"bg-pink-100 text-pink-800":"bg-green-100 text-green-800"}
          `,children:h}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[h==="Cycle"?s.cycleSessions:h==="Barre"?s.barreSessions:s.strengthSessions," sessions"]})]})},{key:"fillRate",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Fill Rate"}),e.jsx(W,{children:"Customers / capacity across sessions (%)"})]})}),sortable:!0,align:"center",render:h=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("span",{className:`font-semibold ${h>=85?"text-green-600":h>=70?"text-yellow-600":"text-red-600"}`,children:[h.toFixed(1),"%"]}),e.jsx(fe,{className:"w-3 h-3 text-slate-400 mt-1"})]})},{key:"conversionRate",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Conversion"}),e.jsx(W,{children:"Converted / new members (%)"})]})}),sortable:!0,align:"center",render:h=>e.jsxs("span",{className:`font-semibold ${h>=80?"text-green-600":h>=65?"text-yellow-600":"text-red-600"}`,children:[h.toFixed(1),"%"]})},{key:"performanceRating",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Rating"}),e.jsx(W,{children:"Performance rating based on revenue thresholds"})]})}),sortable:!0,align:"center",render:(h,s)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(se,{className:`
            ${h==="Excellent"?"bg-green-100 text-green-800":h==="Good"?"bg-blue-100 text-blue-800":h==="Average"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}
          `,children:h}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1 flex items-center gap-1",children:[s.growthTrend>=0?e.jsx(te,{className:"w-3 h-3 text-green-500"}):e.jsx(te,{className:"w-3 h-3 text-red-500 rotate-180"}),Math.abs(s.growthTrend).toFixed(0),"%"]})]})}],f=h=>{o(s=>({key:h,direction:s.key===h&&s.direction==="desc"?"asc":"desc"}))};return e.jsx(Ke,{title:"Trainer Performance Detail Analysis",description:`Comprehensive performance metrics for ${m.length} trainers`,icon:e.jsx(et,{className:"w-5 h-5"}),totalItems:m.length,children:e.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-black text-white",children:e.jsx("tr",{children:x.map((h,s)=>e.jsx("th",{className:`px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider whitespace-nowrap cursor-pointer hover:bg-white/10 transition-colors ${h.className||""} ${s===0?"bg-gradient-to-r from-blue-800 via-blue-900 to-blue-800":"bg-black"}`,onClick:()=>h.sortable!==!1&&f(h.key),style:{height:"35px",maxHeight:"35px"},children:e.jsxs("div",{className:"flex items-center gap-1",children:[h.header,a.key===h.key&&(a.direction==="asc"?e.jsx(te,{className:"w-3 h-3"}):e.jsx(ve,{className:"w-3 h-3"}))]})},h.key))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map((h,s)=>e.jsx("tr",{className:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>w(h),style:{height:"35px",maxHeight:"35px"},children:x.map(t=>e.jsx("td",{className:`px-4 py-2 text-sm whitespace-nowrap ${t.align==="center"?"text-center":t.align==="right"?"text-right":"text-left"}`,children:t.render?t.render(h[t.key],h):h[t.key]},t.key))},s))})]})})})})},ma=({data:n,onRowClick:i})=>{const[a,o]=L.useState({key:"efficiencyScore",direction:"desc"}),m=L.useMemo(()=>{const s=n.reduce((t,u)=>{const p=u.trainerName;return t[p]||(t[p]={trainerName:u.trainerName,location:u.location,totalSessions:0,nonEmptySessions:0,emptySessions:0,totalCustomers:0,totalRevenue:0,cycleSessions:0,barreSessions:0,strengthSessions:0,monthsActive:0,capacityUtilization:0,revenuePerHour:0,customerRetention:0,avgClassFill:0,efficiencyScore:0,productivityRank:"A",timeOptimization:0,resourceUtilization:0,impactScore:0,qualityIndex:0,growthMomentum:0,consistencyFactor:0}),t[p].totalSessions+=u.totalSessions,t[p].nonEmptySessions+=u.nonEmptySessions,t[p].emptySessions+=u.emptySessions,t[p].totalCustomers+=u.totalCustomers,t[p].totalRevenue+=u.totalPaid,t[p].cycleSessions+=u.cycleSessions,t[p].barreSessions+=u.barreSessions,t[p].strengthSessions+=u.strengthSessions,t[p].monthsActive+=1,t},{});return Object.values(s).map(t=>{t.capacityUtilization=t.totalSessions>0?t.nonEmptySessions/t.totalSessions*100:0,t.avgClassFill=t.nonEmptySessions>0?t.totalCustomers/t.nonEmptySessions:0,t.revenuePerHour=t.totalSessions>0?t.totalRevenue/t.totalSessions:0;const u=n.filter(A=>A.trainerName===t.trainerName),p=u.reduce((A,j)=>A+(j.newMembers||0),0),k=u.reduce((A,j)=>A+(j.retainedMembers||0),0);t.customerRetention=p>0?k/p*100:0,t.timeOptimization=t.capacityUtilization,t.resourceUtilization=t.capacityUtilization;const b=Object.values(s).map(A=>A.totalSessions>0?A.totalRevenue/A.totalSessions:0),C=Math.max(...b,1);if(t.impactScore=Math.min(100,t.revenuePerHour/C*100),t.qualityIndex=Math.min(100,t.avgClassFill/20*100),u.length>1){const A=u.map(y=>y.totalSessions||0),j=A.reduce((y,l)=>y+l,0)/A.length,O=A.reduce((y,l)=>y+Math.pow(l-j,2),0)/A.length,S=Math.sqrt(O);t.consistencyFactor=j>0?Math.max(0,100-S/j*100):100}else t.consistencyFactor=100;const g=[...u].sort((A,j)=>(A.monthKey||"").localeCompare(j.monthKey||"")),c=g[g.length-1]?.totalSessions||0,M=g[g.length-2]?.totalSessions||0;return t.growthMomentum=M>0?(c-M)/M*100:c>0?100:0,t.efficiencyScore=t.capacityUtilization*.35+t.revenuePerHour*.02+t.customerRetention*.15+t.impactScore*.15+t.qualityIndex*.1+t.consistencyFactor*.13,t.efficiencyScore>=90?t.productivityRank="S+":t.efficiencyScore>=85?t.productivityRank="A+":t.efficiencyScore>=80?t.productivityRank="A":t.efficiencyScore>=75?t.productivityRank="B+":t.efficiencyScore>=70?t.productivityRank="B":t.productivityRank="C",t}).sort((t,u)=>{if(a.key==="trainerName")return a.direction==="asc"?t.trainerName.localeCompare(u.trainerName):u.trainerName.localeCompare(t.trainerName);const p=t[a.key]||0,k=u[a.key]||0;return a.direction==="asc"?p-k:k-p})},[n,a]),w=s=>{if(i){const u=n.filter(p=>p.trainerName===s.trainerName).sort((p,k)=>(k.monthKey||"").localeCompare(p.monthKey||""))[0];i(s.trainerName,{...u,efficiencyScore:s.efficiencyScore,capacityUtilization:s.capacityUtilization,revenuePerHour:s.revenuePerHour,avgClassFill:s.avgClassFill,customerRetention:s.customerRetention,productivityRank:s.productivityRank,monthYear:u?.monthYear||u?.month||"",location:u?.location||s.location||"",type:"trainer-efficiency",contextFilters:{location:u?.location||s.location||"",month:u?.monthYear||u?.month||""}})}},x=[{key:"trainerName",header:"Trainer",sortable:!0,className:"min-w-[160px]",render:(s,t)=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(qe,{name:s,className:"text-nowrap"}),e.jsx("div",{className:"text-xs text-slate-500 ml-10",children:t.location}),e.jsxs(se,{className:`mt-1 text-xs ml-10 w-fit ${t.productivityRank==="S+"?"bg-purple-100 text-purple-800":t.productivityRank==="A+"?"bg-green-100 text-green-800":t.productivityRank==="A"?"bg-blue-100 text-blue-800":t.productivityRank==="B+"?"bg-yellow-100 text-yellow-800":t.productivityRank==="B"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:["Rank ",t.productivityRank]})]})},{key:"efficiencyScore",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Efficiency Score"}),e.jsx(W,{children:"Composite score from utilization, retention, impact, quality, and consistency"})]})}),sortable:!0,align:"center",render:s=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`text-2xl font-bold ${s>=85?"text-green-600":s>=75?"text-blue-600":s>=65?"text-yellow-600":"text-red-600"}`,children:s.toFixed(0)}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx(os,{className:"w-3 h-3 text-yellow-500"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Score"})]})]})},{key:"capacityUtilization",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Capacity Usage"}),e.jsx(W,{children:"Non-empty sessions divided by total sessions"})]})}),sortable:!0,align:"center",render:(s,t)=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:`font-semibold ${s>=90?"text-green-600":s>=80?"text-blue-600":s>=70?"text-yellow-600":"text-red-600"}`,children:[s.toFixed(1),"%"]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:[t.nonEmptySessions,"/",t.totalSessions]}),e.jsx("div",{className:"w-12 h-1 bg-slate-200 rounded-full mt-1",children:e.jsx("div",{className:`h-full rounded-full ${s>=90?"bg-green-500":s>=80?"bg-blue-500":s>=70?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(s,100)}%`}})})]})},{key:"revenuePerHour",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Revenue/Hour"}),e.jsx(W,{children:"Revenue per session (assumes 1 hour per session)"})]})}),sortable:!0,align:"center",render:s=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-semibold text-green-600",children:U(s)}),e.jsx(st,{className:"w-3 h-3 text-green-400 mt-1"})]})},{key:"avgClassFill",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Avg Fill"}),e.jsx(W,{children:"Average customers per non-empty session"})]})}),sortable:!0,align:"center",render:s=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"font-semibold text-purple-600",children:s.toFixed(1)}),e.jsx("div",{className:"text-xs text-purple-500 mt-1",children:"customers"})]})},{key:"customerRetention",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Retention"}),e.jsx(W,{children:"Weighted retained/new members (%) across months"})]})}),sortable:!0,align:"center",render:s=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("span",{className:`font-semibold ${s>=90?"text-green-600":s>=80?"text-blue-600":s>=70?"text-yellow-600":"text-red-600"}`,children:[s.toFixed(1),"%"]}),e.jsx(fe,{className:"w-3 h-3 text-slate-400 mt-1"})]})},{key:"timeOptimization",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Time Opt."}),e.jsx(W,{children:"Proxy equals capacity usage (%)"})]})}),sortable:!0,align:"center",render:s=>e.jsxs("span",{className:`font-semibold ${s>=90?"text-green-600":s>=85?"text-blue-600":s>=80?"text-yellow-600":"text-red-600"}`,children:[s.toFixed(0),"%"]})},{key:"qualityIndex",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Quality Index"}),e.jsx(W,{children:"Avg fill normalized to 0-100 (20 assumed ceiling)"})]})}),sortable:!0,align:"center",render:s=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:`font-semibold ${s>=90?"text-green-600":s>=85?"text-blue-600":s>=80?"text-yellow-600":"text-red-600"}`,children:s.toFixed(0)}),e.jsx($e,{className:"w-3 h-3 text-slate-400 mt-1"})]})},{key:"growthMomentum",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Growth"}),e.jsx(W,{children:"Last vs previous month sessions (%)"})]})}),sortable:!0,align:"center",render:s=>e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[s>=0?e.jsx(te,{className:"w-3 h-3 text-green-500"}):e.jsx(ve,{className:"w-3 h-3 text-red-500"}),e.jsxs("span",{className:`font-semibold ${s>=0?"text-green-600":"text-red-600"}`,children:[s>=0?"+":"",s.toFixed(1),"%"]})]})},{key:"impactScore",header:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Impact"}),e.jsx(W,{children:"Revenue per session relative to cohort (0-100)"})]})}),sortable:!0,align:"center",render:s=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:`font-bold ${s>=90?"text-purple-600":s>=80?"text-blue-600":s>=70?"text-green-600":"text-yellow-600"}`,children:s.toFixed(0)}),e.jsx("div",{className:"text-xs text-slate-500",children:"score"})]})}],f=s=>{o(t=>({key:s,direction:t.key===s&&t.direction==="desc"?"asc":"desc"}))},h=L.useMemo(()=>{const s=m.reduce((p,k)=>p+k.efficiencyScore,0)/m.length,t=m.filter(p=>p.efficiencyScore>=85).length,u=m.reduce((p,k)=>p+k.capacityUtilization,0)/m.length;return{avgEfficiency:s,topPerformers:t,avgCapacityUtilization:u}},[m]);return e.jsx(Ke,{title:"Trainer Efficiency & Productivity Analysis",description:`Efficiency analysis for ${m.length} trainers with productivity ranking system`,icon:e.jsx(os,{className:"w-5 h-5"}),totalItems:m.length,children:e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-800 via-blue-900 to-slate-900 text-white p-4 rounded-t-lg",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-3",children:[e.jsx("div",{className:"text-white/80",children:"Avg Efficiency"}),e.jsx("div",{className:"text-xl font-bold",children:h.avgEfficiency.toFixed(0)})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-3",children:[e.jsx("div",{className:"text-white/80",children:"Top Performers"}),e.jsx("div",{className:"text-xl font-bold",children:h.topPerformers})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-3",children:[e.jsx("div",{className:"text-white/80",children:"Avg Utilization"}),e.jsxs("div",{className:"text-xl font-bold",children:[h.avgCapacityUtilization.toFixed(1),"%"]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-black text-white",children:e.jsx("tr",{children:x.map((s,t)=>e.jsx("th",{className:`px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider whitespace-nowrap cursor-pointer hover:bg-white/10 transition-colors ${s.className||""} ${s.align==="center"?"text-center":s.align==="right"?"text-right":"text-left"} ${t===0?"bg-gradient-to-r from-blue-800 via-blue-900 to-blue-800":"bg-black"}`,onClick:()=>s.sortable!==!1&&f(s.key),style:{height:"35px",maxHeight:"35px"},children:e.jsxs("div",{className:"flex items-center gap-1",children:[s.header,a.key===s.key&&(a.direction==="asc"?e.jsx(te,{className:"w-3 h-3"}):e.jsx(ve,{className:"w-3 h-3"}))]})},s.key))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map((s,t)=>e.jsx("tr",{className:"hover:bg-gray-50 cursor-pointer transition-colors",onClick:()=>w(s),style:{height:"35px",maxHeight:"35px"},children:x.map(u=>e.jsx("td",{className:`px-4 py-2 text-sm whitespace-nowrap ${u.align==="center"?"text-center":u.align==="right"?"text-right":"text-left"}`,children:u.render?u.render(s[u.key],s):s[u.key]},u.key))},t))})]})})]})})},ha=({value:n,onValueChange:i,className:a=""})=>e.jsx(vs,{value:n,onValueChange:i,className:a,children:e.jsxs(fs,{className:"grid w-full grid-cols-4 md:grid-cols-8 gap-1 h-auto p-2",children:[e.jsxs(oe,{value:"totalSessions",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Total"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Sessions"})]}),e.jsxs(oe,{value:"totalCustomers",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Total"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Members"})]}),e.jsxs(oe,{value:"totalPaid",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Total"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Revenue"})]}),e.jsxs(oe,{value:"classAverageExclEmpty",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Class"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Average"})]}),e.jsxs(oe,{value:"emptySessions",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Empty"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Sessions"})]}),e.jsxs(oe,{value:"conversionRate",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Conversion"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Rate"})]}),e.jsxs(oe,{value:"retentionRate",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"Retention"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Rate"})]}),e.jsxs(oe,{value:"newMembers",className:"text-xs px-3 py-3 h-auto flex-col gap-1",children:[e.jsx("span",{className:"font-semibold",children:"New"}),e.jsx("span",{className:"text-[10px] opacity-80",children:"Members"})]})]})}),xa=n=>{const i=a=>{if(!a)return{monthKey:"",monthLabel:""};let o=null;if(a.includes("/")){const[f,h]=a.split("/").map(u=>u.trim()),s=parseInt(f)-1,t=parseInt(h);!isNaN(s)&&!isNaN(t)&&(o=new Date(t,s,1))}else if(a.includes("-")||a.includes(" ")){const f=a.replace("-"," ").split(" ").filter(Boolean),h=f[0],s=parseInt(f[1]),u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(h);u>=0&&!isNaN(s)&&(o=new Date(s,u,1))}if(!o||isNaN(o.getTime()))return{monthKey:"",monthLabel:a};const m=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`,x=`${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][o.getMonth()]} ${o.getFullYear()}`;return{monthKey:m,monthLabel:x}};return n.map(a=>{const o=a.totalSessions||0,m=a.totalEmptySessions||0,w=a.totalNonEmptySessions||0,x=a.totalCustomers||0,f=a.totalPaid||0,h=a.cycleSessions||0,s=a.barreSessions||0,t=a.strengthSessions||0,u=w>0?x/w:0,p=o>0?x/o:0,k=typeof a.conversion=="string"?parseFloat(a.conversion.replace("%",""))||0:Number(a.conversion)||0,T=typeof a.retention=="string"?parseFloat(a.retention.replace("%",""))||0:Number(a.retention)||0,b=o*20,C=b>0?x/b*100:0,g=o>0?w/o*100:0,c={Cycle:h,Barre:s,Strength:t},M=Object.entries(c).reduce((E,F)=>c[E[0]]>c[F[0]]?E:F)[0],A={Cycle:h>0?h/o*100:0,Barre:s>0?s/o*100:0,Strength:t>0?t/o*100:0},j=o>0?f/o:0,O=x>0?f/x:0,S=0,y=Math.min(100,w/Math.max(o,1)*100),{monthKey:l,monthLabel:Y}=i(a.monthYear||"");return{trainerId:a.teacherId,trainerName:a.teacherName,trainerEmail:a.teacherEmail,location:a.location,monthYear:a.monthYear||"",monthKey:l,monthLabel:Y,totalSessions:o,emptySessions:m,nonEmptySessions:w,totalCustomers:x,totalPaid:f,cycleSessions:h,emptyCycleSessions:a.emptyCycleSessions||0,nonEmptyCycleSessions:a.nonEmptyCycleSessions||0,cycleCustomers:a.cycleCustomers||0,cycleRevenue:a.cyclePaid||0,strengthSessions:t,emptyStrengthSessions:a.emptyStrengthSessions||0,nonEmptyStrengthSessions:a.nonEmptyStrengthSessions||0,strengthCustomers:a.strengthCustomers||0,strengthRevenue:a.strengthPaid||0,barreSessions:s,emptyBarreSessions:a.emptyBarreSessions||0,nonEmptyBarreSessions:a.nonEmptyBarreSessions||0,barreCustomers:a.barreCustomers||0,barreRevenue:a.barrePaid||0,classAverageExclEmpty:u,classAverageInclEmpty:p,fillRate:C,capacity:b,utilizationRate:g,topFormat:M,formatDistribution:A,revenuePerSession:j,revenuePerCustomer:O,growthRate:S,consistencyScore:y,conversion:a.converted||0,retention:a.retained||0,uniqueKey:a.unique||"",newMembers:a.new||0,convertedMembers:a.converted||0,retainedMembers:a.retained||0,conversionRate:k,retentionRate:T}})},ts=(n,i)=>{switch(i){case"totalSessions":return n.totalSessions;case"totalCustomers":return n.totalCustomers;case"totalPaid":return n.totalPaid;case"classAverageExclEmpty":return n.classAverageExclEmpty;case"classAverageInclEmpty":return n.classAverageInclEmpty;case"emptySessions":return n.emptySessions;case"nonEmptySessions":return n.nonEmptySessions;case"cycleSessions":return n.cycleSessions;case"cycleRevenue":return n.cycleRevenue;case"barreSessions":return n.barreSessions;case"barreRevenue":return n.barreRevenue;case"strengthSessions":return n.strengthSessions;case"strengthRevenue":return n.strengthRevenue;case"conversion":return n.conversion;case"retention":return n.retention;case"conversionRate":return n.conversionRate;case"retentionRate":return n.retentionRate;case"newMembers":return n.newMembers;case"convertedMembers":return n.convertedMembers;case"retainedMembers":return n.retainedMembers;case"fillRate":return n.fillRate;case"capacity":return n.capacity;case"utilizationRate":return n.utilizationRate;case"revenuePerSession":return n.revenuePerSession;case"revenuePerCustomer":return n.revenuePerCustomer;case"growthRate":return n.growthRate;case"consistencyScore":return n.consistencyScore;default:return 0}},ua=({data:n,defaultMetric:i="totalSessions",onRowClick:a})=>{const[o,m]=L.useState(i),[w,x]=L.useState(new Set),f=L.useMemo(()=>{const c={};n.forEach(y=>{c[y.trainerName]||(c[y.trainerName]={}),c[y.trainerName][y.monthYear]=y});const M=[],A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],j=new Date,O=j.getFullYear(),S=j.getMonth();for(let y=2024;y<=O;y++){const Y=y===O?S:11;for(let E=0;E<=Y;E++){const F=`${A[E]}-${y}`;M.push(F)}}return M.reverse(),{trainerGroups:c,months:M}},[n]),h=(c,M)=>{switch(M){case"totalPaid":case"cycleRevenue":case"barreRevenue":return U(c);case"retentionRate":case"conversionRate":return`${c.toFixed(1)}%`;case"classAverageExclEmpty":case"classAverageInclEmpty":return c.toFixed(1);default:return B(c)}},s=(c,M)=>M===0?c>0?100:0:(c-M)/M*100,t=c=>{const M=new Set(w);M.has(c)?M.delete(c):M.add(c),x(M)},u=c=>{const M=f.trainerGroups[c],A=f.months,j=Object.values(M||{}),O=j.reduce((d,P)=>d+(P.totalSessions||0),0),S=j.reduce((d,P)=>d+(P.totalPaid||0),0),y=j.reduce((d,P)=>d+(P.totalCustomers||0),0),l=j.reduce((d,P)=>d+(P.cycleSessions||0),0),Y=j.reduce((d,P)=>d+(P.barreSessions||0),0),E=j.reduce((d,P)=>d+(P.strengthSessions||0),0),F=M[A[0]]||{},G=M[A[1]]||{},Z=G.totalSessions||0,J=G.totalPaid||0,I=G.totalCustomers||0,r=F.location||j[0]?.location||"";a&&a(c,{name:c,location:r,monthlyData:M,months:A,totalSessions:O,totalRevenue:S,totalCustomers:y,previousSessions:Z,previousRevenue:J,previousCustomers:I,cycleSessions:l,barreSessions:Y,strengthSessions:E})},p=L.useMemo(()=>{const c={},M=o==="classAverageExclEmpty"||o==="classAverageInclEmpty",A=o==="conversionRate"||o==="retentionRate";return f.months.forEach(j=>{if(!M&&!A){let O=0;Object.values(f.trainerGroups).forEach(S=>{S[j]&&(O+=ts(S[j],o))}),c[j]=O}else if(M){let O=0,S=0;Object.values(f.trainerGroups).forEach(y=>{const l=y[j];if(!l)return;const Y=o==="classAverageExclEmpty"?l.nonEmptySessions||0:l.totalSessions||0,E=l.totalCustomers||0;O+=E,S+=Y}),c[j]=S>0?O/S:0}else if(A){let O=0,S=0;Object.values(f.trainerGroups).forEach(y=>{const l=y[j];l&&(o==="conversionRate"?(O+=l.convertedMembers||0,S+=l.newMembers||0):o==="retentionRate"&&(O+=l.retainedMembers||0,S+=l.newMembers||0))}),c[j]=S>0?O/S*100:0}}),c},[f,o]),k=L.useMemo(()=>{const c=Object.values(p),M=o==="classAverageExclEmpty"||o==="classAverageInclEmpty",A=o==="conversionRate"||o==="retentionRate";let j=0;if(!M&&!A)j=c.reduce((y,l)=>y+l,0);else if(M){let y=0,l=0;f.months.forEach(Y=>{Object.values(f.trainerGroups).forEach(E=>{const F=E[Y];if(!F)return;const G=o==="classAverageExclEmpty"?F.nonEmptySessions||0:F.totalSessions||0,Z=F.totalCustomers||0;y+=Z,l+=G})}),j=l>0?y/l:0}else if(A){let y=0,l=0;f.months.forEach(Y=>{Object.values(f.trainerGroups).forEach(E=>{const F=E[Y];F&&(o==="conversionRate"?(y+=F.convertedMembers||0,l+=F.newMembers||0):o==="retentionRate"&&(y+=F.retainedMembers||0,l+=F.newMembers||0))})}),j=l>0?y/l*100:0}const O=c.length>0&&!M&&!A?j/c.length:j,S=c.length>=2?s(c[0],c[1]):0;return{total:j,average:O,growth:S}},[p,f,o]);if(!n.length)return e.jsx(Ke,{title:"Month-on-Month Trainer Analysis",description:"No trainer data available for month-on-month comparison",icon:e.jsx(_e,{className:"w-5 h-5"}),totalItems:0,children:e.jsx("div",{className:"p-8 text-center text-slate-600",children:"No trainer data available for analysis"})});const T=L.useRef(null),b=Hs(),C="Month-on-Month Trainer Analysis";L.useEffect(()=>{if(!b)return;const c=T.current;if(!c)return;const M=()=>{const A=c.querySelector("table")||c;let j=`${C}
`;const O=A.querySelectorAll("thead th"),S=[];return O.forEach(l=>{const Y=l.textContent?.trim();Y&&S.push(Y)}),S.length&&(j+=S.join("	")+`
`,j+=S.map(()=>"---").join("	")+`
`),A.querySelectorAll("tbody tr").forEach(l=>{const Y=l.querySelectorAll("td"),E=[];Y.forEach(F=>E.push((F.textContent||"").trim())),E.length&&(j+=E.join("	")+`
`)}),j.trim()};return b.register({id:C,getTextContent:M}),()=>b.unregister(C)},[b]);const g=L.useMemo(()=>{const c=["totalSessions","totalCustomers","totalPaid","classAverageExclEmpty","emptySessions","conversionRate","retentionRate","newMembers"],M=j=>{switch(j){case"totalSessions":return"Total Sessions";case"totalCustomers":return"Total Members";case"totalPaid":return"Total Revenue";case"classAverageExclEmpty":return"Class Average";case"emptySessions":return"Empty Sessions";case"conversionRate":return"Conversion Rate";case"retentionRate":return"Retention Rate";case"newMembers":return"New Members";default:return j}},A=[];return A.push(`${C}  All Metrics`),A.push(`Trainers: ${Object.keys(f.trainerGroups).length} | Months: ${f.months.length}`),c.forEach(j=>{A.push(""),A.push(`=== ${M(j)} ===`);const O=["Trainer",...f.months,"MoM Change",j==="classAverageExclEmpty"||j==="classAverageInclEmpty"||j==="conversionRate"||j==="retentionRate"?"Weighted Avg":"Total"];A.push(O.join("	"));const S=j==="classAverageExclEmpty"||j==="classAverageInclEmpty",y=j==="conversionRate"||j==="retentionRate",l=f.months.map(Z=>{if(!S&&!y){let J=0;return Object.values(f.trainerGroups).forEach(I=>{I[Z]&&(J+=ts(I[Z],j))}),J}else if(S){let J=0,I=0;return Object.values(f.trainerGroups).forEach(r=>{const d=r[Z];if(!d)return;const P=j==="classAverageExclEmpty"?d.nonEmptySessions||0:d.totalSessions||0,R=d.totalCustomers||0;J+=R,I+=P}),I>0?J/I:0}else{let J=0,I=0;return Object.values(f.trainerGroups).forEach(r=>{const d=r[Z];d&&(j==="conversionRate"?(J+=d.convertedMembers||0,I+=d.newMembers||0):(J+=d.retainedMembers||0,I+=d.newMembers||0))}),I>0?J/I*100:0}}),Y=l,E=Y.length>=2?s(Y[0],Y[1]):0,F=(()=>{if(!S&&!y)return Y.reduce((I,r)=>I+r,0);if(S){let I=0,r=0;return f.months.forEach(d=>{Object.values(f.trainerGroups).forEach(P=>{const R=P[d];if(!R)return;const $=j==="classAverageExclEmpty"?R.nonEmptySessions||0:R.totalSessions||0,v=R.totalCustomers||0;I+=v,r+=$})}),r>0?I/r:0}let Z=0,J=0;return f.months.forEach(I=>{Object.values(f.trainerGroups).forEach(r=>{const d=r[I];d&&(j==="conversionRate"?(Z+=d.convertedMembers||0,J+=d.newMembers||0):(Z+=d.retainedMembers||0,J+=d.newMembers||0))})}),J>0?Z/J*100:0})(),G=["TOTAL",...l.map(Z=>h(Z,j)),`${E>=0,""}${Math.abs(E).toFixed(1)}%`,h(F,j)];A.push(G.join("	")),Object.entries(f.trainerGroups).forEach(([Z,J])=>{const I=f.months.map(R=>J[R]?ts(J[R],j):0),r=I.length>=2?s(I[0],I[1]):0,d=(()=>{if(!S&&!y)return I.reduce((v,N)=>v+N,0);if(S){let v=0,N=0;return f.months.forEach(z=>{const D=J[z];if(!D)return;const ee=j==="classAverageExclEmpty"?D.nonEmptySessions||0:D.totalSessions||0,ne=D.totalCustomers||0;v+=ne,N+=ee}),N>0?v/N:0}let R=0,$=0;return f.months.forEach(v=>{const N=J[v];N&&(j==="conversionRate"?(R+=N.convertedMembers||0,$+=N.newMembers||0):(R+=N.retainedMembers||0,$+=N.newMembers||0))}),$>0?R/$*100:0})(),P=[Z,...I.map(R=>h(R,j)),`${r>=0,""}${Math.abs(r).toFixed(1)}%`,h(d,j)];A.push(P.join("	"))})}),A.join(`
`)},[f]);return e.jsx(Ke,{title:"Month-on-Month Trainer Analysis",description:`Individual month performance for ${Object.keys(f.trainerGroups).length} trainers  ${f.months.length} months tracked  Sorted by most recent`,icon:e.jsx(_e,{className:"w-5 h-5"}),totalItems:Object.keys(f.trainerGroups).length,children:e.jsxs("div",{ref:T,className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"pb-4 bg-white rounded-t-lg p-4",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"bg-purple-100 text-purple-800 border-purple-200",children:"Individual Monthly Columns"}),e.jsx(Ns,{tableRef:T,tableName:C,size:"sm",onCopyAllTabs:async()=>g})]})}),e.jsx(ha,{value:o,onValueChange:m})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(tt,{children:[e.jsx(at,{className:"sticky top-0 z-20",children:e.jsxs(Ze,{className:"border-none bg-black",style:{height:"35px",maxHeight:"35px"},children:[e.jsx(Ye,{className:"font-bold text-white sticky left-0 bg-gradient-to-r from-blue-800 via-blue-900 to-blue-800 backdrop-blur-sm z-30 min-w-[240px] border-r border-white/20",style:{height:"35px"},children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("span",{className:"text-white font-bold",children:"Trainer"})})}),f.months.map((c,M)=>{const A=new Date,j=A.getMonth(),O=A.getFullYear(),S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];let y=j-1,l=O;y<0&&(y=11,l=O-1);const Y=`${S[y]}-${l}`,E=c===Y;return e.jsx(Ye,{className:Q("text-center font-bold min-w-[140px] whitespace-nowrap text-white bg-black",E?"border-b-2 border-yellow-400":""),style:{height:"35px"},children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[E&&e.jsx(xs,{className:"w-3 h-3 text-yellow-400"}),e.jsx("span",{className:"text-sm font-bold",children:c.replace("-"," ")})]})},c)}),e.jsx(Ye,{className:"text-center font-bold text-white bg-black min-w-[120px]",style:{height:"35px"},children:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"MoM Change"}),e.jsx(W,{children:"Month-over-month change for the selected metric"})]})})}),e.jsx(Ye,{className:"text-center font-bold text-white min-w-[140px]",style:{height:"35px"},children:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:"Total"}),e.jsx(W,{children:o==="classAverageExclEmpty"||o==="classAverageInclEmpty"?"Weighted average across visible months (by sessions)":o==="conversionRate"||o==="retentionRate"?"Weighted average across visible months (by new members)":"Sum across all visible months for each trainer"})]})})}),e.jsx(Ye,{className:"text-right font-bold text-white min-w-[60px]",style:{height:"35px"},children:e.jsx(Ns,{tableRef:T,tableName:C,size:"sm",onCopyAllTabs:async()=>g})})]})}),e.jsxs(rt,{children:[e.jsxs(Ze,{className:"bg-slate-100 font-bold h-9 max-h-9",style:{height:"35px",maxHeight:"35px"},children:[e.jsx(je,{className:"font-bold text-slate-900 sticky left-0 bg-slate-100 z-10 whitespace-nowrap",style:{height:"35px",maxHeight:"35px"},children:"TOTAL"}),f.months.map(c=>e.jsx(je,{className:"text-center font-bold text-slate-900 whitespace-nowrap",style:{height:"35px",maxHeight:"35px"},children:h(p[c]||0,o)},`total-${c}`)),e.jsx(je,{className:"text-center",children:e.jsxs(se,{className:Q("flex items-center gap-1 text-xs px-2 py-1",k.growth>=0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[k.growth>=0?e.jsx(te,{className:"w-3 h-3"}):e.jsx(ve,{className:"w-3 h-3"}),Math.abs(k.growth).toFixed(1),"%"]})}),e.jsx(je,{className:"text-center font-bold text-slate-900",children:h(k.total,o)})]}),Object.entries(f.trainerGroups).map(([c,M])=>{const A=w.has(c),j=f.months.map(y=>M[y]?ts(M[y],o):0),O=(()=>{if(o==="classAverageExclEmpty"||o==="classAverageInclEmpty"){let y=0,l=0;return f.months.forEach((Y,E)=>{const F=M[Y];if(!F)return;const G=o==="classAverageExclEmpty"?F.nonEmptySessions||0:F.totalSessions||0,Z=F.totalCustomers||0;y+=Z,l+=G}),l>0?y/l:0}else if(o==="conversionRate"||o==="retentionRate"){let y=0,l=0;return f.months.forEach(Y=>{const E=M[Y];E&&(o==="conversionRate"?(y+=E.convertedMembers||0,l+=E.newMembers||0):(y+=E.retainedMembers||0,l+=E.newMembers||0))}),l>0?y/l*100:0}return j.reduce((y,l)=>y+l,0)})(),S=j.length>=2?s(j[0],j[1]):0;return e.jsxs(X.Fragment,{children:[e.jsxs(Ze,{className:"hover:bg-slate-50/50 transition-colors border-b cursor-pointer h-9 max-h-9",onClick:()=>u(c),style:{height:"35px"},children:[e.jsx(je,{className:"font-medium text-slate-800 sticky left-0 bg-white z-10 border-r min-w-[240px] whitespace-nowrap overflow-hidden text-ellipsis",style:{height:"35px"},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{variant:"ghost",size:"sm",onClick:y=>{y.stopPropagation(),t(c)},className:"p-1 h-6 w-6",children:A?e.jsx(nt,{className:"w-3 h-3"}):e.jsx(ot,{className:"w-3 h-3"})}),e.jsx(qe,{name:c,className:"text-nowrap"})]})}),j.map((y,l)=>e.jsx(je,{className:"text-center text-sm font-medium text-slate-800 hover:bg-slate-50 cursor-pointer",style:{height:"35px",maxHeight:"35px"},onClick:Y=>{if(Y.stopPropagation(),!a)return;const E=f.months[l],F=f.trainerGroups[c]||{},G=F[E]||{},Z={...G,trainerName:c,monthYear:E,location:G.location||j.length&&F[f.months[0]]?.location||"",type:"trainer-month-cell"};a(c,Z)},children:e.jsx(K,{children:e.jsxs(_,{children:[e.jsx(H,{className:"cursor-help",children:h(y,o)}),e.jsxs(W,{children:[f.months[l],"  ",o]})]})})},`${c}-${l}`)),e.jsx(je,{className:"text-center",children:e.jsxs(se,{className:Q("flex items-center gap-1 w-fit mx-auto",S>=0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[S>=0?e.jsx(te,{className:"w-3 h-3"}):e.jsx(ve,{className:"w-3 h-3"}),Math.abs(S).toFixed(1),"%"]})}),e.jsx(je,{className:"text-center font-bold text-slate-700",children:h(O,o)})]}),A&&e.jsx(Ze,{className:"bg-slate-50/50 hover:bg-slate-50 animate-fade-in",children:e.jsx(je,{colSpan:f.months.length+4,className:"p-6",style:{minHeight:"200px"},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-slate-600 text-xs font-medium",children:"Average per Month"}),e.jsx("p",{className:"font-bold text-slate-800 text-lg",children:h(O/f.months.length,o)})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-slate-600 text-xs font-medium",children:"Best Month"}),e.jsx("p",{className:"font-bold text-green-600 text-lg",children:h(Math.max(...j),o)})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-slate-600 text-xs font-medium",children:"Consistency Score"}),e.jsxs("p",{className:"font-bold text-blue-600 text-lg",children:[j.length>1?(100-j.reduce((y,l,Y)=>{if(Y===0)return y;const E=Math.abs((l-j[Y-1])/Math.max(j[Y-1],1))*100;return y+E},0)/(j.length-1)).toFixed(0):"100","%"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border hover:shadow-md transition-shadow",children:[e.jsx("p",{className:"text-slate-600 text-xs font-medium",children:"Growth Trend"}),e.jsxs("p",{className:Q("font-bold text-lg",S>=0?"text-green-600":"text-red-600"),children:[S>=0?"+":"",S.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-lg border",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"Performance Metrics"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-600",children:"Total:"}),e.jsx("span",{className:"font-bold",children:h(O,o)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-600",children:"Average:"}),e.jsx("span",{className:"font-bold",children:h(O/f.months.length,o)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-600",children:"Best:"}),e.jsx("span",{className:"font-bold",children:h(Math.max(...j),o)})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-lg border",children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"Class Formats"}),e.jsx("div",{className:"space-y-2 text-sm",children:(()=>{const y=Object.values(M||{}),l=y.reduce((F,G)=>F+(G.cycleSessions||0),0),Y=y.reduce((F,G)=>F+(G.barreSessions||0),0),E=y.reduce((F,G)=>F+(G.strengthSessions||0),0);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-600",children:"Cycle Sessions:"}),e.jsx("span",{className:"font-bold",children:B(l)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-600",children:"Barre Sessions:"}),e.jsx("span",{className:"font-bold",children:B(Y)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-green-600",children:"Strength Sessions:"}),e.jsx("span",{className:"font-bold",children:B(E)})]})]})})()})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-lg border",children:[e.jsx("h4",{className:"font-semibold text-purple-800 mb-3",children:"Member Engagement"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-600",children:"Retention:"}),e.jsx("span",{className:"font-bold",children:(()=>{const y=Object.values(M),l=y.reduce((F,G)=>F+(G.newMembers||0),0),Y=y.reduce((F,G)=>F+(G.retainedMembers||0),0);return`${(l>0?Y/l*100:0).toFixed(1)}%`})()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-600",children:"Conversion:"}),e.jsx("span",{className:"font-bold",children:(()=>{const y=Object.values(M),l=y.reduce((F,G)=>F+(G.newMembers||0),0),Y=y.reduce((F,G)=>F+(G.convertedMembers||0),0);return`${(l>0?Y/l*100:0).toFixed(1)}%`})()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-purple-600",children:"Revenue/Session:"}),e.jsx("span",{className:"font-bold",children:(()=>{const y=Object.values(M),l=y.reduce((E,F)=>E+(F.totalPaid||0),0),Y=y.reduce((E,F)=>E+(F.totalSessions||0),0);return U(Y>0?l/Y:0)})()})]})]})]})]})]})})})]},c)})]})]})}),e.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-white border-t p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h4",{className:"text-lg font-semibold text-slate-800 flex items-center gap-2",children:[e.jsx(lt,{className:"w-5 h-5 text-blue-600"}),"Monthly Performance Summary"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Object.keys(f.trainerGroups).length}),e.jsx("div",{className:"text-sm text-slate-600",children:"Active Trainers"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:h(k.total,o)}),e.jsxs("div",{className:"text-sm text-slate-600",children:["Total ",o]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:h(k.average,o)}),e.jsx("div",{className:"text-sm text-slate-600",children:"Monthly Average"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:Q("text-2xl font-bold",k.growth>=0?"text-green-600":"text-red-600"),children:[k.growth>=0?"+":"",k.growth.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Recent Growth"})]})]})]})]})})},ie={primary:"#3B82F6",success:"#10B981",purple:"#8B5CF6",cyan:"#06B6D4",pink:"#EC4899"},ce=({title:n,value:i,subtitle:a,icon:o,trend:m,trendValue:w,color:x="blue",size:f="default"})=>{const h={blue:"from-blue-700 to-blue-800 text-white",green:"from-white to-gray-50 text-gray-900 border-2 border-gray-200",purple:"from-white to-gray-50 text-gray-900 border-2 border-gray-200",amber:"from-white to-gray-50 text-gray-900 border-2 border-gray-200",rose:"from-white to-gray-50 text-gray-900 border-2 border-gray-200",cyan:"from-white to-gray-50 text-gray-900 border-2 border-gray-200"},s=m==="up"?$t:m==="down"?Ft:Rt,t=m==="up"?"text-emerald-400":m==="down"?"text-rose-400":"text-slate-400";return e.jsxs("div",{className:Q("relative overflow-hidden rounded-xl bg-gradient-to-br p-4 shadow-lg transition-all hover:shadow-xl",h[x],f==="large"&&"p-6"),children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:Q("p-2 rounded-lg backdrop-blur-sm",x==="blue"?"bg-white/20":"bg-blue-600"),children:e.jsx(o,{className:Q(f==="large"?"w-6 h-6":"w-5 h-5","text-white")})}),m&&e.jsxs("div",{className:Q("flex items-center gap-1 text-xs font-medium",t),children:[e.jsx(s,{className:"w-3 h-3"}),w]})]}),e.jsx("p",{className:Q("font-bold",f==="large"?"text-3xl":"text-2xl",x==="blue"?"text-white":"text-gray-900"),children:i}),e.jsx("p",{className:Q("text-sm font-medium",x==="blue"?"text-white/90":"text-gray-700"),children:n}),a&&e.jsx("p",{className:Q("text-xs mt-1",x==="blue"?"text-white/70":"text-gray-600"),children:a})]})]})},as=({score:n,label:i})=>{const a=()=>n>=80?"text-emerald-500":n>=60?"text-amber-500":"text-rose-500",m=n>=80?ps:n>=60?Pe:Ds;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:Q("w-5 h-5",a())}),e.jsxs("div",{children:[e.jsx("span",{className:Q("font-bold text-lg",a()),children:n.toFixed(0)}),e.jsx("span",{className:"text-slate-500 text-sm ml-1",children:"/100"})]}),e.jsx("span",{className:"text-slate-600 text-sm",children:i})]})};function pa({isOpen:n,onClose:i,trainerName:a,trainerData:o,allPayrollData:m=[],allSessionsData:w=[],filters:x={}}){const[f,h]=L.useState("overview"),s=L.useMemo(()=>{if(!o)return{hasData:!1,summary:null,byMonth:[],byFormat:[],performanceScore:0,insights:[],comparisons:null};const g=(v,N)=>{if(!N||N==="All Locations")return!0;const z=(v||"").toLowerCase(),D=N.toLowerCase();return D.includes("kenkere")?z.includes("kenkere"):D.includes("kwality")?z.includes("kwality")||z.includes("kemps"):D.includes("supreme")?z.includes("supreme")||z.includes("bandra"):v===N},c=m.filter(v=>v.teacherName===a&&g(v.location,x.location)&&(!x.month||v.monthYear===x.month)),M=m.filter(v=>v.teacherName===a&&g(v.location,x.location)),A=v=>{if(!v&&v!==0)return"";const N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(typeof v=="string"&&/^[A-Za-z]{3}-\d{4}$/.test(v.trim()))return v.trim();const z=ue=>{const pe=new Date(ue);return isNaN(pe.getTime())?"":`${N[pe.getMonth()]}-${pe.getFullYear()}`},D=String(v).trim();let ee=z(D);if(ee)return ee;const ne=D.match(/^(\d{4})[-\/](\d{1,2})[-\/](\d{1,2})$/);if(ne){const ue=Number(ne[1]),pe=Number(ne[2])-1;if(!isNaN(ue)&&!isNaN(pe))return`${N[pe]}-${ue}`}const me=D.match(/^(\d{1,2})[-\/](\d{1,2})[-\/](\d{4})$/);if(me){const ue=Number(me[3]),pe=Number(me[1])-1;if(!isNaN(ue)&&!isNaN(pe))return`${N[pe]}-${ue}`}const le=D.match(/^(\d{1,2})[-\/](\d{1,2})[-\/](\d{4})$/);if(le){const ue=Number(le[3]),pe=Number(le[2])-1;if(!isNaN(ue)&&!isNaN(pe))return`${N[pe]}-${ue}`}const Se=Date.parse(D);if(!isNaN(Se)){const ue=new Date(Se);return`${N[ue.getMonth()]}-${ue.getFullYear()}`}return""},j=(w||[]).filter(v=>{const N=A(String(v.date||"")),z=v.trainerName===a||v.teacherName===a,D=g(v.location,x.location),ee=!x.month||N===x.month;return z&&D&&ee}),S=o&&(o.totalSessions!==void 0||o.currentSessions!==void 0||o.sessions!==void 0)?o:c.length>0?c.reduce((v,N)=>(v.totalSessions=(v.totalSessions||0)+(N.totalSessions||0),v.totalCustomers=(v.totalCustomers||0)+(N.totalCustomers||0),v.totalPaid=(v.totalPaid||0)+(N.totalPaid||0),v.emptySessions=(v.emptySessions||0)+(N.emptySessions||0),v.nonEmptySessions=(v.nonEmptySessions||0)+(N.nonEmptySessions||0),v.cycleSessions=(v.cycleSessions||0)+(N.cycleSessions||0),v.cycleCustomers=(v.cycleCustomers||0)+(N.cycleCustomers||0),v.cycleRevenue=(v.cycleRevenue||0)+(N.cycleRevenue||N.cyclePaid||0),v.strengthSessions=(v.strengthSessions||0)+(N.strengthSessions||0),v.strengthCustomers=(v.strengthCustomers||0)+(N.strengthCustomers||0),v.strengthRevenue=(v.strengthRevenue||0)+(N.strengthRevenue||N.strengthPaid||0),v.barreSessions=(v.barreSessions||0)+(N.barreSessions||0),v.barreCustomers=(v.barreCustomers||0)+(N.barreCustomers||0),v.barreRevenue=(v.barreRevenue||0)+(N.barreRevenue||N.barrePaid||0),v.newMembers=(v.newMembers||0)+(N.newMembers||0),v.convertedMembers=(v.convertedMembers||0)+(N.convertedMembers||0),v.retainedMembers=(v.retainedMembers||0)+(N.retainedMembers||0),v.location||(v.location=N.location),v.monthYear||(v.monthYear=N.monthYear),!v.conversionRate&&N.conversionRate&&(v.conversionRate=N.conversionRate),!v.retentionRate&&N.retentionRate&&(v.retentionRate=N.retentionRate),v),{}):{},y=Number(o?.totalSessions||o?.currentSessions||o?.sessions||0),l={totalSessions:S.totalSessions||S.currentSessions||S.sessions||0,totalCustomers:S.totalCustomers||S.currentCustomers||S.customers||0,totalRevenue:S.totalPaid||S.totalRevenue||S.currentRevenue||S.revenue||0,emptySessions:S.emptySessions||S.totalEmptySessions||0,nonEmptySessions:S.nonEmptySessions||S.totalNonEmptySessions||0,cycleSessions:S.cycleSessions||0,cycleCustomers:S.cycleCustomers||0,cycleRevenue:S.cycleRevenue||S.cyclePaid||0,strengthSessions:S.strengthSessions||0,strengthCustomers:S.strengthCustomers||0,strengthRevenue:S.strengthRevenue||S.strengthPaid||0,barreSessions:S.barreSessions||0,barreCustomers:S.barreCustomers||0,barreRevenue:S.barreRevenue||S.barrePaid||0,conversionRate:typeof S.conversionRate=="number"?S.conversionRate:parseFloat(String(S.conversion||S.conversionRate||"0").replace("%",""))||0,retentionRate:typeof S.retentionRate=="number"?S.retentionRate:parseFloat(String(S.retention||S.retentionRate||"0").replace("%",""))||0,newMembers:S.newMembers||S.new||0,location:S.location||x.location||"",monthYear:S.monthYear||x.month||"",classAverageExclEmpty:S.classAverageExclEmpty||S.currentAvgClassSize||0,classAverageInclEmpty:S.classAverageInclEmpty||0,convertedMembers:S.convertedMembers||S.converted||0,retainedMembers:S.retainedMembers||S.retained||0,clickedCellSessions:y,sessionsSheetCount:0},Y=l.totalSessions>0?l.totalCustomers/l.totalSessions:0,E=l.nonEmptySessions>0?l.totalCustomers/l.nonEmptySessions:0,F=l.totalSessions>0?(l.totalSessions-l.emptySessions)/l.totalSessions*100:0,G=l.totalSessions>0?l.totalRevenue/l.totalSessions:0,Z=l.totalCustomers>0?l.totalRevenue/l.totalCustomers:0,J=(()=>{const v=j,N=v.reduce((ee,ne)=>{const me=(ne.lateCancelledCount||0)>0&&(ne.checkedInCount||0)===0,le=Number(ne.totalPaid||ne.revenue||0),Se=Number(ne.checkedInCount||ne.totalCustomers||ne.attendees||0);return ee.count+=1,ee.attendance+=Se,ee.cancelled+=me?1:0,ee.revenue+=le,ee.capacity+=Number(ne.capacity||0),ee.booked+=Number(ne.bookedCount||0),ee.complimentary+=Number(ne.complimentaryCount||0),ee},{count:0,attendance:0,cancelled:0,revenue:0,capacity:0,booked:0,complimentary:0}),D=["Barre","Power Cycle","Strength Lab"].map(ee=>{const me=v.filter(le=>(le.cleanedClass||le.classType||"").toLowerCase().includes(ee.toLowerCase())).reduce((le,Se)=>(le.sessions+=1,le.attendance+=Number(Se.checkedInCount||0),le.revenue+=Number(Se.totalPaid||Se.revenue||0),le),{sessions:0,attendance:0,revenue:0});return{name:ee,sessions:me.sessions,customers:me.attendance,revenue:me.revenue,avgAttendance:me.sessions>0?me.attendance/me.sessions:0}});return{list:v,totals:N,split:D,avgAttendance:N.count>0?N.attendance/N.count:0,avgRevenuePerSession:N.count>0?N.revenue/N.count:0,fillRate:N.capacity>0?N.attendance/N.capacity*100:0}})();l.sessionsSheetCount=J.list?J.list.length:0;const I=[{name:"Cycle",sessions:l.cycleSessions,customers:l.cycleCustomers,revenue:l.cycleRevenue,value:l.totalSessions>0?l.cycleSessions/l.totalSessions*100:0,avgAttendance:l.cycleSessions>0?l.cycleCustomers/l.cycleSessions:0},{name:"Strength",sessions:l.strengthSessions,customers:l.strengthCustomers,revenue:l.strengthRevenue,value:l.totalSessions>0?l.strengthSessions/l.totalSessions*100:0,avgAttendance:l.strengthSessions>0?l.strengthCustomers/l.strengthSessions:0},{name:"Barre",sessions:l.barreSessions,customers:l.barreCustomers,revenue:l.barreRevenue,value:l.totalSessions>0?l.barreSessions/l.totalSessions*100:0,avgAttendance:l.barreSessions>0?l.barreCustomers/l.barreSessions:0}].filter(v=>v.sessions>0),r=M.map(v=>({month:v.monthYear,sessions:v.totalSessions||0,customers:v.totalCustomers||0,revenue:v.totalPaid||0,avgAttendance:v.totalSessions>0?v.totalCustomers/v.totalSessions:0,conversionRate:typeof v.conversionRate=="number"?v.conversionRate:parseFloat(String(v.conversion||"0").replace("%",""))||0,retentionRate:typeof v.retentionRate=="number"?v.retentionRate:parseFloat(String(v.retention||"0").replace("%",""))||0})).sort((v,N)=>{const z=D=>{const ee=D.replace("-"," ").split(" "),me=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].indexOf(ee[0]),le=parseInt(ee[1])||2024;return new Date(le,me,1).getTime()};return z(v.month)-z(N.month)}),d=Math.min(100,Math.round(F*.25+Math.min(E/15,1)*25+Math.min(l.conversionRate/50,1)*25+Math.min(l.retentionRate/80,1)*25)),P=[];F>=85?P.push({type:"success",message:`Excellent fill rate of ${F.toFixed(1)}% - almost no empty classes!`}):F<70&&P.push({type:"warning",message:`Fill rate of ${F.toFixed(1)}% could be improved - ${l.emptySessions} empty classes`}),E>=12?P.push({type:"success",message:`Strong class attendance averaging ${E.toFixed(1)} students per class`}):E<8&&E>0&&P.push({type:"warning",message:`Average class size of ${E.toFixed(1)} is below target`}),l.conversionRate>=40?P.push({type:"success",message:`Great conversion rate of ${l.conversionRate.toFixed(1)}% (${l.convertedMembers} members converted)`}):l.conversionRate>0&&l.conversionRate<25&&P.push({type:"warning",message:`Conversion rate of ${l.conversionRate.toFixed(1)}% could be improved`}),l.retentionRate>=70?P.push({type:"success",message:`Excellent client retention at ${l.retentionRate.toFixed(1)}% (${l.retainedMembers} retained)`}):l.retentionRate>0&&l.retentionRate<50&&P.push({type:"warning",message:`Retention rate of ${l.retentionRate.toFixed(1)}% needs attention`}),l.newMembers>0&&P.push({type:"info",message:`${l.newMembers} new members joined classes this period`});const R=I.length>0?I.reduce((v,N)=>v.revenue>N.revenue?v:N,I[0]):null;R&&R.revenue>0&&P.push({type:"info",message:`${R.name} is the top revenue format (${U(R.revenue)})`});const $=[{metric:"Fill Rate",value:F,fullMark:100},{metric:"Attendance",value:Math.min(E*6.67,100),fullMark:100},{metric:"Conversion",value:Math.min(l.conversionRate*2,100),fullMark:100},{metric:"Retention",value:Math.min(l.retentionRate*1.25,100),fullMark:100},{metric:"Revenue",value:Math.min(G/20,100),fullMark:100}];return{hasData:!0,summary:{...l,avgClassSize:Y,avgClassSizeExclEmpty:E,fillRate:F,revenuePerSession:G,revenuePerCustomer:Z,newMembers:l.newMembers,convertedMembers:l.convertedMembers,retainedMembers:l.retainedMembers},byMonth:r,byFormat:I,sessionMetrics:J,performanceScore:d,insights:P,radarData:$}},[o,a,m,w,x]);if(!s.hasData||!s.summary)return e.jsx(bs,{open:n,onOpenChange:i,children:e.jsx(js,{className:"max-w-lg",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Pe,{className:"w-16 h-16 text-slate-300 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-slate-700",children:"No Data Available"}),e.jsx("p",{className:"text-slate-500 mt-2",children:"Could not load trainer performance data"}),e.jsx(he,{onClick:i,className:"mt-6",children:"Close"})]})})});const{summary:t,byMonth:u,byFormat:p,performanceScore:k,insights:T,radarData:b,sessionMetrics:C}=s;return e.jsx(bs,{open:n,onOpenChange:i,children:e.jsxs(js,{className:"max-w-[95vw] w-[1400px] max-h-[95vh] p-0 bg-slate-50 overflow-hidden",children:[e.jsxs(Ws,{className:"sr-only",children:[e.jsxs(Us,{children:["Trainer drilldown  ",a]}),e.jsxs(Vs,{children:[t?.monthYear?`Data for ${t.monthYear}`:"All periods",x?.location?`  ${x.location}`:""]})]}),e.jsxs("div",{className:"flex h-[90vh]",children:[e.jsxs("div",{className:"w-80 bg-gray-900 text-white flex flex-col border-r-2 border-gray-700",children:[e.jsx(he,{onClick:i,size:"sm",variant:"ghost",className:"absolute top-4 right-4 z-50 text-slate-400 hover:text-white hover:bg-white/10",children:e.jsx(ms,{className:"w-5 h-5"})}),e.jsx(Cs,{className:"flex-1",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"relative w-32 h-32 mx-auto mb-4",children:[e.jsx("div",{className:"w-full h-full rounded-full overflow-hidden border-4 border-white/20 shadow-2xl",children:e.jsx("img",{src:hs(a),alt:a,className:"w-full h-full object-cover",onError:g=>{const c=g.target;c.style.display="none",c.parentElement.innerHTML=`
                            <div class="w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white text-3xl font-bold">
                              ${Xs(a)}
                            </div>
                          `}})}),k>=80&&e.jsx("div",{className:"absolute -bottom-1 -right-1 bg-gradient-to-r from-amber-400 to-amber-500 rounded-full p-2 shadow-lg",children:e.jsx($e,{className:"w-5 h-5 text-white"})})]}),e.jsx("h2",{className:"text-2xl font-bold",children:a}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-2 text-slate-400",children:[e.jsx(Ys,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:t.location||"All Locations"})]}),t.monthYear&&e.jsxs(se,{className:"mt-2 bg-white/10 text-white/80",children:[e.jsx(ns,{className:"w-3 h-3 mr-1"}),t.monthYear]})]}),e.jsx(V,{className:"bg-gray-800 border-gray-700 mb-6",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-white",children:"Performance Score"}),e.jsx("span",{className:"text-3xl font-bold text-white",children:k})]}),e.jsx(ct,{value:k,className:"h-2 bg-gray-700"}),e.jsx("p",{className:"text-xs text-gray-300 mt-2",children:k>=80?" Outstanding":k>=60?" Great":k>=40?" Good":" Needs Work"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(xe,{className:"w-5 h-5 text-blue-400"}),e.jsx("span",{className:"text-sm text-white",children:"Total Sessions"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold text-lg text-white",children:t.clickedCellSessions||t.totalSessions}),e.jsxs("div",{className:"text-xs text-gray-300",children:["Sheet: ",t.sessionsSheetCount," ",t.clickedCellSessions&&t.clickedCellSessions!==t.sessionsSheetCount&&e.jsx("span",{className:"text-amber-400",children:" Clicked value differs"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(be,{className:"w-5 h-5 text-emerald-400"}),e.jsx("span",{className:"text-sm text-white",children:"Total Attendees"})]}),e.jsx("span",{className:"font-bold text-lg text-white",children:B(t.totalCustomers)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"w-5 h-5 text-amber-400"}),e.jsx("span",{className:"text-sm text-white",children:"Total Revenue"})]}),e.jsx("span",{className:"font-bold text-lg text-white",children:U(t.totalRevenue)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-800 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(fe,{className:"w-5 h-5 text-purple-400"}),e.jsx("span",{className:"text-sm text-white",children:"Fill Rate"})]}),e.jsxs("span",{className:"font-bold text-lg text-white",children:[t.fillRate.toFixed(1),"%"]})]})]}),p.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-white mb-3",children:"Class Format Mix"}),e.jsx("div",{className:"space-y-2",children:p.map(g=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:Q("h-full rounded-full",g.name==="Cycle"&&"bg-blue-500",g.name==="Strength"&&"bg-purple-500",g.name==="Barre"&&"bg-pink-500"),style:{width:`${g.value}%`}})}),e.jsxs("span",{className:"text-xs text-gray-300 w-16",children:[g.name," ",g.value.toFixed(0),"%"]})]},g.name))})]})]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b bg-white",children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900",children:"Performance Analytics"}),e.jsxs("p",{className:"text-slate-500 mt-1",children:["Comprehensive breakdown for ",a]})]}),e.jsxs(vs,{value:f,onValueChange:h,className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"px-6 pt-4 bg-white border-b",children:e.jsxs(fs,{className:"bg-slate-100 p-1",children:[e.jsxs(oe,{value:"overview",className:"data-[state=active]:bg-white",children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),"Overview"]}),e.jsxs(oe,{value:"sessions",className:"data-[state=active]:bg-white",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Sessions"]}),e.jsxs(oe,{value:"revenue",className:"data-[state=active]:bg-white",children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Revenue"]}),e.jsxs(oe,{value:"trends",className:"data-[state=active]:bg-white",children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Trends"]}),e.jsxs(oe,{value:"insights",className:"data-[state=active]:bg-white",children:[e.jsx(Rs,{className:"w-4 h-4 mr-2"}),"Insights"]})]})}),e.jsx(Cs,{className:"flex-1",children:e.jsxs("div",{className:"p-6",children:[e.jsxs(ye,{value:"overview",className:"mt-0 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsx(ce,{title:"Total Sessions",value:t.totalSessions,subtitle:`${t.emptySessions} empty`,icon:xe,color:"blue"}),e.jsx(ce,{title:"Total Attendees",value:B(t.totalCustomers),subtitle:`Avg ${t.avgClassSizeExclEmpty.toFixed(1)}/class`,icon:be,color:"green"}),e.jsx(ce,{title:"Total Revenue",value:U(t.totalRevenue),subtitle:`${U(t.revenuePerSession)}/session`,icon:ge,color:"purple"}),e.jsx(ce,{title:"Fill Rate",value:`${t.fillRate.toFixed(1)}%`,subtitle:`${t.nonEmptySessions||t.totalSessions-t.emptySessions} active classes`,icon:fe,color:"amber"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs(V,{className:"border-0 shadow-md",children:[e.jsx(ae,{className:"pb-2",children:e.jsxs(re,{className:"text-lg flex items-center gap-2",children:[e.jsx(xs,{className:"w-5 h-5 text-amber-500"}),"Performance Radar"]})}),e.jsx(q,{children:e.jsx(ke,{width:"100%",height:280,children:e.jsxs(ia,{data:b,children:[e.jsx(Is,{stroke:"#e2e8f0"}),e.jsx(zs,{dataKey:"metric",tick:{fontSize:12,fill:"#64748b"}}),e.jsx(Ls,{angle:30,domain:[0,100],tick:{fontSize:10}}),e.jsx(Je,{name:"Performance",dataKey:"value",stroke:ie.primary,fill:ie.primary,fillOpacity:.4,strokeWidth:2})]})})})]}),e.jsxs(V,{className:"border-0 shadow-md",children:[e.jsx(ae,{className:"pb-2",children:e.jsxs(re,{className:"text-lg flex items-center gap-2",children:[e.jsx(it,{className:"w-5 h-5 text-purple-500"}),"Class Format Breakdown"]})}),e.jsx(q,{children:p.length>0?e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(ke,{width:"50%",height:200,children:e.jsxs(yt,{children:[e.jsx(Nt,{data:p,dataKey:"sessions",nameKey:"name",cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,paddingAngle:4,children:p.map((g,c)=>e.jsx(bt,{fill:g.name==="Cycle"?ie.primary:g.name==="Strength"?ie.purple:ie.pink},g.name))}),e.jsx(Me,{formatter:(g,c)=>[`${g} sessions`,c]})]})}),e.jsx("div",{className:"flex-1 space-y-4",children:p.map(g=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:Q("w-3 h-3 rounded-full",g.name==="Cycle"&&"bg-blue-500",g.name==="Strength"&&"bg-purple-500",g.name==="Barre"&&"bg-pink-500")}),e.jsx("span",{className:"font-medium text-sm",children:g.name})]}),e.jsxs("span",{className:"text-sm text-slate-600",children:[g.sessions," sessions"]})]}),e.jsxs("div",{className:"text-xs text-slate-500 pl-5",children:[U(g.revenue),"  ",g.customers," attendees"]})]},g.name))})]}):e.jsx("div",{className:"h-[200px] flex items-center justify-center text-slate-400",children:"No format breakdown available"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsx(V,{className:"border-0 shadow-md bg-gradient-to-br from-emerald-50 to-teal-50",children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-emerald-700",children:"Conversion Rate"}),e.jsxs("p",{className:"text-4xl font-bold text-emerald-600 mt-2",children:[t.conversionRate.toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-emerald-600/70 mt-1",children:"New clients converted to members"})]}),e.jsx("div",{className:"p-3 bg-emerald-500/20 rounded-xl",children:e.jsx(te,{className:"w-8 h-8 text-emerald-600"})})]})})}),e.jsx(V,{className:"border-0 shadow-md bg-gradient-to-br from-blue-50 to-indigo-50",children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Retention Rate"}),e.jsxs("p",{className:"text-4xl font-bold text-blue-600 mt-2",children:[t.retentionRate.toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-blue-600/70 mt-1",children:"Members returning for classes"})]}),e.jsx("div",{className:"p-3 bg-blue-500/20 rounded-xl",children:e.jsx(be,{className:"w-8 h-8 text-blue-600"})})]})})})]})]}),e.jsxs(ye,{value:"sessions",className:"mt-0 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(ce,{title:"Total Sessions (Clicked)",value:t.clickedCellSessions||t.totalSessions,subtitle:t.sessionsSheetCount?`Sheet: ${t.sessionsSheetCount}${t.clickedCellSessions&&t.clickedCellSessions!==t.sessionsSheetCount?"  Mismatch":""}`:void 0,icon:xe,color:"blue",size:"large"}),e.jsx(ce,{title:"Active Sessions",value:t.totalSessions-t.emptySessions,subtitle:`${t.fillRate.toFixed(1)}% fill rate`,icon:ps,color:"green",size:"large"}),e.jsx(ce,{title:"Empty Sessions",value:t.emptySessions,subtitle:`${(t.emptySessions/t.totalSessions*100).toFixed(1)}% of total`,icon:Ds,color:"rose",size:"large"})]}),e.jsxs(V,{className:"border-0 shadow-md",children:[e.jsxs(ae,{children:[e.jsx(re,{className:"text-lg",children:"Sessions by Format"}),e.jsx(ys,{children:"Breakdown of classes by type"})]}),e.jsx(q,{children:p.length>0?e.jsx(ke,{width:"100%",height:300,children:e.jsxs(us,{data:p,layout:"vertical",children:[e.jsx(Te,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(Ee,{type:"number"}),e.jsx(Ae,{type:"category",dataKey:"name",width:80}),e.jsx(Me,{formatter:(g,c)=>c==="sessions"?[g,"Sessions"]:c==="customers"?[g,"Attendees"]:[g,c]}),e.jsx(As,{}),e.jsx(Ge,{dataKey:"sessions",fill:ie.primary,name:"Sessions",radius:[0,4,4,0]}),e.jsx(Ge,{dataKey:"customers",fill:ie.success,name:"Attendees",radius:[0,4,4,0]})]})}):e.jsx("div",{className:"h-[300px] flex items-center justify-center text-slate-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xe,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No session format data available"})]})})})]}),e.jsxs(V,{className:"border-0 shadow-md",children:[e.jsxs(ae,{children:[e.jsx(re,{className:"text-lg",children:"Session Metrics (Filtered)"}),e.jsxs(ys,{children:[x?.month?`Month: ${x.month}`:"All Months",x?.location?`  Location: ${x.location}`:""]})]}),e.jsx(q,{children:C?.list&&C.list.length>0?e.jsxs("div",{className:"space-y-6",children:[t.clickedCellSessions&&t.clickedCellSessions!==t.sessionsSheetCount&&e.jsxs("div",{className:"p-3 rounded-md bg-amber-50 border border-amber-200 text-amber-800",children:[e.jsx("div",{className:"font-medium",children:"Clicked cell value differs from sessions sheet"}),e.jsxs("div",{className:"text-sm",children:["Clicked: ",t.clickedCellSessions,"  Sheet rows: ",t.sessionsSheetCount,"  Difference: ",t.clickedCellSessions-t.sessionsSheetCount]})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsx(ce,{title:"Attendance",value:B(C.totals.attendance),subtitle:`Avg ${C.avgAttendance.toFixed(1)}/class`,icon:be,color:"green"}),e.jsx(ce,{title:"Cancelled",value:C.totals.cancelled,subtitle:`${(C.totals.cancelled/C.totals.count*100).toFixed(1)}% of classes`,icon:Pe,color:"amber"}),e.jsx(ce,{title:"Revenue",value:U(C.totals.revenue),subtitle:`${U(C.avgRevenuePerSession)}/session`,icon:ge,color:"purple"}),e.jsx(ce,{title:"Capacity",value:B(C.totals.capacity),subtitle:`Fill ${C.fillRate.toFixed(1)}%`,icon:fe,color:"blue"}),e.jsx(ce,{title:"Booked",value:B(C.totals.booked),subtitle:`Comp ${B(C.totals.complimentary)}`,icon:ns,color:"cyan"})]}),C.split&&C.split.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-4",children:C.split.map(g=>e.jsx(V,{className:"border bg-slate-50",children:e.jsxs(q,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:g.name}),e.jsxs("span",{className:"text-xs text-slate-500",children:[g.sessions," sessions"]})]}),e.jsxs("div",{className:"text-slate-600 text-sm",children:[B(g.customers)," attendees  ",U(g.revenue)]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-1",children:["Avg ",g.avgAttendance.toFixed(1),"/class"]})]})},g.name))}),e.jsx("div",{className:"overflow-x-auto border rounded-lg bg-white",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-100 text-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 text-left",children:"Date"}),e.jsx("th",{className:"p-2 text-left",children:"Time"}),e.jsx("th",{className:"p-2 text-left",children:"Class"}),e.jsx("th",{className:"p-2 text-left",children:"Location"}),e.jsx("th",{className:"p-2 text-right",children:"Attendees"}),e.jsx("th",{className:"p-2 text-right",children:"Cancelled"}),e.jsx("th",{className:"p-2 text-right",children:"Capacity"}),e.jsx("th",{className:"p-2 text-right",children:"Fill %"}),e.jsx("th",{className:"p-2 text-right",children:"Revenue"})]})}),e.jsx("tbody",{children:C.list.map((g,c)=>{const M=Number(g.checkedInCount||g.totalCustomers||0),A=Number(g.capacity||0),j=A>0?M/A*100:0,O=(g.lateCancelledCount||0)>0&&M===0,S=(g.cleanedClass||g.classType||"").trim(),y=Number(g.totalPaid||g.revenue||0);return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:g.date||g.monthYear||""}),e.jsx("td",{className:"p-2",children:g.time||""}),e.jsx("td",{className:"p-2",children:S}),e.jsx("td",{className:"p-2",children:g.location||""}),e.jsx("td",{className:"p-2 text-right",children:M}),e.jsx("td",{className:"p-2 text-right",children:O?"Yes":"No"}),e.jsx("td",{className:"p-2 text-right",children:A}),e.jsxs("td",{className:"p-2 text-right",children:[j.toFixed(1),"%"]}),e.jsx("td",{className:"p-2 text-right",children:U(y)})]},c)})})]})})]}):e.jsx("div",{className:"h-[200px] flex items-center justify-center text-slate-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xe,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No sessions found for the selected filters."})]})})})]}),e.jsxs(V,{className:"border-0 shadow-md",children:[e.jsx(ae,{children:e.jsx(re,{className:"text-lg",children:"Class Size Metrics"})}),e.jsx(q,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Avg Class Size (All Classes)"}),e.jsx("p",{className:"text-3xl font-bold text-slate-800",children:t.avgClassSize.toFixed(1)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500 mb-1",children:"Avg Class Size (Excl. Empty)"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-600",children:t.avgClassSizeExclEmpty.toFixed(1)})]})]}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"w-40 h-40 rounded-full border-8 border-blue-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-4xl font-bold text-blue-600",children:B(t.totalCustomers)}),e.jsx("p",{className:"text-sm text-slate-500",children:"Total Attendees"})]})})})]})})]})]}),e.jsxs(ye,{value:"revenue",className:"mt-0 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx(ce,{title:"Total Revenue",value:U(t.totalRevenue),icon:ge,color:"blue",size:"large"}),e.jsx(ce,{title:"Revenue per Session",value:U(t.revenuePerSession),icon:xe,color:"green",size:"large"}),e.jsx(ce,{title:"Revenue per Customer",value:U(t.revenuePerCustomer),icon:be,color:"purple",size:"large"})]}),e.jsxs(V,{className:"border-0 shadow-sm border border-slate-200",children:[e.jsx(ae,{className:"bg-slate-50 border-b border-slate-200",children:e.jsx(re,{className:"text-lg text-slate-800",children:"Revenue Breakdown by Session"})}),e.jsx(q,{className:"p-0",children:u.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-200 bg-black",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-white bg-gradient-to-r from-blue-800 via-blue-900 to-blue-800",children:"Month"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-white bg-black",children:"Sessions"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-white bg-black",children:"Revenue"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-white bg-black",children:"Avg/Session"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-white bg-black",children:"Customers"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-white bg-black",children:"Avg/Customer"})]})}),e.jsx("tbody",{children:u.map((g,c)=>e.jsxs("tr",{className:Q("border-b border-slate-100 hover:bg-slate-50","h-[35px] max-h-[35px]"),children:[e.jsx("td",{className:"py-2 px-4 font-medium text-slate-900 h-[35px]",children:g.month}),e.jsx("td",{className:"py-2 px-4 text-right text-slate-700 h-[35px]",children:g.sessions}),e.jsx("td",{className:"py-2 px-4 text-right font-semibold text-slate-900 h-[35px]",children:U(g.revenue)}),e.jsx("td",{className:"py-2 px-4 text-right text-slate-700 h-[35px]",children:U(g.revenue/g.sessions)}),e.jsx("td",{className:"py-2 px-4 text-right text-slate-700 h-[35px]",children:g.customers}),e.jsx("td",{className:"py-2 px-4 text-right text-slate-700 h-[35px]",children:U(g.revenue/g.customers)})]},g.month))})]})}):e.jsx("div",{className:"h-[200px] flex items-center justify-center text-slate-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ge,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No revenue data available"})]})})})]}),e.jsxs(V,{className:"border-0 shadow-sm border border-slate-200",children:[e.jsx(ae,{className:"bg-slate-50 border-b border-slate-200",children:e.jsx(re,{className:"text-lg text-slate-800",children:"Revenue by Class Format"})}),e.jsx(q,{children:p.length>0?e.jsx("div",{className:"grid grid-cols-3 gap-6",children:p.map(g=>e.jsxs("div",{className:"p-6 rounded-xl border-2 border-gray-900 bg-white text-gray-900 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[g.name==="Cycle"&&e.jsx(Ot,{className:"w-6 h-6 text-blue-700"}),g.name==="Strength"&&e.jsx(wt,{className:"w-6 h-6 text-blue-700"}),g.name==="Barre"&&e.jsx(Yt,{className:"w-6 h-6 text-blue-700"}),e.jsx("span",{className:"font-bold text-lg text-gray-900",children:g.name})]}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:U(g.revenue)}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2 font-medium",children:[g.sessions," sessions  ",g.customers," attendees"]})]},g.name))}):e.jsx("div",{className:"h-[200px] flex items-center justify-center text-slate-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ge,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No revenue breakdown available"})]})})})]})]}),e.jsx(ye,{value:"trends",className:"mt-0 space-y-6",children:u.length>1?e.jsxs(e.Fragment,{children:[e.jsxs(V,{className:"border-0 shadow-md",children:[e.jsx(ae,{children:e.jsx(re,{className:"text-lg",children:"Monthly Revenue Trend"})}),e.jsx(q,{children:e.jsx(ke,{width:"100%",height:300,children:e.jsxs(St,{data:u,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"revenueGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:ie.success,stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:ie.success,stopOpacity:0})]})}),e.jsx(Te,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(Ee,{dataKey:"month",tick:{fontSize:12}}),e.jsx(Ae,{tick:{fontSize:12}}),e.jsx(Me,{formatter:g=>U(g),labelStyle:{fontWeight:"bold"}}),e.jsx(Ct,{type:"monotone",dataKey:"revenue",stroke:ie.success,fill:"url(#revenueGradient)",strokeWidth:2})]})})})]}),e.jsxs(V,{className:"border-0 shadow-md",children:[e.jsx(ae,{children:e.jsx(re,{className:"text-lg",children:"Sessions & Attendance Trend"})}),e.jsx(q,{children:e.jsx(ke,{width:"100%",height:300,children:e.jsxs(Bs,{data:u,children:[e.jsx(Te,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(Ee,{dataKey:"month",tick:{fontSize:12}}),e.jsx(Ae,{yAxisId:"left",tick:{fontSize:12}}),e.jsx(Ae,{yAxisId:"right",orientation:"right",tick:{fontSize:12}}),e.jsx(Me,{}),e.jsx(As,{}),e.jsx(ls,{yAxisId:"left",type:"monotone",dataKey:"sessions",stroke:ie.primary,strokeWidth:2,dot:{fill:ie.primary},name:"Sessions"}),e.jsx(ls,{yAxisId:"right",type:"monotone",dataKey:"customers",stroke:ie.purple,strokeWidth:2,dot:{fill:ie.purple},name:"Attendees"})]})})})]}),e.jsxs(V,{className:"border-0 shadow-md",children:[e.jsx(ae,{children:e.jsx(re,{className:"text-lg",children:"Average Class Attendance Trend"})}),e.jsx(q,{children:e.jsx(ke,{width:"100%",height:250,children:e.jsxs(us,{data:u,children:[e.jsx(Te,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(Ee,{dataKey:"month",tick:{fontSize:12}}),e.jsx(Ae,{tick:{fontSize:12},domain:[0,"auto"]}),e.jsx(Me,{formatter:g=>g.toFixed(1)}),e.jsx(Ge,{dataKey:"avgAttendance",fill:ie.cyan,name:"Avg Attendance",radius:[4,4,0,0]})]})})})]})]}):e.jsx(V,{className:"border-0 shadow-md",children:e.jsx(q,{className:"p-12",children:e.jsxs("div",{className:"text-center text-slate-400",children:[e.jsx(te,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("h3",{className:"text-lg font-medium text-slate-600 mb-2",children:"Single Period Data"}),e.jsxs("p",{className:"text-sm",children:["Trend analysis requires multiple months of data.",e.jsx("br",{}),"Currently showing data for: ",e.jsx("span",{className:"font-medium",children:t.monthYear||"All time"})]})]})})})}),e.jsxs(ye,{value:"insights",className:"mt-0 space-y-6",children:[e.jsxs(V,{className:"border-0 shadow-md",children:[e.jsx(ae,{children:e.jsxs(re,{className:"text-lg flex items-center gap-2",children:[e.jsx(xs,{className:"w-5 h-5 text-amber-500"}),"Performance Summary"]})}),e.jsx(q,{children:e.jsxs("div",{className:"flex items-center gap-8 mb-6",children:[e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-4xl font-bold",children:k}),e.jsx("p",{className:"text-sm text-white/80",children:"Score"})]})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx(as,{score:t.fillRate,label:"Fill Rate"}),e.jsx(as,{score:Math.min(t.avgClassSizeExclEmpty*6.67,100),label:"Attendance"}),e.jsx(as,{score:Math.min(t.conversionRate*2,100),label:"Conversion"}),e.jsx(as,{score:Math.min(t.retentionRate*1.25,100),label:"Retention"})]})]})})]}),e.jsxs(V,{className:"border-0 shadow-md",children:[e.jsx(ae,{children:e.jsxs(re,{className:"text-lg flex items-center gap-2",children:[e.jsx(Rs,{className:"w-5 h-5 text-purple-500"}),"Key Insights"]})}),e.jsx(q,{children:T.length>0?e.jsx("div",{className:"space-y-3",children:T.map((g,c)=>e.jsxs("div",{className:Q("flex items-start gap-3 p-4 rounded-lg",g.type==="success"&&"bg-emerald-50 border border-emerald-200",g.type==="warning"&&"bg-amber-50 border border-amber-200",g.type==="info"&&"bg-blue-50 border border-blue-200"),children:[g.type==="success"&&e.jsx(ps,{className:"w-5 h-5 text-emerald-500 flex-shrink-0 mt-0.5"}),g.type==="warning"&&e.jsx(Pe,{className:"w-5 h-5 text-amber-500 flex-shrink-0 mt-0.5"}),g.type==="info"&&e.jsx(os,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:Q("text-sm",g.type==="success"&&"text-emerald-800",g.type==="warning"&&"text-amber-800",g.type==="info"&&"text-blue-800"),children:g.message})]},c))}):e.jsx("p",{className:"text-slate-500 text-center py-8",children:"No insights available"})})]}),e.jsxs(V,{className:"border-0 shadow-md bg-gradient-to-br from-slate-800 to-slate-900 text-white",children:[e.jsx(ae,{children:e.jsxs(re,{className:"text-lg flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-amber-400"}),"Recommendations"]})}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-4",children:[t.emptySessions>2&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white/10 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-amber-500/20 rounded",children:e.jsx(Pe,{className:"w-4 h-4 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Reduce Empty Classes"}),e.jsxs("p",{className:"text-sm text-white/70",children:["Consider adjusting schedule or promotion for the ",t.emptySessions," classes with no attendance."]})]})]}),t.avgClassSizeExclEmpty<10&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white/10 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-blue-500/20 rounded",children:e.jsx(be,{className:"w-4 h-4 text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Boost Class Attendance"}),e.jsxs("p",{className:"text-sm text-white/70",children:["Average class size is ",t.avgClassSizeExclEmpty.toFixed(1),". Target 12+ for optimal revenue."]})]})]}),t.conversionRate<30&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white/10 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-emerald-500/20 rounded",children:e.jsx(te,{className:"w-4 h-4 text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Improve Conversion"}),e.jsxs("p",{className:"text-sm text-white/70",children:["Focus on converting trial members. Current rate: ",t.conversionRate.toFixed(1),"%"]})]})]}),k>=70&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white/10 rounded-lg",children:[e.jsx("div",{className:"p-1.5 bg-amber-500/20 rounded",children:e.jsx($e,{className:"w-4 h-4 text-amber-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Strong Performance"}),e.jsx("p",{className:"text-sm text-white/70",children:"Keep up the great work! Consider mentoring other trainers."})]})]})]})})]})]})]})})]})]})]})]})})}const ga=({data:n,onFiltersChange:i,isCollapsed:a,onToggleCollapse:o})=>{const[m,w]=L.useState({location:"all",trainer:"all",month:"all",searchTerm:"",minSessions:"",maxSessions:"",minRevenue:"",maxRevenue:"",performanceLevel:"all",classType:"all"}),x=Array.from(new Set(n.map(b=>b.location))).filter(Boolean),f=Array.from(new Set(n.map(b=>b.teacherName))).filter(Boolean),h=Array.from(new Set(n.map(b=>b.monthYear))).filter(Boolean).sort().reverse();L.useEffect(()=>{if(h.length>0&&x.length>0){const b=new Date,C=new Date(b.getFullYear(),b.getMonth()-1,1),g=C.toLocaleDateString("en-US",{month:"short"}),c=C.getFullYear(),M=`${g}-${c}`,A=h.find(O=>O===M)||h[0]||"all",j=x.find(O=>O.toLowerCase().includes("kwality"))||"all";if(m.month==="all"&&m.location==="all"){const O={...m,month:A,location:j};w(O),u(O)}}},[h,x]);const s=[{value:"all",label:"All Performance Levels"},{value:"high",label:"High Performers (Top 25%)"},{value:"medium",label:"Medium Performers (25-75%)"},{value:"low",label:"Low Performers (Bottom 25%)"}],t=[{value:"all",label:"All Class Types"},{value:"cycle",label:"Cycle Classes"},{value:"barre",label:"Barre Classes"},{value:"strength",label:"Strength Classes"}],u=b=>{const C={...m,...b};w(C);const g={location:C.location==="all"?"":C.location,trainer:C.trainer==="all"?"":C.trainer,month:C.month==="all"?"":C.month,searchTerm:C.searchTerm||"",performanceLevel:C.performanceLevel==="all"?"":C.performanceLevel,classType:C.classType==="all"?"":C.classType,minSessions:C.minSessions?Number(C.minSessions):null,maxSessions:C.maxSessions?Number(C.maxSessions):null,minRevenue:C.minRevenue?Number(C.minRevenue):null,maxRevenue:C.maxRevenue?Number(C.maxRevenue):null};i(g)},p=()=>{const b={location:"all",trainer:"all",month:"all",searchTerm:"",minSessions:"",maxSessions:"",minRevenue:"",maxRevenue:"",performanceLevel:"all",classType:"all"};w(b),u(b)},k=Object.entries(m).some(([b,C])=>b==="searchTerm"||b.includes("min")||b.includes("max")?C!=="":C!==""&&C!=="all"),T=Object.entries(m).filter(([b,C])=>b==="searchTerm"||b.includes("min")||b.includes("max")?C!=="":C!==""&&C!=="all").length;return a?e.jsx(V,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:e.jsx(q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Enhanced Filters"}),k&&e.jsxs(se,{variant:"secondary",className:"text-xs",children:[T," active"]})]}),e.jsx(he,{variant:"ghost",size:"sm",onClick:o,className:"text-blue-600 hover:text-blue-700",children:"Show Filters"})]})})}):e.jsxs(V,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:[e.jsx(ae,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(re,{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:[e.jsx(Ps,{className:"w-5 h-5 text-blue-600"}),"Enhanced Trainer Filters"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[k&&e.jsxs(he,{variant:"outline",size:"sm",onClick:p,className:"text-slate-600 hover:text-slate-700",children:[e.jsx(ms,{className:"w-3 h-3 mr-1"}),"Clear All"]}),e.jsx(he,{variant:"ghost",size:"sm",onClick:o,className:"text-blue-600 hover:text-blue-700",children:"Hide Filters"})]})]})}),e.jsxs(q,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Re,{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[e.jsx(qs,{className:"w-4 h-4 text-blue-600"}),"Search Trainers"]}),e.jsx(ze,{placeholder:"Search by name...",value:m.searchTerm,onChange:b=>u({searchTerm:b.target.value}),className:"h-9"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Re,{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[e.jsx(Ys,{className:"w-4 h-4 text-blue-600"}),"Location"]}),e.jsxs(Le,{value:m.location,onValueChange:b=>u({location:b}),children:[e.jsx(De,{className:"h-9",children:e.jsx(Be,{placeholder:"All Locations"})}),e.jsxs(Ie,{children:[e.jsx(Ce,{value:"all",children:"All Locations"}),x.map(b=>e.jsx(Ce,{value:b,children:b},b))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Re,{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[e.jsx(kt,{className:"w-4 h-4 text-blue-600"}),"Trainer"]}),e.jsxs(Le,{value:m.trainer,onValueChange:b=>u({trainer:b}),children:[e.jsx(De,{className:"h-9",children:e.jsx(Be,{placeholder:"All Trainers"})}),e.jsxs(Ie,{children:[e.jsx(Ce,{value:"all",children:"All Trainers"}),f.map(b=>e.jsx(Ce,{value:b,children:b},b))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Re,{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[e.jsx(ns,{className:"w-4 h-4 text-blue-600"}),"Month"]}),e.jsxs(Le,{value:m.month,onValueChange:b=>u({month:b}),children:[e.jsx(De,{className:"h-9",children:e.jsx(Be,{placeholder:"All Months"})}),e.jsxs(Ie,{children:[e.jsx(Ce,{value:"all",children:"All Months"}),h.map(b=>e.jsx(Ce,{value:b,children:b},b))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Re,{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4 text-blue-600"}),"Performance Level"]}),e.jsxs(Le,{value:m.performanceLevel,onValueChange:b=>u({performanceLevel:b}),children:[e.jsx(De,{className:"h-9",children:e.jsx(Be,{placeholder:"All Performance Levels"})}),e.jsx(Ie,{children:s.map(b=>e.jsx(Ce,{value:b.value,children:b.label},b.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Re,{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-blue-600"}),"Class Type"]}),e.jsxs(Le,{value:m.classType,onValueChange:b=>u({classType:b}),children:[e.jsx(De,{className:"h-9",children:e.jsx(Be,{placeholder:"All Class Types"})}),e.jsx(Ie,{children:t.map(b=>e.jsx(Ce,{value:b.value,children:b.label},b.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Re,{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-blue-600"}),"Sessions Range"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{children:e.jsx(ze,{placeholder:"Min sessions",type:"number",value:m.minSessions,onChange:b=>u({minSessions:b.target.value}),className:"h-9"})}),e.jsx("div",{children:e.jsx(ze,{placeholder:"Max sessions",type:"number",value:m.maxSessions,onChange:b=>u({maxSessions:b.target.value}),className:"h-9"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(Re,{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4 text-blue-600"}),"Revenue Range"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{children:e.jsx(ze,{placeholder:"Min revenue",type:"number",value:m.minRevenue,onChange:b=>u({minRevenue:b.target.value}),className:"h-9"})}),e.jsx("div",{children:e.jsx(ze,{placeholder:"Max revenue",type:"number",value:m.maxRevenue,onChange:b=>u({maxRevenue:b.target.value}),className:"h-9"})})]})]})]}),k&&e.jsx("div",{className:"pt-4 border-t border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Active Filters:"}),Object.entries(m).map(([b,C])=>{if(b==="searchTerm"||b.includes("min")||b.includes("max")){if(!C)return null}else if(!C||C==="all")return null;const g=b.includes("min")||b.includes("max")?`${b.replace(/([A-Z])/g," $1").toLowerCase()}: ${C}`:`${b.replace(/([A-Z])/g," $1").toLowerCase()}: ${C}`;return e.jsxs(se,{variant:"secondary",className:"text-xs",children:[g,e.jsx("button",{onClick:()=>{const c=b==="searchTerm"||b.includes("min")||b.includes("max")?"":"all";u({[b]:c})},className:"ml-1 hover:text-blue-600",children:e.jsx(ms,{className:"w-3 h-3"})})]},b)})]})})]})]})},va=({data:n,onCardClick:i})=>{const a=X.useMemo(()=>{if(!n.length)return null;const w=new Set(n.map(M=>M.trainerName)).size,x=n.reduce((M,A)=>M+A.totalSessions,0),f=n.reduce((M,A)=>M+A.totalPaid,0),h=n.reduce((M,A)=>M+A.totalCustomers,0),s=x>0?h/x:0,t=w>0?f/w:0,u=x>0?f/x:0,p=n.reduce((M,A)=>M+A.nonEmptySessions,0),k=x>0?p/x*100:0,T=n.reduce((M,A)=>M+(A.newMembers||0),0),b=n.reduce((M,A)=>M+(A.convertedMembers||0),0),C=n.reduce((M,A)=>M+(A.retainedMembers||0),0),g=T>0?b/T*100:0,c=T>0?C/T*100:0;return{totalTrainers:w,totalSessions:x,totalRevenue:f,totalCustomers:h,avgClassSize:s,avgRevenue:t,avgRevenuePerSession:u,utilizationRate:k,avgConversionRate:g,avgRetentionRate:c}},[n]);if(!a)return null;const o=[{title:"Active Trainers",value:B(a.totalTrainers),subtitle:"Total instructors",icon:be,gradient:"from-blue-500 to-cyan-600",bgGradient:"from-blue-50 to-cyan-50",borderColor:"border-blue-200",change:"+5.2%",changeType:"positive",details:[{label:"Avg Sessions/Trainer",value:(a.totalSessions/a.totalTrainers).toFixed(1)},{label:"Avg Revenue/Trainer",value:U(a.avgRevenue)}]},{title:"Total Sessions",value:B(a.totalSessions),subtitle:"Classes conducted",icon:xe,gradient:"from-green-500 to-emerald-600",bgGradient:"from-green-50 to-emerald-50",borderColor:"border-green-200",change:"+12.8%",changeType:"positive",details:[{label:"Utilization Rate",value:`${a.utilizationRate.toFixed(1)}%`},{label:"Avg Class Size",value:a.avgClassSize.toFixed(1)}]},{title:"Total Revenue",value:U(a.totalRevenue),subtitle:"Generated income",icon:ge,gradient:"from-purple-500 to-violet-600",bgGradient:"from-purple-50 to-violet-50",borderColor:"border-purple-200",change:"+8.7%",changeType:"positive",details:[{label:"Revenue/Session",value:U(a.avgRevenuePerSession)},{label:"Revenue/Customer",value:U(a.totalRevenue/a.totalCustomers)}]},{title:"Total Members",value:B(a.totalCustomers),subtitle:"Class attendees",icon:fe,gradient:"from-orange-500 to-red-500",bgGradient:"from-orange-50 to-red-50",borderColor:"border-orange-200",change:"+15.3%",changeType:"positive",details:[{label:"Members/Session",value:a.avgClassSize.toFixed(1)},{label:"Total Unique",value:B(a.totalCustomers)}]},{title:"Efficiency Score",value:`${a.utilizationRate.toFixed(1)}%`,subtitle:"Session utilization",icon:os,gradient:"from-indigo-500 to-purple-600",bgGradient:"from-indigo-50 to-purple-50",borderColor:"border-indigo-200",change:"+3.2%",changeType:"positive",details:[{label:"Fill Rate",value:`${a.utilizationRate.toFixed(1)}%`},{label:"Performance",value:"Excellent"}]},{title:"Conversion Rate",value:`${a.avgConversionRate.toFixed(1)}%`,subtitle:"Member conversion",icon:te,gradient:"from-teal-500 to-green-600",bgGradient:"from-teal-50 to-green-50",borderColor:"border-teal-200",change:"+2.1%",changeType:"positive",details:[{label:"Retention Rate",value:`${a.avgRetentionRate.toFixed(1)}%`},{label:"Performance",value:"Strong"}]},{title:"Revenue / Session",value:U(a.avgRevenuePerSession),subtitle:"Average per class",icon:_e,gradient:"from-fuchsia-500 to-pink-600",bgGradient:"from-fuchsia-50 to-pink-50",borderColor:"border-fuchsia-200",change:"+1.2%",changeType:"positive",details:[{label:"Total Revenue",value:U(a.totalRevenue)},{label:"Total Sessions",value:B(a.totalSessions)}]},{title:"Retention Rate",value:`${a.avgRetentionRate.toFixed(1)}%`,subtitle:"Weighted across months",icon:$e,gradient:"from-sky-500 to-blue-600",bgGradient:"from-sky-50 to-blue-50",borderColor:"border-sky-200",change:"+0.8%",changeType:"positive",details:[{label:"Conversion Rate",value:`${a.avgConversionRate.toFixed(1)}%`},{label:"Utilization",value:`${a.utilizationRate.toFixed(1)}%`}]}],m=X.useMemo(()=>{if(!n.length)return[];const w=new Map;return n.forEach(x=>{const f=w.get(x.trainerName)||0;w.set(x.trainerName,f+x.totalPaid)}),Array.from(w.entries()).sort((x,f)=>f[1]-x[1]).slice(0,3).map(([x])=>x)},[n]);return e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:o.slice(0,8).map((w,x)=>{const f=w.icon,h=w.changeType==="positive";return e.jsx(V,{onClick:()=>i?.(w.title,{...a,metric:w.title}),className:Q("group relative overflow-hidden cursor-pointer transition-all duration-700","bg-white hover:bg-gradient-to-br hover:from-gray-900 hover:via-slate-900 hover:to-slate-900",x%4===0&&"border-t-4 border-blue-700 hover:border-blue-700 shadow-lg",x%4===1&&"border-t-4 border-green-700 hover:border-green-700 shadow-lg",x%4===2&&"border-t-4 border-purple-700 hover:border-purple-700 shadow-lg",x%4===3&&"border-t-4 border-amber-700 hover:border-amber-700 shadow-lg","hover:shadow-2xl hover:shadow-slate-900/30","hover:-translate-y-2 hover:scale-[1.02]"),children:e.jsxs(q,{className:"p-6 relative",children:[e.jsx("div",{className:"absolute top-4 right-4 opacity-10 group-hover:opacity-20 transition-all duration-700",children:e.jsx(f,{className:Q("w-12 h-12 transition-all duration-700",x%4===0&&"text-blue-700",x%4===1&&"text-green-700",x%4===2&&"text-purple-700",x%4===3&&"text-amber-700","group-hover:text-white/40")})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:Q("p-4 rounded-2xl transition-all duration-700 border-1 shadow-md",x%4===0&&"bg-gradient-to-br from-blue-700 to-blue-600 border-blue-900 text-white shadow-blue-200",x%4===1&&"bg-gradient-to-br from-green-700 to-green-600 border-green-900 text-white shadow-green-200",x%4===2&&"bg-gradient-to-br from-purple-700 to-purple-600 border-purple-900 text-white shadow-purple-200",x%4===3&&"bg-gradient-to-br from-amber-700 to-amber-600 border-amber-900 text-white shadow-amber-200","group-hover:bg-white/20 group-hover:border-white/40 group-hover:text-white group-hover:shadow-white/20"),children:e.jsx(f,{className:"w-6 h-6 drop-shadow-sm"})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("h3",{className:"font-semibold text-lg text-slate-900 group-hover:text-white/95 transition-colors duration-700",children:w.title})})]}),e.jsxs("div",{className:Q("flex items-center space-x-1 px-3 py-1 rounded-full text-xs font-semibold transition-all duration-700",h?"bg-green-50 text-green-700 group-hover:bg-green-400/30 group-hover:text-green-100":"bg-red-50 text-red-700 group-hover:bg-red-400/30 group-hover:text-red-100"),children:[h?e.jsx(te,{className:"w-3 h-3"}):e.jsx(ve,{className:"w-3 h-3"}),e.jsx("span",{children:w.change})]})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("p",{className:Q("text-4xl font-bold transition-all duration-700 text-slate-900 group-hover:text-white"),children:w.value}),e.jsx("p",{className:Q("text-xs text-slate-500 group-hover:text-slate-200 transition-colors"),children:w.subtitle})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"flex -space-x-2",children:m.slice(0,3).map((s,t)=>e.jsx("div",{className:Q("border-2 border-white group-hover:border-slate-800 transition-all duration-500","hover:z-10 hover:scale-110"),children:e.jsx(qe,{name:s,className:"w-8 h-8 text-xs",showName:!1})},s))}),e.jsxs("span",{className:"text-xs text-slate-600 group-hover:text-slate-300 transition-colors",children:["Top ",m.length," Trainers"]})]})]}),e.jsx("div",{className:Q("mt-4 p-3 border-t border-l-4 transition-all duration-700","bg-slate-50 group-hover:bg-slate-800/50 border-t-slate-200 group-hover:border-t-white/10",x%4===0&&"border-l-blue-700",x%4===1&&"border-l-green-700",x%4===2&&"border-l-purple-700",x%4===3&&"border-l-amber-700"),children:e.jsx("div",{className:"space-y-1.5",children:w.details.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-slate-600 group-hover:text-slate-300 transition-colors duration-700",children:s.label}),e.jsx("span",{className:"font-semibold text-slate-900 group-hover:text-white transition-colors duration-700",children:s.value})]},t))})})]})},w.title)})})},fa=()=>{const{data:n,isLoading:i,error:a}=Os(),{data:o}=Qs();Zs();const[m,w]=L.useState("month-on-month"),[x,f]=L.useState(null),[h,s]=L.useState(null),[t,u]=L.useState(null),[p,k]=L.useState(!0),[T,b]=L.useState("Kwality House, Kemps Corner"),[C,g]=L.useState(!0),[c,M]=L.useState({location:"",trainer:"",month:"",searchTerm:"",performanceLevel:"",classType:"",minSessions:null,maxSessions:null,minRevenue:null,maxRevenue:null}),A=L.useMemo(()=>!n||n.length===0?[]:xa(n),[n]),j=L.useMemo(()=>{let r=[...A];if(T!=="All Locations"&&(r.length,r=r.filter(d=>(d.location||"")===T)),c.trainer&&(r=r.filter(d=>d.trainerName===c.trainer)),c.month&&(r=r.filter(d=>d.monthYear===c.month)),c.searchTerm){const d=c.searchTerm.toLowerCase();r=r.filter(P=>P.trainerName.toLowerCase().includes(d)||(P.location||"").toLowerCase().includes(d))}if(c.minSessions!==null&&(r=r.filter(d=>d.totalSessions>=c.minSessions)),c.maxSessions!==null&&(r=r.filter(d=>d.totalSessions<=c.maxSessions)),c.minRevenue!==null&&(r=r.filter(d=>d.totalPaid>=c.minRevenue)),c.maxRevenue!==null&&(r=r.filter(d=>d.totalPaid<=c.maxRevenue)),c.performanceLevel){const P=[...r].sort((N,z)=>z.totalPaid-N.totalPaid),R=P.length,$=Math.ceil(R*.25),v=Math.ceil(R*.25);if(c.performanceLevel==="high"){const N=P.slice(0,$);r=r.filter(z=>N.some(D=>D.trainerName===z.trainerName&&D.monthYear===z.monthYear))}else if(c.performanceLevel==="low"){const N=P.slice(R-v);r=r.filter(z=>N.some(D=>D.trainerName===z.trainerName&&D.monthYear===z.monthYear))}else if(c.performanceLevel==="medium"){const N=P.slice($,R-v);r=r.filter(z=>N.some(D=>D.trainerName===z.trainerName&&D.monthYear===z.monthYear))}}return c.classType&&(c.classType==="cycle"?r=r.filter(d=>d.cycleSessions>d.barreSessions&&d.cycleSessions>(d.strengthSessions||0)):c.classType==="barre"?r=r.filter(d=>d.barreSessions>d.cycleSessions&&d.barreSessions>(d.strengthSessions||0)):c.classType==="strength"&&(r=r.filter(d=>(d.strengthSessions||0)>d.cycleSessions&&(d.strengthSessions||0)>d.barreSessions))),r},[A,c,T]),O=L.useMemo(()=>{let r=[...A];if(T!=="All Locations"&&(r=r.filter(d=>(d.location||"")===T)),c.trainer&&(r=r.filter(d=>d.trainerName===c.trainer)),c.searchTerm){const d=c.searchTerm.toLowerCase();r=r.filter(P=>P.trainerName.toLowerCase().includes(d)||(P.location||"").toLowerCase().includes(d))}if(c.minSessions!==null&&(r=r.filter(d=>d.totalSessions>=c.minSessions)),c.maxSessions!==null&&(r=r.filter(d=>d.totalSessions<=c.maxSessions)),c.minRevenue!==null&&(r=r.filter(d=>d.totalPaid>=c.minRevenue)),c.maxRevenue!==null&&(r=r.filter(d=>d.totalPaid<=c.maxRevenue)),c.performanceLevel){const P=[...r].sort((N,z)=>z.totalPaid-N.totalPaid),R=P.length,$=Math.ceil(R*.25),v=Math.ceil(R*.25);if(c.performanceLevel==="high"){const N=P.slice(0,$);r=r.filter(z=>N.some(D=>D.trainerName===z.trainerName&&D.monthYear===z.monthYear))}else if(c.performanceLevel==="low"){const N=P.slice(R-v);r=r.filter(z=>N.some(D=>D.trainerName===z.trainerName&&D.monthYear===z.monthYear))}else if(c.performanceLevel==="medium"){const N=P.slice($,R-v);r=r.filter(z=>N.some(D=>D.trainerName===z.trainerName&&D.monthYear===z.monthYear))}}return c.classType&&(c.classType==="cycle"?r=r.filter(d=>d.cycleSessions>d.barreSessions&&d.cycleSessions>(d.strengthSessions||0)):c.classType==="barre"?r=r.filter(d=>d.barreSessions>d.cycleSessions&&d.barreSessions>(d.strengthSessions||0)):c.classType==="strength"&&(r=r.filter(d=>(d.strengthSessions||0)>d.cycleSessions&&(d.strengthSessions||0)>d.barreSessions))),r},[A,c.location,c.trainer,c.searchTerm,c.minSessions,c.maxSessions,c.minRevenue,c.maxRevenue,c.performanceLevel,c.classType,T]),S=(r,d)=>{const P=d?.type||"generic",R=d.location||c.location||T;let $="";P==="trainer-month-cell"?$=d.monthYear||c.month||"":P==="trainer-efficiency"?$=d.monthYear||"":$=c.month||"",f(r),u("overview"),s({...d,trainerName:r,location:R,monthYear:d.monthYear||$,contextFilters:{location:R,month:$},rawPayrollRecords:(n||[]).filter(v=>v.teacherName===r)})},y=()=>{f(null),s(null)};L.useMemo(()=>{if(!j.length)return null;const r=new Set(j.map(N=>N.trainerName)).size,d=j.reduce((N,z)=>N+z.totalSessions,0),P=j.reduce((N,z)=>N+z.totalPaid,0),R=j.reduce((N,z)=>N+z.totalCustomers,0),$=d>0?R/d:0,v=r>0?P/r:0;return{totalTrainers:r,totalSessions:d,totalRevenue:P,totalCustomers:R,avgClassSize:$,avgRevenue:v}},[j]);const[l,Y]=L.useState("revenue"),[E,F]=L.useState(5),G=L.useMemo(()=>{if(!j.length)return[];const r=j.reduce((R,$)=>{const v=$.trainerName;R[v]||(R[v]={name:v,location:$.location,totalRevenue:0,totalSessions:0,totalCustomers:0,nonEmptySessions:0,totalConverted:0,totalNew:0,totalRetained:0,conversionSum:0,retentionSum:0,records:0,emptySessions:0});const N=R[v];return N.totalRevenue+=$.totalPaid||0,N.totalSessions+=$.totalSessions||0,N.totalCustomers+=$.totalCustomers||0,N.nonEmptySessions+=$.nonEmptySessions||0,N.totalConverted+=$.convertedMembers??$.converted??0,N.totalNew+=$.newMembers??$.new??0,N.totalRetained+=$.retainedMembers??$.retained??0,N.conversionSum+=$.conversionRate??0,N.retentionSum+=$.retentionRate??0,N.emptySessions+=$.emptySessions??$.totalEmptySessions??0,N.records+=1,R},{}),d=Object.values(r).map(R=>{const $=R.totalSessions>0?R.totalRevenue/R.totalSessions:0,v=R.totalSessions>0?R.nonEmptySessions>0?R.totalCustomers/R.nonEmptySessions:R.totalCustomers/R.totalSessions:0,N=R.records>0?R.conversionSum/R.records:0,z=R.records>0?R.retentionSum/R.records:0;return{...R,efficiency:$,classAvg:v,conversionRate:N,retentionRate:z,newMembers:R.totalNew,convertedMembers:R.totalConverted,retainedMembers:R.totalRetained,fillRate:R.totalSessions>0?R.totalCustomers/(R.totalSessions*20)*100:0}}),P=(R,$)=>{switch(l){case"revenue":return $.totalRevenue-R.totalRevenue;case"sessions":return $.totalSessions-R.totalSessions;case"customers":return $.totalCustomers-R.totalCustomers;case"efficiency":return $.efficiency-R.efficiency;case"classAvg":return $.classAvg-R.classAvg;case"fillRate":return $.fillRate-R.fillRate;case"conversion":return $.conversionRate-R.conversionRate;case"retention":return $.retentionRate-R.retentionRate;case"emptySessions":return $.emptySessions-R.emptySessions;default:return $.totalRevenue-R.totalRevenue}};return d.sort(P)},[j,l]),Z=G.slice(0,E),J=G.slice(-E).reverse(),I=L.useMemo(()=>{if(!j.length)return[];const r=j.reduce((d,P)=>{const R=P.monthYear;return d[R]||(d[R]={month:R,sessions:0,revenue:0,customers:0}),d[R].sessions+=P.totalSessions,d[R].revenue+=P.totalPaid,d[R].customers+=P.totalCustomers,d},{});return Object.values(r).sort((d,P)=>d.month.localeCompare(P.month))},[j]);return L.useEffect(()=>{if(!i&&n&&n.length>0&&j.length>0){const r=setTimeout(()=>{g(!1)},100);return()=>clearTimeout(r)}else!i&&(!n||n.length===0)&&g(!1)},[i,n,j]),i||C?null:a?e.jsx(V,{className:"bg-gradient-to-br from-red-50 to-red-100 border-red-200 shadow-xl",children:e.jsx(q,{className:"p-6",children:e.jsxs("div",{className:"flex items-center space-x-2 text-red-700",children:[e.jsx(Pe,{className:"w-5 h-5"}),e.jsxs("span",{children:["Error loading trainer data: ",a]})]})})}):j.length?e.jsxs("div",{className:"space-y-6",children:[e.jsx(dt,{activeLocation:T==="All Locations"?"all":T.toLowerCase().includes("kwality")?"kwality":T.toLowerCase().includes("supreme")?"supreme":T.toLowerCase().includes("kenkere")?"kenkere":"all",onLocationChange:r=>{const P={all:"All Locations",kwality:"Kwality House, Kemps Corner",supreme:"Supreme HQ, Bandra",kenkere:"Kenkere House"}[r]||"All Locations";b(P),M(R=>({...R,location:""}))},showInfoPopover:!0,infoPopoverContext:"trainer-performance-overview"}),e.jsx("div",{className:"glass-card modern-card-hover p-6 rounded-2xl mb-6",id:"filters",children:e.jsx(ga,{data:A.map(r=>({teacherName:r.trainerName,location:r.location,monthYear:r.monthYear,totalSessions:r.totalSessions,totalPaid:r.totalPaid}))||[],onFiltersChange:M,isCollapsed:p,onToggleCollapse:()=>k(!p)})}),e.jsx("div",{className:"glass-card modern-card-hover rounded-2xl p-6 soft-bounce stagger-2",id:"metrics",children:e.jsx(va,{data:j,onCardClick:(r,d)=>{const P=r,R=d.location||c.location||T,$=c.month||"";f(P),u(r),s({...d,trainerName:P,location:R,monthYear:$,type:"metric-card",contextFilters:{location:R,month:$}})}})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(V,{className:"group relative bg-gradient-to-br from-white via-blue-50/30 to-white border-0 shadow-xl hover:shadow-2xl transition-all duration-500 overflow-hidden",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-blue-600/20 to-cyan-600/20 opacity-0 group-hover:opacity-100 blur-xl transition-opacity duration-500 -z-10"}),e.jsx(ae,{children:e.jsxs(re,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg text-white shadow-lg group-hover:scale-110 transition-transform duration-300",children:e.jsx(te,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-blue-800 bg-clip-text text-transparent",children:"Monthly Performance Trends"}),e.jsx("div",{className:"text-xs text-slate-500 font-normal",children:"Revenue & session growth over time"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(he,{size:"sm",variant:"outline",className:"bg-white/50 hover:bg-blue-50 border-blue-200",children:e.jsx(ws,{className:"w-4 h-4"})}),e.jsx(he,{size:"sm",variant:"outline",className:"bg-white/50 hover:bg-blue-50 border-blue-200",children:e.jsx(Ss,{className:"w-4 h-4"})}),e.jsx(he,{size:"sm",variant:"outline",className:"bg-white/50 hover:bg-blue-50 border-blue-200",children:e.jsx(Ts,{className:"w-4 h-4"})})]})]})}),e.jsx(q,{children:e.jsx(ke,{width:"100%",height:350,children:e.jsxs(Bs,{data:I,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"revenueGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"sessionsGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]}),e.jsx("filter",{id:"shadow",children:e.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"3",floodOpacity:"0.3"})})]}),e.jsx(Te,{strokeDasharray:"3 3",stroke:"#e2e8f0",strokeOpacity:.5}),e.jsx(Ee,{dataKey:"month",stroke:"#64748b",style:{fontSize:"12px",fontWeight:500},tick:{fill:"#64748b"}}),e.jsx(Ae,{stroke:"#64748b",style:{fontSize:"12px",fontWeight:500},tick:{fill:"#64748b"}}),e.jsx(Me,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.95)",border:"none",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.3)",padding:"12px 16px",backdropFilter:"blur(10px)"},labelStyle:{color:"#f1f5f9",fontWeight:600,marginBottom:"8px"},itemStyle:{color:"#e2e8f0",padding:"4px 0"},cursor:{stroke:"#3B82F6",strokeWidth:2,strokeDasharray:"5 5"}}),e.jsx(ls,{type:"monotone",dataKey:"revenue",stroke:"#3B82F6",strokeWidth:4,name:"Revenue",dot:{fill:"#3B82F6",strokeWidth:2,r:6,stroke:"#fff",filter:"url(#shadow)"},activeDot:{r:8,fill:"#2563EB",stroke:"#fff",strokeWidth:3},fill:"url(#revenueGradient)",animationDuration:1500,animationEasing:"ease-in-out"}),e.jsx(ls,{type:"monotone",dataKey:"sessions",stroke:"#10B981",strokeWidth:3,strokeDasharray:"5 5",name:"Sessions",dot:{fill:"#10B981",strokeWidth:2,r:5,stroke:"#fff",filter:"url(#shadow)"},activeDot:{r:7,fill:"#059669",stroke:"#fff",strokeWidth:3},animationDuration:1500,animationEasing:"ease-in-out"})]})})})]}),e.jsxs(V,{className:"group relative bg-gradient-to-br from-white via-green-50/30 to-white border-0 shadow-xl hover:shadow-2xl transition-all duration-500 overflow-hidden",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-r from-green-600/20 to-purple-600/20 opacity-0 group-hover:opacity-100 blur-xl transition-opacity duration-500 -z-10"}),e.jsx(ae,{children:e.jsxs(re,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-green-600 to-green-700 rounded-lg text-white shadow-lg group-hover:scale-110 transition-transform duration-300",children:e.jsx(xe,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-bold bg-gradient-to-r from-green-600 to-green-800 bg-clip-text text-transparent",children:"Sessions vs Members"}),e.jsx("div",{className:"text-xs text-slate-500 font-normal",children:"Comparative analysis by month"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(he,{size:"sm",variant:"outline",className:"bg-white/50 hover:bg-green-50 border-green-200",children:e.jsx(ws,{className:"w-4 h-4"})}),e.jsx(he,{size:"sm",variant:"outline",className:"bg-white/50 hover:bg-green-50 border-green-200",children:e.jsx(Ss,{className:"w-4 h-4"})}),e.jsx(he,{size:"sm",variant:"outline",className:"bg-white/50 hover:bg-green-50 border-green-200",children:e.jsx(Ts,{className:"w-4 h-4"})})]})]})}),e.jsx(q,{children:e.jsx(ke,{width:"100%",height:350,children:e.jsxs(us,{data:I,margin:{top:20,right:30,left:20,bottom:20},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"sessionsBarGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#10B981",stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:"#059669",stopOpacity:.8})]}),e.jsxs("linearGradient",{id:"customersBarGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:"#8B5CF6",stopOpacity:1}),e.jsx("stop",{offset:"100%",stopColor:"#7C3AED",stopOpacity:.8})]}),e.jsx("filter",{id:"barShadow",children:e.jsx("feDropShadow",{dx:"0",dy:"4",stdDeviation:"4",floodOpacity:"0.4"})})]}),e.jsx(Te,{strokeDasharray:"3 3",stroke:"#e2e8f0",strokeOpacity:.5}),e.jsx(Ee,{dataKey:"month",stroke:"#64748b",style:{fontSize:"12px",fontWeight:500},tick:{fill:"#64748b"}}),e.jsx(Ae,{stroke:"#64748b",style:{fontSize:"12px",fontWeight:500},tick:{fill:"#64748b"}}),e.jsx(Me,{contentStyle:{backgroundColor:"rgba(15, 23, 42, 0.95)",border:"none",borderRadius:"12px",boxShadow:"0 10px 40px rgba(0, 0, 0, 0.3)",padding:"12px 16px",backdropFilter:"blur(10px)"},labelStyle:{color:"#f1f5f9",fontWeight:600,marginBottom:"8px"},itemStyle:{color:"#e2e8f0",padding:"4px 0"},cursor:{fill:"rgba(148, 163, 184, 0.1)"}}),e.jsx(Ge,{dataKey:"sessions",fill:"url(#sessionsBarGradient)",name:"Sessions",radius:[8,8,0,0],filter:"url(#barShadow)",animationDuration:1200,animationEasing:"ease-out"}),e.jsx(Ge,{dataKey:"customers",fill:"url(#customersBarGradient)",name:"Members",radius:[8,8,0,0],filter:"url(#barShadow)",animationDuration:1200,animationEasing:"ease-out"})]})})})]})]}),e.jsxs(V,{className:"bg-gradient-to-br from-white via-slate-50/20 to-white border-0 shadow-xl",children:[e.jsx(ae,{className:"pb-3",children:e.jsx(re,{className:"text-2xl font-bold bg-gradient-to-r from-slate-700 via-slate-800 to-slate-900 bg-clip-text text-transparent",children:"Trainer Top & Bottom Performers"})}),e.jsxs(q,{children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-6",children:[e.jsx("div",{className:"flex flex-wrap bg-slate-50 border border-slate-200 rounded-lg p-1 gap-1",children:[{key:"revenue",label:"Revenue",icon:ge},{key:"sessions",label:"Sessions",icon:xe},{key:"customers",label:"Members",icon:be},{key:"efficiency",label:"Rev/Session",icon:ge},{key:"classAvg",label:"Class Avg",icon:be},{key:"fillRate",label:"Fill Rate",icon:fe},{key:"conversion",label:"Conversion",icon:te},{key:"retention",label:"Retention",icon:fe},{key:"emptySessions",label:"Empty",icon:xe}].map(({key:r,label:d,icon:P})=>e.jsxs(he,{size:"sm",variant:l===r?"default":"ghost",className:l===r?"bg-black text-white":"text-slate-700 hover:bg-slate-100",onClick:()=>Y(r),children:[e.jsx(P,{className:"w-3 h-3 mr-1"})," ",d]},r))}),e.jsx("div",{className:"flex bg-slate-50 border border-slate-200 rounded-lg p-1",children:[5,10,15].map(r=>e.jsx(he,{size:"sm",variant:E===r?"default":"ghost",className:E===r?"bg-purple-800 text-white":"text-slate-700 hover:bg-slate-100",onClick:()=>F(r),children:r},r))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(V,{className:"bg-gradient-to-br from-white via-slate-50/50 to-white border-0 shadow-xl hover:shadow-2xl transition-all duration-500 flex flex-col",children:[e.jsx(ae,{className:"pb-4",children:e.jsxs(re,{className:"flex items-center gap-3 text-xl",children:[e.jsx("div",{className:"p-2 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500",children:e.jsx($e,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("span",{className:"bg-gradient-to-r from-yellow-600 to-orange-600 bg-clip-text text-transparent",children:"Top Trainers"}),e.jsxs("p",{className:"text-sm text-slate-600 font-normal capitalize",children:["By ",l==="efficiency"?"Revenue/Session":l==="classAvg"?"Class Average":l==="conversion"?"Conversion Rate":l]})]})]})}),e.jsx(q,{className:"space-y-4 flex-1",children:Z.map((r,d)=>e.jsxs("div",{className:"group flex items-center justify-between p-4 rounded-xl bg-white shadow-sm border hover:shadow-md transition-all duration-300 cursor-pointer hover:border-emerald-200/70 min-h-[88px]",onClick:()=>S(r.name,{...r,type:"ranking-item"}),children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsxs("div",{className:"relative w-16 h-16 flex-shrink-0",children:[e.jsx("div",{className:"w-full h-full rounded-full overflow-hidden border-4 shadow-lg",style:{borderColor:d===0?"#f59e0b":d===1?"#9ca3af":d===2?"#d97706":"#3b82f6"},children:e.jsx("img",{src:hs(r.name),alt:r.name,className:"w-full h-full object-cover",onError:P=>{const R=P.target;R.style.display="none";const $=r.name.split(" ").map(v=>v[0]).join("");R.parentElement.innerHTML=`<div class="w-full h-full bg-gradient-to-br ${d===0?"from-yellow-400 to-orange-500":d===1?"from-gray-300 to-gray-500":d===2?"from-amber-400 to-amber-600":"from-blue-500 to-blue-700"} flex items-center justify-center text-white text-lg font-bold">${$}</div>`}})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-7 h-7 rounded-full flex items-center justify-center shadow-md text-white text-xs font-bold border-2 border-white "+(d===0?"bg-gradient-to-br from-yellow-400 via-amber-500 to-orange-500":d===1?"bg-gradient-to-br from-gray-300 via-gray-400 to-gray-500":d===2?"bg-gradient-to-br from-amber-400 via-amber-500 to-amber-600":"bg-gradient-to-br from-blue-500 via-blue-600 to-blue-700"),children:d===0?e.jsx(Mt,{className:"w-4 h-4"}):d===1?e.jsx(At,{className:"w-4 h-4"}):d===2?e.jsx(Pt,{className:"w-3 h-3"}):e.jsx("span",{children:d+1})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold text-slate-900 truncate group-hover:text-blue-600 transition-colors",title:r.name,children:r.name}),e.jsxs("div",{className:"flex gap-2 mt-2 overflow-x-auto no-scrollbar",children:[e.jsx(se,{variant:"secondary",className:"text-xs bg-blue-50 text-blue-700 border-blue-200 whitespace-nowrap",children:l==="conversion"?`${B(r.totalNew||0)} new`:`${B(r.totalSessions)} sessions`}),e.jsx(se,{variant:"outline",className:"text-xs border-green-200 text-green-700 whitespace-nowrap",children:l==="conversion"?`${B(r.totalConverted||0)} converted`:l==="fillRate"?`${(r.fillRate??0).toFixed(1)}% fill`:`Avg: ${(r.nonEmptySessions>0?r.totalCustomers/r.nonEmptySessions:r.totalSessions>0?r.totalCustomers/r.totalSessions:0).toFixed(1)}`}),e.jsx(se,{variant:"outline",className:"text-xs border-purple-200 text-purple-700 whitespace-nowrap",children:l==="conversion"?`${B(r.totalRetained||0)} retained`:l==="fillRate"?`${(r.nonEmptySessions/Math.max(r.totalSessions,1)*100).toFixed(1)}% utilization`:`${B(r.totalCustomers)} members`})]})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0 ml-4",children:[e.jsx("p",{className:"font-bold text-xl text-slate-900 group-hover:text-blue-600 transition-colors whitespace-nowrap",children:l==="revenue"?Qe(r.totalRevenue):l==="sessions"?B(r.totalSessions):l==="customers"?B(r.totalCustomers):l==="efficiency"?Qe(r.efficiency):l==="classAvg"?r.classAvg.toFixed(1):l==="fillRate"?`${(r.fillRate??0).toFixed(1)}%`:l==="conversion"?`${r.conversionRate.toFixed(1)}%`:l==="retention"?`${r.retentionRate.toFixed(1)}%`:B(r.emptySessions)}),e.jsx("p",{className:"text-sm text-slate-500 truncate",title:r.location,children:l==="conversion"?`${r.totalConverted||0}/${r.totalNew||0} converted`:r.location})]})]},r.name))})]}),e.jsxs(V,{className:"bg-gradient-to-br from-white via-slate-50/50 to-white border-0 shadow-xl hover:shadow-2xl transition-all duration-500 flex flex-col",children:[e.jsx(ae,{className:"pb-4",children:e.jsxs(re,{className:"flex items-center gap-3 text-xl",children:[e.jsx("div",{className:"p-2 rounded-full bg-gradient-to-r from-red-500 to-rose-600",children:e.jsx(ve,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("span",{className:"bg-gradient-to-r from-red-600 to-rose-600 bg-clip-text text-transparent",children:"Bottom Trainers"}),e.jsxs("p",{className:"text-sm text-slate-600 font-normal capitalize",children:["By ",l==="efficiency"?"Revenue/Session":l==="classAvg"?"Class Average":l==="conversion"?"Conversion Rate":l]})]})]})}),e.jsx(q,{className:"space-y-4 flex-1",children:J.map((r,d)=>e.jsxs("div",{className:"group flex items-center justify-between p-4 rounded-xl bg-white shadow-sm border hover:shadow-md transition-all duration-300 cursor-pointer hover:border-rose-200/70 min-h-[88px]",onClick:()=>S(r.name,{...r,type:"ranking-item"}),children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsxs("div",{className:"relative w-14 h-14 flex-shrink-0",children:[e.jsx("div",{className:"w-full h-full rounded-full overflow-hidden border-4 border-red-500 shadow-lg",children:e.jsx("img",{src:hs(r.name),alt:r.name,className:"w-full h-full object-cover",onError:P=>{const R=P.target;R.style.display="none";const $=r.name.split(" ").map(v=>v[0]).join("");R.parentElement.innerHTML=`<div class="w-full h-full bg-gradient-to-br from-slate-500 to-slate-600 flex items-center justify-center text-white text-sm font-bold">${$}</div>`}})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 rounded-full bg-gradient-to-br from-red-500 via-rose-600 to-red-700 flex items-center justify-center shadow-md text-white text-xs font-bold border-2 border-white",children:e.jsx("span",{children:d+1})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold text-slate-900 truncate group-hover:text-blue-600 transition-colors",title:r.name,children:r.name}),e.jsxs("div",{className:"flex gap-2 mt-2 overflow-x-auto no-scrollbar",children:[e.jsx(se,{variant:"secondary",className:"text-xs bg-blue-50 text-blue-700 border-blue-200 whitespace-nowrap",children:l==="conversion"?`${B(r.totalNew||0)} new`:`${B(r.totalSessions)} sessions`}),e.jsx(se,{variant:"outline",className:"text-xs border-green-200 text-green-700 whitespace-nowrap",children:l==="conversion"?`${B(r.totalConverted||0)} converted`:l==="fillRate"?`${(r.fillRate??0).toFixed(1)}% fill`:`Avg: ${(r.nonEmptySessions>0?r.totalCustomers/r.nonEmptySessions:r.totalSessions>0?r.totalCustomers/r.totalSessions:0).toFixed(1)}`}),e.jsx(se,{variant:"outline",className:"text-xs border-purple-200 text-purple-700 whitespace-nowrap",children:l==="conversion"?`${B(r.totalRetained||0)} retained`:l==="fillRate"?`${(r.nonEmptySessions/Math.max(r.totalSessions,1)*100).toFixed(1)}% utilization`:`${B(r.totalCustomers)} members`})]})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0 ml-4",children:[e.jsx("p",{className:"font-bold text-xl text-slate-900 group-hover:text-blue-600 transition-colors whitespace-nowrap",children:l==="revenue"?Qe(r.totalRevenue):l==="sessions"?B(r.totalSessions):l==="customers"?B(r.totalCustomers):l==="efficiency"?Qe(r.efficiency):l==="classAvg"?r.classAvg.toFixed(1):l==="fillRate"?`${(r.fillRate??0).toFixed(1)}%`:l==="conversion"?`${r.conversionRate.toFixed(1)}%`:l==="retention"?`${r.retentionRate.toFixed(1)}%`:B(r.emptySessions)}),e.jsx("p",{className:"text-sm text-slate-500 truncate",title:r.location,children:l==="conversion"?`${r.totalConverted||0}/${r.totalNew||0} converted`:r.location})]})]},r.name))})]})]})]})]}),e.jsxs(vs,{value:m,onValueChange:w,className:"space-y-4",children:[e.jsxs(fs,{className:"grid w-full grid-cols-4 bg-white border border-gray-200 p-1 rounded-xl shadow-sm h-14",children:[e.jsxs(oe,{value:"month-on-month",className:"flex items-center gap-2 px-3 py-2 rounded-lg font-semibold text-xs transition-all duration-200 data-[state=active]:bg-black data-[state=active]:text-white data-[state=active]:shadow-md hover:bg-gray-50 data-[state=active]:hover:bg-gray-800",children:[e.jsx(ns,{className:"w-4 h-4"}),"Month-on-Month"]}),e.jsxs(oe,{value:"year-on-year",className:"flex items-center gap-2 px-3 py-2 rounded-lg font-semibold text-xs transition-all duration-200 data-[state=active]:bg-emerald-600 data-[state=active]:text-white data-[state=active]:shadow-md hover:bg-gray-50 data-[state=active]:hover:bg-emerald-700",children:[e.jsx(te,{className:"w-4 h-4"}),"Year-on-Year"]}),e.jsxs(oe,{value:"efficiency-analysis",className:"flex items-center gap-2 px-3 py-2 rounded-lg font-semibold text-xs transition-all duration-200 data-[state=active]:bg-orange-600 data-[state=active]:text-white data-[state=active]:shadow-md hover:bg-gray-50 data-[state=active]:hover:bg-orange-700",children:[e.jsx(fe,{className:"w-4 h-4"}),"Efficiency"]}),e.jsxs(oe,{value:"performance-detail",className:"flex items-center gap-2 px-3 py-2 rounded-lg font-semibold text-xs transition-all duration-200 data-[state=active]:bg-purple-800 data-[state=active]:text-white data-[state=active]:shadow-md hover:bg-gray-50 data-[state=active]:hover:bg-purple-900",children:[e.jsx($e,{className:"w-4 h-4"}),"Performance"]})]}),e.jsxs(ye,{value:"month-on-month",className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(ss,{payrollData:O.map(r=>({teacherName:r.trainerName,location:r.location,monthYear:r.monthYear,totalSessions:r.totalSessions,totalPaid:r.totalPaid,totalCustomers:r.totalCustomers}))||[],defaultFileName:"month-on-month-trainer-analysis",size:"sm",variant:"outline"})}),e.jsxs("div",{className:"flex items-center gap-2 -mt-2 flex-wrap",children:[e.jsx(se,{variant:"outline",className:"text-xs text-amber-700 border-amber-200 bg-amber-50",children:"Ignoring Month Filter"}),e.jsx("button",{onClick:()=>M(r=>({...r,location:""})),className:"rounded",children:e.jsxs(se,{variant:"outline",className:"text-xs text-slate-700 border-slate-200 bg-slate-50 hover:bg-slate-100",children:["Location: ",c.location||T||"All Locations"]})}),e.jsx("button",{onClick:()=>M(r=>({...r,trainer:""})),className:"rounded",children:e.jsxs(se,{variant:"outline",className:"text-xs text-slate-700 border-slate-200 bg-slate-50 hover:bg-slate-100",children:["Trainer: ",c.trainer||"All Trainers"]})})]}),e.jsx(ua,{data:O,defaultMetric:"totalSessions",onRowClick:S})]}),e.jsxs(ye,{value:"year-on-year",className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(ss,{payrollData:O.map(r=>({teacherName:r.trainerName,location:r.location,monthYear:r.monthYear,totalSessions:r.totalSessions,totalPaid:r.totalPaid,totalCustomers:r.totalCustomers}))||[],defaultFileName:"year-on-year-trainer-analysis",size:"sm",variant:"outline"})}),e.jsxs("div",{className:"flex items-center gap-2 -mt-2 flex-wrap",children:[e.jsx(se,{variant:"outline",className:"text-xs text-amber-700 border-amber-200 bg-amber-50",children:"Ignoring Month Filter"}),e.jsx("button",{onClick:()=>M(r=>({...r,location:""})),className:"rounded",children:e.jsxs(se,{variant:"outline",className:"text-xs text-slate-700 border-slate-200 bg-slate-50 hover:bg-slate-100",children:["Location: ",c.location||T||"All Locations"]})}),e.jsx("button",{onClick:()=>M(r=>({...r,trainer:""})),className:"rounded",children:e.jsxs(se,{variant:"outline",className:"text-xs text-slate-700 border-slate-200 bg-slate-50 hover:bg-slate-100",children:["Trainer: ",c.trainer||"All Trainers"]})})]}),e.jsx(ca,{data:O,onRowClick:S})]}),e.jsxs(ye,{value:"efficiency-analysis",className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(ss,{payrollData:O.map(r=>({teacherName:r.trainerName,location:r.location,monthYear:r.monthYear,totalSessions:r.totalSessions,totalPaid:r.totalPaid,totalCustomers:r.totalCustomers}))||[],defaultFileName:"trainer-efficiency-analysis",size:"sm",variant:"outline"})}),e.jsx(ma,{data:O,onRowClick:S})]}),e.jsxs(ye,{value:"performance-detail",className:"space-y-6",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(ss,{payrollData:j.map(r=>({teacherName:r.trainerName,location:r.location,monthYear:r.monthYear,totalSessions:r.totalSessions,totalPaid:r.totalPaid,totalCustomers:r.totalCustomers}))||[],defaultFileName:"trainer-performance-detail",size:"sm",variant:"outline"})}),e.jsx(da,{data:j,onRowClick:S})]})]}),x&&h&&e.jsx(pa,{isOpen:!!h,onClose:y,trainerName:x,trainerData:h,allPayrollData:O.map(r=>({teacherName:r.trainerName,location:r.location,monthYear:r.monthYear,totalSessions:r.totalSessions,totalPaid:r.totalPaid,totalCustomers:r.totalCustomers}))||[],allSessionsData:o||[],filters:h.contextFilters||{location:T,month:c.month||""}})]}):e.jsx(V,{className:"bg-gradient-to-br from-white via-slate-50/30 to-white border-0 shadow-xl",children:e.jsx(q,{className:"p-6",children:e.jsxs("p",{className:"text-center text-slate-600",children:["No trainer performance data available for: ",T]})})})},br=()=>{const{data:n,isLoading:i}=Os(),{isLoading:a,setLoading:o}=Js(),[m,w]=L.useState(!1);L.useEffect(()=>{o(i||!m,"Analyzing trainer performance metrics and insights...")},[i,m,o]),L.useEffect(()=>{if(!i&&n&&n.length>0){const f=setTimeout(()=>{w(!0)},150);return()=>clearTimeout(f)}else!i&&(!n||n.length===0)&&w(!0)},[i,n]);const x=L.useMemo(()=>!n||n.length===0?[]:[{key:"Kwality House, Kemps Corner",name:"Kwality"},{key:"Supreme HQ, Bandra",name:"Supreme"},{key:"Kenkere House",name:"Kenkere"}].map(h=>{const s=n.filter(k=>h.key==="Kenkere House"?k.location?.includes("Kenkere")||k.location==="Kenkere House":k.location===h.key),t=new Set(s.map(k=>k.teacherName)).size;s.reduce((k,T)=>k+(T.totalSessions||0),0);const u=s.reduce((k,T)=>k+(T.totalPaid||0),0),p=t>0?u/t:0;return{location:h.name,label:`${t} Trainers`,value:U(p),subtitle:`Avg ${(p/1e3).toFixed(0)}K/trainer`}}),[n]);return a?null:e.jsxs("div",{className:"min-h-screen bg-white relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute top-20 left-10 w-96 h-96 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-full floating-animation stagger-1"}),e.jsx("div",{className:"absolute bottom-20 right-10 w-80 h-80 bg-gradient-to-r from-purple-500/10 to-pink-500/10 rounded-full floating-animation stagger-3"}),e.jsx("div",{className:"absolute top-1/2 left-1/3 w-72 h-72 bg-gradient-to-r from-cyan-500/10 to-teal-500/10 rounded-full morph-shape stagger-2"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"bg-white text-slate-800 slide-in-from-left",children:e.jsx(Et,{title:"Trainer Performance Analytics",subtitle:"Comprehensive trainer performance metrics, insights, and development opportunities",metrics:x,onExportClick:()=>{}})}),e.jsx("div",{className:"container mx-auto px-6 py-8 bg-white min-h-screen",children:e.jsx("main",{className:"space-y-8 slide-in-from-right stagger-1",children:e.jsx(fa,{})})}),e.jsx(Tt,{})]})]})};export{br as default};
//# sourceMappingURL=TrainerPerformance-Cju_lXVc.js.map
