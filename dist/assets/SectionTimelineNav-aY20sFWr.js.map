{"version":3,"file":"SectionTimelineNav-aY20sFWr.js","sources":["../../node_modules/lucide-react/dist/esm/icons/navigation.js","../../src/components/ui/SectionTimelineNav.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.462.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Navigation = createLucideIcon(\"Navigation\", [\n  [\"polygon\", { points: \"3 11 22 2 13 21 11 13 3 11\", key: \"1ltx0t\" }]\n]);\n\nexport { Navigation as default };\n//# sourceMappingURL=navigation.js.map\n","import * as React from \"react\";\nimport { cn } from \"@/lib/utils\";\nimport { useSectionNavigation } from \"@/contexts/SectionNavigationContext\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { ListTree, Navigation } from \"lucide-react\";\nimport { useTheme } from \"next-themes\";\n\ntype SectionTimelineNavProps = {\n  title?: string;\n  position?: \"left\" | \"right\";\n  className?: string;\n  collapseOnMobile?: boolean;\n};\n\nexport function SectionTimelineNav({\n  title = \"On this page\",\n  position = \"right\",\n  className,\n  collapseOnMobile = true,\n}: SectionTimelineNavProps) {\n  const { sections, jumpTo } = useSectionNavigation();\n  const [activeId, setActiveId] = React.useState<string | null>(null);\n  const [adaptiveDark, setAdaptiveDark] = React.useState<boolean | null>(null);\n  const { resolvedTheme } = useTheme();\n  const scrollSpyEnabled = React.useRef(false);\n\n  // Compute background luminance from CSS variable --background (shadcn uses hsl(var(--background)))\n  React.useEffect(() => {\n    const compute = () => {\n      try {\n        const root = getComputedStyle(document.documentElement);\n        const bg = root.getPropertyValue(\"--background\").trim(); // e.g., \"222.2 84% 4.9%\"\n        const parts = bg.split(/\\s+/);\n        if (parts.length >= 3) {\n          const h = parseFloat(parts[0]);\n          const s = parseFloat(parts[1].replace('%',''))/100;\n          const l = parseFloat(parts[2].replace('%',''))/100;\n          // Convert HSL to RGB\n          const c = (1 - Math.abs(2*l - 1)) * s;\n          const x = c * (1 - Math.abs(((h/60) % 2) - 1));\n          const m = l - c/2;\n          let r=0,g=0,b=0;\n          if (0 <= h && h < 60) { r=c; g=x; b=0; }\n          else if (60 <= h && h < 120) { r=x; g=c; b=0; }\n          else if (120 <= h && h < 180) { r=0; g=c; b=x; }\n          else if (180 <= h && h < 240) { r=0; g=x; b=c; }\n          else if (240 <= h && h < 300) { r=x; g=0; b=c; }\n          else { r=c; g=0; b=x; }\n          r = (r + m); g = (g + m); b = (b + m);\n          // relative luminance\n          const srgb = [r,g,b].map(v => {\n            return v <= 0.03928 ? v/12.92 : Math.pow((v+0.055)/1.055, 2.4);\n          });\n          const lum = 0.2126*srgb[0] + 0.7152*srgb[1] + 0.0722*srgb[2];\n          setAdaptiveDark(lum > 0.6);\n        } else {\n          // Fallback: use theme\n          if (resolvedTheme === 'dark') setAdaptiveDark(false);\n          else if (resolvedTheme === 'light') setAdaptiveDark(true);\n          else setAdaptiveDark(!document.documentElement.classList.contains('dark'));\n        }\n      } catch {\n        // Fallback: use theme\n        if (resolvedTheme === 'dark') setAdaptiveDark(false);\n        else if (resolvedTheme === 'light') setAdaptiveDark(true);\n        else setAdaptiveDark(!document.documentElement.classList.contains('dark'));\n      }\n    };\n\n    compute();\n\n    // Observe theme changes via class mutations on documentElement (e.g., 'dark')\n    const obs = new MutationObserver((mutations) => {\n      for (const m of mutations) {\n        if (m.type === 'attributes' && (m.attributeName === 'class' || m.attributeName === 'style')) {\n          compute();\n        }\n      }\n    });\n    obs.observe(document.documentElement, { attributes: true, attributeFilter: ['class','style'] });\n\n    // Also react to system theme changes\n    const media = window.matchMedia('(prefers-color-scheme: dark)');\n    const onMedia = () => compute();\n    try { media.addEventListener('change', onMedia); } catch { /* older safari */ media.addListener(onMedia); }\n\n    return () => {\n      obs.disconnect();\n      try { media.removeEventListener('change', onMedia); } catch { media.removeListener(onMedia); }\n    };\n  }, [resolvedTheme]);\n\n  React.useEffect(() => {\n    if (!sections.length) return;\n\n    const elements: { id: string; el: HTMLElement }[] = sections\n      .map((s) => ({ id: s.id, el: (s.getElement?.() || document.getElementById(s.id)) as HTMLElement | null }))\n      .filter((x): x is { id: string; el: HTMLElement } => !!x.el);\n\n    const onScroll = () => {\n      if (!scrollSpyEnabled.current) return;\n      const viewportTop = 0;\n      const candidates = elements\n        .map(({ id, el }) => ({ id, rect: el.getBoundingClientRect() }))\n        .sort((a, b) => a.rect.top - b.rect.top);\n\n      let current: string | null = candidates[0]?.id ?? null;\n      for (const c of candidates) {\n        if (c.rect.top <= window.innerHeight * 0.3) {\n          current = c.id;\n        } else {\n          break;\n        }\n      }\n      setActiveId(current);\n    };\n\n    // Defer enabling scrollspy to avoid auto-selecting last section on initial layout\n    const enableTimer = setTimeout(() => {\n      scrollSpyEnabled.current = true;\n      onScroll();\n    }, 250);\n    window.addEventListener(\"scroll\", onScroll, { passive: true });\n    window.addEventListener(\"resize\", onScroll);\n    return () => {\n      clearTimeout(enableTimer);\n      window.removeEventListener(\"scroll\", onScroll);\n      window.removeEventListener(\"resize\", onScroll);\n    };\n  }, [sections]);\n\n  if (!sections.length) return null;\n\n  const fixedPos = position === \"right\" ? \"right-3\" : \"left-3\";\n  const visibility = collapseOnMobile ? \"sm:block\" : \"block\"; // show from small screens upward\n\n  return (\n    <nav\n      aria-label=\"Section timeline\"\n      className={cn(\n        visibility,\n        \"group fixed z-20\",\n        fixedPos,\n        \"top-28\",\n        // fixed slim width; no expansion on hover\n        \"w-6\",\n        // don't block interactions unless hovering\n        \"pointer-events-none\",\n        className\n      )}\n    >\n      <div className=\"relative h-auto pointer-events-auto\">\n        <ol className=\"relative ml-3 py-4 pr-2\">\n          {/* ultra-thin vertical line with better contrast */}\n          <div className=\"absolute left-1 top-4 bottom-4 w-px bg-gradient-to-b from-transparent via-foreground/20 to-transparent\" />\n          {sections.map((s) => {\n            const isActive = s.id === activeId;\n            // Adaptive ring colors\n            const ringActive = adaptiveDark === null ? 'ring-blue-500/40' : (adaptiveDark ? 'ring-blue-600/40' : 'ring-blue-400/50');\n            const ringHover = adaptiveDark === null ? 'hover:ring-blue-500/20' : (adaptiveDark ? 'hover:ring-blue-600/20' : 'hover:ring-blue-400/30');\n            // Adaptive dot base and active colors (light on dark, dark/brand on light)\n            const dotBase = adaptiveDark === false ? 'bg-white/80 hover:bg-white' : 'bg-foreground/70 hover:bg-foreground';\n            const dotActive = adaptiveDark === false ? 'bg-white shadow-[0_0_0_2px_rgba(255,255,255,0.25)]' : 'bg-blue-600 shadow-[0_0_0_2px_rgba(37,99,235,0.18)]';\n            return (\n              <li key={s.id} className=\"relative pl-6 py-5\">\n                {/* clickable dot only (small visual dot, larger hit area) */}\n                <button\n                  type=\"button\"\n                  onClick={() => jumpTo(s.id)}\n                  title={s.label}\n                  aria-label={s.label}\n                  aria-current={isActive ? 'location' : undefined}\n                  className={cn(\n                    \"absolute left-[-13px] top-0.5 w-6 h-6 rounded-full transition-transform\",\n                    \"outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-600 focus:ring-offset-background\",\n                    isActive ? cn(\"scale-105 ring-2\", ringActive) : cn(\"hover:ring-1\", ringHover)\n                  )}\n                >\n                  <span\n                    className={cn(\n                      \"block m-auto rounded-full\",\n                      \"w-2.5 h-2.5\",\n                      isActive ? dotActive : dotBase\n                    )}\n                  />\n                </button>\n              </li>\n            );\n          })}\n        </ol>\n      </div>\n      {/* floating quick-access button with popover, non-obstructive */}\n      <div className={cn(\"fixed\", position === \"right\" ? \"right-3\" : \"left-3\", \"bottom-6 z-30\")}\n        style={{ pointerEvents: 'auto' }}\n      >\n        <Popover>\n          <PopoverTrigger asChild>\n            <button\n              type=\"button\"\n              aria-label=\"Open section navigator\"\n              className={cn(\n                \"h-10 w-10 rounded-full transition flex items-center justify-center\",\n                \"shadow-lg hover:shadow-xl focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-background\",\n                adaptiveDark === null \n                  ? \"bg-primary text-primary-foreground ring-1 ring-primary/30 focus-visible:ring-primary\" \n                  : adaptiveDark \n                    ? \"bg-foreground text-background ring-1 ring-foreground/20 focus-visible:ring-foreground\"\n                    : \"bg-background text-foreground ring-1 ring-foreground/20 focus-visible:ring-foreground\"\n              )}\n            >\n              <Navigation className=\"w-5 h-5\" />\n            </button>\n          </PopoverTrigger>\n          <PopoverContent align=\"end\" className=\"w-64 p-2\">\n            <div className=\"text-xs font-semibold text-muted-foreground uppercase tracking-wide p-2\">{title}</div>\n            <ul className=\"max-h-80 overflow-auto\">\n              {sections.map((s) => (\n                <li key={s.id}>\n                  <button\n                    type=\"button\"\n                    className=\"w-full text-left text-sm px-2 py-2 rounded hover:bg-accent\"\n                    onClick={() => jumpTo(s.id)}\n                  >\n                    {s.label}\n                  </button>\n                </li>\n              ))}\n            </ul>\n          </PopoverContent>\n        </Popover>\n      </div>\n    </nav>\n  );\n}\n\nexport default SectionTimelineNav;\n"],"names":["Navigation","createLucideIcon","SectionTimelineNav","title","position","className","collapseOnMobile","sections","jumpTo","useSectionNavigation","activeId","setActiveId","React.useState","adaptiveDark","setAdaptiveDark","resolvedTheme","useTheme","scrollSpyEnabled","React.useRef","React.useEffect","compute","parts","h","s","l","c","x","m","r","g","b","srgb","v","lum","obs","mutations","media","onMedia","elements","onScroll","candidates","id","el","a","current","enableTimer","fixedPos","visibility","jsxs","cn","jsx","isActive","ringActive","ringHover","dotBase","dotActive","Popover","PopoverTrigger","PopoverContent"],"mappings":"kIASA,MAAMA,EAAaC,EAAiB,aAAc,CAChD,CAAC,UAAW,CAAE,OAAQ,6BAA8B,IAAK,QAAQ,CAAE,CACrE,CAAC,ECGM,SAASC,EAAmB,CACjC,MAAAC,EAAQ,eACR,SAAAC,EAAW,QACX,UAAAC,EACA,iBAAAC,EAAmB,EACrB,EAA4B,CAC1B,KAAM,CAAE,SAAAC,EAAU,OAAAC,CAAA,EAAWC,EAAA,EACvB,CAACC,EAAUC,CAAW,EAAIC,EAAAA,SAA8B,IAAI,EAC5D,CAACC,EAAcC,CAAe,EAAIF,EAAAA,SAA+B,IAAI,EACrE,CAAE,cAAAG,CAAA,EAAkBC,EAAA,EACpBC,EAAmBC,EAAAA,OAAa,EAAK,EA2G3C,GAxGAC,EAAAA,UAAgB,IAAM,CACpB,MAAMC,EAAU,IAAM,CACpB,GAAI,CAGF,MAAMC,EAFO,iBAAiB,SAAS,eAAe,EACtC,iBAAiB,cAAc,EAAE,KAAA,EAChC,MAAM,KAAK,EAC5B,GAAIA,EAAM,QAAU,EAAG,CACrB,MAAMC,EAAI,WAAWD,EAAM,CAAC,CAAC,EACvBE,EAAI,WAAWF,EAAM,CAAC,EAAE,QAAQ,IAAI,EAAE,CAAC,EAAE,IACzCG,EAAI,WAAWH,EAAM,CAAC,EAAE,QAAQ,IAAI,EAAE,CAAC,EAAE,IAEzCI,GAAK,EAAI,KAAK,IAAI,EAAED,EAAI,CAAC,GAAKD,EAC9BG,EAAID,GAAK,EAAI,KAAK,IAAMH,EAAE,GAAM,EAAK,CAAC,GACtCK,EAAIH,EAAIC,EAAE,EAChB,IAAIG,EAAE,EAAEC,EAAE,EAAEC,EAAE,EACV,GAAKR,GAAKA,EAAI,IAAMM,EAAEH,EAAGI,EAAEH,EAAGI,EAAE,GAC3B,IAAMR,GAAKA,EAAI,KAAOM,EAAEF,EAAGG,EAAEJ,EAAGK,EAAE,GAClC,KAAOR,GAAKA,EAAI,KAAOM,EAAE,EAAGC,EAAEJ,EAAGK,EAAEJ,GACnC,KAAOJ,GAAKA,EAAI,KAAOM,EAAE,EAAGC,EAAEH,EAAGI,EAAEL,GACnC,KAAOH,GAAKA,EAAI,KAAOM,EAAEF,EAAGG,EAAE,EAAGC,EAAEL,IACrCG,EAAEH,EAAGI,EAAE,EAAGC,EAAEJ,GACnBE,EAAKA,EAAID,EAAIE,EAAKA,EAAIF,EAAIG,EAAKA,EAAIH,EAEnC,MAAMI,EAAO,CAACH,EAAEC,EAAEC,CAAC,EAAE,IAAIE,GAChBA,GAAK,OAAUA,EAAE,MAAQ,KAAK,KAAKA,EAAE,MAAO,MAAO,GAAG,CAC9D,EACKC,EAAM,MAAOF,EAAK,CAAC,EAAI,MAAOA,EAAK,CAAC,EAAI,MAAOA,EAAK,CAAC,EAC3DjB,EAAgBmB,EAAM,EAAG,CAC3B,MAEgCnB,EAA1BC,IAAkB,OAAwB,GACrCA,IAAkB,QAAyB,GAC/B,CAAC,SAAS,gBAAgB,UAAU,SAAS,MAAM,CAFrB,CAIvD,MAAQ,CAEwBD,EAA1BC,IAAkB,OAAwB,GACrCA,IAAkB,QAAyB,GAC/B,CAAC,SAAS,gBAAgB,UAAU,SAAS,MAAM,CAFrB,CAGrD,CACF,EAEAK,EAAA,EAGA,MAAMc,EAAM,IAAI,iBAAkBC,GAAc,CAC9C,UAAWR,KAAKQ,EACVR,EAAE,OAAS,eAAiBA,EAAE,gBAAkB,SAAWA,EAAE,gBAAkB,UACjFP,EAAA,CAGN,CAAC,EACDc,EAAI,QAAQ,SAAS,gBAAiB,CAAE,WAAY,GAAM,gBAAiB,CAAC,QAAQ,OAAO,CAAA,CAAG,EAG9F,MAAME,EAAQ,OAAO,WAAW,8BAA8B,EACxDC,EAAU,IAAMjB,EAAA,EACtB,GAAI,CAAEgB,EAAM,iBAAiB,SAAUC,CAAO,CAAG,MAAQ,CAAqBD,EAAM,YAAYC,CAAO,CAAG,CAE1G,MAAO,IAAM,CACXH,EAAI,WAAA,EACJ,GAAI,CAAEE,EAAM,oBAAoB,SAAUC,CAAO,CAAG,MAAQ,CAAED,EAAM,eAAeC,CAAO,CAAG,CAC/F,CACF,EAAG,CAACtB,CAAa,CAAC,EAElBI,EAAAA,UAAgB,IAAM,CACpB,GAAI,CAACZ,EAAS,OAAQ,OAEtB,MAAM+B,EAA8C/B,EACjD,IAAKgB,IAAO,CAAE,GAAIA,EAAE,GAAI,GAAKA,EAAE,aAAA,GAAkB,SAAS,eAAeA,EAAE,EAAE,GAA2B,EACxG,OAAQG,GAA4C,CAAC,CAACA,EAAE,EAAE,EAEvDa,EAAW,IAAM,CACrB,GAAI,CAACtB,EAAiB,QAAS,OAE/B,MAAMuB,EAAaF,EAChB,IAAI,CAAC,CAAE,GAAAG,EAAI,GAAAC,CAAA,KAAU,CAAE,GAAAD,EAAI,KAAMC,EAAG,uBAAsB,EAAI,EAC9D,KAAK,CAACC,EAAGb,IAAMa,EAAE,KAAK,IAAMb,EAAE,KAAK,GAAG,EAEzC,IAAIc,EAAyBJ,EAAW,CAAC,GAAG,IAAM,KAClD,UAAWf,KAAKe,EACd,GAAIf,EAAE,KAAK,KAAO,OAAO,YAAc,GACrCmB,EAAUnB,EAAE,OAEZ,OAGJd,EAAYiC,CAAO,CACrB,EAGMC,EAAc,WAAW,IAAM,CACnC5B,EAAiB,QAAU,GAC3BsB,EAAA,CACF,EAAG,GAAG,EACN,cAAO,iBAAiB,SAAUA,EAAU,CAAE,QAAS,GAAM,EAC7D,OAAO,iBAAiB,SAAUA,CAAQ,EACnC,IAAM,CACX,aAAaM,CAAW,EACxB,OAAO,oBAAoB,SAAUN,CAAQ,EAC7C,OAAO,oBAAoB,SAAUA,CAAQ,CAC/C,CACF,EAAG,CAAChC,CAAQ,CAAC,EAET,CAACA,EAAS,OAAQ,OAAO,KAE7B,MAAMuC,EAAW1C,IAAa,QAAU,UAAY,SAC9C2C,EAAazC,EAAmB,WAAa,QAEnD,OACE0C,EAAAA,KAAC,MAAA,CACC,aAAW,mBACX,UAAWC,EACTF,EACA,mBACAD,EACA,SAEA,MAEA,sBACAzC,CAAA,EAGF,SAAA,CAAA6C,EAAAA,IAAC,OAAI,UAAU,sCACb,SAAAF,EAAAA,KAAC,KAAA,CAAG,UAAU,0BAEZ,SAAA,CAAAE,EAAAA,IAAC,MAAA,CAAI,UAAU,wGAAA,CAAyG,EACvH3C,EAAS,IAAKgB,GAAM,CACnB,MAAM4B,EAAW5B,EAAE,KAAOb,EAEpB0C,EAAavC,IAAiB,KAAO,mBAAsBA,EAAe,mBAAqB,mBAC/FwC,EAAYxC,IAAiB,KAAO,yBAA4BA,EAAe,yBAA2B,yBAE1GyC,EAAUzC,IAAiB,GAAQ,6BAA+B,uCAClE0C,EAAY1C,IAAiB,GAAQ,qDAAuD,sDAClG,OACEqC,EAAAA,IAAC,KAAA,CAAc,UAAU,qBAEvB,SAAAA,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM1C,EAAOe,EAAE,EAAE,EAC1B,MAAOA,EAAE,MACT,aAAYA,EAAE,MACd,eAAc4B,EAAW,WAAa,OACtC,UAAWF,EACT,0EACA,iGACAE,EAAWF,EAAG,mBAAoBG,CAAU,EAAIH,EAAG,eAAgBI,CAAS,CAAA,EAG9E,SAAAH,EAAAA,IAAC,OAAA,CACC,UAAWD,EACT,4BACA,cACAE,EAAWI,EAAYD,CAAA,CACzB,CAAA,CACF,CAAA,CACF,EArBO/B,EAAE,EAsBX,CAEJ,CAAC,CAAA,CAAA,CACH,CAAA,CACF,EAEA2B,EAAAA,IAAC,MAAA,CAAI,UAAWD,EAAG,QAAS7C,IAAa,QAAU,UAAY,SAAU,eAAe,EACtF,MAAO,CAAE,cAAe,MAAA,EAExB,gBAACoD,EAAA,CACC,SAAA,CAAAN,EAAAA,IAACO,EAAA,CAAe,QAAO,GACrB,SAAAP,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,aAAW,yBACX,UAAWD,EACT,qEACA,6IACApC,IAAiB,KACb,uFACAA,EACE,wFACA,uFAAA,EAGR,SAAAqC,EAAAA,IAAClD,EAAA,CAAW,UAAU,SAAA,CAAU,CAAA,CAAA,EAEpC,EACAgD,EAAAA,KAACU,EAAA,CAAe,MAAM,MAAM,UAAU,WACpC,SAAA,CAAAR,EAAAA,IAAC,MAAA,CAAI,UAAU,0EAA2E,SAAA/C,EAAM,EAChG+C,EAAAA,IAAC,MAAG,UAAU,yBACX,WAAS,IAAK3B,GACb2B,EAAAA,IAAC,KAAA,CACC,SAAAA,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,UAAU,6DACV,QAAS,IAAM1C,EAAOe,EAAE,EAAE,EAEzB,SAAAA,EAAE,KAAA,CAAA,GANEA,EAAE,EAQX,CACD,CAAA,CACH,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CAGN","x_google_ignoreList":[0]}