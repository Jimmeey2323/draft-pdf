import{r as m,j as e,D as P,n as B,X as D,C as N,a as g,b as w,c as y,S as E}from"./index-Bm67KBkU.js";import{B as H,f as p}from"./index-DkD_C-d1.js";import{g as O}from"./TrainerAvatar-B3vSnngB.js";import{P as z}from"./progress-BPRqleTC.js";import{I as G,S as X,d as K,e as U,g as V,h as S,f as q}from"./select-CM-Birqk.js";import{S as Y}from"./star-qy423-d6.js";import{A as $}from"./award-D0x2LQSI.js";import{R as J,B as Q,a as W,X as Z,Y as _,T as ee,b as se}from"./BarChart-o5Oeg9Jb.js";import{M as te}from"./StudioLocationTabs-BSKYatd_.js";import{C as ae}from"./googleAuth-BGo8ElRc.js";import"./chevron-right-CbIMR3DA.js";import"./index-BdQq_4o_.js";import"./SalesMotionHero-sGphstF2.js";import"./dollar-sign-CKqx8kbC.js";function ve({isOpen:C,onClose:v,trainerName:c,trainerData:h,monthYear:b}){const[r,R]=m.useState(""),[f,A]=m.useState("all"),a=m.useMemo(()=>{if(!h||!h.individualSessions)return{sessions:[],metrics:{totalSessions:0,totalRevenue:0,totalAttendees:0,totalCapacity:0,avgRevenue:0,avgAttendees:0,fillRate:0},byLocation:[]};const s=h.individualSessions,t=s.length,n=s.reduce((l,i)=>l+(parseFloat(i.revenue)||0),0),x=s.reduce((l,i)=>l+(parseInt(i.attendees)||0),0),u=s.reduce((l,i)=>l+(parseInt(i.capacity)||0),0),k=t>0?n/t:0,M=t>0?x/t:0,T=u>0?x/u*100:0,I=s.reduce((l,i)=>{const o=i.location||"Unknown";return l[o]||(l[o]={name:o,sessions:0,revenue:0,attendees:0}),l[o].sessions+=1,l[o].revenue+=parseFloat(i.revenue)||0,l[o].attendees+=parseInt(i.attendees)||0,l},{}),F=Object.values(I).sort((l,i)=>i.revenue-l.revenue);return{sessions:s,metrics:{totalSessions:t,totalRevenue:n,totalAttendees:x,totalCapacity:u,avgRevenue:k,avgAttendees:M,fillRate:T},byLocation:F}},[h]),j=m.useMemo(()=>{let s=a.sessions;return r&&(s=s.filter(t=>(t.className||"").toLowerCase().includes(r.toLowerCase())||(t.location||"").toLowerCase().includes(r.toLowerCase())||(t.date||"").includes(r))),f!=="all"&&(s=s.filter(t=>t.location===f)),s},[a.sessions,r,f]),L=Array.from(new Set(a.sessions.map(s=>s.location).filter(Boolean))),d=m.useMemo(()=>{const s=Math.min(a.metrics.avgRevenue/100*20,30),t=Math.min(a.metrics.fillRate*.4,40),n=Math.min(a.metrics.totalSessions/10*10,30);return Math.min(s+t+n,100)},[a.metrics]);return e.jsx(P,{open:C,onOpenChange:v,children:e.jsx(B,{className:"max-w-[95vw] w-full max-h-[95vh] h-full p-0 bg-white border-0 shadow-2xl overflow-hidden",children:e.jsxs("div",{className:"flex h-full overflow-hidden",children:[e.jsxs("div",{className:"w-80 bg-gradient-to-b from-slate-800 to-slate-900 text-white p-6 flex flex-col overflow-y-auto",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold tracking-tight",children:c}),e.jsx("button",{onClick:v,className:"p-2 rounded-lg bg-white/10 hover:bg-white/20 transition-colors",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"text-center mb-6 flex-1 flex flex-col",children:[e.jsx("div",{className:"relative flex-1 max-h-80 mx-auto mb-4 rounded-xl overflow-hidden border border-white/20 shadow-lg bg-gradient-to-br from-slate-600 to-slate-700",children:e.jsx("img",{src:O(c),alt:c,className:"w-full h-full object-cover",style:{minHeight:"200px"},onError:s=>{const t=s.target,n=c.split(" ").map(x=>x[0]).join("");t.style.display="none",t.parentElement.innerHTML=`<div class="w-full h-full bg-gradient-to-br from-slate-600 to-slate-700 flex items-center justify-center text-white text-6xl font-bold">${n}</div>`}})}),e.jsx("div",{className:"mt-4",children:e.jsxs(H,{className:"bg-white/10 text-white border-white/20",children:[e.jsx(Y,{className:"w-3 h-3 mr-1"}),"Trainer Profile"]})})]}),e.jsxs("div",{className:"bg-white/10 rounded-xl p-4 mb-4",children:[e.jsx("div",{className:"text-xs font-semibold uppercase tracking-wide mb-3 opacity-80",children:"Performance Overview"}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[e.jsxs("li",{children:[e.jsx("span",{className:"opacity-70",children:"Period:"})," ",e.jsx("span",{className:"font-medium",children:b})]}),e.jsxs("li",{children:[e.jsx("span",{className:"opacity-70",children:"Total Sessions:"})," ",e.jsx("span",{className:"font-medium",children:a.metrics.totalSessions})]}),e.jsxs("li",{children:[e.jsx("span",{className:"opacity-70",children:"Total Revenue:"})," ",e.jsx("span",{className:"font-medium",children:p(a.metrics.totalRevenue)})]}),e.jsxs("li",{children:[e.jsx("span",{className:"opacity-70",children:"Avg Attendees:"})," ",e.jsx("span",{className:"font-medium",children:a.metrics.avgAttendees.toFixed(1)})]}),e.jsxs("li",{children:[e.jsx("span",{className:"opacity-70",children:"Fill Rate:"})," ",e.jsxs("span",{className:"font-medium",children:[a.metrics.fillRate.toFixed(1),"%"]})]})]})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm rounded-xl p-4 border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx($,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Performance Score"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-xl font-bold",children:[d.toFixed(0),"/100"]}),e.jsx(z,{value:d,className:"flex-1 h-2 bg-white/20"})]}),e.jsx("p",{className:"text-xs opacity-70 mt-2",children:d>=80?"Outstanding":d>=60?"Great":d>=40?"Good":"Needs Improvement"})]})]}),e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto bg-slate-50",children:[e.jsx("div",{className:"flex items-start justify-between mb-6",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-800",children:[c," - ",b]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Individual session analytics"})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-1",children:"Sessions"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:a.metrics.totalSessions})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-1",children:"Attendees"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:a.metrics.totalAttendees})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-1",children:"Fill Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-slate-900",children:[a.metrics.fillRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-slate-200 shadow-sm",children:[e.jsx("div",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-1",children:"Revenue"}),e.jsx("div",{className:"text-2xl font-bold text-slate-900",children:p(a.metrics.totalRevenue)})]})]}),a.byLocation.length>0&&e.jsxs(N,{className:"border border-slate-200 mb-8",children:[e.jsx(g,{className:"pb-3",children:e.jsx(w,{className:"text-lg",children:"Performance by Location"})}),e.jsx(y,{children:e.jsx(J,{width:"100%",height:300,children:e.jsxs(Q,{data:a.byLocation,children:[e.jsx(W,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),e.jsx(Z,{dataKey:"name",fontSize:12,tick:{fill:"#64748b"}}),e.jsx(_,{fontSize:12,tick:{fill:"#64748b"}}),e.jsx(ee,{contentStyle:{backgroundColor:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:"8px",fontSize:"12px"},formatter:(s,t)=>[t==="revenue"?p(s):s,t==="revenue"?"Revenue":"Sessions"]}),e.jsx(se,{dataKey:"revenue",fill:"#1e293b",radius:[4,4,0,0]})]})})})]}),e.jsxs(N,{className:"border border-slate-200",children:[e.jsxs(g,{className:"pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{className:"text-lg",children:"Individual Sessions"}),e.jsxs("div",{className:"text-sm text-slate-600",children:[j.length," sessions"]})]}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx(G,{placeholder:"Search sessions...",value:r,onChange:s=>R(s.target.value),className:"pl-10"})]}),e.jsxs(X,{value:f,onValueChange:A,children:[e.jsx(K,{className:"w-[180px]",children:e.jsx(U,{placeholder:"All Locations"})}),e.jsxs(V,{children:[e.jsx(S,{value:"all",children:"All Locations"}),L.map(s=>e.jsx(S,{value:s,children:s},s))]})]})]})]}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:[j.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg border border-slate-200 hover:shadow-sm transition-shadow",style:{minHeight:"35px"},children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("div",{className:"px-2 py-1 rounded bg-slate-800 text-white text-xs font-semibold",children:s.className||s.cleanedClass||"Class"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-slate-800",children:s.date?q(new Date(s.date),"dd-MMM-yyyy"):"No Date"}),e.jsxs("div",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3"}),s.location||"Unknown"]})]})]}),e.jsxs("div",{className:"flex gap-4 text-xs text-slate-600",children:[e.jsxs("span",{children:["Revenue: ",e.jsx("span",{className:"font-medium text-slate-800",children:p(parseFloat(s.revenue)||0)})]}),e.jsxs("span",{children:["Attendees: ",e.jsx("span",{className:"font-medium text-slate-800",children:s.attendees||0})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-semibold text-slate-700",children:[s.attendees||0,"/",s.capacity||0]}),e.jsxs("div",{className:"text-xs text-slate-500",children:[s.capacity?Math.round((s.attendees||0)/s.capacity*100):0,"% full"]})]})]},t)),j.length===0&&e.jsxs("div",{className:"text-center py-8 text-slate-500",children:[e.jsx(ae,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No sessions found"})]})]})})]})]})]})})})}export{ve as EnhancedTrainerDrillDownModal};
//# sourceMappingURL=EnhancedTrainerDrillDownModal-SyxMIHRh.js.map
