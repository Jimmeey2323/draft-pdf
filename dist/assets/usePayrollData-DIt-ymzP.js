import{r as c}from"./index-Bm67KBkU.js";const r={CLIENT_ID:"416630995185-g7b0fm679lb4p45p5lou070cqscaalaf.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04yfYtJTsGbluCgYIARAAGAQSNwF-L9Ir3g0kqAfdV7MLUcncxyc5-U0rp2T4rjHmGaxLUF3PZy7VX8wdumM8_ABdltAqXTsC6sk",TOKEN_URL:"https://oauth2.googleapis.com/token"},q="1DSRuJJBhl1Sc9yfY6ki-ZFhdmQ_OeVeGyPDE6n9zpK4",Y=()=>{const[R,y]=c.useState([]),[f,d]=c.useState(!0),[g,i]=c.useState(null),_=async()=>{try{return(await(await fetch(r.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:r.CLIENT_ID,client_secret:r.CLIENT_SECRET,refresh_token:r.REFRESH_TOKEN,grant_type:"refresh_token"})})).json()).access_token}catch(s){throw s}},e=s=>{if(typeof s=="number")return isNaN(s)?0:s;if(!s||s==="")return 0;const n=s.toString().replace(/[^0-9.-]/g,""),l=parseFloat(n);return isNaN(l)?0:l},m=async()=>{try{d(!0);const s=await _(),n=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${q}/values/Payroll?valueRenderOption=UNFORMATTED_VALUE&dateTimeRenderOption=FORMATTED_STRING`,{headers:{Authorization:`Bearer ${s}`}});if(!n.ok)throw new Error(`Failed to fetch payroll data: ${n.status} ${n.statusText}`);const h=(await n.json()).values||[];if(h.length<2){y([]),i(null);return}const N=h.slice(1).map(t=>{const C=e(t[4]),I=e(t[5]),A=e(t[6]),O=e(t[7]),D=e(t[8]),F=e(t[9]),L=e(t[10]),P=e(t[11]),k=e(t[12]),x=e(t[13]),b=e(t[14]),G=e(t[15]),M=e(t[16]),U=e(t[17]),v=e(t[18]),p=e(t[19]),V=e(t[20]),E=e(t[21]),u=e(t[22]),$=e(t[23]),B=e(t[26]),a=e(t[27]),S=a<=1&&a>0?a*100:a,K=e(t[28]),o=e(t[29]),T=o<=1&&o>0?o*100:o,j=e(t[30]);return{teacherId:t[0]||"",teacherName:t[1]||"",teacherEmail:t[2]||"",location:t[3]||"",cycleSessions:C,emptyCycleSessions:I,nonEmptyCycleSessions:A,cycleCustomers:O,cyclePaid:D,strengthSessions:F,emptyStrengthSessions:L,nonEmptyStrengthSessions:P,strengthCustomers:k,strengthPaid:x,barreSessions:b,emptyBarreSessions:G,nonEmptyBarreSessions:M,barreCustomers:U,barrePaid:v,totalSessions:p,totalEmptySessions:V,totalNonEmptySessions:E,totalCustomers:u,totalPaid:$,monthYear:t[24]||"",unique:t[25]||"",converted:B,conversion:`${S.toFixed(1)}%`,retained:K,retention:`${T.toFixed(1)}%`,new:j,conversionRate:S,retentionRate:T,classAverageInclEmpty:p>0?u/p:0,classAverageExclEmpty:E>0?u/E:0}});y(N),i(null)}catch{i("Failed to load payroll data")}finally{d(!1)}};return c.useEffect(()=>{m()},[]),{data:R,isLoading:f,error:g,refetch:m}};export{Y as u};
//# sourceMappingURL=usePayrollData-DIt-ymzP.js.map
