{"version":3,"file":"ModernDataTable-Qj0casC7.js","sources":["../../src/components/ui/ModernDataTable.tsx"],"sourcesContent":["\nimport React, { useRef, useEffect } from 'react';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow, TableFooter } from '@/components/ui/table';\nimport { cn } from '@/lib/utils';\nimport { ChevronUp, ChevronDown } from 'lucide-react';\nimport { TABLE_STYLES, HEADER_GRADIENTS } from '@/styles/tableStyles';\n\ninterface Column {\n  key: string;\n  header: string;\n  render?: (value: any, row: any) => React.ReactNode;\n  align?: 'left' | 'center' | 'right';\n  className?: string;\n  sortable?: boolean;\n  sticky?: boolean;\n}\n\ninterface ModernDataTableProps {\n  data: any[];\n  columns: Column[];\n  loading?: boolean;\n  stickyHeader?: boolean;\n  showFooter?: boolean;\n  footerData?: any;\n  maxHeight?: string;\n  className?: string;\n  headerGradient?: keyof typeof HEADER_GRADIENTS | string;\n  onSort?: (field: string) => void;\n  sortField?: string;\n  sortDirection?: 'asc' | 'desc';\n  onRowClick?: (row: any) => void;\n  tableId?: string;\n  disableRegistry?: boolean;\n  striped?: boolean;\n  compact?: boolean;\n}\n\nimport CopyTableButton from '@/components/ui/CopyTableButton';\nimport { useMetricsTablesRegistry } from '@/contexts/MetricsTablesRegistryContext';\n\nexport const ModernDataTable: React.FC<ModernDataTableProps> = ({\n  data,\n  columns,\n  loading = false,\n  stickyHeader = false,\n  showFooter = false,\n  footerData,\n  maxHeight,\n  className,\n  headerGradient = \"default\",\n  onSort,\n  sortField,\n  sortDirection,\n  onRowClick,\n  tableId,\n  disableRegistry = false,\n  striped = true,\n  compact = false\n}) => {\n  // Get the gradient class - support both preset keys and custom strings\n  const gradientClass = HEADER_GRADIENTS[headerGradient as keyof typeof HEADER_GRADIENTS] || headerGradient;\n  // Remove individual loading state - parent components handle loading via global loader\n  // if (loading) {\n  //   return (\n  //     <div className=\"flex items-center justify-center p-8\">\n  //       <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n  //     </div>\n  //   );\n  // }\n\n  const formatCurrencyValue = (value: any) => {\n    if (typeof value === 'string' && (value.includes('₹') || value.includes('$'))) {\n      const numericValue = parseFloat(value.replace(/[₹$,]/g, ''));\n      if (!isNaN(numericValue) && numericValue < 1000) {\n        return `₹${Math.round(numericValue)}`;\n      }\n    }\n    return value;\n  };\n\n  const formatFooterValue = (value: any) => {\n    if (value === null || value === undefined) return '';\n    // Handle objects (like nested month data) - return empty string\n    if (typeof value === 'object') {\n      // If it's an object with a specific value we want to display, handle it\n      // Otherwise return empty to avoid [object Object]\n      return '';\n    }\n    if (typeof value === 'number') {\n      // Check if it's a percentage (typically 0-100 range with decimals)\n      if (value >= 0 && value <= 100 && !Number.isInteger(value)) {\n        return `${value.toFixed(1)}%`;\n      }\n      // Check if it looks like currency (large numbers)\n      if (value >= 1000) {\n        return `₹${value.toLocaleString('en-IN', { maximumFractionDigits: 0 })}`;\n      }\n      // Format with max 1 decimal\n      return Number.isInteger(value) ? value.toString() : value.toFixed(1);\n    }\n    return formatCurrencyValue(value);\n  };\n\n  const handleSort = (column: Column) => {\n    if (column.sortable && onSort) {\n      onSort(column.key);\n    }\n  };\n\n  const containerRef = useRef<HTMLDivElement>(null);\n  const registry = useMetricsTablesRegistry();\n\n  // auto-register for copy-all\n  useEffect(() => {\n    if (disableRegistry) return;\n    if (!registry) return;\n    if (!tableId) return;\n    const el = containerRef.current;\n    if (!el) return;\n    const getTextContent = () => {\n      const table = el.querySelector('table') || el;\n      let text = `${tableId}\\n`;\n      const headerCells = table.querySelectorAll('thead th, thead td, tr:first-child th, tr:first-child td');\n      const headers: string[] = [];\n      headerCells.forEach(cell => { const t = cell.textContent?.trim(); if (t) headers.push(t); });\n      if (headers.length) {\n        text += headers.join('\\t') + '\\n';\n        text += headers.map(() => '---').join('\\t') + '\\n';\n      }\n      const rows = table.querySelectorAll('tbody tr, tr:not(:first-child)');\n      rows.forEach(row => {\n        const cells = row.querySelectorAll('td, th');\n        const rowData: string[] = [];\n        cells.forEach(c => rowData.push((c.textContent || '').trim()));\n        if (rowData.length) text += rowData.join('\\t') + '\\n';\n      });\n      return text.trim();\n    };\n    registry.register({ id: tableId, getTextContent });\n    return () => registry.unregister(tableId);\n  }, [registry, tableId, disableRegistry]);\n\n  return (\n    <div ref={containerRef} className={cn(TABLE_STYLES.container, className)} style={{ maxHeight }}>\n      <Table className={TABLE_STYLES.table}>\n        <TableHeader className={cn(\n          stickyHeader && TABLE_STYLES.header.wrapper,\n          \"border-b border-slate-300\"\n        )}>\n          <TableRow className={cn(\n            \"border-none\",\n            compact ? \"h-10\" : \"h-12\",\n            \"relative\",\n            gradientClass.includes('from-') ? `bg-gradient-to-r ${gradientClass}` : ''\n          )} style={!gradientClass.includes('from-') ? {\n            background: `linear-gradient(to right, rgb(51 65 85), rgb(15 23 42), rgb(51 65 85))`\n          } : undefined}>\n            {columns.map((column, colIndex) => {\n              const isSticky = column.sticky || colIndex === 0;\n              const isLastColumn = colIndex === columns.length - 1;\n              const sanitizedHeaderClass = (column.className || '')\n                .split(' ')\n                .filter(c => !c.startsWith('bg-'))\n                .join(' ');\n              return (\n                <TableHead \n                  key={column.key} \n                  className={cn(\n                    \"px-3 text-left text-white font-bold text-xs uppercase tracking-wide border-r border-white/20 last:border-r-0\",\n                    compact ? \"py-2\" : \"py-3\",\n                    column.align === 'center' && 'text-center',\n                    column.align === 'right' && 'text-right',\n                    column.sortable && 'cursor-pointer hover:bg-white/10 transition-colors',\n                    isSticky && 'sticky left-0 z-40 border-r border-white/20',\n                    sanitizedHeaderClass,\n                    isLastColumn && tableId && \"pr-12\" // Extra padding for copy button\n                  )}\n                  style={{\n                    minWidth: '80px',\n                    ...(isSticky\n                      ? {\n                          background: gradientClass.includes('from-')\n                            ? `linear-gradient(to right, ${gradientClass.split(' ').slice(1).join(' ')})`\n                            : 'linear-gradient(to right, rgb(51 65 85), rgb(15 23 42))',\n                        }\n                      : {}),\n                  }}\n                  onClick={() => handleSort(column)}\n                >\n                <div className={cn(\n                  \"flex items-center gap-1 h-full\",\n                  column.align === 'center' && 'justify-center',\n                  column.align === 'right' && 'justify-end'\n                )}>\n                  <span className=\"text-xs font-bold uppercase tracking-wide leading-tight\">\n                    {column.header}\n                  </span>\n                  {column.sortable && sortField === column.key && (\n                    sortDirection === 'asc' ? \n                      <ChevronUp className=\"w-3 h-3\" /> : \n                      <ChevronDown className=\"w-3 h-3\" />\n                  )}\n                </div>\n                {/* Copy button positioned in last column header */}\n                {isLastColumn && tableId && (\n                  <div className=\"absolute right-2 top-1/2 -translate-y-1/2\">\n                    <CopyTableButton \n                      tableRef={containerRef as any}\n                      tableName={tableId}\n                      size=\"sm\"\n                      onCopyAllTabs={registry ? async () => registry.getAllTabsContent() : undefined}\n                    />\n                  </div>\n                )}\n                </TableHead>\n              );\n            })}\n          </TableRow>\n        </TableHeader>\n        <TableBody>\n          {data.map((row, index) => (\n            <TableRow \n              key={index} \n              className={cn(\n                TABLE_STYLES.body.row,\n                striped && index % 2 === 1 && TABLE_STYLES.body.rowAlternate,\n                onRowClick && TABLE_STYLES.body.rowClickable,\n                compact ? \"h-10\" : \"h-12\"\n              )}\n              onClick={() => onRowClick?.(row)}\n            >\n              {columns.map((column, colIndex) => {\n                const isSticky = column.sticky || colIndex === 0;\n                return (\n                  <TableCell \n                    key={column.key}\n                    className={cn(\n                      TABLE_STYLES.body.cell,\n                      compact ? \"py-1.5\" : \"py-2\",\n                      column.align === 'center' && TABLE_STYLES.body.cellCenter,\n                      column.align === 'right' && 'text-right',\n                      isSticky && TABLE_STYLES.body.cellSticky,\n                      column.className\n                    )}\n                    style={{ minWidth: '80px' }}\n                  >\n                    <div className={cn(\n                      \"flex items-center h-full\",\n                      column.align === 'center' && 'justify-center',\n                      column.align === 'right' && 'justify-end'\n                    )}>\n                      {column.render \n                        ? column.render(row[column.key], row)\n                        : <span className=\"text-sm truncate\">{formatCurrencyValue(row[column.key])}</span>\n                      }\n                    </div>\n                  </TableCell>\n                );\n              })}\n            </TableRow>\n          ))}\n        </TableBody>\n        {showFooter && footerData && (\n          <TableFooter className=\"sticky bottom-0 z-10\">\n            <TableRow className={cn(\n              TABLE_STYLES.footer.row,\n              compact ? \"h-10\" : \"h-12\",\n              \"hover:bg-slate-800\" // Prevent hover color change\n            )}>\n              {columns.map((column, colIndex) => {\n                const isSticky = column.sticky || colIndex === 0;\n                return (\n                  <TableCell \n                    key={column.key}\n                    className={cn(\n                      TABLE_STYLES.footer.cell,\n                      compact ? \"py-1.5\" : \"py-2\",\n                      column.align === 'center' && TABLE_STYLES.footer.cellCenter,\n                      column.align === 'right' && 'text-right',\n                      isSticky && TABLE_STYLES.footer.cellSticky\n                    )}\n                    style={{ minWidth: '80px' }}\n                  >\n                    <div className={cn(\n                      \"flex items-center h-full\",\n                      column.align === 'center' && 'justify-center',\n                      column.align === 'right' && 'justify-end'\n                    )}>\n                      <span className=\"text-sm font-bold text-white\">\n                        {footerData[column.key] === 'TOTALS' || footerData[column.key] === 'TOTAL' \n                          ? footerData[column.key] \n                          : column.render && typeof footerData[column.key] === 'object'\n                            ? (() => {\n                                const rendered = column.render(footerData[column.key], footerData);\n                                // Strip out any text color classes and force white\n                                if (React.isValidElement(rendered)) {\n                                  return React.cloneElement(rendered as React.ReactElement<any>, {\n                                    className: cn(\n                                      (rendered as React.ReactElement<any>).props?.className?.replace(/text-slate-\\d+/g, '').replace(/text-blue-\\d+/g, '').replace(/text-green-\\d+/g, ''),\n                                      'text-white'\n                                    )\n                                  });\n                                }\n                                return rendered;\n                              })()\n                            : formatFooterValue(footerData[column.key])}\n                      </span>\n                    </div>\n                  </TableCell>\n                );\n              })}\n            </TableRow>\n          </TableFooter>\n        )}\n      </Table>\n    </div>\n  );\n};\n"],"names":["ModernDataTable","data","columns","loading","stickyHeader","showFooter","footerData","maxHeight","className","headerGradient","onSort","sortField","sortDirection","onRowClick","tableId","disableRegistry","striped","compact","gradientClass","HEADER_GRADIENTS","formatCurrencyValue","value","numericValue","formatFooterValue","handleSort","column","containerRef","useRef","registry","useMetricsTablesRegistry","useEffect","el","getTextContent","table","text","headerCells","headers","cell","t","row","cells","rowData","c","cn","TABLE_STYLES","Table","jsx","TableHeader","TableRow","colIndex","isSticky","isLastColumn","sanitizedHeaderClass","jsxs","TableHead","ChevronUp","ChevronDown","CopyTableButton","TableBody","index","TableCell","TableFooter","rendered","React"],"mappings":"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"}