{"version":3,"file":"DiscountsPromotions-CzVp9_-P.js","sources":["../../node_modules/recharts/es6/cartesian/ZAxis.js","../../node_modules/recharts/es6/util/ScatterUtils.js","../../node_modules/recharts/es6/cartesian/Scatter.js","../../node_modules/recharts/es6/chart/ScatterChart.js","../../src/hooks/useDiscountMetrics.ts","../../src/components/dashboard/DiscountsAnimatedMetricCards.tsx","../../src/components/dashboard/DiscountInteractiveCharts.tsx","../../src/components/dashboard/DiscountInteractiveTopBottomLists.tsx","../../src/components/dashboard/EnhancedDiscountDataTable.tsx","../../src/components/dashboard/EnhancedDiscountBreakdownTables.tsx","../../src/components/dashboard/MonthOnMonthDiscountTable.tsx","../../src/components/dashboard/EnhancedDiscountsDashboardV2.tsx","../../src/pages/DiscountsPromotions.tsx"],"sourcesContent":["function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/**\n * @fileOverview Z Axis\n */\nimport * as React from 'react';\n// eslint-disable-next-line react/prefer-stateless-function -- requires static defaultProps\nexport var ZAxis = /*#__PURE__*/function (_React$Component) {\n  function ZAxis() {\n    _classCallCheck(this, ZAxis);\n    return _callSuper(this, ZAxis, arguments);\n  }\n  _inherits(ZAxis, _React$Component);\n  return _createClass(ZAxis, [{\n    key: \"render\",\n    value: function render() {\n      return null;\n    }\n  }]);\n}(React.Component);\n_defineProperty(ZAxis, \"displayName\", 'ZAxis');\n_defineProperty(ZAxis, \"defaultProps\", {\n  zAxisId: 0,\n  range: [64, 64],\n  scale: 'auto',\n  type: 'number'\n});","var _excluded = [\"option\", \"isActive\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } } return target; }\nimport * as React from 'react';\nimport { Symbols } from '../shape/Symbols';\nimport { Shape } from './ActiveShapeUtils';\nexport function ScatterSymbol(_ref) {\n  var option = _ref.option,\n    isActive = _ref.isActive,\n    props = _objectWithoutProperties(_ref, _excluded);\n  if (typeof option === 'string') {\n    return /*#__PURE__*/React.createElement(Shape, _extends({\n      option: /*#__PURE__*/React.createElement(Symbols, _extends({\n        type: option\n      }, props)),\n      isActive: isActive,\n      shapeType: \"symbols\"\n    }, props));\n  }\n  return /*#__PURE__*/React.createElement(Shape, _extends({\n    option: option,\n    isActive: isActive,\n    shapeType: \"symbols\"\n  }, props));\n}","var _Scatter;\nfunction _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _callSuper(t, o, e) { return o = _getPrototypeOf(o), _possibleConstructorReturn(t, _isNativeReflectConstruct() ? Reflect.construct(o, e || [], _getPrototypeOf(t).constructor) : o.apply(t, e)); }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { try { var t = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); } catch (t) {} return (_isNativeReflectConstruct = function _isNativeReflectConstruct() { return !!t; })(); }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(t) { var i = _toPrimitive(t, \"string\"); return \"symbol\" == _typeof(i) ? i : i + \"\"; }\nfunction _toPrimitive(t, r) { if (\"object\" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || \"default\"); if (\"object\" != _typeof(i)) return i; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (\"string\" === r ? String : Number)(t); }\n/**\n * @fileOverview Render a group of scatters\n */\nimport React, { PureComponent } from 'react';\nimport Animate from 'react-smooth';\nimport isNil from 'lodash/isNil';\nimport isEqual from 'lodash/isEqual';\nimport isFunction from 'lodash/isFunction';\nimport clsx from 'clsx';\nimport { Layer } from '../container/Layer';\nimport { LabelList } from '../component/LabelList';\nimport { findAllByType, filterProps } from '../util/ReactUtils';\nimport { Global } from '../util/Global';\nimport { ZAxis } from './ZAxis';\nimport { Curve } from '../shape/Curve';\nimport { ErrorBar } from './ErrorBar';\nimport { Cell } from '../component/Cell';\nimport { uniqueId, interpolateNumber, getLinearRegression } from '../util/DataUtils';\nimport { getValueByDataKey, getCateCoordinateOfLine } from '../util/ChartUtils';\nimport { adaptEventsOfChild } from '../util/types';\nimport { ScatterSymbol } from '../util/ScatterUtils';\nexport var Scatter = /*#__PURE__*/function (_PureComponent) {\n  function Scatter() {\n    var _this;\n    _classCallCheck(this, Scatter);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _callSuper(this, Scatter, [].concat(args));\n    _defineProperty(_this, \"state\", {\n      isAnimationFinished: false\n    });\n    _defineProperty(_this, \"handleAnimationEnd\", function () {\n      _this.setState({\n        isAnimationFinished: true\n      });\n    });\n    _defineProperty(_this, \"handleAnimationStart\", function () {\n      _this.setState({\n        isAnimationFinished: false\n      });\n    });\n    _defineProperty(_this, \"id\", uniqueId('recharts-scatter-'));\n    return _this;\n  }\n  _inherits(Scatter, _PureComponent);\n  return _createClass(Scatter, [{\n    key: \"renderSymbolsStatically\",\n    value: function renderSymbolsStatically(points) {\n      var _this2 = this;\n      var _this$props = this.props,\n        shape = _this$props.shape,\n        activeShape = _this$props.activeShape,\n        activeIndex = _this$props.activeIndex;\n      var baseProps = filterProps(this.props, false);\n      return points.map(function (entry, i) {\n        var isActive = activeIndex === i;\n        var option = isActive ? activeShape : shape;\n        var props = _objectSpread(_objectSpread({}, baseProps), entry);\n        return /*#__PURE__*/React.createElement(Layer, _extends({\n          className: \"recharts-scatter-symbol\"\n          // eslint-disable-next-line react/no-array-index-key\n          ,\n          key: \"symbol-\".concat(entry === null || entry === void 0 ? void 0 : entry.cx, \"-\").concat(entry === null || entry === void 0 ? void 0 : entry.cy, \"-\").concat(entry === null || entry === void 0 ? void 0 : entry.size, \"-\").concat(i)\n        }, adaptEventsOfChild(_this2.props, entry, i), {\n          role: \"img\"\n        }), /*#__PURE__*/React.createElement(ScatterSymbol, _extends({\n          option: option,\n          isActive: isActive\n          // eslint-disable-next-line react/no-array-index-key\n          ,\n          key: \"symbol-\".concat(i)\n        }, props)));\n      });\n    }\n  }, {\n    key: \"renderSymbolsWithAnimation\",\n    value: function renderSymbolsWithAnimation() {\n      var _this3 = this;\n      var _this$props2 = this.props,\n        points = _this$props2.points,\n        isAnimationActive = _this$props2.isAnimationActive,\n        animationBegin = _this$props2.animationBegin,\n        animationDuration = _this$props2.animationDuration,\n        animationEasing = _this$props2.animationEasing,\n        animationId = _this$props2.animationId;\n      var prevPoints = this.state.prevPoints;\n      return /*#__PURE__*/React.createElement(Animate, {\n        begin: animationBegin,\n        duration: animationDuration,\n        isActive: isAnimationActive,\n        easing: animationEasing,\n        from: {\n          t: 0\n        },\n        to: {\n          t: 1\n        },\n        key: \"pie-\".concat(animationId),\n        onAnimationEnd: this.handleAnimationEnd,\n        onAnimationStart: this.handleAnimationStart\n      }, function (_ref) {\n        var t = _ref.t;\n        var stepData = points.map(function (entry, index) {\n          var prev = prevPoints && prevPoints[index];\n          if (prev) {\n            var interpolatorCx = interpolateNumber(prev.cx, entry.cx);\n            var interpolatorCy = interpolateNumber(prev.cy, entry.cy);\n            var interpolatorSize = interpolateNumber(prev.size, entry.size);\n            return _objectSpread(_objectSpread({}, entry), {}, {\n              cx: interpolatorCx(t),\n              cy: interpolatorCy(t),\n              size: interpolatorSize(t)\n            });\n          }\n          var interpolator = interpolateNumber(0, entry.size);\n          return _objectSpread(_objectSpread({}, entry), {}, {\n            size: interpolator(t)\n          });\n        });\n        return /*#__PURE__*/React.createElement(Layer, null, _this3.renderSymbolsStatically(stepData));\n      });\n    }\n  }, {\n    key: \"renderSymbols\",\n    value: function renderSymbols() {\n      var _this$props3 = this.props,\n        points = _this$props3.points,\n        isAnimationActive = _this$props3.isAnimationActive;\n      var prevPoints = this.state.prevPoints;\n      if (isAnimationActive && points && points.length && (!prevPoints || !isEqual(prevPoints, points))) {\n        return this.renderSymbolsWithAnimation();\n      }\n      return this.renderSymbolsStatically(points);\n    }\n  }, {\n    key: \"renderErrorBar\",\n    value: function renderErrorBar() {\n      var isAnimationActive = this.props.isAnimationActive;\n      if (isAnimationActive && !this.state.isAnimationFinished) {\n        return null;\n      }\n      var _this$props4 = this.props,\n        points = _this$props4.points,\n        xAxis = _this$props4.xAxis,\n        yAxis = _this$props4.yAxis,\n        children = _this$props4.children;\n      var errorBarItems = findAllByType(children, ErrorBar);\n      if (!errorBarItems) {\n        return null;\n      }\n      return errorBarItems.map(function (item, i) {\n        var _item$props = item.props,\n          direction = _item$props.direction,\n          errorDataKey = _item$props.dataKey;\n        return /*#__PURE__*/React.cloneElement(item, {\n          key: \"\".concat(direction, \"-\").concat(errorDataKey, \"-\").concat(points[i]),\n          data: points,\n          xAxis: xAxis,\n          yAxis: yAxis,\n          layout: direction === 'x' ? 'vertical' : 'horizontal',\n          dataPointFormatter: function dataPointFormatter(dataPoint, dataKey) {\n            return {\n              x: dataPoint.cx,\n              y: dataPoint.cy,\n              value: direction === 'x' ? +dataPoint.node.x : +dataPoint.node.y,\n              errorVal: getValueByDataKey(dataPoint, dataKey)\n            };\n          }\n        });\n      });\n    }\n  }, {\n    key: \"renderLine\",\n    value: function renderLine() {\n      var _this$props5 = this.props,\n        points = _this$props5.points,\n        line = _this$props5.line,\n        lineType = _this$props5.lineType,\n        lineJointType = _this$props5.lineJointType;\n      var scatterProps = filterProps(this.props, false);\n      var customLineProps = filterProps(line, false);\n      var linePoints, lineItem;\n      if (lineType === 'joint') {\n        linePoints = points.map(function (entry) {\n          return {\n            x: entry.cx,\n            y: entry.cy\n          };\n        });\n      } else if (lineType === 'fitting') {\n        var _getLinearRegression = getLinearRegression(points),\n          xmin = _getLinearRegression.xmin,\n          xmax = _getLinearRegression.xmax,\n          a = _getLinearRegression.a,\n          b = _getLinearRegression.b;\n        var linearExp = function linearExp(x) {\n          return a * x + b;\n        };\n        linePoints = [{\n          x: xmin,\n          y: linearExp(xmin)\n        }, {\n          x: xmax,\n          y: linearExp(xmax)\n        }];\n      }\n      var lineProps = _objectSpread(_objectSpread(_objectSpread({}, scatterProps), {}, {\n        fill: 'none',\n        stroke: scatterProps && scatterProps.fill\n      }, customLineProps), {}, {\n        points: linePoints\n      });\n      if ( /*#__PURE__*/React.isValidElement(line)) {\n        lineItem = /*#__PURE__*/React.cloneElement(line, lineProps);\n      } else if (isFunction(line)) {\n        lineItem = line(lineProps);\n      } else {\n        lineItem = /*#__PURE__*/React.createElement(Curve, _extends({}, lineProps, {\n          type: lineJointType\n        }));\n      }\n      return /*#__PURE__*/React.createElement(Layer, {\n        className: \"recharts-scatter-line\",\n        key: \"recharts-scatter-line\"\n      }, lineItem);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props6 = this.props,\n        hide = _this$props6.hide,\n        points = _this$props6.points,\n        line = _this$props6.line,\n        className = _this$props6.className,\n        xAxis = _this$props6.xAxis,\n        yAxis = _this$props6.yAxis,\n        left = _this$props6.left,\n        top = _this$props6.top,\n        width = _this$props6.width,\n        height = _this$props6.height,\n        id = _this$props6.id,\n        isAnimationActive = _this$props6.isAnimationActive;\n      if (hide || !points || !points.length) {\n        return null;\n      }\n      var isAnimationFinished = this.state.isAnimationFinished;\n      var layerClass = clsx('recharts-scatter', className);\n      var needClipX = xAxis && xAxis.allowDataOverflow;\n      var needClipY = yAxis && yAxis.allowDataOverflow;\n      var needClip = needClipX || needClipY;\n      var clipPathId = isNil(id) ? this.id : id;\n      return /*#__PURE__*/React.createElement(Layer, {\n        className: layerClass,\n        clipPath: needClip ? \"url(#clipPath-\".concat(clipPathId, \")\") : null\n      }, needClipX || needClipY ? /*#__PURE__*/React.createElement(\"defs\", null, /*#__PURE__*/React.createElement(\"clipPath\", {\n        id: \"clipPath-\".concat(clipPathId)\n      }, /*#__PURE__*/React.createElement(\"rect\", {\n        x: needClipX ? left : left - width / 2,\n        y: needClipY ? top : top - height / 2,\n        width: needClipX ? width : width * 2,\n        height: needClipY ? height : height * 2\n      }))) : null, line && this.renderLine(), this.renderErrorBar(), /*#__PURE__*/React.createElement(Layer, {\n        key: \"recharts-scatter-symbols\"\n      }, this.renderSymbols()), (!isAnimationActive || isAnimationFinished) && LabelList.renderCallByParent(this.props, points));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      if (nextProps.animationId !== prevState.prevAnimationId) {\n        return {\n          prevAnimationId: nextProps.animationId,\n          curPoints: nextProps.points,\n          prevPoints: prevState.curPoints\n        };\n      }\n      if (nextProps.points !== prevState.curPoints) {\n        return {\n          curPoints: nextProps.points\n        };\n      }\n      return null;\n    }\n  }]);\n}(PureComponent);\n_Scatter = Scatter;\n_defineProperty(Scatter, \"displayName\", 'Scatter');\n_defineProperty(Scatter, \"defaultProps\", {\n  xAxisId: 0,\n  yAxisId: 0,\n  zAxisId: 0,\n  legendType: 'circle',\n  lineType: 'joint',\n  lineJointType: 'linear',\n  data: [],\n  shape: 'circle',\n  hide: false,\n  isAnimationActive: !Global.isSsr,\n  animationBegin: 0,\n  animationDuration: 400,\n  animationEasing: 'linear'\n});\n/**\n * Compose the data of each group\n * @param  {Object} xAxis   The configuration of x-axis\n * @param  {Object} yAxis   The configuration of y-axis\n * @param  {String} dataKey The unique key of a group\n * @return {Array}  Composed data\n */\n_defineProperty(Scatter, \"getComposedData\", function (_ref2) {\n  var xAxis = _ref2.xAxis,\n    yAxis = _ref2.yAxis,\n    zAxis = _ref2.zAxis,\n    item = _ref2.item,\n    displayedData = _ref2.displayedData,\n    xAxisTicks = _ref2.xAxisTicks,\n    yAxisTicks = _ref2.yAxisTicks,\n    offset = _ref2.offset;\n  var tooltipType = item.props.tooltipType;\n  var cells = findAllByType(item.props.children, Cell);\n  var xAxisDataKey = isNil(xAxis.dataKey) ? item.props.dataKey : xAxis.dataKey;\n  var yAxisDataKey = isNil(yAxis.dataKey) ? item.props.dataKey : yAxis.dataKey;\n  var zAxisDataKey = zAxis && zAxis.dataKey;\n  var defaultRangeZ = zAxis ? zAxis.range : ZAxis.defaultProps.range;\n  var defaultZ = defaultRangeZ && defaultRangeZ[0];\n  var xBandSize = xAxis.scale.bandwidth ? xAxis.scale.bandwidth() : 0;\n  var yBandSize = yAxis.scale.bandwidth ? yAxis.scale.bandwidth() : 0;\n  var points = displayedData.map(function (entry, index) {\n    var x = getValueByDataKey(entry, xAxisDataKey);\n    var y = getValueByDataKey(entry, yAxisDataKey);\n    var z = !isNil(zAxisDataKey) && getValueByDataKey(entry, zAxisDataKey) || '-';\n    var tooltipPayload = [{\n      name: isNil(xAxis.dataKey) ? item.props.name : xAxis.name || xAxis.dataKey,\n      unit: xAxis.unit || '',\n      value: x,\n      payload: entry,\n      dataKey: xAxisDataKey,\n      type: tooltipType\n    }, {\n      name: isNil(yAxis.dataKey) ? item.props.name : yAxis.name || yAxis.dataKey,\n      unit: yAxis.unit || '',\n      value: y,\n      payload: entry,\n      dataKey: yAxisDataKey,\n      type: tooltipType\n    }];\n    if (z !== '-') {\n      tooltipPayload.push({\n        name: zAxis.name || zAxis.dataKey,\n        unit: zAxis.unit || '',\n        value: z,\n        payload: entry,\n        dataKey: zAxisDataKey,\n        type: tooltipType\n      });\n    }\n    var cx = getCateCoordinateOfLine({\n      axis: xAxis,\n      ticks: xAxisTicks,\n      bandSize: xBandSize,\n      entry: entry,\n      index: index,\n      dataKey: xAxisDataKey\n    });\n    var cy = getCateCoordinateOfLine({\n      axis: yAxis,\n      ticks: yAxisTicks,\n      bandSize: yBandSize,\n      entry: entry,\n      index: index,\n      dataKey: yAxisDataKey\n    });\n    var size = z !== '-' ? zAxis.scale(z) : defaultZ;\n    var radius = Math.sqrt(Math.max(size, 0) / Math.PI);\n    return _objectSpread(_objectSpread({}, entry), {}, {\n      cx: cx,\n      cy: cy,\n      x: cx - radius,\n      y: cy - radius,\n      xAxis: xAxis,\n      yAxis: yAxis,\n      zAxis: zAxis,\n      width: 2 * radius,\n      height: 2 * radius,\n      size: size,\n      node: {\n        x: x,\n        y: y,\n        z: z\n      },\n      tooltipPayload: tooltipPayload,\n      tooltipPosition: {\n        x: cx,\n        y: cy\n      },\n      payload: entry\n    }, cells && cells[index] && cells[index].props);\n  });\n  return _objectSpread({\n    points: points\n  }, offset);\n});","/**\n * @fileOverview Scatter Chart\n */\nimport { generateCategoricalChart } from './generateCategoricalChart';\nimport { Scatter } from '../cartesian/Scatter';\nimport { XAxis } from '../cartesian/XAxis';\nimport { YAxis } from '../cartesian/YAxis';\nimport { ZAxis } from '../cartesian/ZAxis';\nimport { formatAxisMap } from '../util/CartesianUtils';\nexport var ScatterChart = generateCategoricalChart({\n  chartName: 'ScatterChart',\n  GraphicalChild: Scatter,\n  defaultTooltipEventType: 'item',\n  validateTooltipEventTypes: ['item'],\n  axisComponents: [{\n    axisType: 'xAxis',\n    AxisComp: XAxis\n  }, {\n    axisType: 'yAxis',\n    AxisComp: YAxis\n  }, {\n    axisType: 'zAxis',\n    AxisComp: ZAxis\n  }],\n  formatAxisMap: formatAxisMap\n});","import { useMemo } from 'react';\nimport { SalesData } from '@/types/dashboard';\nimport { parseDate } from '@/utils/dateUtils';\nimport { formatCurrency, formatNumber, formatPercentage } from '@/utils/formatters';\n\ntype Trend = 'strong' | 'moderate' | 'weak';\n\nexport interface DiscountMetric {\n  title: string;\n  value: string;\n  rawValue: number;\n  change: number; // percent\n  changeDetails: { rate: number; isSignificant: boolean; trend: Trend };\n  previousValue: string;\n  previousRawValue: number;\n  periodLabel?: string;\n  icon: string;\n  description: string;\n}\n\ninterface Options {\n  dateRange?: { start?: string | Date; end?: string | Date };\n}\n\nconst num = (v: any): number => {\n  if (v == null) return 0;\n  if (typeof v === 'number') return v;\n  if (typeof v === 'string') {\n    const n = parseFloat(v.replace(/[^0-9.-]/g, ''));\n    return isNaN(n) ? 0 : n;\n  }\n  return 0;\n};\n\nconst calcGrowth = (current: number, previous: number) => {\n  if (previous === 0) return { rate: current > 0 ? 100 : 0, isSignificant: current > 0, trend: current > 0 ? 'moderate' as Trend : 'weak' as Trend };\n  const rate = ((current - previous) / previous) * 100;\n  const mag = Math.abs(rate);\n  \n  // Trend should consider direction of change\n  let trend: Trend;\n  if (rate > 0) {\n    // Positive growth\n    trend = mag > 20 ? 'strong' : mag > 5 ? 'moderate' : 'weak';\n  } else {\n    // Negative growth (decline) - should always be weak or moderate at best\n    trend = mag > 20 ? 'weak' : mag > 5 ? 'moderate' : 'weak';\n  }\n  \n  return { rate, isSignificant: mag > 2, trend };\n};\n\nexport function useDiscountMetrics(\n  data: SalesData[] = [],\n  historicalData?: SalesData[],\n  options?: Options\n) {\n  return useMemo(() => {\n\n    // Current period metrics come directly from `data` (which is already filtered)\n    // Historical/previous period comes from `historicalData` filtered by previous month\n    \n    // Determine comparison end date for period labeling\n    let compareEnd: Date;\n    if (options?.dateRange?.end) {\n      compareEnd = typeof options.dateRange.end === 'string' \n        ? new Date(options.dateRange.end) \n        : (options.dateRange.end as Date);\n    } else {\n      compareEnd = new Date();\n    }\n    \n    const monthStart = (d: Date) => new Date(d.getFullYear(), d.getMonth(), 1);\n    const monthEnd = (d: Date) => new Date(d.getFullYear(), d.getMonth() + 1, 0, 23, 59, 59, 999);\n    const currentStart = monthStart(compareEnd);\n    const prevAnchor = new Date(currentStart.getFullYear(), currentStart.getMonth() - 1, 15);\n    const prevStart = monthStart(prevAnchor);\n    const prevEnd = monthEnd(prevAnchor);\n    const fmt = (d: Date) => d.toLocaleDateString(undefined, { month: 'short', year: 'numeric' });\n    const periodLabel = `${fmt(currentStart)} vs ${fmt(prevStart)}`;\n\n    const within = (d?: Date | null, start?: Date, end?: Date) => !!(d && start && end && d >= start && d <= end);\n\n    // Current period: use data directly (it's already filtered by the dashboard)\n    const current = data;\n    \n    // Previous period: filter historicalData by the previous month\n    const histBase = (historicalData && historicalData.length > 0) ? historicalData : [];\n    const previous = histBase.filter((it) => within(parseDate((it as any).paymentDate), prevStart, prevEnd));\n    \n\n\n    // Compute metrics for a list\n    // Note: totalRevenue here = paymentValue (net revenue after discount, before VAT)\n    const totals = (list: SalesData[]) => {\n      const totalDiscounts = list.reduce((s, it) => s + num(it.discountAmount), 0);\n      const totalRevenue = list.reduce((s, it) => s + num(it.paymentValue), 0);\n      const totalTransactions = list.length;\n      const discountedTransactions = list.filter((it) => num(it.discountAmount) > 0).length;\n      const uniqueCustomers = new Set(list.map((it) => it.memberId || it.customerEmail).filter(Boolean)).size;\n      const customersWithDiscounts = new Set(\n        list.filter((it) => num(it.discountAmount) > 0).map((it) => it.memberId || it.customerEmail).filter(Boolean)\n      ).size;\n\n      // Calculate discount rate: Total Discounts / Gross Revenue (before discount) * 100\n      const grossRevenue = totalRevenue + totalDiscounts;\n      const discountRate = grossRevenue > 0 ? (totalDiscounts / grossRevenue) * 100 : 0;\n      const discountPenetration = totalTransactions > 0 ? (discountedTransactions / totalTransactions) * 100 : 0;\n      const customerDiscountPenetration = uniqueCustomers > 0 ? (customersWithDiscounts / uniqueCustomers) * 100 : 0;\n      const avgDiscountPerTransaction = discountedTransactions > 0 ? totalDiscounts / discountedTransactions : 0;\n      const avgDiscountPerCustomer = customersWithDiscounts > 0 ? totalDiscounts / customersWithDiscounts : 0;\n\n      return {\n        totalDiscounts,\n        totalRevenue,\n        discountRate,\n        discountedTransactions,\n        customersWithDiscounts,\n        avgDiscountPerTransaction,\n        avgDiscountPerCustomer,\n        discountPenetration,\n        customerDiscountPenetration,\n        totalTransactions,\n      };\n    };\n\n    const cur = totals(current);\n    const prev = totals(previous);\n    \n\n\n    const m: DiscountMetric[] = [\n      {\n        title: 'Total Discounts',\n        value: formatCurrency(cur.totalDiscounts),\n        rawValue: cur.totalDiscounts,\n        change: calcGrowth(cur.totalDiscounts, prev.totalDiscounts).rate,\n        changeDetails: calcGrowth(cur.totalDiscounts, prev.totalDiscounts),\n        previousValue: formatCurrency(prev.totalDiscounts),\n        previousRawValue: prev.totalDiscounts,\n        periodLabel,\n        icon: 'DollarSign',\n        description: 'Total amount discounted this month',\n      },\n      {\n        title: 'Discount Rate',\n        value: formatPercentage(cur.discountRate),\n        rawValue: cur.discountRate,\n        change: calcGrowth(cur.discountRate, prev.discountRate).rate,\n        changeDetails: calcGrowth(cur.discountRate, prev.discountRate),\n        previousValue: formatPercentage(prev.discountRate),\n        previousRawValue: prev.discountRate,\n        periodLabel,\n        icon: 'Percent',\n        description: 'Discounts as % of gross (pre-discount) revenue',\n      },\n      {\n        title: 'Transactions with Discounts',\n        value: formatNumber(cur.discountedTransactions),\n        rawValue: cur.discountedTransactions,\n        change: calcGrowth(cur.discountedTransactions, prev.discountedTransactions).rate,\n        changeDetails: calcGrowth(cur.discountedTransactions, prev.discountedTransactions),\n        previousValue: formatNumber(prev.discountedTransactions),\n        previousRawValue: prev.discountedTransactions,\n        periodLabel,\n        icon: 'ShoppingCart',\n        description: 'Number of transactions where a discount was applied',\n      },\n      {\n        title: 'Customers with Discounts',\n        value: formatNumber(cur.customersWithDiscounts),\n        rawValue: cur.customersWithDiscounts,\n        change: calcGrowth(cur.customersWithDiscounts, prev.customersWithDiscounts).rate,\n        changeDetails: calcGrowth(cur.customersWithDiscounts, prev.customersWithDiscounts),\n        previousValue: formatNumber(prev.customersWithDiscounts),\n        previousRawValue: prev.customersWithDiscounts,\n        periodLabel,\n        icon: 'Users',\n        description: 'Unique customers receiving discounts',\n      },\n      {\n        title: 'Avg Discount per Transaction',\n        value: formatCurrency(cur.avgDiscountPerTransaction),\n        rawValue: cur.avgDiscountPerTransaction,\n        change: calcGrowth(cur.avgDiscountPerTransaction, prev.avgDiscountPerTransaction).rate,\n        changeDetails: calcGrowth(cur.avgDiscountPerTransaction, prev.avgDiscountPerTransaction),\n        previousValue: formatCurrency(prev.avgDiscountPerTransaction),\n        previousRawValue: prev.avgDiscountPerTransaction,\n        periodLabel,\n        icon: 'Target',\n        description: 'Average discount per discounted transaction',\n      },\n      {\n        title: 'Avg Discount per Customer',\n        value: formatCurrency(cur.avgDiscountPerCustomer),\n        rawValue: cur.avgDiscountPerCustomer,\n        change: calcGrowth(cur.avgDiscountPerCustomer, prev.avgDiscountPerCustomer).rate,\n        changeDetails: calcGrowth(cur.avgDiscountPerCustomer, prev.avgDiscountPerCustomer),\n        previousValue: formatCurrency(prev.avgDiscountPerCustomer),\n        previousRawValue: prev.avgDiscountPerCustomer,\n        periodLabel,\n        icon: 'Activity',\n        description: 'Average discount per customer receiving discounts',\n      },\n      {\n        title: 'Discount Penetration',\n        value: formatPercentage(cur.discountPenetration),\n        rawValue: cur.discountPenetration,\n        change: calcGrowth(cur.discountPenetration, prev.discountPenetration).rate,\n        changeDetails: calcGrowth(cur.discountPenetration, prev.discountPenetration),\n        previousValue: formatPercentage(prev.discountPenetration),\n        previousRawValue: prev.discountPenetration,\n        periodLabel,\n        icon: 'PieChart',\n        description: 'Percentage of transactions that received discounts',\n      },\n      {\n        title: 'Customer Discount Rate',\n        value: formatPercentage(cur.customerDiscountPenetration),\n        rawValue: cur.customerDiscountPenetration,\n        change: calcGrowth(cur.customerDiscountPenetration, prev.customerDiscountPenetration || 0).rate,\n        changeDetails: calcGrowth(cur.customerDiscountPenetration, prev.customerDiscountPenetration || 0),\n        previousValue: formatPercentage(prev.customerDiscountPenetration || 0),\n        previousRawValue: prev.customerDiscountPenetration || 0,\n        periodLabel,\n        icon: 'UserCheck',\n        description: 'Percentage of unique customers who received discounts',\n      },\n    ];\n\n    return { metrics: m };\n  }, [data, historicalData, options?.dateRange?.start, options?.dateRange?.end]);\n}\n","import React, { useMemo } from 'react';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { TrendingUp, TrendingDown, Percent, ShoppingCart, CreditCard, DollarSign, Target, Activity, Users, ArrowUpRight, ArrowDownRight } from 'lucide-react';\nimport { SalesData } from '@/types/dashboard';\nimport { formatCurrency, formatNumber, formatPercentage } from '@/utils/formatters';\nimport { cn } from '@/lib/utils';\nimport { useDiscountMetrics } from '@/hooks/useDiscountMetrics';\n\ninterface DiscountsAnimatedMetricCardsProps {\n  data: SalesData[];\n  historicalData?: SalesData[];\n  dateRange?: { start?: string | Date; end?: string | Date };\n  onMetricClick?: (metricData: any) => void;\n}\n\nconst iconMap: Record<string, any> = {\n  DollarSign,\n  ShoppingCart,\n  Activity,\n  Users,\n  Target,\n  Percent,\n  CreditCard,\n  ArrowDownRight\n};\n\nexport const DiscountsAnimatedMetricCards: React.FC<DiscountsAnimatedMetricCardsProps> = ({ \n  data,\n  historicalData,\n  dateRange,\n  onMetricClick \n}) => {\n  const { metrics } = useDiscountMetrics(data, historicalData, { dateRange });\n\n  // Debug logging removed for production\n\n  // For drill down context, compute some derived totals from current period subset of data\n  // Note: Show ALL transactions, not just discounted ones - useful for seeing full sales picture even if no discounts\n  const calculatedContext = useMemo(() => {\n    const totalDiscounts = data.reduce((sum, item) => sum + (item.discountAmount || 0), 0);\n    const totalRevenue = data.reduce((sum, item) => sum + (item.paymentValue || 0), 0);\n    const totalTransactions = data.length;\n    const discountedTransactions = data.filter(item => (item.discountAmount || 0) > 0).length;\n    const uniqueCustomers = new Set(data.map(item => item.memberId || item.customerEmail)).size;\n    const customersWithDiscounts = new Set(\n      data.filter(item => (item.discountAmount || 0) > 0)\n          .map(item => item.memberId || item.customerEmail)\n    ).size;\n    const discountPenetration = totalTransactions > 0 ? (discountedTransactions / totalTransactions) * 100 : 0;\n    const discountRate = totalRevenue + totalDiscounts > 0 ? (totalDiscounts / (totalRevenue + totalDiscounts)) * 100 : 0;\n    \n    // Debug: log removed for production\n    \n    return { totalDiscounts, totalRevenue, totalTransactions, discountedTransactions, uniqueCustomers, customersWithDiscounts, discountPenetration, discountRate };\n  }, [data]);\n\n  const { totalRevenue, totalDiscounts, totalTransactions, discountedTransactions, uniqueCustomers, customersWithDiscounts, discountPenetration, discountRate } = calculatedContext;\n\n  const handleMetricClick = (metric: any) => {\n    if (onMetricClick) {\n      const drillDownData = {\n        title: metric.title,\n        name: metric.title,\n        type: 'metric',\n        totalRevenue,\n        totalDiscounts,\n        transactions: totalTransactions,\n        discountedTransactions,\n        uniqueCustomers,\n        customersWithDiscounts,\n        discountRate,\n        discountPenetration,\n        rawData: data,\n        filteredTransactionData: data,\n        isDynamic: true,\n        calculatedFromFiltered: true\n      };\n      \n      onMetricClick(drillDownData);\n    }\n  };\n\n  return (\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n      {metrics.map((metric, index) => {\n        const IconComponent = iconMap[metric.icon as keyof typeof iconMap] || DollarSign;\n        const isPositive = metric.change > 0;\n        const isNegative = metric.change < 0;\n        \n        return (\n          <Card \n            key={metric.title}\n            className={cn(\n              \"group relative overflow-hidden cursor-pointer transition-all duration-700\",\n              \"bg-white hover:bg-gradient-to-br hover:from-gray-900 hover:via-slate-900 hover:to-slate-900\",\n              index % 4 === 0 && \"border-t-4 border-indigo-700 hover:border-indigo-700 shadow-lg\",\n              index % 4 === 1 && \"border-t-4 border-purple-700 hover:border-purple-700 shadow-lg\",\n              index % 4 === 2 && \"border-t-4 border-blue-700 hover:border-blue-700 shadow-lg\", \n              index % 4 === 3 && \"border-t-4 border-violet-700 hover:border-violet-700 shadow-lg\",\n              \"hover:shadow-2xl hover:shadow-slate-900/30\",\n              \"hover:-translate-y-2 hover:scale-[1.02]\",\n              onMetricClick && \"hover:cursor-pointer\"\n            )}\n            onClick={() => handleMetricClick(metric)}\n          >\n            <CardContent className=\"p-6 relative\">\n              <div className=\"absolute top-4 right-4 opacity-10 group-hover:opacity-20 transition-all duration-700\">\n                <IconComponent className={cn(\n                  \"w-12 h-12 transition-all duration-700\",\n                  index % 4 === 0 && \"text-indigo-700\",\n                  index % 4 === 1 && \"text-purple-700\",\n                  index % 4 === 2 && \"text-blue-700\",\n                  index % 4 === 3 && \"text-violet-700\",\n                  \"group-hover:text-white/40\"\n                )} />\n              </div>\n              \n              <div className=\"relative z-10\">\n                <div className=\"flex items-center justify-between mb-4\">\n                  <div className=\"flex items-center gap-6\">\n                    <div className={cn(\n                      \"p-4 rounded-2xl transition-all duration-700 border-1 shadow-md\",\n                      index % 4 === 0 && \"bg-gradient-to-br from-indigo-700 to-indigo-600 border-indigo-900 text-white shadow-indigo-200\",\n                      index % 4 === 1 && \"bg-gradient-to-br from-purple-700 to-purple-600 border-purple-900 text-white shadow-purple-200\",\n                      index % 4 === 2 && \"bg-gradient-to-br from-blue-700 to-blue-600 border-blue-900 text-white shadow-blue-200\",\n                      index % 4 === 3 && \"bg-gradient-to-br from-violet-700 to-violet-600 border-violet-900 text-white shadow-violet-200\",\n                      \"group-hover:bg-white/20 group-hover:border-white/40 group-hover:text-white group-hover:shadow-white/20\"\n                    )}>\n                      <IconComponent className=\"w-6 h-6 drop-shadow-sm\" />\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <h3 className=\"font-semibold text-lg text-slate-900 group-hover:text-white/95 transition-colors duration-700\">\n                        {metric.title}\n                      </h3>\n                    </div>\n                  </div>\n                  \n                  <div className={cn(\n                    \"flex items-center space-x-1 px-3 py-1 rounded-full text-xs font-semibold transition-all duration-700\",\n                    isPositive\n                      ? \"bg-green-50 text-green-700 group-hover:bg-green-400/30 group-hover:text-green-100\"\n                      : isNegative\n                      ? \"bg-red-50 text-red-700 group-hover:bg-red-400/30 group-hover:text-red-100\"\n                      : \"bg-blue-50 text-blue-700 group-hover:bg-blue-400/30 group-hover:text-blue-100\"\n                  )}>\n                    {isPositive && <TrendingUp className=\"w-3 h-3\" />}\n                    {isNegative && <TrendingDown className=\"w-3 h-3\" />}\n                    <span>\n                      {metric.change > 0 ? '+' : ''}{metric.change.toFixed(1)}%\n                    </span>\n                  </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                  <p className={cn(\n                    \"text-4xl font-bold transition-all duration-700 text-slate-900 group-hover:text-white\"\n                  )}>\n                    {metric.value}\n                  </p>\n                  <p className={cn(\n                    \"text-xs text-slate-500 group-hover:text-slate-200 transition-colors\"\n                  )}>\n                    {metric.periodLabel ? (\n                      <>\n                        {metric.periodLabel}: <span className=\"font-medium\">{metric.previousValue}</span>\n                      </>\n                    ) : (\n                      <>vs previous month: <span className=\"font-medium\">{metric.previousValue}</span></>\n                    )}\n                  </p>\n                </div>\n              </div>\n              \n              <div className={cn(\n                \"mt-4 p-3 border-t border-l-4 transition-all duration-700\",\n                \"bg-slate-50 group-hover:bg-slate-800/50 border-t-slate-200 group-hover:border-t-white/10\",\n                index % 4 === 0 && \"border-l-indigo-700\",\n                index % 4 === 1 && \"border-l-purple-700\",\n                index % 4 === 2 && \"border-l-blue-700\",\n                index % 4 === 3 && \"border-l-violet-700\"\n              )}>\n                <p className=\"text-xs text-slate-900 group-hover:text-white transition-colors duration-700\">\n                  {metric.description}\n                </p>\n              </div>\n            </CardContent>\n          </Card>\n        );\n      })}\n    </div>\n  );\n};","\nimport React, { useMemo, useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, LineChart, Line, PieChart, Pie, Cell, ScatterChart, Scatter } from 'recharts';\nimport { TrendingUp, BarChart3, PieChart as PieChartIcon, Activity, Calendar, Package } from 'lucide-react';\nimport { SalesData } from '@/types/dashboard';\nimport { formatCurrency, formatNumber } from '@/utils/formatters';\n\ninterface DiscountInteractiveChartsProps {\n  data: SalesData[];\n  filters?: any;\n}\n\nconst COLORS = ['#8b5cf6', '#06b6d4', '#10b981', '#f59e0b', '#ef4444', '#6366f1', '#ec4899', '#84cc16'];\n\nexport const DiscountInteractiveCharts: React.FC<DiscountInteractiveChartsProps> = ({ data, filters }) => {\n  const [activeChart, setActiveChart] = useState('trends');\n\n  const chartData = useMemo(() => {\n    let filteredData = data.filter(item => (item.discountAmount || 0) > 0);\n\n    // Apply filters\n    if (filters) {\n      filteredData = filteredData.filter(item => {\n        if (filters.location && item.calculatedLocation !== filters.location) return false;\n        if (filters.category && item.cleanedCategory !== filters.category) return false;\n        if (filters.product && item.cleanedProduct !== filters.product) return false;\n        if (filters.soldBy && (item.soldBy === '-' ? 'Online/System' : item.soldBy) !== filters.soldBy) return false;\n        if (filters.paymentMethod && item.paymentMethod !== filters.paymentMethod) return false;\n        if (filters.minDiscountAmount && (item.discountAmount || 0) < filters.minDiscountAmount) return false;\n        if (filters.maxDiscountAmount && (item.discountAmount || 0) > filters.maxDiscountAmount) return false;\n        if (filters.minDiscountPercent && (item.discountPercentage || 0) < filters.minDiscountPercent) return false;\n        if (filters.maxDiscountPercent && (item.discountPercentage || 0) > filters.maxDiscountPercent) return false;\n        if (filters.dateRange?.from || filters.dateRange?.to) {\n          const itemDate = new Date(item.paymentDate);\n          if (filters.dateRange.from && itemDate < filters.dateRange.from) return false;\n          if (filters.dateRange.to && itemDate > filters.dateRange.to) return false;\n        }\n        return true;\n      });\n    }\n\n    // Monthly trends\n    const monthlyData = filteredData.reduce((acc, item) => {\n      const date = new Date(item.paymentDate);\n      const monthKey = `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}`;\n      \n      if (!acc[monthKey]) {\n        acc[monthKey] = {\n          month: monthKey,\n          transactions: 0,\n          totalDiscount: 0,\n          totalRevenue: 0,\n          avgDiscount: 0\n        };\n      }\n      \n      acc[monthKey].transactions += 1;\n      acc[monthKey].totalDiscount += item.discountAmount || 0;\n      acc[monthKey].totalRevenue += item.paymentValue || 0;\n      \n      return acc;\n    }, {} as Record<string, any>);\n\n    const monthlyTrends = Object.values(monthlyData)\n      .map((item: any) => ({\n        ...item,\n        avgDiscount: item.transactions > 0 ? item.totalDiscount / item.transactions : 0,\n        discountRate: item.totalRevenue > 0 ? (item.totalDiscount / (item.totalRevenue + item.totalDiscount)) * 100 : 0\n      }))\n      .sort((a, b) => a.month.localeCompare(b.month));\n\n    // Category distribution\n    const categoryData = filteredData.reduce((acc, item) => {\n      const category = item.cleanedCategory || 'Unknown';\n      if (!acc[category]) {\n        acc[category] = {\n          name: category,\n          value: 0,\n          transactions: 0\n        };\n      }\n      acc[category].value += item.discountAmount || 0;\n      acc[category].transactions += 1;\n      return acc;\n    }, {} as Record<string, any>);\n\n    const categoryDistribution = Object.values(categoryData)\n      .sort((a: any, b: any) => b.value - a.value)\n      .slice(0, 8);\n\n    // Discount range analysis\n    const discountRanges = [\n      { min: 0, max: 100, label: '0-100' },\n      { min: 100, max: 500, label: '100-500' },\n      { min: 500, max: 1000, label: '500-1K' },\n      { min: 1000, max: 2500, label: '1K-2.5K' },\n      { min: 2500, max: 5000, label: '2.5K-5K' },\n      { min: 5000, max: Infinity, label: '5K+' }\n    ];\n\n    const rangeAnalysis = discountRanges.map(range => {\n      const itemsInRange = filteredData.filter(item => {\n        const discount = item.discountAmount || 0;\n        return discount >= range.min && discount < range.max;\n      });\n\n      return {\n        range: range.label,\n        transactions: itemsInRange.length,\n        totalDiscount: itemsInRange.reduce((sum, item) => sum + (item.discountAmount || 0), 0),\n        avgDiscount: itemsInRange.length > 0 ? itemsInRange.reduce((sum, item) => sum + (item.discountAmount || 0), 0) / itemsInRange.length : 0,\n        totalRevenue: itemsInRange.reduce((sum, item) => sum + (item.paymentValue || 0), 0)\n      };\n    });\n\n    // Scatter plot data\n    const scatterData = filteredData\n      .slice(0, 200)\n      .map(item => ({\n        discountAmount: item.discountAmount || 0,\n        discountPercent: item.discountPercentage || 0,\n        revenue: item.paymentValue || 0,\n        category: item.cleanedCategory || 'Unknown'\n      }));\n\n    return {\n      monthlyTrends,\n      categoryDistribution,\n      rangeAnalysis,\n      scatterData\n    };\n  }, [data, filters]);\n\n  return (\n    <div className=\"space-y-6\">\n      <Tabs value={activeChart} onValueChange={setActiveChart} className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-4 bg-white border border-slate-200 p-1 rounded-xl shadow-sm h-auto\">\n          <TabsTrigger value=\"trends\" className=\"text-sm px-4 py-3 data-[state=active]:bg-blue-600 data-[state=active]:text-white\">\n            <Calendar className=\"w-4 h-4 mr-2\" />\n            Trends\n          </TabsTrigger>\n          <TabsTrigger value=\"distribution\" className=\"text-sm px-4 py-3 data-[state=active]:bg-purple-600 data-[state=active]:text-white\">\n            <PieChartIcon className=\"w-4 h-4 mr-2\" />\n            Distribution\n          </TabsTrigger>\n          <TabsTrigger value=\"ranges\" className=\"text-sm px-4 py-3 data-[state=active]:bg-green-600 data-[state=active]:text-white\">\n            <BarChart3 className=\"w-4 h-4 mr-2\" />\n            Ranges\n          </TabsTrigger>\n          <TabsTrigger value=\"correlation\" className=\"text-sm px-4 py-3 data-[state=active]:bg-orange-600 data-[state=active]:text-white\">\n            <Activity className=\"w-4 h-4 mr-2\" />\n            Correlation\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"trends\" className=\"space-y-6\">\n          <Card className=\"bg-gradient-to-br from-white via-blue-50/30 to-indigo-50/20 border-0 shadow-xl\">\n            <CardHeader>\n              <CardTitle className=\"text-xl font-bold bg-gradient-to-r from-blue-700 to-indigo-700 bg-clip-text text-transparent flex items-center gap-2\">\n                <Calendar className=\"w-6 h-6 text-blue-600\" />\n                Monthly Discount Trends\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={400}>\n                <LineChart data={chartData.monthlyTrends}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"month\" />\n                  <YAxis yAxisId=\"left\" tickFormatter={(value) => formatCurrency(value)} />\n                  <YAxis yAxisId=\"right\" orientation=\"right\" tickFormatter={(value) => `${value}%`} />\n                  <Tooltip \n                    formatter={(value, name) => [\n                      name === 'discountRate' ? `${(value as number).toFixed(1)}%` : formatCurrency(value as number),\n                      name === 'totalDiscount' ? 'Total Discount' : \n                      name === 'totalRevenue' ? 'Revenue' : 'Discount Rate'\n                    ]}\n                  />\n                  <Legend />\n                  <Bar yAxisId=\"left\" dataKey=\"totalDiscount\" fill=\"#3b82f6\" name=\"Total Discount\" />\n                  <Line yAxisId=\"right\" type=\"monotone\" dataKey=\"discountRate\" stroke=\"#ef4444\" strokeWidth={3} name=\"Discount Rate %\" />\n                </LineChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"distribution\" className=\"space-y-6\">\n          <Card className=\"bg-gradient-to-br from-white via-purple-50/30 to-violet-50/20 border-0 shadow-xl\">\n            <CardHeader>\n              <CardTitle className=\"text-xl font-bold bg-gradient-to-r from-purple-700 to-violet-700 bg-clip-text text-transparent flex items-center gap-2\">\n                <PieChartIcon className=\"w-6 h-6 text-purple-600\" />\n                Discount Distribution by Category\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={400}>\n                <PieChart>\n                  <Pie\n                    data={chartData.categoryDistribution}\n                    cx=\"50%\"\n                    cy=\"50%\"\n                    labelLine={false}\n                    label={({ name, value }) => `${name}: ${formatCurrency(value)}`}\n                    outerRadius={120}\n                    fill=\"#8884d8\"\n                    dataKey=\"value\"\n                  >\n                    {chartData.categoryDistribution.map((entry, index) => (\n                      <Cell key={`cell-${index}`} fill={COLORS[index % COLORS.length]} />\n                    ))}\n                  </Pie>\n                  <Tooltip formatter={(value) => formatCurrency(value as number)} />\n                </PieChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"ranges\" className=\"space-y-6\">\n          <Card className=\"bg-gradient-to-br from-white via-green-50/30 to-emerald-50/20 border-0 shadow-xl\">\n            <CardHeader>\n              <CardTitle className=\"text-xl font-bold bg-gradient-to-r from-green-700 to-emerald-700 bg-clip-text text-transparent flex items-center gap-2\">\n                <BarChart3 className=\"w-6 h-6 text-green-600\" />\n                Discount Range Analysis\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={400}>\n                <BarChart data={chartData.rangeAnalysis}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis dataKey=\"range\" />\n                  <YAxis tickFormatter={(value) => formatCurrency(value)} />\n                  <Tooltip \n                    formatter={(value, name) => [\n                      formatCurrency(value as number),\n                      name === 'totalDiscount' ? 'Total Discount' : 'Average Discount'\n                    ]}\n                  />\n                  <Legend />\n                  <Bar dataKey=\"totalDiscount\" fill=\"#10b981\" name=\"Total Discount\" />\n                  <Bar dataKey=\"avgDiscount\" fill=\"#06b6d4\" name=\"Average Discount\" />\n                </BarChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"correlation\" className=\"space-y-6\">\n          <Card className=\"bg-gradient-to-br from-white via-orange-50/30 to-amber-50/20 border-0 shadow-xl\">\n            <CardHeader>\n              <CardTitle className=\"text-xl font-bold bg-gradient-to-r from-orange-700 to-amber-700 bg-clip-text text-transparent flex items-center gap-2\">\n                <Activity className=\"w-6 h-6 text-orange-600\" />\n                Discount Amount vs Percentage Correlation\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <ResponsiveContainer width=\"100%\" height={400}>\n                <ScatterChart data={chartData.scatterData}>\n                  <CartesianGrid strokeDasharray=\"3 3\" />\n                  <XAxis \n                    dataKey=\"discountPercent\" \n                    name=\"Discount %\" \n                    tickFormatter={(value) => `${value}%`}\n                  />\n                  <YAxis \n                    dataKey=\"discountAmount\" \n                    name=\"Discount Amount\"\n                    tickFormatter={(value) => formatCurrency(value)}\n                  />\n                  <Tooltip \n                    formatter={(value, name) => [\n                      name === 'discountPercent' ? `${value}%` : formatCurrency(value as number),\n                      name === 'discountPercent' ? 'Discount %' : 'Discount Amount'\n                    ]}\n                  />\n                  <Scatter dataKey=\"discountAmount\" fill=\"#f59e0b\" />\n                </ScatterChart>\n              </ResponsiveContainer>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n};\n","\nimport React, { useMemo, useState } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { SalesData } from '@/types/dashboard';\nimport { formatCurrency, formatNumber } from '@/utils/formatters';\nimport { TrendingUp, TrendingDown, Users, Package, CreditCard, User, ArrowUpDown, Crown, Target } from 'lucide-react';\n\ninterface DiscountInteractiveTopBottomListsProps {\n  data: SalesData[];\n  filters?: any;\n  onDrillDown?: (title: string, data: any[], type: string) => void;\n}\n\nexport const DiscountInteractiveTopBottomLists: React.FC<DiscountInteractiveTopBottomListsProps> = ({ \n  data, \n  filters,\n  onDrillDown \n}) => {\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('desc');\n\n  const processedData = useMemo(() => {\n    // Group by different dimensions\n    const byCategory = data.reduce((acc, item) => {\n      const key = item.cleanedCategory || 'Unknown';\n      if (!acc[key]) acc[key] = { totalDiscount: 0, count: 0, totalRevenue: 0, avgPercent: 0 };\n      acc[key].totalDiscount += item.discountAmount || 0;\n      acc[key].count += 1;\n      acc[key].totalRevenue += item.paymentValue || 0;\n      acc[key].avgPercent += item.discountPercentage || 0;\n      return acc;\n    }, {} as Record<string, any>);\n\n    const byProduct = data.reduce((acc, item) => {\n      const key = item.cleanedProduct || 'Unknown';\n      if (!acc[key]) acc[key] = { totalDiscount: 0, count: 0, totalRevenue: 0, avgPercent: 0 };\n      acc[key].totalDiscount += item.discountAmount || 0;\n      acc[key].count += 1;\n      acc[key].totalRevenue += item.paymentValue || 0;\n      acc[key].avgPercent += item.discountPercentage || 0;\n      return acc;\n    }, {} as Record<string, any>);\n\n    const bySoldBy = data.reduce((acc, item) => {\n      const key = item.soldBy === '-' ? 'Online/System' : item.soldBy;\n      if (!acc[key]) acc[key] = { totalDiscount: 0, count: 0, totalRevenue: 0, avgPercent: 0 };\n      acc[key].totalDiscount += item.discountAmount || 0;\n      acc[key].count += 1;\n      acc[key].totalRevenue += item.paymentValue || 0;\n      acc[key].avgPercent += item.discountPercentage || 0;\n      return acc;\n    }, {} as Record<string, any>);\n\n    const byPaymentMethod = data.reduce((acc, item) => {\n      const key = item.paymentMethod || 'Unknown';\n      if (!acc[key]) acc[key] = { totalDiscount: 0, count: 0, totalRevenue: 0, avgPercent: 0 };\n      acc[key].totalDiscount += item.discountAmount || 0;\n      acc[key].count += 1;\n      acc[key].totalRevenue += item.paymentValue || 0;\n      acc[key].avgPercent += item.discountPercentage || 0;\n      return acc;\n    }, {} as Record<string, any>);\n\n    // Convert to arrays and calculate averages\n    const processArray = (obj: Record<string, any>) => {\n      return Object.entries(obj).map(([name, data]) => ({\n        name,\n        totalDiscount: data.totalDiscount,\n        count: data.count,\n        totalRevenue: data.totalRevenue,\n        avgPercent: data.count > 0 ? data.avgPercent / data.count : 0,\n        avgDiscount: data.count > 0 ? data.totalDiscount / data.count : 0\n      })).sort((a, b) => sortOrder === 'desc' ? b.totalDiscount - a.totalDiscount : a.totalDiscount - b.totalDiscount);\n    };\n\n    return {\n      categories: processArray(byCategory),\n      products: processArray(byProduct),\n      soldBy: processArray(bySoldBy),\n      paymentMethods: processArray(byPaymentMethod)\n    };\n  }, [data, sortOrder]);\n\n  const renderTopBottomList = (items: any[], icon: React.ReactNode, title: string, type: string) => {\n    const topItems = items.slice(0, 5);\n    const bottomItems = items.slice(-5).reverse();\n    \n    return (\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Top Performers */}\n        <Card className=\"bg-gradient-to-br from-white via-green-50/30 to-emerald-50/20 border-0 shadow-lg\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-lg font-bold text-slate-800 flex items-center gap-2\">\n              <Crown className=\"w-5 h-5 text-yellow-600\" />\n              Top {title} by Discount\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setSortOrder(sortOrder === 'desc' ? 'asc' : 'desc')}\n                className=\"ml-auto\"\n              >\n                <ArrowUpDown className=\"w-4 h-4\" />\n              </Button>\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            {topItems.map((item, index) => (\n              <div \n                key={item.name} \n                className=\"flex items-center justify-between p-4 bg-white/60 rounded-lg hover:bg-white/80 transition-all duration-300 cursor-pointer hover:scale-102 group\"\n                onClick={() => onDrillDown?.(\n                  `${item.name} - Discount Details`, \n                  data.filter(d => (type === 'category' ? d.cleanedCategory : \n                                   type === 'product' ? d.cleanedProduct :\n                                   type === 'soldBy' ? (d.soldBy === '-' ? 'Online/System' : d.soldBy) :\n                                   d.paymentMethod) === item.name),\n                  type\n                )}\n              >\n                <div className=\"flex items-center gap-3\">\n                  <div className={`w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-sm ${\n                    index === 0 ? 'bg-gradient-to-r from-yellow-500 to-amber-500' :\n                    index === 1 ? 'bg-gradient-to-r from-gray-400 to-gray-500' :\n                    index === 2 ? 'bg-gradient-to-r from-orange-500 to-amber-600' :\n                    'bg-gradient-to-r from-blue-500 to-purple-600'\n                  }`}>\n                    #{index + 1}\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"font-medium text-sm text-slate-800 truncate group-hover:text-slate-900\">\n                      {item.name}\n                    </p>\n                    <div className=\"flex items-center gap-4 text-xs text-slate-600\">\n                      <span>{formatNumber(item.count)} transactions</span>\n                      <Badge variant=\"outline\" className=\"text-xs bg-green-50 text-green-700 border-green-200\">\n                        {item.avgPercent.toFixed(1)}% avg\n                      </Badge>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"text-right space-y-1\">\n                  <div className=\"font-bold text-red-600 text-sm\">\n                    {formatCurrency(item.totalDiscount)}\n                  </div>\n                  <div className=\"text-xs text-slate-500\">\n                    {formatCurrency(item.avgDiscount)}/txn\n                  </div>\n                </div>\n              </div>\n            ))}\n          </CardContent>\n        </Card>\n\n        {/* Bottom Performers */}\n        <Card className=\"bg-gradient-to-br from-white via-blue-50/30 to-indigo-50/20 border-0 shadow-lg\">\n          <CardHeader className=\"pb-3\">\n            <CardTitle className=\"text-lg font-bold text-slate-800 flex items-center gap-2\">\n              <Target className=\"w-5 h-5 text-blue-600\" />\n              Lowest {title} by Discount\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            {bottomItems.map((item, index) => (\n              <div \n                key={item.name} \n                className=\"flex items-center justify-between p-4 bg-white/60 rounded-lg hover:bg-white/80 transition-all duration-300 cursor-pointer hover:scale-102 group\"\n                onClick={() => onDrillDown?.(\n                  `${item.name} - Discount Details`, \n                  data.filter(d => (type === 'category' ? d.cleanedCategory : \n                                   type === 'product' ? d.cleanedProduct :\n                                   type === 'soldBy' ? (d.soldBy === '-' ? 'Online/System' : d.soldBy) :\n                                   d.paymentMethod) === item.name),\n                  type\n                )}\n              >\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"w-10 h-10 bg-gradient-to-r from-slate-500 to-gray-600 rounded-full flex items-center justify-center text-white font-bold text-sm\">\n                    #{bottomItems.length - index}\n                  </div>\n                  <div className=\"flex-1\">\n                    <p className=\"font-medium text-sm text-slate-800 truncate group-hover:text-slate-900\">\n                      {item.name}\n                    </p>\n                    <div className=\"flex items-center gap-4 text-xs text-slate-600\">\n                      <span>{formatNumber(item.count)} transactions</span>\n                      <Badge variant=\"outline\" className=\"text-xs bg-blue-50 text-blue-700 border-blue-200\">\n                        {item.avgPercent.toFixed(1)}% avg\n                      </Badge>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"text-right space-y-1\">\n                  <div className=\"font-bold text-blue-600 text-sm\">\n                    {formatCurrency(item.totalDiscount)}\n                  </div>\n                  <div className=\"text-xs text-slate-500\">\n                    {formatCurrency(item.avgDiscount)}/txn\n                  </div>\n                </div>\n              </div>\n            ))}\n          </CardContent>\n        </Card>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"space-y-8\">\n      <div className=\"flex items-center justify-between\">\n        <h2 className=\"text-2xl font-bold text-slate-800\">Top & Bottom Performers</h2>\n        <Badge variant=\"outline\" className=\"text-sm\">\n          {formatNumber(data.length)} total discounted transactions\n        </Badge>\n      </div>\n      \n      <Tabs defaultValue=\"categories\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-4 mb-6 bg-white shadow-sm\">\n          <TabsTrigger value=\"categories\" className=\"flex items-center gap-2\">\n            <Package className=\"w-4 h-4\" />\n            Categories\n          </TabsTrigger>\n          <TabsTrigger value=\"products\" className=\"flex items-center gap-2\">\n            <Package className=\"w-4 h-4\" />\n            Products\n          </TabsTrigger>\n          <TabsTrigger value=\"soldBy\" className=\"flex items-center gap-2\">\n            <User className=\"w-4 h-4\" />\n            Sold By\n          </TabsTrigger>\n          <TabsTrigger value=\"payment\" className=\"flex items-center gap-2\">\n            <CreditCard className=\"w-4 h-4\" />\n            Payment Method\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"categories\">\n          {renderTopBottomList(processedData.categories, <Package className=\"w-5 h-5\" />, \"Categories\", \"category\")}\n        </TabsContent>\n\n        <TabsContent value=\"products\">\n          {renderTopBottomList(processedData.products, <Package className=\"w-5 h-5\" />, \"Products\", \"product\")}\n        </TabsContent>\n\n        <TabsContent value=\"soldBy\">\n          {renderTopBottomList(processedData.soldBy, <User className=\"w-5 h-5\" />, \"Staff\", \"soldBy\")}\n        </TabsContent>\n\n        <TabsContent value=\"payment\">\n          {renderTopBottomList(processedData.paymentMethods, <CreditCard className=\"w-5 h-5\" />, \"Payment Methods\", \"paymentMethod\")}\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n};\n","import React, { useState, useMemo, useRef, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Badge } from '@/components/ui/badge';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow, TableFooter } from '@/components/ui/table';\nimport { Search, Download, Filter, TrendingUp, TrendingDown, Percent, DollarSign, Eye } from 'lucide-react';\nimport { formatCurrency, formatNumber, formatPercentage } from '@/utils/formatters';\nimport { SalesData } from '@/types/dashboard';\nimport { PersistentTableFooter } from '@/components/dashboard/PersistentTableFooter';\nimport CopyTableButton from '@/components/ui/CopyTableButton';\nimport { useMetricsTablesRegistry } from '@/contexts/MetricsTablesRegistryContext';\nimport { useGlobalFilters } from '@/contexts/GlobalFiltersContext';\ninterface EnhancedDiscountDataTableProps {\n  data: SalesData[];\n  onRowClick?: (title: string, data: any[], type: string) => void;\n}\nexport const EnhancedDiscountDataTable: React.FC<EnhancedDiscountDataTableProps> = ({\n  data,\n  onRowClick\n}) => {\n  const { filters } = useGlobalFilters();\n  const periodId = `${filters.dateRange.start}:${filters.dateRange.end}`;\n  const [searchTerm, setSearchTerm] = useState('');\n  const [sortColumn, setSortColumn] = useState<string>('paymentDate');\n  const [sortDirection, setSortDirection] = useState<'asc' | 'desc'>('desc');\n  const [currentPage, setCurrentPage] = useState(1);\n  const itemsPerPage = 50;\n\n  // Filter and sort data\n  const filteredAndSortedData = useMemo(() => {\n    let filtered = data.filter(item => {\n      const searchLower = searchTerm.toLowerCase();\n      return item.customerName?.toLowerCase().includes(searchLower) || item.customerEmail?.toLowerCase().includes(searchLower) || item.cleanedProduct?.toLowerCase().includes(searchLower) || item.cleanedCategory?.toLowerCase().includes(searchLower) || item.calculatedLocation?.toLowerCase().includes(searchLower) || item.soldBy?.toLowerCase().includes(searchLower);\n    });\n\n    // Sort data\n    filtered.sort((a, b) => {\n      let aValue = a[sortColumn as keyof SalesData];\n      let bValue = b[sortColumn as keyof SalesData];\n\n      // Handle numeric values\n      if (typeof aValue === 'number' && typeof bValue === 'number') {\n        return sortDirection === 'asc' ? aValue - bValue : bValue - aValue;\n      }\n\n      // Handle string values\n      if (typeof aValue === 'string' && typeof bValue === 'string') {\n        return sortDirection === 'asc' ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);\n      }\n      return 0;\n    });\n    return filtered;\n  }, [data, searchTerm, sortColumn, sortDirection]);\n\n  // Pagination\n  const totalPages = Math.ceil(filteredAndSortedData.length / itemsPerPage);\n  const paginatedData = filteredAndSortedData.slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage);\n\n  // Calculate summary statistics\n  const summaryStats = useMemo(() => {\n    const totalDiscount = filteredAndSortedData.reduce((sum, item) => sum + (item.discountAmount || 0), 0);\n    const totalRevenue = filteredAndSortedData.reduce((sum, item) => sum + (item.paymentValue || 0), 0);\n    const totalMrp = filteredAndSortedData.reduce((sum, item) => sum + (item.mrpPostTax || 0), 0);\n    const avgDiscountPercentage = filteredAndSortedData.length > 0 ? filteredAndSortedData.reduce((sum, item) => sum + (item.discountPercentage || 0), 0) / filteredAndSortedData.length : 0;\n    return {\n      totalDiscount,\n      totalRevenue,\n      totalMrp,\n      avgDiscountPercentage,\n      totalTransactions: filteredAndSortedData.length\n    };\n  }, [filteredAndSortedData]);\n  const handleSort = (column: string) => {\n    if (sortColumn === column) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortColumn(column);\n      setSortDirection('desc');\n    }\n  };\n  const handleRowClick = (item: SalesData) => {\n    if (onRowClick) {\n      onRowClick(`Transaction Details - ${item.customerName}`, [item], 'transaction-detail');\n    }\n  };\n  const getSortIcon = (column: string) => {\n    if (sortColumn !== column) return null;\n    return sortDirection === 'asc' ? <TrendingUp className=\"w-4 h-4\" /> : <TrendingDown className=\"w-4 h-4\" />;\n  };\n  const getDiscountBadgeColor = (percentage: number) => {\n    if (percentage >= 25) return 'secondary';\n    return 'outline';\n  };\n  // Columns definition for AI analysis footer\n  const footerColumns = [\n    { header: 'Date', key: 'paymentDate', type: 'date' },\n    { header: 'Customer', key: 'customerName', type: 'text' },\n    { header: 'Product', key: 'cleanedProduct', type: 'text' },\n    { header: 'Category', key: 'cleanedCategory', type: 'text' },\n    { header: 'MRP (Post Tax)', key: 'mrpPostTax', type: 'currency' },\n    { header: 'Discount Amount', key: 'discountAmount', type: 'currency' },\n    { header: 'Discount %', key: 'discountPercentage', type: 'percentage' },\n    { header: 'Final Amount', key: 'paymentValue', type: 'currency' },\n    { header: 'Location', key: 'calculatedLocation', type: 'text' },\n    { header: 'Sold By', key: 'soldBy', type: 'text' }\n  ];\n  const containerRef = useRef<HTMLDivElement>(null);\n  const registry = useMetricsTablesRegistry();\n  const tableId = `Detailed Discount Analysis (${periodId})`;\n  useEffect(() => {\n    if (!registry) return;\n    const el = containerRef.current;\n    if (!el) return;\n    const getTextContent = () => {\n      const table = el.querySelector('table') || el;\n      let text = `${tableId}\\n`;\n      const headerCells = table.querySelectorAll('thead th');\n      const headers: string[] = [];\n      headerCells.forEach(cell => { const t = cell.textContent?.trim(); if (t) headers.push(t); });\n      if (headers.length) {\n        text += headers.join('\\t') + '\\n';\n        text += headers.map(() => '---').join('\\t') + '\\n';\n      }\n      const rows = table.querySelectorAll('tbody tr');\n      rows.forEach(row => {\n        const cells = row.querySelectorAll('td');\n        const rowData: string[] = [];\n        cells.forEach(c => rowData.push((c.textContent || '').trim()));\n        if (rowData.length) text += rowData.join('\\t') + '\\n';\n      });\n      return text.trim();\n    };\n    registry.register({ id: tableId, getTextContent });\n    return () => registry.unregister(tableId);\n  }, [registry, tableId]);\n\n  return <Card ref={containerRef} className=\"shadow-xl border-0 bg-gradient-to-br from-white via-slate-50 to-blue-50/30\">\n      <CardHeader className=\"bg-gradient-to-r from-slate-800 via-slate-700 to-slate-600 text-white rounded-t-lg\">\n        <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"p-2 bg-white/10 rounded-lg backdrop-blur-sm\">\n              <Percent className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <CardTitle className=\"text-2xl font-bold\">Detailed Discount Analysis</CardTitle>\n\n          <div className=\"p-6 border-t\">\n          </div>\n              <p className=\"text-slate-200 mt-1\">\n                Comprehensive transaction-level discount data with advanced filtering\n              </p>\n            </div>\n          </div>\n          \n          <div className=\"flex items-center gap-3\">\n            <div className=\"relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4\" />\n              <Input placeholder=\"Search transactions...\" value={searchTerm} onChange={e => setSearchTerm(e.target.value)} className=\"pl-10 bg-white/10 border-white/20 text-white placeholder:text-slate-300\" />\n            </div>\n            <Button variant=\"outline\" size=\"sm\" className=\"bg-white/10 border-white/20 text-white hover:bg-white/20\">\n              <Download className=\"w-4 h-4 mr-2\" />\n              Export\n            </Button>\n            <CopyTableButton\n              tableRef={containerRef as any}\n              tableName={tableId}\n              size=\"sm\"\n              onCopyAllTabs={registry ? async () => registry.getAllTabsContent() : undefined}\n            />\n          </div>\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"p-0\">\n        {/* Summary Stats Bar */}\n        <div className=\"grid grid-cols-2 lg:grid-cols-5 gap-4 p-6 bg-gradient-to-r from-slate-50 to-slate-100 border-b\">\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-slate-800\">{formatNumber(summaryStats.totalTransactions)}</div>\n            <div className=\"text-sm text-slate-600\">Total Transactions</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-slate-800\">{formatCurrency(summaryStats.totalDiscount)}</div>\n            <div className=\"text-sm text-slate-600\">Total Discount</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-slate-800\">{formatCurrency(summaryStats.totalRevenue)}</div>\n            <div className=\"text-sm text-slate-600\">Total Revenue</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-slate-800\">{formatCurrency(summaryStats.totalMrp)}</div>\n            <div className=\"text-sm text-slate-600\">Total MRP</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-slate-800\">{formatPercentage(summaryStats.avgDiscountPercentage)}</div>\n            <div className=\"text-sm text-slate-600\">Avg Discount %</div>\n          </div>\n        </div>\n\n        <div className=\"overflow-x-auto\">\n          <Table>\n            <TableHeader className=\"bg-gradient-to-br from-indigo-800 to-blue-900 \">\n              <TableRow className=\"bg-gradient-to-br from-gray-800 to-indigo-900\">\n                <TableHead className=\"cursor-pointer\" onClick={() => handleSort('paymentDate')}>\n                  <div className=\"flex items-center gap-2\">\n                    Date {getSortIcon('paymentDate')}\n                  </div>\n                </TableHead>\n                <TableHead className=\"cursor-pointer\" onClick={() => handleSort('customerName')}>\n                  <div className=\"flex items-center gap-2\">\n                    Customer {getSortIcon('customerName')}\n                  </div>\n                </TableHead>\n                <TableHead onClick={() => handleSort('cleanedProduct')} className=\"cursor-pointer bg-gradient-to-br from-gray-800 to-indigo-900 \">\n                  <div className=\"flex items-center gap-2\">\n                    Product {getSortIcon('cleanedProduct')}\n                  </div>\n                </TableHead>\n                <TableHead className=\"cursor-pointer text-right\" onClick={() => handleSort('mrpPostTax')}>\n                  <div className=\"flex items-center justify-end gap-2\">\n                    MRP {getSortIcon('mrpPostTax')}\n                  </div>\n                </TableHead>\n                <TableHead className=\"cursor-pointer text-right\" onClick={() => handleSort('discountAmount')}>\n                  <div className=\"flex items-center justify-end gap-2\">\n                    Discount {getSortIcon('discountAmount')}\n                  </div>\n                </TableHead>\n                <TableHead className=\"cursor-pointer text-right\" onClick={() => handleSort('discountPercentage')}>\n                  <div className=\"flex items-center justify-end gap-2\">\n                    Discount % {getSortIcon('discountPercentage')}\n                  </div>\n                </TableHead>\n                <TableHead className=\"cursor-pointer text-right\" onClick={() => handleSort('paymentValue')}>\n                  <div className=\"flex items-center justify-end gap-2\">\n                    Final Amount {getSortIcon('paymentValue')}\n                  </div>\n                </TableHead>\n                <TableHead>Location</TableHead>\n                <TableHead>Sold By</TableHead>\n                <TableHead className=\"text-center\">Actions</TableHead>\n                <TableHead className=\"text-right\">\n                  <CopyTableButton\n                    tableRef={containerRef as any}\n                    tableName={tableId}\n                    size=\"sm\"\n                    onCopyAllTabs={registry ? async () => registry.getAllTabsContent() : undefined}\n                  />\n                </TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {paginatedData.map((item, index) => <TableRow key={`${item.saleItemId}-${index}`} className=\"hover:cursor-pointer max-h-[35px]\">\n                  <TableCell className=\"font-medium py-2 max-h-[35px]\">\n                    <span className=\"truncate block\">{new Date(item.paymentDate).toLocaleDateString()}</span>\n                  </TableCell>\n                  <TableCell className=\"py-2 max-h-[35px]\">\n                    <div className=\"truncate\">\n                      <div className=\"font-medium text-sm text-slate-700 truncate\">{item.customerName}</div>\n                      <div className=\"text-xs text-slate-500 truncate\">{item.customerEmail}</div>\n                    </div>\n                  </TableCell>\n                  <TableCell className=\"py-2 max-h-[35px]\">\n                    <div className=\"truncate\">\n                      <div className=\"font-medium text-sm text-slate-700 truncate\">{item.cleanedProduct}</div>\n                      <div className=\"text-xs text-slate-500 truncate\">{item.cleanedCategory}</div>\n                    </div>\n                  </TableCell>\n                  <TableCell className=\"text-right font-medium py-2 max-h-[35px]\">\n                    <span className=\"truncate block\">{formatCurrency(item.mrpPostTax || 0)}</span>\n                  </TableCell>\n                  <TableCell className=\"text-right py-2 max-h-[35px]\">\n                    <span className=\"font-medium text-sm text-slate-700 truncate block\">\n                      -{formatCurrency(item.discountAmount || 0)}\n                    </span>\n                  </TableCell>\n                  <TableCell className=\"text-right py-2 max-h-[35px]\">\n                    <Badge variant={getDiscountBadgeColor(item.discountPercentage || 0)} className=\"text-xs h-6 px-2 font-medium w-16 justify-center\">\n                      {formatPercentage(item.discountPercentage || 0)}\n                    </Badge>\n                  </TableCell>\n                  <TableCell className=\"text-right font-medium text-sm text-slate-700 py-2 max-h-[35px]\">\n                    <span className=\"truncate block\">{formatCurrency(item.paymentValue || 0)}</span>\n                  </TableCell>\n                  <TableCell className=\"py-2 max-h-[35px]\">\n                    <span className=\"text-sm text-slate-600 truncate block\">{item.calculatedLocation}</span>\n                  </TableCell>\n                  <TableCell className=\"py-2 max-h-[35px]\">\n                    <span className=\"text-sm text-slate-600 truncate block\">{item.soldBy}</span>\n                  </TableCell>\n                  <TableCell className=\"text-center py-2 max-h-[35px]\">\n                    <Button variant=\"outline\" size=\"sm\" onClick={() => handleRowClick(item)} className=\"hover:bg-blue-50 h-7\">\n                      <Eye className=\"w-3 h-3\" />\n                    </Button>\n                  </TableCell>\n                </TableRow>)}\n            </TableBody>\n            <TableFooter>\n              <TableRow>\n                <TableCell colSpan={3} className=\"font-bold text-white\">\n                  Summary ({formatNumber(summaryStats.totalTransactions)} transactions)\n                </TableCell>\n                <TableCell className=\"text-right font-bold text-white\">\n                  {formatCurrency(summaryStats.totalMrp)}\n                </TableCell>\n                <TableCell className=\"text-right font-bold text-white\">\n                  -{formatCurrency(summaryStats.totalDiscount)}\n                </TableCell>\n                <TableCell className=\"text-right font-bold text-white\">\n                  {formatPercentage(summaryStats.avgDiscountPercentage)}\n                </TableCell>\n                <TableCell className=\"text-right font-bold text-white\">\n                  {formatCurrency(summaryStats.totalRevenue)}\n                </TableCell>\n                <TableCell colSpan={3}></TableCell>\n              </TableRow>\n            </TableFooter>\n          </Table>\n        </div>\n\n        {/* Pagination */}\n        {totalPages > 1 && <div className=\"flex items-center justify-between p-4 border-t bg-slate-50\">\n            <div className=\"text-sm text-slate-600\">\n              Showing {(currentPage - 1) * itemsPerPage + 1} to {Math.min(currentPage * itemsPerPage, filteredAndSortedData.length)} of {filteredAndSortedData.length} results\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <Button variant=\"outline\" size=\"sm\" onClick={() => setCurrentPage(Math.max(1, currentPage - 1))} disabled={currentPage === 1}>\n                Previous\n              </Button>\n              <span className=\"text-sm text-slate-600\">\n                Page {currentPage} of {totalPages}\n              </span>\n              <Button variant=\"outline\" size=\"sm\" onClick={() => setCurrentPage(Math.min(totalPages, currentPage + 1))} disabled={currentPage === totalPages}>\n                Next\n              </Button>\n            </div>\n          </div>}\n      </CardContent>\n        <PersistentTableFooter\n          tableId=\"discounts-detailed-table\"\n          tableName=\"Detailed Discount Analysis\"\n          tableContext=\"Transaction-level discounts and revenue performance\"\n          tableData={filteredAndSortedData}\n          tableColumns={footerColumns as any}\n          className=\"rounded-b-lg\"\n        />\n    </Card>;\n};","import React, { useMemo, useRef, useEffect } from 'react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { \n  Table, \n  TableBody, \n  TableCell, \n  TableHead, \n  TableHeader, \n  TableRow,\n  TableFooter \n} from '@/components/ui/table';\nimport { \n  BarChart3, \n  Users, \n  MapPin, \n  Package, \n  TrendingDown,\n  Eye,\n  Percent,\n  DollarSign\n} from 'lucide-react';\nimport { formatCurrency, formatNumber, formatPercentage } from '@/utils/formatters';\nimport { SalesData } from '@/types/dashboard';\nimport { PersistentTableFooter } from '@/components/dashboard/PersistentTableFooter';\nimport CopyTableButton from '@/components/ui/CopyTableButton';\nimport { useMetricsTablesRegistry } from '@/contexts/MetricsTablesRegistryContext';\n\ninterface EnhancedDiscountBreakdownTablesProps {\n  data: SalesData[];\n  onDrillDown?: (title: string, data: any[], type: string) => void;\n}\n\nexport const EnhancedDiscountBreakdownTables: React.FC<EnhancedDiscountBreakdownTablesProps> = ({ \n  data, \n  onDrillDown \n}) => {\n  const productRef = useRef<HTMLDivElement>(null);\n  const locationRef = useRef<HTMLDivElement>(null);\n  const staffRef = useRef<HTMLDivElement>(null);\n  const registry = useMetricsTablesRegistry();\n\n  useEffect(() => {\n    if (!registry) return;\n    const register = (ref: React.RefObject<HTMLDivElement>, id: string) => {\n      const el = ref.current;\n      if (!el) return;\n      const getTextContent = () => {\n        const table = el.querySelector('table') || el;\n        let text = `${id}\\n`;\n        const headerCells = table.querySelectorAll('thead th');\n        const headers: string[] = [];\n        headerCells.forEach(cell => { const t = cell.textContent?.trim(); if (t) headers.push(t); });\n        if (headers.length) {\n          text += headers.join('\\t') + '\\n';\n          text += headers.map(() => '---').join('\\t') + '\\n';\n        }\n        const rows = table.querySelectorAll('tbody tr');\n        rows.forEach(row => {\n          const cells = row.querySelectorAll('td');\n          const rowData: string[] = [];\n          cells.forEach(c => rowData.push((c.textContent || '').trim()));\n          if (rowData.length) text += rowData.join('\\t') + '\\n';\n        });\n        return text.trim();\n      };\n      registry.register({ id, getTextContent });\n    };\n    register(productRef, 'Product-wise Discount Breakdown');\n    register(locationRef, 'Location-wise Discount Breakdown');\n    register(staffRef, 'Staff-wise Discount Breakdown');\n    return () => {\n      registry.unregister('Product-wise Discount Breakdown');\n      registry.unregister('Location-wise Discount Breakdown');\n      registry.unregister('Staff-wise Discount Breakdown');\n    };\n  }, [registry]);\n  \n  // Product breakdown\n  const productBreakdown = useMemo(() => {\n    const breakdown = data.reduce((acc, item) => {\n      const key = item.cleanedProduct || 'Unknown Product';\n      if (!acc[key]) {\n        acc[key] = {\n          product: key,\n          category: item.cleanedCategory || 'Unknown',\n          transactions: 0,\n          totalDiscount: 0,\n          totalRevenue: 0,\n          totalMrp: 0,\n          avgDiscountPercentage: 0,\n          data: []\n        };\n      }\n      acc[key].transactions += 1;\n      acc[key].totalDiscount += item.discountAmount || 0;\n      acc[key].totalRevenue += item.paymentValue || 0;\n      acc[key].totalMrp += item.mrpPostTax || 0;\n      acc[key].data.push(item);\n      return acc;\n    }, {} as Record<string, any>);\n\n    return Object.values(breakdown).map((item: any) => ({\n      ...item,\n      avgDiscountPercentage: item.totalMrp > 0 ? (item.totalDiscount / item.totalMrp) * 100 : 0,\n      discountRate: item.transactions > 0 ? (item.totalDiscount / item.transactions) : 0\n    })).sort((a, b) => b.totalDiscount - a.totalDiscount);\n  }, [data]);\n\n  // Location breakdown\n  const locationBreakdown = useMemo(() => {\n    const breakdown = data.reduce((acc, item) => {\n      const key = item.calculatedLocation || 'Unknown Location';\n      if (!acc[key]) {\n        acc[key] = {\n          location: key,\n          transactions: 0,\n          totalDiscount: 0,\n          totalRevenue: 0,\n          totalMrp: 0,\n          uniqueCustomers: new Set(),\n          data: []\n        };\n      }\n      acc[key].transactions += 1;\n      acc[key].totalDiscount += item.discountAmount || 0;\n      acc[key].totalRevenue += item.paymentValue || 0;\n      acc[key].totalMrp += item.mrpPostTax || 0;\n      acc[key].uniqueCustomers.add(item.customerEmail);\n      acc[key].data.push(item);\n      return acc;\n    }, {} as Record<string, any>);\n\n    return Object.values(breakdown).map((item: any) => ({\n      ...item,\n      uniqueCustomers: item.uniqueCustomers.size,\n      avgDiscountPercentage: item.totalMrp > 0 ? (item.totalDiscount / item.totalMrp) * 100 : 0,\n      avgDiscountPerTransaction: item.transactions > 0 ? (item.totalDiscount / item.transactions) : 0\n    })).sort((a, b) => b.totalDiscount - a.totalDiscount);\n  }, [data]);\n\n  // Staff breakdown\n  const staffBreakdown = useMemo(() => {\n    const breakdown = data.reduce((acc, item) => {\n      const key = item.soldBy || 'Unknown';\n      if (!acc[key]) {\n        acc[key] = {\n          staff: key,\n          transactions: 0,\n          totalDiscount: 0,\n          totalRevenue: 0,\n          totalMrp: 0,\n          data: []\n        };\n      }\n      acc[key].transactions += 1;\n      acc[key].totalDiscount += item.discountAmount || 0;\n      acc[key].totalRevenue += item.paymentValue || 0;\n      acc[key].totalMrp += item.mrpPostTax || 0;\n      acc[key].data.push(item);\n      return acc;\n    }, {} as Record<string, any>);\n\n    return Object.values(breakdown).map((item: any) => ({\n      ...item,\n      avgDiscountPercentage: item.totalMrp > 0 ? (item.totalDiscount / item.totalMrp) * 100 : 0,\n      discountRate: item.transactions > 0 ? (item.totalDiscount / item.transactions) : 0\n    })).sort((a, b) => b.totalDiscount - a.totalDiscount);\n  }, [data]);\n\n  const handleDrillDown = (title: string, data: any[], type: string) => {\n    if (onDrillDown) {\n      onDrillDown(title, data, type);\n    }\n  };\n\n  const getPerformanceBadge = (percentage: number) => {\n    if (percentage >= 20) return { variant: 'secondary' as const, label: 'High' };\n    return { variant: 'outline' as const, label: 'Low' };\n  };\n\n  return (\n    <div className=\"grid gap-6\">\n      {/* Product Breakdown */}\n      <Card ref={productRef} className=\"shadow-xl border-0 bg-white\">\n        <CardHeader className=\"bg-gradient-to-r from-slate-800 via-slate-700 to-slate-600 text-white rounded-t-lg\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"p-2 bg-white/10 rounded-lg backdrop-blur-sm\">\n              <Package className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <CardTitle className=\"text-2xl font-bold\">Product-wise Discount Breakdown</CardTitle>\n              <p className=\"text-slate-200 mt-1\">\n                Discount performance analysis by product category\n              </p>\n            </div>\n            <CopyTableButton\n              tableRef={productRef as any}\n              tableName=\"Product-wise Discount Breakdown\"\n              size=\"sm\"\n              onCopyAllTabs={registry ? async () => registry.getAllTabsContent() : undefined}\n            />\n          </div>\n        </CardHeader>\n        \n        <CardContent className=\"p-0\">\n          <div className=\"overflow-x-auto\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Product</TableHead>\n                  <TableHead>Category</TableHead>\n                  <TableHead className=\"text-center\">Transactions</TableHead>\n                  <TableHead className=\"text-right\">Total Discount</TableHead>\n                  <TableHead className=\"text-right\">Avg Discount %</TableHead>\n                  <TableHead className=\"text-right\">Total Revenue</TableHead>\n                  <TableHead className=\"text-right\">Discount Impact</TableHead>\n                  <TableHead className=\"text-center\">Actions</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {productBreakdown.slice(0, 10).map((item, index) => {\n                  const badge = getPerformanceBadge(item.avgDiscountPercentage);\n                  return (\n                    <TableRow key={index} className=\"max-h-[35px]\">\n                      <TableCell className=\"font-medium py-2 max-h-[35px]\">\n                        <div className=\"max-w-[200px] truncate text-sm\" title={item.product}>\n                          {item.product}\n                        </div>\n                      </TableCell>\n                      <TableCell className=\"py-2 max-h-[35px]\">\n                        <span className=\"text-sm text-slate-600 truncate block\">{item.category}</span>\n                      </TableCell>\n                      <TableCell className=\"text-center py-2 max-h-[35px]\">\n                        <Badge variant=\"outline\" className=\"text-xs h-6 px-2 w-16 justify-center\">{formatNumber(item.transactions)}</Badge>\n                      </TableCell>\n                      <TableCell className=\"text-right font-medium text-sm text-slate-700 py-2 max-h-[35px]\">\n                        <span className=\"truncate block\">{formatCurrency(item.totalDiscount)}</span>\n                      </TableCell>\n                      <TableCell className=\"text-right py-2 max-h-[35px]\">\n                        <Badge variant={badge.variant} className=\"text-xs h-6 px-2 w-20 justify-center\">\n                          {formatPercentage(item.avgDiscountPercentage)}\n                        </Badge>\n                      </TableCell>\n                      <TableCell className=\"text-right font-medium text-sm text-slate-700 py-2 max-h-[35px]\">\n                        <span className=\"truncate block\">{formatCurrency(item.totalRevenue)}</span>\n                      </TableCell>\n                      <TableCell className=\"text-right py-2 max-h-[35px]\">\n                        <div className=\"text-xs truncate\">\n                          <div className=\"font-medium truncate\">{formatCurrency(item.discountRate)}</div>\n                          <div className=\"text-slate-500 truncate\">per transaction</div>\n                        </div>\n                      </TableCell>\n                      <TableCell className=\"text-center py-2 max-h-[35px]\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => handleDrillDown(\n                            `${item.product} - Discount Analysis`, \n                            item.data, \n                            'product-discount'\n                          )}\n                          className=\"hover:bg-slate-50 h-7\"\n                        >\n                          <Eye className=\"w-3 h-3\" />\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  );\n                })}\n              </TableBody>\n              <TableFooter>\n                <TableRow>\n                  <TableCell colSpan={2} className=\"font-bold text-white\">Total (Top 10)</TableCell>\n                  <TableCell className=\"text-center font-bold text-white\">\n                    {formatNumber(productBreakdown.slice(0, 10).reduce((sum, item) => sum + item.transactions, 0))}\n                  </TableCell>\n                  <TableCell className=\"text-right font-bold text-white\">\n                    {formatCurrency(productBreakdown.slice(0, 10).reduce((sum, item) => sum + item.totalDiscount, 0))}\n                  </TableCell>\n                  <TableCell className=\"text-right font-bold text-white\">\n                    {formatPercentage(\n                      productBreakdown.slice(0, 10).reduce((sum, item) => sum + item.avgDiscountPercentage, 0) / \n                      Math.min(10, productBreakdown.length)\n                    )}\n                  </TableCell>\n                  <TableCell className=\"text-right font-bold text-white\">\n                    {formatCurrency(productBreakdown.slice(0, 10).reduce((sum, item) => sum + item.totalRevenue, 0))}\n                  </TableCell>\n                  <TableCell colSpan={2}></TableCell>\n                </TableRow>\n              </TableFooter>\n            </Table>\n          </div>\n        </CardContent>\n      </Card>\n      {/* Product AI Footer */}\n      <PersistentTableFooter\n        tableId=\"discounts-product-breakdown\"\n        tableName=\"Product-wise Discount Breakdown\"\n        tableContext=\"Discounts grouped by product and category with impact metrics\"\n        tableData={productBreakdown}\n        tableColumns={[\n          { header: 'Product', key: 'product', type: 'text' },\n          { header: 'Category', key: 'category', type: 'text' },\n          { header: 'Transactions', key: 'transactions', type: 'number' },\n          { header: 'Total Discount', key: 'totalDiscount', type: 'currency' },\n          { header: 'Avg Discount %', key: 'avgDiscountPercentage', type: 'percentage' },\n          { header: 'Total Revenue', key: 'totalRevenue', type: 'currency' }\n        ] as any}\n      />\n\n      {/* Location Breakdown */}\n      <Card ref={locationRef} className=\"shadow-xl border-0 bg-white\">\n        <CardHeader className=\"bg-gradient-to-r from-slate-800 via-slate-700 to-slate-600 text-white rounded-t-lg\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"p-2 bg-white/10 rounded-lg backdrop-blur-sm\">\n              <MapPin className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <CardTitle className=\"text-2xl font-bold\">Location-wise Discount Breakdown</CardTitle>\n              <p className=\"text-slate-200 mt-1\">\n                Geographic analysis of discount utilization patterns\n              </p>\n            </div>\n            <CopyTableButton\n              tableRef={locationRef as any}\n              tableName=\"Location-wise Discount Breakdown\"\n              size=\"sm\"\n              onCopyAllTabs={registry ? async () => registry.getAllTabsContent() : undefined}\n            />\n          </div>\n        </CardHeader>\n        \n        <CardContent className=\"p-0\">\n          <div className=\"overflow-x-auto\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Location</TableHead>\n                  <TableHead className=\"text-center\">Transactions</TableHead>\n                  <TableHead className=\"text-center\">Customers</TableHead>\n                  <TableHead className=\"text-right\">Total Discount</TableHead>\n                  <TableHead className=\"text-right\">Avg Discount %</TableHead>\n                  <TableHead className=\"text-right\">Avg per Transaction</TableHead>\n                  <TableHead className=\"text-right\">Total Revenue</TableHead>\n                  <TableHead className=\"text-center\">Actions</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {locationBreakdown.map((item, index) => {\n                  const badge = getPerformanceBadge(item.avgDiscountPercentage);\n                  return (\n                    <TableRow key={index}>\n                      <TableCell className=\"font-medium\">{item.location}</TableCell>\n                      <TableCell className=\"text-center\">\n                        <Badge variant=\"outline\" className=\"w-16 justify-center\">{formatNumber(item.transactions)}</Badge>\n                      </TableCell>\n                      <TableCell className=\"text-center\">\n                        <Badge variant=\"secondary\" className=\"w-16 justify-center\">{formatNumber(item.uniqueCustomers)}</Badge>\n                      </TableCell>\n                      <TableCell className=\"text-right font-medium text-slate-700\">\n                        {formatCurrency(item.totalDiscount)}\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <Badge variant={badge.variant} className=\"w-20 justify-center\">\n                          {formatPercentage(item.avgDiscountPercentage)}\n                        </Badge>\n                      </TableCell>\n                      <TableCell className=\"text-right font-medium text-slate-700\">\n                        {formatCurrency(item.avgDiscountPerTransaction)}\n                      </TableCell>\n                      <TableCell className=\"text-right font-medium text-slate-700\">\n                        {formatCurrency(item.totalRevenue)}\n                      </TableCell>\n                      <TableCell className=\"text-center\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => handleDrillDown(\n                            `${item.location} - Discount Analysis`, \n                            item.data, \n                            'location-discount'\n                          )}\n                          className=\"hover:bg-slate-50\"\n                        >\n                          <Eye className=\"w-4 h-4\" />\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  );\n                })}\n              </TableBody>\n              <TableFooter>\n                <TableRow>\n                  <TableCell className=\"font-bold text-white\">Total</TableCell>\n                  <TableCell className=\"text-center font-bold text-white\">\n                    {formatNumber(locationBreakdown.reduce((sum, item) => sum + item.transactions, 0))}\n                  </TableCell>\n                  <TableCell className=\"text-center font-bold text-white\">\n                    {formatNumber(locationBreakdown.reduce((sum, item) => sum + item.uniqueCustomers, 0))}\n                  </TableCell>\n                  <TableCell className=\"text-right font-bold text-white\">\n                    {formatCurrency(locationBreakdown.reduce((sum, item) => sum + item.totalDiscount, 0))}\n                  </TableCell>\n                  <TableCell className=\"text-right font-bold text-white\">\n                    {formatPercentage(\n                      locationBreakdown.reduce((sum, item) => sum + item.avgDiscountPercentage, 0) / \n                      locationBreakdown.length\n                    )}\n                  </TableCell>\n                  <TableCell className=\"text-right font-bold text-white\">\n                    {formatCurrency(\n                      locationBreakdown.reduce((sum, item) => sum + item.avgDiscountPerTransaction, 0) / \n                      locationBreakdown.length\n                    )}\n                  </TableCell>\n                  <TableCell className=\"text-right font-bold text-white\">\n                    {formatCurrency(locationBreakdown.reduce((sum, item) => sum + item.totalRevenue, 0))}\n                  </TableCell>\n                  <TableCell></TableCell>\n                </TableRow>\n              </TableFooter>\n            </Table>\n          </div>\n        </CardContent>\n      </Card>\n      {/* Location AI Footer */}\n      <PersistentTableFooter\n        tableId=\"discounts-location-breakdown\"\n        tableName=\"Location-wise Discount Breakdown\"\n        tableContext=\"Discounts grouped by studio location with customer counts and impact\"\n        tableData={locationBreakdown}\n        tableColumns={[\n          { header: 'Location', key: 'location', type: 'text' },\n          { header: 'Transactions', key: 'transactions', type: 'number' },\n          { header: 'Customers', key: 'uniqueCustomers', type: 'number' },\n          { header: 'Total Discount', key: 'totalDiscount', type: 'currency' },\n          { header: 'Avg Discount %', key: 'avgDiscountPercentage', type: 'percentage' },\n          { header: 'Avg per Txn', key: 'avgDiscountPerTransaction', type: 'currency' },\n          { header: 'Revenue', key: 'totalRevenue', type: 'currency' }\n        ] as any}\n      />\n\n      {/* Staff Breakdown */}\n      <Card ref={staffRef} className=\"shadow-xl border-0 bg-gradient-to-br from-white via-purple-50/30 to-pink-50/20\">\n        <CardHeader className=\"bg-gradient-to-r from-slate-800 via-slate-700 to-slate-600 text-white rounded-t-lg\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"p-2 bg-white/10 rounded-lg backdrop-blur-sm\">\n              <Users className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <CardTitle className=\"text-2xl font-bold\">Staff-wise Discount Breakdown</CardTitle>\n              <p className=\"text-slate-200 mt-1\">\n                Analysis of discount authorization by sales staff\n              </p>\n            </div>\n            <CopyTableButton\n              tableRef={staffRef as any}\n              tableName=\"Staff-wise Discount Breakdown\"\n              size=\"sm\"\n              onCopyAllTabs={registry ? async () => registry.getAllTabsContent() : undefined}\n            />\n          </div>\n        </CardHeader>\n        \n        <CardContent className=\"p-0\">\n          <div className=\"overflow-x-auto\">\n            <Table>\n              <TableHeader>\n                <TableRow>\n                  <TableHead>Staff Member</TableHead>\n                  <TableHead className=\"text-center\">Transactions</TableHead>\n                  <TableHead className=\"text-right\">Total Discount</TableHead>\n                  <TableHead className=\"text-right\">Avg Discount %</TableHead>\n                  <TableHead className=\"text-right\">Discount per Sale</TableHead>\n                  <TableHead className=\"text-right\">Total Revenue</TableHead>\n                  <TableHead className=\"text-center\">Performance</TableHead>\n                  <TableHead className=\"text-center\">Actions</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {staffBreakdown.map((item, index) => {\n                  const badge = getPerformanceBadge(item.avgDiscountPercentage);\n                  return (\n                    <TableRow key={index}>\n                      <TableCell className=\"font-medium\">{item.staff}</TableCell>\n                      <TableCell className=\"text-center\">\n                        <Badge variant=\"outline\">{formatNumber(item.transactions)}</Badge>\n                      </TableCell>\n                      <TableCell className=\"text-right font-semibold text-red-600\">\n                        {formatCurrency(item.totalDiscount)}\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <Badge variant={badge.variant}>\n                          {formatPercentage(item.avgDiscountPercentage)}\n                        </Badge>\n                      </TableCell>\n                      <TableCell className=\"text-right font-medium\">\n                        {formatCurrency(item.discountRate)}\n                      </TableCell>\n                      <TableCell className=\"text-right font-semibold text-green-600\">\n                        {formatCurrency(item.totalRevenue)}\n                      </TableCell>\n                      <TableCell className=\"text-center\">\n                        <Badge variant={badge.variant}>{badge.label}</Badge>\n                      </TableCell>\n                      <TableCell className=\"text-center\">\n                        <Button\n                          variant=\"outline\"\n                          size=\"sm\"\n                          onClick={() => handleDrillDown(\n                            `${item.staff} - Discount Analysis`, \n                            item.data, \n                            'staff-discount'\n                          )}\n                          className=\"hover:bg-purple-50\"\n                        >\n                          <Eye className=\"w-4 h-4\" />\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  );\n                })}\n              </TableBody>\n              <TableFooter>\n                <TableRow>\n                  <TableCell className=\"font-bold text-white\">Total</TableCell>\n                  <TableCell className=\"text-center font-bold text-white\">\n                    {formatNumber(staffBreakdown.reduce((sum, item) => sum + item.transactions, 0))}\n                  </TableCell>\n                  <TableCell className=\"text-right font-bold text-white\">\n                    {formatCurrency(staffBreakdown.reduce((sum, item) => sum + item.totalDiscount, 0))}\n                  </TableCell>\n                  <TableCell className=\"text-right font-bold text-white\">\n                    {formatPercentage(\n                      staffBreakdown.reduce((sum, item) => sum + item.avgDiscountPercentage, 0) / \n                      staffBreakdown.length\n                    )}\n                  </TableCell>\n                  <TableCell className=\"text-right font-bold text-white\">\n                    {formatCurrency(\n                      staffBreakdown.reduce((sum, item) => sum + item.discountRate, 0) / \n                      staffBreakdown.length\n                    )}\n                  </TableCell>\n                  <TableCell className=\"text-right font-bold text-white\">\n                    {formatCurrency(staffBreakdown.reduce((sum, item) => sum + item.totalRevenue, 0))}\n                  </TableCell>\n                  <TableCell colSpan={2}></TableCell>\n                </TableRow>\n              </TableFooter>\n            </Table>\n          </div>\n        </CardContent>\n      </Card>\n      {/* Staff AI Footer */}\n      <PersistentTableFooter\n        tableId=\"discounts-staff-breakdown\"\n        tableName=\"Staff-wise Discount Breakdown\"\n        tableContext=\"Discount authorization and revenue by staff member\"\n        tableData={staffBreakdown}\n        tableColumns={[\n          { header: 'Staff', key: 'staff', type: 'text' },\n          { header: 'Transactions', key: 'transactions', type: 'number' },\n          { header: 'Total Discount', key: 'totalDiscount', type: 'currency' },\n          { header: 'Avg Discount %', key: 'avgDiscountPercentage', type: 'percentage' },\n          { header: 'Discount per Sale', key: 'discountRate', type: 'currency' },\n          { header: 'Revenue', key: 'totalRevenue', type: 'currency' }\n        ] as any}\n      />\n    </div>\n  );\n};","import React, { useState, useMemo, useEffect } from 'react';\nimport { motion } from 'framer-motion';\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { BarChart3, Calendar, Filter } from \"lucide-react\";\nimport { formatCurrency, formatNumber, formatPercentage } from \"@/utils/formatters\";\nimport { SalesData } from '@/types/dashboard';\nimport { cn } from '@/lib/utils';\nimport { ModernDataTable } from '@/components/ui/ModernDataTable';\nimport { useMetricsTablesRegistry } from '@/contexts/MetricsTablesRegistryContext';\n\ninterface MonthOnMonthDiscountTableProps {\n  data: SalesData[];\n}\n\ntype GroupKey = 'product' | 'category' | 'location' | 'soldBy';\ntype MetricType = 'totalDiscounts' | 'discountedTransactions' | 'avgDiscount' | 'discountRate' | 'uniqueCustomers' | 'totalValue';\n\ninterface MonthData {\n  totalDiscounts: number;\n  discountedTransactions: number;\n  totalTransactions: number;\n  totalValue: number;\n  uniqueCustomers: number;\n  customersWithDiscounts: number;\n}\n\nconst emptyMonthData = (): MonthData => ({\n  totalDiscounts: 0,\n  discountedTransactions: 0,\n  totalTransactions: 0,\n  totalValue: 0,\n  uniqueCustomers: 0,\n  customersWithDiscounts: 0,\n});\n\nexport const MonthOnMonthDiscountTable: React.FC<MonthOnMonthDiscountTableProps> = ({ data }) => {\n  const [groupKey, setGroupKey] = useState<GroupKey>('product');\n  const [metric, setMetric] = useState<MetricType>('totalDiscounts');\n  const [viewMode, setViewMode] = useState<'values' | 'growth'>('values');\n  const registry = useMetricsTablesRegistry();\n\n  const months = useMemo(() => {\n    // Get last 6 months including current month\n    const now = new Date();\n    const arr: string[] = [];\n    for (let i = 5; i >= 0; i--) {\n      const d = new Date(now.getFullYear(), now.getMonth() - i, 1);\n      arr.push(`${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, '0')}`);\n    }\n    return arr;\n  }, []);\n\n  const processedData = useMemo(() => {\n    const map = new Map<string, { group: string; months: Map<string, MonthData>; totals: MonthData }>();\n\n    const addToMonthData = (monthData: MonthData, item: SalesData) => {\n      const discountAmount = (item.discountAmount || 0);\n      const paymentValue = (item.paymentValue || 0);\n      const hasDiscount = discountAmount > 0 || (item.discountPercentage || 0) > 0;\n      \n      monthData.totalDiscounts += discountAmount;\n      monthData.totalTransactions += 1;\n      monthData.totalValue += paymentValue;\n      \n      if (hasDiscount) {\n        monthData.discountedTransactions += 1;\n      }\n      \n      // Track unique customers (simplified - in reality you'd want to dedupe properly)\n      if (item.memberId || item.customerEmail) {\n        monthData.uniqueCustomers += 1; // This is simplified, should be proper deduplication\n        if (hasDiscount) {\n          monthData.customersWithDiscounts += 1;\n        }\n      }\n    };\n\n    data.forEach(item => {\n      if (!item.paymentDate) return;\n      \n      const itemDate = new Date(item.paymentDate);\n      if (isNaN(itemDate.getTime())) return;\n      \n      const monthKey = `${itemDate.getFullYear()}-${String(itemDate.getMonth() + 1).padStart(2, '0')}`;\n      \n      let groupValue = '';\n      switch (groupKey) {\n        case 'product':\n          groupValue = item.cleanedProduct || 'Unknown Product';\n          break;\n        case 'category':\n          groupValue = item.cleanedCategory || 'Uncategorized';\n          break;\n        case 'location':\n          groupValue = item.calculatedLocation || 'Unknown Location';\n          break;\n        case 'soldBy':\n          groupValue = item.soldBy === '-' ? 'Online/System' : (item.soldBy || 'Unknown');\n          break;\n      }\n\n      if (!map.has(groupValue)) {\n        map.set(groupValue, { \n          group: groupValue, \n          months: new Map(), \n          totals: emptyMonthData() \n        });\n      }\n\n      const entry = map.get(groupValue)!;\n      \n      if (!entry.months.has(monthKey)) {\n        entry.months.set(monthKey, emptyMonthData());\n      }\n\n      addToMonthData(entry.months.get(monthKey)!, item);\n      addToMonthData(entry.totals, item);\n    });\n\n    // Convert to array and sort by total metric value\n    const rows = Array.from(map.values()).map(entry => {\n      let totalValue = 0;\n      switch (metric) {\n        case 'totalDiscounts':\n          totalValue = entry.totals.totalDiscounts;\n          break;\n        case 'discountedTransactions':\n          totalValue = entry.totals.discountedTransactions;\n          break;\n        case 'avgDiscount':\n          totalValue = entry.totals.discountedTransactions > 0 \n            ? entry.totals.totalDiscounts / entry.totals.discountedTransactions \n            : 0;\n          break;\n        case 'discountRate':\n          totalValue = (entry.totals.totalValue + entry.totals.totalDiscounts) > 0 \n            ? (entry.totals.totalDiscounts / (entry.totals.totalValue + entry.totals.totalDiscounts)) * 100 \n            : 0;\n          break;\n        case 'uniqueCustomers':\n          totalValue = entry.totals.customersWithDiscounts;\n          break;\n        case 'totalValue':\n          totalValue = entry.totals.totalValue;\n          break;\n      }\n      \n      return { ...entry, totalValue };\n    });\n\n    return rows.sort((a, b) => b.totalValue - a.totalValue);\n  }, [data, groupKey, metric, months]);\n\n  const formatMetricValue = (monthData: MonthData | undefined, metricType: MetricType): string => {\n    if (!monthData) return '0';\n    \n    switch (metricType) {\n      case 'totalDiscounts':\n      case 'totalValue':\n        return formatCurrency(monthData.totalDiscounts);\n      case 'discountedTransactions':\n        return formatNumber(monthData.discountedTransactions);\n      case 'avgDiscount':\n        return monthData.discountedTransactions > 0 \n          ? formatCurrency(monthData.totalDiscounts / monthData.discountedTransactions)\n          : '0';\n      case 'discountRate':\n        return (monthData.totalValue + monthData.totalDiscounts) > 0 \n          ? formatPercentage((monthData.totalDiscounts / (monthData.totalValue + monthData.totalDiscounts)) * 100)\n          : '0%';\n      case 'uniqueCustomers':\n        return formatNumber(monthData.customersWithDiscounts);\n      default:\n        return '0';\n    }\n  };\n\n  const getMetricValue = (monthData: MonthData | undefined): number => {\n    if (!monthData) return 0;\n    \n    switch (metric) {\n      case 'totalDiscounts':\n        return monthData.totalDiscounts;\n      case 'discountedTransactions':\n        return monthData.discountedTransactions;\n      case 'avgDiscount':\n        return monthData.discountedTransactions > 0 \n          ? monthData.totalDiscounts / monthData.discountedTransactions \n          : 0;\n      case 'discountRate':\n        return (monthData.totalValue + monthData.totalDiscounts) > 0 \n          ? (monthData.totalDiscounts / (monthData.totalValue + monthData.totalDiscounts)) * 100 \n          : 0;\n      case 'uniqueCustomers':\n        return monthData.customersWithDiscounts;\n      case 'totalValue':\n        return monthData.totalValue;\n      default:\n        return 0;\n    }\n  };\n\n  const columns = [\n    {\n      key: 'group',\n      header: groupKey.charAt(0).toUpperCase() + groupKey.slice(1),\n      align: 'left' as const,\n      className: 'min-w-[200px] sticky left-0 bg-white',\n      render: (value: string) => (\n        <div className=\"font-semibold text-slate-800 truncate pr-4\">\n          {groupKey === 'location' \n            ? value.replace('Kwality House, Kemps Corner', 'Kwality')\n                   .replace('Supreme HQ, Bandra', 'Supreme')\n                   .replace('Kenkere House', 'Kenkere')\n            : value}\n        </div>\n      )\n    },\n    ...months.map((monthKey, idx) => ({\n      key: monthKey,\n      header: new Date(monthKey + '-01').toLocaleDateString('en-US', { \n        month: 'short', \n        year: 'numeric' \n      }),\n      align: 'center' as const,\n      className: 'min-w-[100px]',\n      render: (_: any, row: any) => {\n        const monthData = row.months.get(monthKey);\n        \n        if (viewMode === 'values') {\n          return (\n            <div className=\"text-sm font-medium text-slate-800\">\n              {formatMetricValue(monthData, metric)}\n            </div>\n          );\n        }\n        \n        // Growth mode\n        const prevMonthKey = months[idx - 1];\n        if (!prevMonthKey) {\n          return <span className=\"text-slate-400 text-xs\">-</span>;\n        }\n        \n        const current = getMetricValue(monthData);\n        const previous = getMetricValue(row.months.get(prevMonthKey));\n        \n        if (previous === 0 && current === 0) {\n          return <span className=\"text-slate-400 text-xs\">0%</span>;\n        }\n        \n        const growth = previous > 0 ? ((current - previous) / previous) * 100 : (current > 0 ? 100 : 0);\n        \n        return (\n          <div className={cn(\n            'text-xs font-semibold',\n            growth > 0 ? 'text-emerald-600' : growth < 0 ? 'text-red-600' : 'text-slate-500'\n          )}>\n            {growth === 0 ? '0%' : `${growth > 0 ? '+' : ''}${growth.toFixed(1)}%`}\n          </div>\n        );\n      }\n    }))\n  ];\n\n  // Generate text content for copy functionality\n  const generateTextContent = () => {\n    const lines = ['Month-on-Month Discount Analysis'];\n    lines.push(`Group: ${groupKey.charAt(0).toUpperCase() + groupKey.slice(1)}, Metric: ${metric}`);\n    lines.push(`View Mode: ${viewMode}`);\n    lines.push(''); // Empty line\n\n    // Headers\n    const headers = ['Group', ...months.map(monthKey => \n      new Date(monthKey + '-01').toLocaleDateString('en-US', { month: 'short', year: 'numeric' })\n    )];\n    lines.push(headers.join('\\t'));\n\n    // Data rows\n    processedData.forEach(row => {\n      const dataRow = [row.group];\n      months.forEach((monthKey, idx) => {\n        const monthData = row.months.get(monthKey);\n        \n        if (viewMode === 'values') {\n          dataRow.push(formatMetricValue(monthData, metric));\n        } else {\n          // Growth mode\n          const prevMonthKey = months[idx - 1];\n          if (!prevMonthKey) {\n            dataRow.push('-');\n          } else {\n            const current = getMetricValue(monthData);\n            const previous = getMetricValue(row.months.get(prevMonthKey));\n            \n            if (previous === 0 && current === 0) {\n              dataRow.push('0%');\n            } else if (previous === 0) {\n              dataRow.push('+100%');\n            } else {\n              const growth = ((current - previous) / previous * 100).toFixed(1);\n              dataRow.push(`${growth}%`);\n            }\n          }\n        }\n      });\n      lines.push(dataRow.join('\\t'));\n    });\n\n    return lines.join('\\n');\n  };\n\n  // Register with MetricsTablesRegistry for \"Copy All Tabs\" functionality\n  useEffect(() => {\n    if (registry) {\n      const tableId = 'Month-on-Month Discount Analysis';\n      registry.register({\n        id: tableId,\n        getTextContent: generateTextContent,\n      });\n      \n      return () => {\n        registry.unregister(tableId);\n      };\n    }\n  }, [registry, processedData, groupKey, metric, viewMode, months]);\n\n  // Calculate totals row\n  const totalsMap = new Map<string, MonthData>();\n  processedData.forEach(row => {\n    months.forEach(monthKey => {\n      const monthData = row.months.get(monthKey);\n      if (!totalsMap.has(monthKey)) {\n        totalsMap.set(monthKey, emptyMonthData());\n      }\n      \n      const acc = totalsMap.get(monthKey)!;\n      if (monthData) {\n        acc.totalDiscounts += monthData.totalDiscounts;\n        acc.discountedTransactions += monthData.discountedTransactions;\n        acc.totalTransactions += monthData.totalTransactions;\n        acc.totalValue += monthData.totalValue;\n        acc.uniqueCustomers += monthData.uniqueCustomers;\n        acc.customersWithDiscounts += monthData.customersWithDiscounts;\n      }\n    });\n  });\n  \n  // Pre-format footer data for display\n  const footerData: Record<string, any> = { group: 'TOTALS' };\n  months.forEach((monthKey, idx) => {\n    const monthData = totalsMap.get(monthKey);\n    if (viewMode === 'values') {\n      footerData[monthKey] = formatMetricValue(monthData, metric);\n    } else {\n      // Growth mode\n      const prevMonthKey = months[idx - 1];\n      if (!prevMonthKey) {\n        footerData[monthKey] = '-';\n      } else {\n        const current = getMetricValue(monthData);\n        const previous = getMetricValue(totalsMap.get(prevMonthKey));\n        if (previous === 0 && current === 0) {\n          footerData[monthKey] = '0%';\n        } else if (previous === 0) {\n          footerData[monthKey] = '+100%';\n        } else {\n          const growth = ((current - previous) / previous) * 100;\n          footerData[monthKey] = `${growth > 0 ? '+' : ''}${growth.toFixed(1)}%`;\n        }\n      }\n    }\n  });\n\n  const tableVariants = { hidden: { opacity: 0, y: 20 }, visible: { opacity: 1, y: 0, transition: { duration: 0.6 } } };\n  const headerVariants = { hidden: { opacity: 0, y: -10 }, visible: { opacity: 1, y: 0, transition: { duration: 0.4, delay: 0.2 } } };\n\n  return (\n    <motion.div \n      variants={tableVariants} \n      initial=\"hidden\" \n      animate=\"visible\" \n      className=\"w-full\"\n    >\n      <Card className=\"w-full bg-white/95 backdrop-blur-sm border-0 shadow-2xl overflow-hidden\">\n        <CardHeader className=\"pb-4\">\n          <motion.div variants={headerVariants} className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 bg-gradient-to-br from-slate-900 to-indigo-900 rounded-lg shadow-lg\">\n                <BarChart3 className=\"w-5 h-5 text-white\" />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900\">Month-on-Month Discount Analysis</h3>\n                <p className=\"text-sm text-gray-600\">Historical discount trends by group and metric</p>\n              </div>\n            </div>\n            <Badge \n              variant=\"outline\" \n              className=\"bg-gradient-to-r from-indigo-500/10 to-purple-500/10 text-indigo-700 border-indigo-300/50 backdrop-blur-sm\"\n            >\n              <Calendar className=\"w-3 h-3 mr-1\" />\n              Last 6 Months\n            </Badge>\n          </motion.div>\n          \n          <motion.div variants={headerVariants} className=\"flex flex-wrap items-center gap-2 text-xs text-slate-600 mt-2\">\n            <Filter className=\"w-3 h-3\" />\n            <span>Showing {processedData.length} groups across {months.length} months</span>\n            <div className=\"flex items-center gap-2 ml-auto\">\n              <select \n                className=\"border rounded-md px-2 py-1 text-xs bg-white\"\n                value={groupKey} \n                onChange={e => setGroupKey(e.target.value as GroupKey)}\n              >\n                <option value=\"product\">Group: Product</option>\n                <option value=\"category\">Group: Category</option>\n                <option value=\"location\">Group: Location</option>\n                <option value=\"soldBy\">Group: Sales Rep</option>\n              </select>\n              \n              <select \n                className=\"border rounded-md px-2 py-1 text-xs bg-white\"\n                value={metric} \n                onChange={e => setMetric(e.target.value as MetricType)}\n              >\n                <option value=\"totalDiscounts\">Metric: Total Discounts</option>\n                <option value=\"discountedTransactions\">Metric: Discounted Transactions</option>\n                <option value=\"avgDiscount\">Metric: Avg Discount</option>\n                <option value=\"discountRate\">Metric: Discount Rate</option>\n                <option value=\"uniqueCustomers\">Metric: Customers w/ Discounts</option>\n                <option value=\"totalValue\">Metric: Total Value</option>\n              </select>\n              \n              <div className=\"flex items-center gap-1 text-xs\">\n                <span className=\"font-medium\">View:</span>\n                <Button \n                  size=\"sm\" \n                  variant={viewMode === 'values' ? 'default' : 'outline'} \n                  onClick={() => setViewMode('values')}\n                  className=\"h-7 px-2\"\n                >\n                  Values\n                </Button>\n                <Button \n                  size=\"sm\" \n                  variant={viewMode === 'growth' ? 'default' : 'outline'} \n                  onClick={() => setViewMode('growth')}\n                  className=\"h-7 px-2\"\n                >\n                  Growth%\n                </Button>\n              </div>\n            </div>\n          </motion.div>\n        </CardHeader>\n        \n        <CardContent className=\"pt-0\">\n          <motion.div \n            className=\"overflow-x-auto\" \n            initial={{ opacity: 0 }} \n            animate={{ opacity: 1 }} \n            transition={{ delay: 0.3 }}\n          >\n            <ModernDataTable\n              data={processedData}\n              columns={columns}\n              loading={false}\n              stickyHeader={true}\n              showFooter={true}\n              footerData={footerData}\n              maxHeight=\"500px\"\n              className=\"rounded-lg\"\n              headerGradient=\"from-slate-800 via-slate-900 to-slate-800\"\n              tableId=\"month-on-month-discount-analysis\"\n            />\n          </motion.div>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n};","import React, { useState, useMemo, useEffect } from 'react';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { DiscountsAnimatedMetricCards } from './DiscountsAnimatedMetricCards';\nimport { AutoCloseFilterSection } from './AutoCloseFilterSection';\nimport { DiscountInteractiveCharts } from './DiscountInteractiveCharts';\nimport { DiscountInteractiveTopBottomLists } from './DiscountInteractiveTopBottomLists';\nimport { EnhancedDiscountDataTable } from './EnhancedDiscountDataTable';\nimport { EnhancedDiscountBreakdownTables } from './EnhancedDiscountBreakdownTables';\nimport { DiscountDrillDownModal } from './DiscountDrillDownModal';\nimport { MonthOnMonthDiscountTable } from './MonthOnMonthDiscountTable';\nimport { getActiveTabClasses } from '@/utils/colorThemes';\nimport { SalesData } from '@/types/dashboard';\nimport { cn } from '@/lib/utils';\nimport { InfoPopover } from '@/components/ui/InfoSidebar';\nimport { StudioLocationTabs } from '@/components/ui/StudioLocationTabs';\nimport { parseDate } from '@/utils/dateUtils';\n\ninterface EnhancedDiscountsDashboardV2Props {\n  data: SalesData[];\n}\n\nconst locations = [\n  { id: 'all', name: 'All Locations' },\n  { id: 'kwality', name: 'Kwality House, Kemps Corner' },\n  { id: 'supreme', name: 'Supreme HQ, Bandra' },\n  { id: 'kenkere', name: 'Kenkere House' },\n  { id: 'popup', name: 'Pop-up' }\n];\n\nconst getPreviousMonthDateRange = () => {\n  const now = new Date();\n  \n  // Use UTC to avoid timezone issues\n  const year = now.getFullYear();\n  const month = now.getMonth(); // Current month (0-indexed)\n  \n  // Get first day of previous month (in local time, formatted as YYYY-MM-DD)\n  const firstDayPreviousMonth = new Date(year, month - 1, 1);\n  const firstFormatted = `${firstDayPreviousMonth.getFullYear()}-${String(firstDayPreviousMonth.getMonth() + 1).padStart(2, '0')}-01`;\n  \n  // Get last day of previous month (in local time, formatted as YYYY-MM-DD)\n  const lastDayPreviousMonth = new Date(year, month, 0);\n  const lastFormatted = `${lastDayPreviousMonth.getFullYear()}-${String(lastDayPreviousMonth.getMonth() + 1).padStart(2, '0')}-${String(lastDayPreviousMonth.getDate()).padStart(2, '0')}`;\n  \n  console.log('Date range calculation:', {\n    today: now.toLocaleDateString(),\n    currentMonth: month,\n    previousMonth: month - 1,\n    firstDay: firstFormatted,\n    lastDay: lastFormatted\n  });\n  \n  return {\n    start: firstFormatted,\n    end: lastFormatted\n  };\n};\n\nexport const EnhancedDiscountsDashboardV2: React.FC<EnhancedDiscountsDashboardV2Props> = ({ data }) => {\n  const [activeLocation, setActiveLocation] = useState('kwality');  // Changed default to 'kwality' for better visibility\n  const [filters, setFilters] = useState<any>({\n    dateRange: { start: null, end: null },\n    category: [],\n    product: [],\n    soldBy: [],\n    paymentMethod: []\n  });\n  \n  const [drillDownData, setDrillDownData] = useState<{\n    isOpen: boolean;\n    title: string;\n    data: any[];\n    type: string;\n  }>({ isOpen: false, title: '', data: [], type: '' });\n\n  // Debug: Log received data with available months\n  useEffect(() => {\n    if (data?.length > 0) {\n      // Analyze what months have data\n      const monthCounts: Record<string, number> = {};\n      data.forEach(d => {\n        if (d.paymentDate) {\n          const parsed = parseDate(d.paymentDate);\n          if (parsed) {\n            const key = `${parsed.getFullYear()}-${String(parsed.getMonth() + 1).padStart(2, '0')}`;\n            monthCounts[key] = (monthCounts[key] || 0) + 1;\n          }\n        }\n      });\n      \n      const sortedMonths = Object.entries(monthCounts).sort((a, b) => b[0].localeCompare(a[0]));\n      \n      console.log('EnhancedDiscountsDashboardV2 received data:', {\n        totalRecords: data?.length || 0,\n        samplePaymentDates: data?.slice(0, 5).map(d => d.paymentDate),\n        availableMonths: sortedMonths.slice(0, 10), // Top 10 most recent months\n        latestMonth: sortedMonths[0]?.[0]\n      });\n    }\n  }, [data]);\n\n  // Get the most recent month with data\n  const getLatestMonthWithData = () => {\n    if (!data || data.length === 0) return null;\n    \n    let latestDate: Date | null = null;\n    \n    data.forEach(d => {\n      if (d.paymentDate) {\n        const parsed = parseDate(d.paymentDate);\n        if (parsed && (!latestDate || parsed > latestDate)) {\n          latestDate = parsed;\n        }\n      }\n    });\n    \n    if (!latestDate) return null;\n    \n    const firstDay = new Date(latestDate.getFullYear(), latestDate.getMonth(), 1);\n    const lastDay = new Date(latestDate.getFullYear(), latestDate.getMonth() + 1, 0);\n    \n    return {\n      start: `${firstDay.getFullYear()}-${String(firstDay.getMonth() + 1).padStart(2, '0')}-01`,\n      end: `${lastDay.getFullYear()}-${String(lastDay.getMonth() + 1).padStart(2, '0')}-${String(lastDay.getDate()).padStart(2, '0')}`\n    };\n  };\n\n  // Set default date range - prefer previous month, but fall back to latest month with data\n  useEffect(() => {\n    if (data && data.length > 0) {\n      const previousMonth = getPreviousMonthDateRange();\n      \n      // Check if previous month has data\n      const prevStart = new Date(previousMonth.start);\n      const prevEnd = new Date(previousMonth.end);\n      prevEnd.setHours(23, 59, 59, 999);\n      \n      const hasDataInPreviousMonth = data.some(d => {\n        if (!d.paymentDate) return false;\n        const parsed = parseDate(d.paymentDate);\n        return parsed && parsed >= prevStart && parsed <= prevEnd;\n      });\n      \n      if (hasDataInPreviousMonth) {\n        console.log('Using previous month (has data):', previousMonth);\n        setFilters(prev => ({\n          ...prev,\n          dateRange: {\n            start: previousMonth.start,\n            end: previousMonth.end\n          }\n        }));\n      } else {\n        // Fall back to latest month with data\n        const latestMonth = getLatestMonthWithData();\n        if (latestMonth) {\n          console.log('Previous month has no data. Using latest month with data:', latestMonth);\n          setFilters(prev => ({\n            ...prev,\n            dateRange: {\n              start: latestMonth.start,\n              end: latestMonth.end\n            }\n          }));\n        }\n      }\n    }\n  }, [data]);\n\n  // Apply filters similar to sales section\n  const applyFilters = (rawData: SalesData[], includeHistoric: boolean = false) => {\n    let filtered = rawData.slice();\n    \n    console.log('Starting filter with:', filtered.length, 'records');\n\n    // Apply location filter\n    if (activeLocation !== 'all') {\n      filtered = filtered.filter(item => {\n        const loc = (item.calculatedLocation || '').toString().toLowerCase();\n        if (activeLocation === 'kwality') return loc.includes('kwality') || loc.includes('kemps');\n        if (activeLocation === 'supreme') return loc.includes('supreme') || loc.includes('bandra');\n        if (activeLocation === 'kenkere') return loc.includes('kenkere') || loc.includes('bengaluru');\n        if (activeLocation === 'popup') return loc.includes('pop') || loc.includes('popup') || loc.includes('pop-up');\n        return false;\n      });\n    }\n\n    console.log('After location filter:', filtered.length, 'records');\n\n    // Apply date range filter (skip if includeHistoric is true)\n    if (!includeHistoric && (filters.dateRange.start || filters.dateRange.end)) {\n      const startDate = filters.dateRange.start ? new Date(filters.dateRange.start) : null;\n      const endDate = filters.dateRange.end ? (() => {\n        const date = new Date(filters.dateRange.end);\n        date.setHours(23, 59, 59, 999);\n        return date;\n      })() : null;\n\n      console.log('Date filtering with range:', { \n        start: startDate?.toISOString(), \n        end: endDate?.toISOString() \n      });\n\n      if (startDate || endDate) {\n        filtered = filtered.filter(item => {\n          if (!item.paymentDate) return false;\n          \n          // Use centralized parseDate utility for consistent parsing\n          const itemDate = parseDate(item.paymentDate);\n          \n          if (!itemDate || isNaN(itemDate.getTime())) {\n            // Debug only first few invalid dates\n            return false;\n          }\n          \n          const itemInRange = (!startDate || itemDate >= startDate) && (!endDate || itemDate <= endDate);\n          \n          return itemInRange;\n        });\n        \n        console.log('After date filter:', filtered.length, 'records');\n      }\n    }\n\n    // Apply category filter\n    if (filters.category && filters.category.length > 0) {\n      filtered = filtered.filter(item => \n        filters.category.includes(item.cleanedCategory || 'Uncategorized')\n      );\n    }\n\n    // Apply product filter\n    if (filters.product && filters.product.length > 0) {\n      filtered = filtered.filter(item => \n        filters.product.includes(item.cleanedProduct || item.paymentItem || 'Unknown')\n      );\n    }\n\n    // Apply soldBy filter\n    if (filters.soldBy && filters.soldBy.length > 0) {\n      filtered = filtered.filter(item => \n        filters.soldBy.includes(item.soldBy || 'Unknown')\n      );\n    }\n\n    // Apply payment method filter\n    if (filters.paymentMethod && filters.paymentMethod.length > 0) {\n      filtered = filtered.filter(item => \n        filters.paymentMethod.includes(item.paymentMethod || 'Unknown')\n      );\n    }\n\n    console.log('Final filtered data:', filtered.length, 'records');\n    return filtered;\n  };\n\n  const filteredData = useMemo(() => applyFilters(data), [data, filters, activeLocation]);\n  const allHistoricData = useMemo(() => applyFilters(data, true), [data, activeLocation]);\n\n  // For discount analysis, we need ALL sales data to calculate discount opportunities and performance\n  // Show all filtered data (both discounted and non-discounted transactions)\n  const discountAnalysisData = useMemo(() => {\n    console.log('Discount Analysis Data:', filteredData.length, 'total transactions');\n    console.log('Sample data:', filteredData.slice(0, 3));\n    return filteredData;\n  }, [filteredData]);\n\n  // Separate data for components that specifically need only discounted transactions\n  const onlyDiscountedData = useMemo(() => {\n    const discounted = filteredData.filter(item => (item.discountAmount || 0) > 0);\n    console.log('Only Discounted Data:', discounted.length, 'discounted transactions');\n    return discounted;\n  }, [filteredData]);\n\n  const handleMetricClick = (metricData: any) => {\n    setDrillDownData({\n      isOpen: true,\n      title: `${metricData.title} Analysis`,\n      data: metricData.rawData || filteredData,\n      type: 'metric'\n    });\n  };\n\n  const handleDrillDown = (title: string, data: any[], type: string) => {\n    setDrillDownData({\n      isOpen: true,\n      title,\n      data,\n      type\n    });\n  };\n\n  const resetFilters = () => {\n    // Check if previous month has data, otherwise use latest month with data\n    const previousMonth = getPreviousMonthDateRange();\n    const prevStart = new Date(previousMonth.start);\n    const prevEnd = new Date(previousMonth.end);\n    prevEnd.setHours(23, 59, 59, 999);\n    \n    const hasDataInPreviousMonth = data.some(d => {\n      if (!d.paymentDate) return false;\n      const parsed = parseDate(d.paymentDate);\n      return parsed && parsed >= prevStart && parsed <= prevEnd;\n    });\n    \n    let dateRange = { start: previousMonth.start, end: previousMonth.end };\n    \n    if (!hasDataInPreviousMonth) {\n      const latestMonth = getLatestMonthWithData();\n      if (latestMonth) {\n        dateRange = latestMonth;\n      }\n    }\n    \n    setFilters({\n      dateRange,\n      category: [],\n      product: [],\n      soldBy: [],\n      paymentMethod: []\n    });\n  };\n\n  // Calculate tab counts for location tabs using filtered data\n  const tabCounts = useMemo(() => {\n    const counts = { all: 0, kwality: 0, supreme: 0, kenkere: 0 };\n    \n    discountAnalysisData.forEach(item => {\n      counts.all++;\n      const loc = (item.calculatedLocation || '').toString().toLowerCase();\n      if (loc.includes('kwality')) {\n        counts.kwality++;\n      } else if (loc.includes('supreme')) {\n        counts.supreme++;\n      } else if (loc.includes('kenkere') || loc.includes('bengaluru')) {\n        counts.kenkere++;\n      }\n    });\n    \n    return counts;\n  }, [discountAnalysisData]);\n\n  return (\n    <div className=\"space-y-8\">\n      {/* Note Taker Component */}\n      <div className=\"container mx-auto px-6\">\n  {/* NoteTaker removed as per request */}\n      </div>\n\n      {/* Enhanced Location Tabs - unified styling (matching Client Retention) */}\n      <div className=\"container mx-auto px-6 space-y-6\">\n        <StudioLocationTabs \n          activeLocation={activeLocation}\n          onLocationChange={setActiveLocation}\n          showInfoPopover={true}\n          infoPopoverContext=\"discounts-promotions-overview\"\n        />\n\n        {/* Content Sections */}\n        <div className=\"space-y-8\">\n        <div className=\"w-full\">\n          <AutoCloseFilterSection\n            filters={filters} \n            onFiltersChange={setFilters} \n            onReset={resetFilters} \n          />\n        </div>\n\n        {/* Modern Animated Metric Cards */}\n        <DiscountsAnimatedMetricCards \n          data={discountAnalysisData}\n          historicalData={allHistoricData}\n          dateRange={filters.dateRange}\n          onMetricClick={handleMetricClick}\n        />\n\n        <DiscountInteractiveCharts data={allHistoricData} />\n\n        <DiscountInteractiveTopBottomLists \n          data={discountAnalysisData} \n          onDrillDown={handleDrillDown}\n        />\n\n        {/* Month-on-Month Analysis Table */}\n        <MonthOnMonthDiscountTable data={allHistoricData} />\n\n        {/* Main Content Tabs */}\n        <Tabs defaultValue=\"detailed\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-3 bg-gradient-to-r from-slate-50 via-indigo-50 to-purple-50 p-1.5 rounded-xl shadow-md border border-slate-200\">\n            <TabsTrigger \n              value=\"detailed\" \n              className=\"rounded-lg px-4 py-2.5 font-semibold transition-all duration-300 text-slate-700 hover:text-slate-900 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg\"\n            >\n              Data Tables\n            </TabsTrigger>\n            <TabsTrigger \n              value=\"breakdown\" \n              className=\"rounded-lg px-4 py-2.5 font-semibold transition-all duration-300 text-slate-700 hover:text-slate-900 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg\"\n            >\n              Breakdowns\n            </TabsTrigger>\n            <TabsTrigger \n              value=\"analytics\" \n              className=\"rounded-lg px-4 py-2.5 font-semibold transition-all duration-300 text-slate-700 hover:text-slate-900 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-600 data-[state=active]:to-purple-600 data-[state=active]:text-white data-[state=active]:shadow-lg\"\n            >\n              Analytics\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"analytics\" className=\"space-y-6\">\n            <DiscountInteractiveCharts data={discountAnalysisData} />\n          </TabsContent>\n\n          <TabsContent value=\"detailed\" className=\"space-y-6\">\n            <div className=\"bg-white/80 backdrop-blur-sm rounded-xl shadow-xl p-6 border border-slate-200/50\">\n              <EnhancedDiscountDataTable \n                data={discountAnalysisData}\n                onRowClick={(title, data, type) => handleDrillDown(title, data, type)}\n              />\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"breakdown\" className=\"space-y-6\">\n            <EnhancedDiscountBreakdownTables \n              data={discountAnalysisData}\n              onDrillDown={handleDrillDown}\n            />\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>      {/* Drill Down Modal */}\n      <DiscountDrillDownModal\n        isOpen={drillDownData.isOpen}\n        onClose={() => setDrillDownData({ isOpen: false, title: '', data: [], type: '' })}\n        title={drillDownData.title}\n        data={drillDownData.data}\n        type={drillDownData.type}\n      />\n    </div>\n  );\n};","import React, { useEffect, useMemo, useState } from 'react';\nimport { useSalesData } from '@/hooks/useSalesData';\nimport { useGlobalLoading } from '@/hooks/useGlobalLoading';\nimport { EnhancedDiscountsDashboardV2 } from '@/components/dashboard/EnhancedDiscountsDashboardV2';\nimport DashboardMotionHero from '@/components/ui/DashboardMotionHero';\nimport { formatNumber, formatCurrency } from '@/utils/formatters';\nimport { useNavigate } from 'react-router-dom';\nimport { Footer } from '@/components/ui/footer';\nimport { AdvancedExportButton } from '@/components/ui/AdvancedExportButton';\n\nconst DiscountsPromotions: React.FC = () => {\n  const navigate = useNavigate();\n  const { setLoading } = useGlobalLoading();\n  const { data: salesData, loading, error } = useSalesData();\n  \n  // Transform sales data for discount analysis\n  const discountData = useMemo(() => {\n    if (!salesData) {\n      return [];\n    }\n    \n    return salesData.map((item: any) => {\n      // Parse numeric values safely\n      const parseNumber = (value: any): number => {\n        if (value === null || value === undefined || value === '') return 0;\n        const cleanValue = value.toString().replace(/[,\\s]/g, '');\n        const num = parseFloat(cleanValue);\n        return isNaN(num) ? 0 : num;\n      };\n\n      const discountAmount = parseNumber(item.discountAmount || item['Discount Amount -Mrp- Payment Value'] || 0);\n      const discountPercentage = parseNumber(item.discountPercentage || item['Discount Percentage - discount amount/mrp*100'] || 0);\n      const paymentValue = parseNumber(item.paymentValue || item['Payment Value'] || 0);\n      const mrpPreTax = parseNumber(item.mrpPreTax || item['Mrp - Pre Tax'] || 0);\n      const mrpPostTax = parseNumber(item.mrpPostTax || item['Mrp - Post Tax'] || 0);\n\n      return {\n        ...item,\n        memberId: item.memberId || item['Member ID']?.toString() || '',\n        customerName: item.customerName || item['Customer Name'] || '',\n        customerEmail: item.customerEmail || item['Customer Email'] || '',\n        paymentDate: item.paymentDate || item['Payment Date'] || '',\n        paymentValue,\n        paymentMethod: item.paymentMethod || item['Payment Method'] || '',\n        calculatedLocation: item.calculatedLocation || item['Calculated Location'] || '',\n        cleanedProduct: item.cleanedProduct || item['Cleaned Product'] || '',\n        cleanedCategory: item.cleanedCategory || item['Cleaned Category'] || '',\n        soldBy: item.soldBy === '-' ? 'Online/System' : (item.soldBy || item['Sold By'] || 'Unknown'),\n        discountAmount,\n        discountPercentage,\n        mrpPreTax,\n        mrpPostTax,\n        hasDiscount: discountAmount > 0 || discountPercentage > 0,\n      };\n    });\n  }, [salesData]);\n\n  const heroMetrics = useMemo(() => {\n    if (!discountData || discountData.length === 0) return [];\n\n    // Import parseDate for consistent date handling\n    const parseDateStr = (dateStr: string): Date | null => {\n      if (!dateStr || dateStr.trim() === '') return null;\n      try {\n        // Handle DD/MM/YYYY format with optional time\n        if (dateStr.includes('/')) {\n          const datePart = dateStr.split(' ')[0].trim();\n          const parts = datePart.split('/');\n          if (parts.length === 3) {\n            const day = parseInt(parts[0]);\n            const month = parseInt(parts[1]);\n            const year = parseInt(parts[2]);\n            if (!isNaN(year) && !isNaN(month) && !isNaN(day)) {\n              return new Date(year, month - 1, day);\n            }\n          }\n        }\n        // Handle YYYY-MM-DD format\n        if (dateStr.includes('-')) {\n          const date = new Date(dateStr);\n          if (!isNaN(date.getTime())) return date;\n        }\n        return null;\n      } catch (e) {\n        return null;\n      }\n    };\n\n    // Always use previous month\n    const now = new Date();\n    const firstDayOfMonth = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n    const lastDayOfMonth = new Date(now.getFullYear(), now.getMonth(), 0, 23, 59, 59, 999);\n\n    // Filter data for that month\n    const monthData = discountData.filter(item => {\n      if (!item.paymentDate) return false;\n      const itemDate = parseDateStr(item.paymentDate);\n      return itemDate && itemDate >= firstDayOfMonth && itemDate <= lastDayOfMonth;\n    });\n\n    const locations = [\n      { key: 'Kwality House, Kemps Corner', name: 'Kwality' },\n      { key: 'Supreme HQ, Bandra', name: 'Supreme' },\n      { key: 'Kenkere House', name: 'Kenkere' }\n    ];\n\n    return locations.map(location => {\n      const locationData = monthData.filter(item => \n        location.key === 'Kenkere House' \n          ? item.calculatedLocation?.includes('Kenkere') || item.calculatedLocation === 'Kenkere House'\n          : item.calculatedLocation === location.key\n      );\n      \n      const totalDiscounts = locationData.reduce((sum, item) => sum + (item.discountAmount || 0), 0);\n      \n      return {\n        location: location.name,\n        label: 'Previous Month Discounts',\n        value: formatCurrency(totalDiscounts)\n      };\n    });\n  }, [discountData]);\n\n  useEffect(() => {\n    setLoading(loading, 'Loading discount and promotional analysis...');\n  }, [loading, setLoading]);\n\n  // Remove individual loader - rely on global loader only\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-indigo-50/30 to-purple-50/20\">\n        <div className=\"flex items-center justify-center min-h-screen p-4\">\n          <div className=\"text-center\">\n            <h1 className=\"text-2xl font-bold text-red-600 mb-4\">Connection Error</h1>\n            <p className=\"text-gray-600 mb-4\">{error}</p>\n            <button \n              onClick={() => window.location.reload()}\n              className=\"bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700\"\n            >\n              Retry Loading\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const exportButton = (\n    <AdvancedExportButton \n      discountData={discountData}\n      defaultFileName=\"discounts-promotions-export\"\n      size=\"sm\"\n      variant=\"ghost\"\n      buttonClassName=\"rounded-xl border border-white/30 text-white hover:border-white/50\"\n    />\n  );\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-purple-50/30 to-indigo-50/20\">\n      <DashboardMotionHero \n        title=\"Discounts & Promotions\"\n        subtitle=\"Comprehensive analysis of discount strategies, promotional effectiveness, and customer savings patterns\"\n        metrics={heroMetrics}\n        extra={exportButton}\n      />\n\n      {/* Main Content */}\n      <div className=\"container mx-auto px-6 py-8\">\n        <main className=\"space-y-8\">\n          <EnhancedDiscountsDashboardV2 data={discountData} />\n        </main>\n      </div>\n      \n      <Footer />\n\n      <style>{`\n        @keyframes fade-in-up {\n          from {\n            opacity: 0;\n            transform: translateY(30px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n        \n        @keyframes bounce-slow {\n          0%, 20%, 50%, 80%, 100% {\n            transform: translateY(0);\n          }\n          40% {\n            transform: translateY(-15px);\n          }\n          60% {\n            transform: translateY(-8px);\n          }\n        }\n        \n        @keyframes pulse-slow {\n          0%, 100% {\n            opacity: 0.3;\n            transform: scale(1);\n          }\n          50% {\n            opacity: 0.7;\n            transform: scale(1.08);\n          }\n        }\n        \n        @keyframes spin-slow {\n          from {\n            transform: rotate(0deg);\n          }\n          to {\n            transform: rotate(360deg);\n          }\n        }\n        \n        @keyframes float {\n          0%, 100% {\n            transform: translateY(0px) translateX(0px);\n          }\n          33% {\n            transform: translateY(-12px) translateX(4px);\n          }\n          66% {\n            transform: translateY(-6px) translateX(-4px);\n          }\n        }\n        \n        @keyframes twinkle {\n          0%, 100% {\n            opacity: 0.3;\n            transform: scale(1) rotate(0deg);\n          }\n          25% {\n            opacity: 0.9;\n            transform: scale(1.3) rotate(90deg);\n          }\n          75% {\n            opacity: 0.6;\n            transform: scale(0.8) rotate(270deg);\n          }\n        }\n        \n        @keyframes drift-left {\n          0%, 100% {\n            transform: translateX(0px) translateY(0px);\n          }\n          50% {\n            transform: translateX(-20px) translateY(-10px);\n          }\n        }\n        \n        @keyframes drift-right {\n          0%, 100% {\n            transform: translateX(0px) translateY(0px);\n          }\n          50% {\n            transform: translateX(20px) translateY(-10px);\n          }\n        }\n        \n        @keyframes gentle-float {\n          0%, 100% {\n            transform: translateY(0px);\n          }\n          50% {\n            transform: translateY(-8px);\n          }\n        }\n        \n        @keyframes gentle-bounce {\n          0%, 100% {\n            transform: translateY(0px);\n          }\n          50% {\n            transform: translateY(-6px);\n          }\n        }\n        \n        @keyframes gentle-pulse {\n          0%, 100% {\n            opacity: 0.2;\n            transform: scale(1);\n          }\n          50% {\n            opacity: 0.5;\n            transform: scale(1.1);\n          }\n        }\n        \n        @keyframes gentle-spin {\n          from {\n            transform: rotate(0deg);\n          }\n          to {\n            transform: rotate(360deg);\n          }\n        }\n        \n        @keyframes gentle-drift {\n          0%, 100% {\n            transform: translateX(0px);\n          }\n          50% {\n            transform: translateX(10px);\n          }\n        }\n        \n        @keyframes gentle-wave {\n          0%, 100% {\n            transform: translateY(0px) rotate(0deg);\n          }\n          50% {\n            transform: translateY(-5px) rotate(180deg);\n          }\n        }\n        \n        @keyframes gentle-bob {\n          0%, 100% {\n            transform: translateY(0px) translateX(0px);\n          }\n          33% {\n            transform: translateY(-4px) translateX(2px);\n          }\n          66% {\n            transform: translateY(-2px) translateX(-2px);\n          }\n        }\n        \n        .animate-fade-in-up {\n          animation: fade-in-up 0.6s ease-out forwards;\n        }\n        \n        .animate-bounce-slow {\n          animation: bounce-slow 4s ease-in-out infinite;\n        }\n        \n        .animate-pulse-slow {\n          animation: pulse-slow 5s ease-in-out infinite;\n        }\n        \n        .animate-spin-slow {\n          animation: spin-slow 12s linear infinite;\n        }\n        \n        .animate-float {\n          animation: float 4s ease-in-out infinite;\n        }\n        \n        .animate-twinkle {\n          animation: twinkle 3s ease-in-out infinite;\n        }\n        \n        .animate-drift-left {\n          animation: drift-left 6s ease-in-out infinite;\n        }\n        \n        .animate-drift-right {\n          animation: drift-right 6s ease-in-out infinite;\n        }\n        \n        .animate-gentle-float {\n          animation: gentle-float 3s ease-in-out infinite;\n        }\n        \n        .animate-gentle-bounce {\n          animation: gentle-bounce 2.5s ease-in-out infinite;\n        }\n        \n        .animate-gentle-pulse {\n          animation: gentle-pulse 4s ease-in-out infinite;\n        }\n        \n        .animate-gentle-spin {\n          animation: gentle-spin 20s linear infinite;\n        }\n        \n        .animate-gentle-drift {\n          animation: gentle-drift 5s ease-in-out infinite;\n        }\n        \n        .animate-gentle-wave {\n          animation: gentle-wave 4s ease-in-out infinite;\n        }\n        \n        .animate-gentle-bob {\n          animation: gentle-bob 3.5s ease-in-out infinite;\n        }\n        \n        .animate-bounce-delayed {\n          animation: bounce-slow 4s ease-in-out infinite;\n          animation-delay: 0.8s;\n        }\n        \n        .animate-pulse-delayed {\n          animation: pulse-slow 5s ease-in-out infinite;\n          animation-delay: 1.2s;\n        }\n        \n        .animate-float-delayed {\n          animation: float 4s ease-in-out infinite;\n          animation-delay: 2s;\n        }\n        \n        /* Enhanced Glow effects */\n        .glow-purple {\n          filter: drop-shadow(0 0 25px rgba(168, 85, 247, 0.6)) drop-shadow(0 0 50px rgba(168, 85, 247, 0.3));\n        }\n        \n        .glow-blue {\n          filter: drop-shadow(0 0 25px rgba(59, 130, 246, 0.6)) drop-shadow(0 0 50px rgba(59, 130, 246, 0.3));\n        }\n        \n        .glow-pink {\n          filter: drop-shadow(0 0 25px rgba(236, 72, 153, 0.6)) drop-shadow(0 0 50px rgba(236, 72, 153, 0.3));\n        }\n        \n        .glow-green {\n          filter: drop-shadow(0 0 25px rgba(34, 197, 94, 0.6)) drop-shadow(0 0 50px rgba(34, 197, 94, 0.3));\n        }\n        \n        .glow-yellow {\n          filter: drop-shadow(0 0 25px rgba(234, 179, 8, 0.6)) drop-shadow(0 0 50px rgba(234, 179, 8, 0.3));\n        }\n        \n        .glow-indigo {\n          filter: drop-shadow(0 0 25px rgba(99, 102, 241, 0.6)) drop-shadow(0 0 50px rgba(99, 102, 241, 0.3));\n        }\n        \n        .glow-orange {\n          filter: drop-shadow(0 0 25px rgba(249, 115, 22, 0.6)) drop-shadow(0 0 50px rgba(249, 115, 22, 0.3));\n        }\n        \n        .glow-cyan {\n          filter: drop-shadow(0 0 20px rgba(6, 182, 212, 0.5));\n        }\n        \n        .glow-rose {\n          filter: drop-shadow(0 0 20px rgba(244, 63, 94, 0.5));\n        }\n        \n        .glow-emerald {\n          filter: drop-shadow(0 0 20px rgba(16, 185, 129, 0.5));\n        }\n        \n        .glow-violet {\n          filter: drop-shadow(0 0 20px rgba(139, 69, 228, 0.5));\n        }\n        \n        .glow-amber {\n          filter: drop-shadow(0 0 20px rgba(245, 158, 11, 0.5));\n        }\n        \n        .glow-teal {\n          filter: drop-shadow(0 0 15px rgba(20, 184, 166, 0.4));\n        }\n        \n        .glow-fuchsia {\n          filter: drop-shadow(0 0 15px rgba(217, 70, 239, 0.4));\n        }\n        \n        .glow-lime {\n          filter: drop-shadow(0 0 15px rgba(132, 204, 22, 0.4));\n        }\n        \n        .glow-sky {\n          filter: drop-shadow(0 0 15px rgba(14, 165, 233, 0.4));\n        }\n        \n        .glow-red {\n          filter: drop-shadow(0 0 15px rgba(239, 68, 68, 0.4));\n        }\n        \n        .glow-blue-light {\n          filter: drop-shadow(0 0 12px rgba(147, 197, 253, 0.3));\n        }\n        \n        .glow-purple-light {\n          filter: drop-shadow(0 0 12px rgba(196, 181, 253, 0.3));\n        }\n        \n        .delay-200 {\n          animation-delay: 0.2s;\n        }\n        \n        .delay-300 {\n          animation-delay: 0.3s;\n        }\n        \n        .delay-500 {\n          animation-delay: 0.5s;\n        }\n      `}</style>\n    </div>\n  );\n};\n\nexport default DiscountsPromotions;"],"names":["_typeof","o","_classCallCheck","instance","Constructor","_defineProperties","target","props","i","descriptor","_toPropertyKey","_createClass","protoProps","staticProps","_callSuper","t","e","_getPrototypeOf","_possibleConstructorReturn","_isNativeReflectConstruct","self","call","_assertThisInitialized","_inherits","subClass","superClass","_setPrototypeOf","p","_defineProperty","obj","key","value","_toPrimitive","r","ZAxis","_React$Component","React.Component","_excluded","_extends","source","_objectWithoutProperties","excluded","_objectWithoutPropertiesLoose","sourceSymbolKeys","ScatterSymbol","_ref","option","isActive","React.createElement","Shape","Symbols","ownKeys","_objectSpread","Scatter","_PureComponent","_this","_len","args","_key","uniqueId","points","_this2","_this$props","shape","activeShape","activeIndex","baseProps","filterProps","entry","React","Layer","adaptEventsOfChild","_this3","_this$props2","isAnimationActive","animationBegin","animationDuration","animationEasing","animationId","prevPoints","Animate","stepData","index","prev","interpolatorCx","interpolateNumber","interpolatorCy","interpolatorSize","interpolator","_this$props3","isEqual","_this$props4","xAxis","yAxis","children","errorBarItems","findAllByType","ErrorBar","item","_item$props","direction","errorDataKey","dataPoint","dataKey","getValueByDataKey","_this$props5","line","lineType","lineJointType","scatterProps","customLineProps","linePoints","lineItem","_getLinearRegression","getLinearRegression","xmin","xmax","a","b","linearExp","x","lineProps","isFunction","Curve","_this$props6","hide","className","left","top","width","height","id","isAnimationFinished","layerClass","clsx","needClipX","needClipY","needClip","clipPathId","isNil","LabelList","nextProps","prevState","PureComponent","Global","_ref2","zAxis","displayedData","xAxisTicks","yAxisTicks","offset","tooltipType","cells","Cell","xAxisDataKey","yAxisDataKey","zAxisDataKey","defaultRangeZ","defaultZ","xBandSize","yBandSize","y","z","tooltipPayload","cx","getCateCoordinateOfLine","cy","size","radius","ScatterChart","generateCategoricalChart","XAxis","YAxis","formatAxisMap","num","v","n","calcGrowth","current","previous","rate","mag","trend","useDiscountMetrics","data","historicalData","options","useMemo","compareEnd","monthStart","d","monthEnd","currentStart","prevAnchor","prevStart","prevEnd","fmt","periodLabel","within","start","end","it","parseDate","totals","list","totalDiscounts","s","totalRevenue","totalTransactions","discountedTransactions","uniqueCustomers","customersWithDiscounts","grossRevenue","discountRate","discountPenetration","customerDiscountPenetration","avgDiscountPerTransaction","avgDiscountPerCustomer","cur","formatCurrency","formatPercentage","formatNumber","iconMap","DollarSign","ShoppingCart","Activity","Users","Target","Percent","CreditCard","ArrowDownRight","DiscountsAnimatedMetricCards","dateRange","onMetricClick","metrics","calculatedContext","sum","handleMetricClick","metric","drillDownData","jsx","IconComponent","isPositive","isNegative","Card","cn","jsxs","CardContent","TrendingUp","TrendingDown","Fragment","COLORS","DiscountInteractiveCharts","filters","activeChart","setActiveChart","useState","chartData","filteredData","itemDate","monthlyData","acc","date","monthKey","monthlyTrends","categoryData","category","categoryDistribution","rangeAnalysis","range","itemsInRange","discount","scatterData","Tabs","TabsList","TabsTrigger","Calendar","PieChartIcon","BarChart3","TabsContent","CardHeader","CardTitle","ResponsiveContainer","LineChart","CartesianGrid","Tooltip","name","Legend","Bar","Line","PieChart","Pie","BarChart","DiscountInteractiveTopBottomLists","onDrillDown","sortOrder","setSortOrder","processedData","byCategory","byProduct","bySoldBy","byPaymentMethod","processArray","renderTopBottomList","items","icon","title","type","topItems","bottomItems","Crown","Button","ArrowUpDown","Badge","Package","User","EnhancedDiscountDataTable","onRowClick","useGlobalFilters","periodId","searchTerm","setSearchTerm","sortColumn","setSortColumn","sortDirection","setSortDirection","currentPage","setCurrentPage","itemsPerPage","filteredAndSortedData","filtered","searchLower","aValue","bValue","totalPages","paginatedData","summaryStats","totalDiscount","totalMrp","avgDiscountPercentage","handleSort","column","handleRowClick","getSortIcon","getDiscountBadgeColor","percentage","footerColumns","containerRef","useRef","registry","useMetricsTablesRegistry","tableId","useEffect","el","getTextContent","table","text","headerCells","headers","cell","row","rowData","c","Search","Input","Download","CopyTableButton","Table","TableHeader","TableRow","TableHead","TableBody","TableCell","Eye","TableFooter","PersistentTableFooter","EnhancedDiscountBreakdownTables","productRef","locationRef","staffRef","register","ref","productBreakdown","breakdown","locationBreakdown","staffBreakdown","handleDrillDown","getPerformanceBadge","badge","MapPin","emptyMonthData","MonthOnMonthDiscountTable","groupKey","setGroupKey","setMetric","viewMode","setViewMode","months","now","arr","map","addToMonthData","monthData","discountAmount","paymentValue","hasDiscount","groupValue","totalValue","formatMetricValue","metricType","getMetricValue","columns","idx","_","prevMonthKey","growth","generateTextContent","lines","dataRow","totalsMap","footerData","tableVariants","headerVariants","motion","Filter","ModernDataTable","getPreviousMonthDateRange","year","month","firstDayPreviousMonth","firstFormatted","lastDayPreviousMonth","lastFormatted","EnhancedDiscountsDashboardV2","activeLocation","setActiveLocation","setFilters","setDrillDownData","monthCounts","parsed","getLatestMonthWithData","latestDate","firstDay","lastDay","previousMonth","latestMonth","applyFilters","rawData","includeHistoric","loc","startDate","endDate","allHistoricData","discountAnalysisData","metricData","resetFilters","hasDataInPreviousMonth","counts","StudioLocationTabs","AutoCloseFilterSection","DiscountDrillDownModal","DiscountsPromotions","useNavigate","setLoading","useGlobalLoading","salesData","loading","error","useSalesData","discountData","parseNumber","cleanValue","discountPercentage","mrpPreTax","mrpPostTax","heroMetrics","parseDateStr","dateStr","parts","day","firstDayOfMonth","lastDayOfMonth","location","exportButton","AdvancedExportButton","DashboardMotionHero","Footer"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}