import{i as Et,aO as St,r as O,g as et,p as ee,d as tt,h as ce,j as e,C as F,c as P,a as U,b as H}from"./index-Bm67KBkU.js";import{F as At}from"./footer-BTvMjyAb.js";import{T as Tt,a as It,b as Ot,c as _t}from"./tabs-BTrhdLSC.js";import{A as Lt}from"./AutoCloseFilterSection-DJhjGBJF.js";import{B as Mt}from"./BrandSpinner-CGFi2e0U.js";import{f as C,b as p,a as j,e as $t}from"./index-DkD_C-d1.js";import{u as Dt}from"./useSalesData-Bl_2HqTc.js";import{u as kt}from"./useSessionsData-CuS9CUZY.js";import{u as Ft}from"./usePayrollData-DIt-ymzP.js";import{u as Pt}from"./useNewClientData-Dl1VV2C_.js";import{u as Gt}from"./useLeadsData-nt_JwR0P.js";import{u as Ut}from"./useDiscountAnalysis-Vi7IK6Kl.js";import{u as Ht}from"./useLateCancellationsData-CGb6iEHP.js";import{u as Bt}from"./useExpirationsData-CHlNy1D0.js";import{F as Yt}from"./file-text-DChZNHsM.js";import{T as ve}from"./googleAuth-BGo8ElRc.js";import{U as W}from"./users-7Ku-1TDB.js";import{T as be}from"./target-BmxdxojS.js";import{A as le}from"./activity-CeUP9h5f.js";import{C as ye}from"./circle-alert-bpasmovd.js";import{C as Me}from"./circle-check-big-y8tZauB3.js";import"./select-CM-Birqk.js";import"./chevron-right-CbIMR3DA.js";import"./index-BdQq_4o_.js";import"./collapsible-bGJQ2Wb9.js";import"./useGoogleSheets-BPVLuLVa.js";const qt=Et("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);var $e;(function(s){s.STRING="string",s.NUMBER="number",s.INTEGER="integer",s.BOOLEAN="boolean",s.ARRAY="array",s.OBJECT="object"})($e||($e={}));var De;(function(s){s.LANGUAGE_UNSPECIFIED="language_unspecified",s.PYTHON="python"})(De||(De={}));var ke;(function(s){s.OUTCOME_UNSPECIFIED="outcome_unspecified",s.OUTCOME_OK="outcome_ok",s.OUTCOME_FAILED="outcome_failed",s.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(ke||(ke={}));const Fe=["user","model","function","system"];var Pe;(function(s){s.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",s.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",s.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",s.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",s.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",s.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Pe||(Pe={}));var Ge;(function(s){s.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",s.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",s.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",s.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",s.BLOCK_NONE="BLOCK_NONE"})(Ge||(Ge={}));var Ue;(function(s){s.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",s.NEGLIGIBLE="NEGLIGIBLE",s.LOW="LOW",s.MEDIUM="MEDIUM",s.HIGH="HIGH"})(Ue||(Ue={}));var He;(function(s){s.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",s.SAFETY="SAFETY",s.OTHER="OTHER"})(He||(He={}));var te;(function(s){s.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",s.STOP="STOP",s.MAX_TOKENS="MAX_TOKENS",s.SAFETY="SAFETY",s.RECITATION="RECITATION",s.LANGUAGE="LANGUAGE",s.BLOCKLIST="BLOCKLIST",s.PROHIBITED_CONTENT="PROHIBITED_CONTENT",s.SPII="SPII",s.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",s.OTHER="OTHER"})(te||(te={}));var Be;(function(s){s.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",s.RETRIEVAL_QUERY="RETRIEVAL_QUERY",s.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",s.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",s.CLASSIFICATION="CLASSIFICATION",s.CLUSTERING="CLUSTERING"})(Be||(Be={}));var Ye;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.AUTO="AUTO",s.ANY="ANY",s.NONE="NONE"})(Ye||(Ye={}));var qe;(function(s){s.MODE_UNSPECIFIED="MODE_UNSPECIFIED",s.MODE_DYNAMIC="MODE_DYNAMIC"})(qe||(qe={}));class T extends Error{constructor(t){super(`[GoogleGenerativeAI Error]: ${t}`)}}class Q extends T{constructor(t,n){super(t),this.response=n}}class st extends T{constructor(t,n,a,r){super(t),this.status=n,this.statusText=a,this.errorDetails=r}}class K extends T{}class nt extends T{}const Kt="https://generativelanguage.googleapis.com",Vt="v1beta",zt="0.24.1",Jt="genai-js";var z;(function(s){s.GENERATE_CONTENT="generateContent",s.STREAM_GENERATE_CONTENT="streamGenerateContent",s.COUNT_TOKENS="countTokens",s.EMBED_CONTENT="embedContent",s.BATCH_EMBED_CONTENTS="batchEmbedContents"})(z||(z={}));class Wt{constructor(t,n,a,r,i){this.model=t,this.task=n,this.apiKey=a,this.stream=r,this.requestOptions=i}toString(){var t,n;const a=((t=this.requestOptions)===null||t===void 0?void 0:t.apiVersion)||Vt;let i=`${((n=this.requestOptions)===null||n===void 0?void 0:n.baseUrl)||Kt}/${a}/${this.model}:${this.task}`;return this.stream&&(i+="?alt=sse"),i}}function Qt(s){const t=[];return s?.apiClient&&t.push(s.apiClient),t.push(`${Jt}/${zt}`),t.join(" ")}async function Xt(s){var t;const n=new Headers;n.append("Content-Type","application/json"),n.append("x-goog-api-client",Qt(s.requestOptions)),n.append("x-goog-api-key",s.apiKey);let a=(t=s.requestOptions)===null||t===void 0?void 0:t.customHeaders;if(a){if(!(a instanceof Headers))try{a=new Headers(a)}catch(r){throw new K(`unable to convert customHeaders value ${JSON.stringify(a)} to Headers: ${r.message}`)}for(const[r,i]of a.entries()){if(r==="x-goog-api-key")throw new K(`Cannot set reserved header name ${r}`);if(r==="x-goog-api-client")throw new K(`Header name ${r} can only be set using the apiClient field`);n.append(r,i)}}return n}async function Zt(s,t,n,a,r,i){const o=new Wt(s,t,n,a,i);return{url:o.toString(),fetchOptions:Object.assign(Object.assign({},ns(i)),{method:"POST",headers:await Xt(o),body:r})}}async function ae(s,t,n,a,r,i={},o=fetch){const{url:l,fetchOptions:d}=await Zt(s,t,n,a,r,i);return es(l,d,o)}async function es(s,t,n=fetch){let a;try{a=await n(s,t)}catch(r){ts(r,s)}return a.ok||await ss(a,s),a}function ts(s,t){let n=s;throw n.name==="AbortError"?(n=new nt(`Request aborted when fetching ${t.toString()}: ${s.message}`),n.stack=s.stack):s instanceof st||s instanceof K||(n=new T(`Error fetching from ${t.toString()}: ${s.message}`),n.stack=s.stack),n}async function ss(s,t){let n="",a;try{const r=await s.json();n=r.error.message,r.error.details&&(n+=` ${JSON.stringify(r.error.details)}`,a=r.error.details)}catch{}throw new st(`Error fetching from ${t.toString()}: [${s.status} ${s.statusText}] ${n}`,s.status,s.statusText,a)}function ns(s){const t={};if(s?.signal!==void 0||s?.timeout>=0){const n=new AbortController;s?.timeout>=0&&setTimeout(()=>n.abort(),s.timeout),s?.signal&&s.signal.addEventListener("abort",()=>{n.abort()}),t.signal=n.signal}return t}function je(s){return s.text=()=>{if(s.candidates&&s.candidates.length>0){if(s.candidates.length>1,de(s.candidates[0]))throw new Q(`${q(s)}`,s);return as(s)}else if(s.promptFeedback)throw new Q(`Text not available. ${q(s)}`,s);return""},s.functionCall=()=>{if(s.candidates&&s.candidates.length>0){if(s.candidates.length>1,de(s.candidates[0]))throw new Q(`${q(s)}`,s);return Ke(s)[0]}else if(s.promptFeedback)throw new Q(`Function call not available. ${q(s)}`,s)},s.functionCalls=()=>{if(s.candidates&&s.candidates.length>0){if(s.candidates.length>1,de(s.candidates[0]))throw new Q(`${q(s)}`,s);return Ke(s)}else if(s.promptFeedback)throw new Q(`Function call not available. ${q(s)}`,s)},s}function as(s){var t,n,a,r;const i=[];if(!((n=(t=s.candidates)===null||t===void 0?void 0:t[0].content)===null||n===void 0)&&n.parts)for(const o of(r=(a=s.candidates)===null||a===void 0?void 0:a[0].content)===null||r===void 0?void 0:r.parts)o.text&&i.push(o.text),o.executableCode&&i.push("\n```"+o.executableCode.language+`
`+o.executableCode.code+"\n```\n"),o.codeExecutionResult&&i.push("\n```\n"+o.codeExecutionResult.output+"\n```\n");return i.length>0?i.join(""):""}function Ke(s){var t,n,a,r;const i=[];if(!((n=(t=s.candidates)===null||t===void 0?void 0:t[0].content)===null||n===void 0)&&n.parts)for(const o of(r=(a=s.candidates)===null||a===void 0?void 0:a[0].content)===null||r===void 0?void 0:r.parts)o.functionCall&&i.push(o.functionCall);if(i.length>0)return i}const rs=[te.RECITATION,te.SAFETY,te.LANGUAGE];function de(s){return!!s.finishReason&&rs.includes(s.finishReason)}function q(s){var t,n,a;let r="";if((!s.candidates||s.candidates.length===0)&&s.promptFeedback)r+="Response was blocked",!((t=s.promptFeedback)===null||t===void 0)&&t.blockReason&&(r+=` due to ${s.promptFeedback.blockReason}`),!((n=s.promptFeedback)===null||n===void 0)&&n.blockReasonMessage&&(r+=`: ${s.promptFeedback.blockReasonMessage}`);else if(!((a=s.candidates)===null||a===void 0)&&a[0]){const i=s.candidates[0];de(i)&&(r+=`Candidate was blocked due to ${i.finishReason}`,i.finishMessage&&(r+=`: ${i.finishMessage}`))}return r}function se(s){return this instanceof se?(this.v=s,this):new se(s)}function os(s,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a=n.apply(s,t||[]),r,i=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(c){a[c]&&(r[c]=function(v){return new Promise(function(w,N){i.push([c,v,w,N])>1||l(c,v)})})}function l(c,v){try{d(a[c](v))}catch(w){E(i[0][3],w)}}function d(c){c.value instanceof se?Promise.resolve(c.value.v).then(h,y):E(i[0][2],c)}function h(c){l("next",c)}function y(c){l("throw",c)}function E(c,v){c(v),i.shift(),i.length&&l(i[0][0],i[0][1])}}const Ve=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function is(s){const t=s.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),n=ds(t),[a,r]=n.tee();return{stream:cs(a),response:ls(r)}}async function ls(s){const t=[],n=s.getReader();for(;;){const{done:a,value:r}=await n.read();if(a)return je(us(t));t.push(r)}}function cs(s){return os(this,arguments,function*(){const n=s.getReader();for(;;){const{value:a,done:r}=yield se(n.read());if(r)break;yield yield se(je(a))}})}function ds(s){const t=s.getReader();return new ReadableStream({start(a){let r="";return i();function i(){return t.read().then(({value:o,done:l})=>{if(l){if(r.trim()){a.error(new T("Failed to parse stream"));return}a.close();return}r+=o;let d=r.match(Ve),h;for(;d;){try{h=JSON.parse(d[1])}catch{a.error(new T(`Error parsing JSON response: "${d[1]}"`));return}a.enqueue(h),r=r.substring(d[0].length),d=r.match(Ve)}return i()}).catch(o=>{let l=o;throw l.stack=o.stack,l.name==="AbortError"?l=new nt("Request aborted when reading from the stream"):l=new T("Error reading from the stream"),l})}}})}function us(s){const t=s[s.length-1],n={promptFeedback:t?.promptFeedback};for(const a of s){if(a.candidates){let r=0;for(const i of a.candidates)if(n.candidates||(n.candidates=[]),n.candidates[r]||(n.candidates[r]={index:r}),n.candidates[r].citationMetadata=i.citationMetadata,n.candidates[r].groundingMetadata=i.groundingMetadata,n.candidates[r].finishReason=i.finishReason,n.candidates[r].finishMessage=i.finishMessage,n.candidates[r].safetyRatings=i.safetyRatings,i.content&&i.content.parts){n.candidates[r].content||(n.candidates[r].content={role:i.content.role||"user",parts:[]});const o={};for(const l of i.content.parts)l.text&&(o.text=l.text),l.functionCall&&(o.functionCall=l.functionCall),l.executableCode&&(o.executableCode=l.executableCode),l.codeExecutionResult&&(o.codeExecutionResult=l.codeExecutionResult),Object.keys(o).length===0&&(o.text=""),n.candidates[r].content.parts.push(o)}r++}a.usageMetadata&&(n.usageMetadata=a.usageMetadata)}return n}async function at(s,t,n,a){const r=await ae(t,z.STREAM_GENERATE_CONTENT,s,!0,JSON.stringify(n),a);return is(r)}async function rt(s,t,n,a){const i=await(await ae(t,z.GENERATE_CONTENT,s,!1,JSON.stringify(n),a)).json();return{response:je(i)}}function ot(s){if(s!=null){if(typeof s=="string")return{role:"system",parts:[{text:s}]};if(s.text)return{role:"system",parts:[s]};if(s.parts)return s.role?s:{role:"system",parts:s.parts}}}function ne(s){let t=[];if(typeof s=="string")t=[{text:s}];else for(const n of s)typeof n=="string"?t.push({text:n}):t.push(n);return hs(t)}function hs(s){const t={role:"user",parts:[]},n={role:"function",parts:[]};let a=!1,r=!1;for(const i of s)"functionResponse"in i?(n.parts.push(i),r=!0):(t.parts.push(i),a=!0);if(a&&r)throw new T("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!a&&!r)throw new T("No content is provided for sending chat message.");return a?t:n}function gs(s,t){var n;let a={model:t?.model,generationConfig:t?.generationConfig,safetySettings:t?.safetySettings,tools:t?.tools,toolConfig:t?.toolConfig,systemInstruction:t?.systemInstruction,cachedContent:(n=t?.cachedContent)===null||n===void 0?void 0:n.name,contents:[]};const r=s.generateContentRequest!=null;if(s.contents){if(r)throw new K("CountTokensRequest must have one of contents or generateContentRequest, not both.");a.contents=s.contents}else if(r)a=Object.assign(Object.assign({},a),s.generateContentRequest);else{const i=ne(s);a.contents=[i]}return{generateContentRequest:a}}function ze(s){let t;return s.contents?t=s:t={contents:[ne(s)]},s.systemInstruction&&(t.systemInstruction=ot(s.systemInstruction)),t}function ms(s){return typeof s=="string"||Array.isArray(s)?{content:ne(s)}:s}const Je=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],fs={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function xs(s){let t=!1;for(const n of s){const{role:a,parts:r}=n;if(!t&&a!=="user")throw new T(`First content should be with role 'user', got ${a}`);if(!Fe.includes(a))throw new T(`Each item should include role field. Got ${a} but valid roles are: ${JSON.stringify(Fe)}`);if(!Array.isArray(r))throw new T("Content should have 'parts' property with an array of Parts");if(r.length===0)throw new T("Each Content should have at least one part");const i={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const l of r)for(const d of Je)d in l&&(i[d]+=1);const o=fs[a];for(const l of Je)if(!o.includes(l)&&i[l]>0)throw new T(`Content with role '${a}' can't contain '${l}' part`);t=!0}}function We(s){var t;if(s.candidates===void 0||s.candidates.length===0)return!1;const n=(t=s.candidates[0])===null||t===void 0?void 0:t.content;if(n===void 0||n.parts===void 0||n.parts.length===0)return!1;for(const a of n.parts)if(a===void 0||Object.keys(a).length===0||a.text!==void 0&&a.text==="")return!1;return!0}const Qe="SILENT_ERROR";class ps{constructor(t,n,a,r={}){this.model=n,this.params=a,this._requestOptions=r,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=t,a?.history&&(xs(a.history),this._history=a.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(t,n={}){var a,r,i,o,l,d;await this._sendPromise;const h=ne(t),y={safetySettings:(a=this.params)===null||a===void 0?void 0:a.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(l=this.params)===null||l===void 0?void 0:l.systemInstruction,cachedContent:(d=this.params)===null||d===void 0?void 0:d.cachedContent,contents:[...this._history,h]},E=Object.assign(Object.assign({},this._requestOptions),n);let c;return this._sendPromise=this._sendPromise.then(()=>rt(this._apiKey,this.model,y,E)).then(v=>{var w;if(We(v.response)){this._history.push(h);const N=Object.assign({parts:[],role:"model"},(w=v.response.candidates)===null||w===void 0?void 0:w[0].content);this._history.push(N)}else{const N=q(v.response)}c=v}).catch(v=>{throw this._sendPromise=Promise.resolve(),v}),await this._sendPromise,c}async sendMessageStream(t,n={}){var a,r,i,o,l,d;await this._sendPromise;const h=ne(t),y={safetySettings:(a=this.params)===null||a===void 0?void 0:a.safetySettings,generationConfig:(r=this.params)===null||r===void 0?void 0:r.generationConfig,tools:(i=this.params)===null||i===void 0?void 0:i.tools,toolConfig:(o=this.params)===null||o===void 0?void 0:o.toolConfig,systemInstruction:(l=this.params)===null||l===void 0?void 0:l.systemInstruction,cachedContent:(d=this.params)===null||d===void 0?void 0:d.cachedContent,contents:[...this._history,h]},E=Object.assign(Object.assign({},this._requestOptions),n),c=at(this._apiKey,this.model,y,E);return this._sendPromise=this._sendPromise.then(()=>c).catch(v=>{throw new Error(Qe)}).then(v=>v.response).then(v=>{if(We(v)){this._history.push(h);const w=Object.assign({},v.candidates[0].content);w.role||(w.role="model"),this._history.push(w)}else{const w=q(v)}}).catch(v=>{v.message}),c}}async function vs(s,t,n,a){return(await ae(t,z.COUNT_TOKENS,s,!1,JSON.stringify(n),a)).json()}async function bs(s,t,n,a){return(await ae(t,z.EMBED_CONTENT,s,!1,JSON.stringify(n),a)).json()}async function ys(s,t,n,a){const r=n.requests.map(o=>Object.assign(Object.assign({},o),{model:t}));return(await ae(t,z.BATCH_EMBED_CONTENTS,s,!1,JSON.stringify({requests:r}),a)).json()}class Xe{constructor(t,n,a={}){this.apiKey=t,this._requestOptions=a,n.model.includes("/")?this.model=n.model:this.model=`models/${n.model}`,this.generationConfig=n.generationConfig||{},this.safetySettings=n.safetySettings||[],this.tools=n.tools,this.toolConfig=n.toolConfig,this.systemInstruction=ot(n.systemInstruction),this.cachedContent=n.cachedContent}async generateContent(t,n={}){var a;const r=ze(t),i=Object.assign(Object.assign({},this._requestOptions),n);return rt(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(a=this.cachedContent)===null||a===void 0?void 0:a.name},r),i)}async generateContentStream(t,n={}){var a;const r=ze(t),i=Object.assign(Object.assign({},this._requestOptions),n);return at(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(a=this.cachedContent)===null||a===void 0?void 0:a.name},r),i)}startChat(t){var n;return new ps(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(n=this.cachedContent)===null||n===void 0?void 0:n.name},t),this._requestOptions)}async countTokens(t,n={}){const a=gs(t,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),r=Object.assign(Object.assign({},this._requestOptions),n);return vs(this.apiKey,this.model,a,r)}async embedContent(t,n={}){const a=ms(t),r=Object.assign(Object.assign({},this._requestOptions),n);return bs(this.apiKey,this.model,a,r)}async batchEmbedContents(t,n={}){const a=Object.assign(Object.assign({},this._requestOptions),n);return ys(this.apiKey,this.model,t,a)}}class Ns{constructor(t){this.apiKey=t}getGenerativeModel(t,n){if(!t.model)throw new T("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new Xe(this.apiKey,t,n)}getGenerativeModelFromCachedContent(t,n,a){if(!t.name)throw new K("Cached content must contain a `name` field.");if(!t.model)throw new K("Cached content must contain a `model` field.");const r=["model","systemInstruction"];for(const o of r)if(n?.[o]&&t[o]&&n?.[o]!==t[o]){if(o==="model"){const l=n.model.startsWith("models/")?n.model.replace("models/",""):n.model,d=t.model.startsWith("models/")?t.model.replace("models/",""):t.model;if(l===d)continue}throw new K(`Different value for "${o}" specified in modelParams (${n[o]}) and cachedContent (${t[o]})`)}const i=Object.assign(Object.assign({},n),{model:t.model,tools:t.tools,toolConfig:t.toolConfig,systemInstruction:t.systemInstruction,cachedContent:t});return new Xe(this.apiKey,i,a)}}class js{constructor(t){this.model=t}async generateTableSummary(t){try{const{tableData:n}=t;if(!n||n.length===0)return{summary:"No data available for analysis.",keyInsights:["No data to analyze"],trends:["Insufficient data for trend analysis"]};const a=this.buildJSONPrompt(t),r=await this.callModelWithRetries(a),i=this.resolveFocusPeriod(t.tableData,t.columns),o=this.collectMonthValues(t.tableData,t.columns),l={focus:i.label,comparedAgainst:{mom:o.has(i.prev)?i.prevLabel:"not available",yoy:o.has(i.yoy)?i.yoyLabel:"not available"}};try{const h=JSON.parse(r);if(h&&typeof h=="object")return{summary:h.summary||"No summary generated.",keyInsights:Array.isArray(h.keyInsights)?h.keyInsights:[],trends:Array.isArray(h.trends)?h.trends:[],recommendations:Array.isArray(h.recommendations)?h.recommendations:void 0,diagnostics:h.diagnostics??l}}catch{}const d=this.parseGeminiResponse(r);return{summary:d.summary||r.slice(0,1e3)+(r.length>1e3?"...":""),keyInsights:d.keyInsights||this.extractBulletPoints(r).slice(0,8),trends:d.trends||this.extractBulletPoints(r).slice(0,6),recommendations:d.recommendations||void 0,diagnostics:l}}catch(n){let a="AI analysis temporarily unavailable. Please try again later.";return n?.status===404?a="Model not found. Please check the Gemini model configuration.":n?.status===429?a="Rate limit exceeded. Please try again in a few moments.":n?.status===403&&(a="API access denied. Please check your API key."),{summary:a,keyInsights:["AI service encountered an error"],trends:["Unable to analyze trends at this time"],error:n?.message||n?.status||"Unknown error occurred"}}}async generateQuickInsights(t,n,a){try{if(!t||t.length===0)return["No data available"];const r=this.extractTableStatistics(t,n),{label:i,prevLabel:o}=this.resolveFocusPeriod(t,n),l=`Analyze this ${a||"business"} data with EXCLUSIVE FOCUS on ${i} performance and provide 5 detailed key insights:

Data: ${t.length} rows
Key metrics: ${Object.values(r.numericColumns).map(h=>`${h.header}: ${C(h.sum)}`).join(", ")}

${i} FOCUS REQUIREMENTS for insights:
1. Start each insight with "${i}:" when referring to performance data
2. Include ${i} vs ${o} comparisons (month-over-month) if available
3. Show how ${i} ranks against other months in the dataset
4. Highlight ${i} specific performance metrics and achievements
5. Compare ${i} to historical averages and identify trends

Provide exactly 5 detailed bullet points focusing EXCLUSIVELY on ${i} performance with specific numbers, percentages, and month-over-month comparisons for the Indian fitness/wellness market:`,d=await this.callModelWithRetries(l);return this.extractBulletPoints(d,5)}catch{return["Insights unavailable at this time"]}}buildJSONPrompt(t){const{tableData:n,columns:a,tableName:r,context:i,summaryType:o,includeRecommendations:l,maxRows:d}=t,h=this.extractTableStatistics(n,a),y=d?n.slice(0,Math.min(d,5)):n.slice(0,5),E=this.resolveFocusPeriod(n,a),{label:c,prevLabel:v,yoyLabel:w}=E;let N=`You are a senior business intelligence analyst for fitness/wellness (India). Produce JSON ONLY, no prose outside JSON.

FOCUS: Entire analysis must focus on ${c}. Where comparisons are requested, compare ${c} vs ${v} (MoM) and vs ${w} (YoY) ONLY if those periods exist in the data; otherwise state "not available".

ðŸ“Š DATA CONTEXT & OVERVIEW - ${c} FOCUS
**Business Entity**: ${r||"Business Performance Analytics"}
**Primary Analysis Focus**: **${c} PERFORMANCE ASSESSMENT**
**Context**: ${i||`${c} business performance tracking and optimization`}
**Dataset Size**: ${h.totalRows} total records
**Analysis Framework**: ${o||"comprehensive"} deep-dive analysis of ${c}
**Currency**: All financial figures in Indian Rupees (â‚¹)
`;Object.keys(h.numericColumns).length>0&&(N+=`
**${c} QUANTITATIVE METRICS & FINANCIAL INDICATORS:**

`,Object.entries(h.numericColumns).forEach(([,x])=>{const L=G=>x.type==="currency"?C(G):x.type==="percentage"?`${G.toFixed(1)}%`:this.formatNumber(G),M=x.max-x.min,V=x.average!==0?M/Math.max(1e-6,x.average)*100:0;N+=`ðŸ“Š **${x.header} - ${c} Performance**
â€¢ ${c} Total: ${L(x.sum)}
â€¢ ${c} Average: ${L(x.average)}
â€¢ ${c} Range: ${L(x.min)} â†’ ${L(x.max)}
â€¢ ${c} Variance: ${V.toFixed(1)}%
â€¢ ${c} Sample Size: ${x.count} data points

`})),Object.keys(h.textColumns).length>0&&(N+=`
**${c} CATEGORICAL DISTRIBUTION & SEGMENTATION:**

`,Object.entries(h.textColumns).forEach(([,x])=>{const L=(x.mostCommon.count/Math.max(1,h.totalRows)*100).toFixed(1);N+=`ðŸ·ï¸ **${x.header} - ${c} Analysis**
â€¢ ${c} Categories: ${x.uniqueCount}
â€¢ ${c} Leader: "${x.mostCommon.value}" (${L}% share)
â€¢ ${c} Distribution: ${x.examples.join(", ")}

`})),Object.keys(h.dateColumns).length>0&&(N+=`
**${c} TEMPORAL SCOPE & TIME-SERIES CONTEXT:**

`,Object.entries(h.dateColumns).forEach(([,x])=>{N+=`ðŸ“… **${x.header} - ${c} Focus**
â€¢ ${c} Analysis Period: Focus on ${c}
â€¢ Data Coverage: ${x.count} ${c} records
â€¢ ${c} Granularity: Daily/weekly performance within the month

`}));const A=Array.isArray(y)?y:[];if(A.length>0){N+=`
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
`,N+=`ðŸ“‹ ${c} SAMPLE DATA EXTRACT
`,N+=`â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

`;const x=a.map(L=>L.header).join(" | ");N+=`${x}
`,N+=`${"â”€".repeat(x.length)}
`,A.slice(0,5).forEach((L,M)=>{const V=a.map(G=>{const b=L[G.key];return b==null?"N/A":G.type==="currency"&&typeof b=="number"?C(b):G.type==="number"&&typeof b=="number"?this.formatNumber(b):G.type==="date"&&b?new Date(b).toLocaleDateString("en-IN"):String(b)}).join(" | ");N+=`${M+1}. ${V}
`})}return N+=`

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ðŸŽ¯ ${c} COMPREHENSIVE ANALYSIS REQUIREMENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

**MANDATORY FOCUS: Every section must specifically analyze ${c} performance. If a requested comparison period doesn't exist in the data, clearly say "not available".**

OUTPUT REQUIREMENT: Respond ONLY with valid JSON matching this schema (no prose outside JSON):
{"summary": string, "keyInsights": string[], "trends": string[], "recommendations": string[] | null, "diagnostics": {"focus": string, "comparedAgainst": {"mom": string | "not available", "yoy": string | "not available"}}}

YOUR ANALYSIS BEGINS BELOW AS JSON ONLY:`,N}extractTableStatistics(t,n){const a={totalRows:t.length,numericColumns:{},textColumns:{},dateColumns:{}},r=o=>typeof o=="number"&&isFinite(o),i=o=>typeof o=="string"&&o.trim()!=="";return n.forEach(o=>{let l=0,d=0,h=1/0,y=-1/0;for(const E of t){const c=E[o.key];r(c)&&(l++,d+=c,c<h&&(h=c),c>y&&(y=c))}l>0&&(a.numericColumns[o.key]={header:o.header,key:o.key,count:l,sum:d,average:d/l,min:h,max:y,type:o.type||"number"})}),n.forEach(o=>{const l={};for(const h of t){const y=h[o.key];i(y)&&(l[y]=(l[y]||0)+1)}const d=Object.entries(l).sort((h,y)=>y[1]-h[1]);d.length>0&&(a.textColumns[o.key]={header:o.header,key:o.key,uniqueCount:d.length,mostCommon:{value:d[0][0],count:d[0][1]},examples:d.slice(0,5).map(h=>`${h[0]} (${h[1]})`)})}),n.filter(o=>o.type==="date").forEach(o=>{let l=0;for(const d of t)d[o.key]&&l++;a.dateColumns[o.key]={header:o.header,key:o.key,count:l}}),a}parseGeminiResponse(t){return{summary:"",keyInsights:[],trends:[],recommendations:void 0}}extractBulletPoints(t,n){const a=t.split(`
`).filter(r=>r.trim().startsWith("â€¢")||r.trim().startsWith("-"));return n?a.slice(0,n):a}resolveFocusPeriod(t,n){const a=["monthYear","month","period"],r=n.find(A=>A.type==="date")?.key,i=A=>`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}`,o=St(),l=new Set;t.forEach(A=>{for(const x of a)A[x]&&typeof A[x]=="string"&&l.add(A[x]);if(r&&A[r]){const x=new Date(A[r]);isNaN(x.getTime())||l.add(i(new Date(x.getFullYear(),x.getMonth(),1)))}});const d=Array.from(l).sort(),h=d.includes(o)?o:d[d.length-1]||o,[y,E]=h.split("-").map(Number),c=new Date(y,E-1,1),v=new Date(c.getFullYear(),c.getMonth()-1,1),w=new Date(c.getFullYear()-1,c.getMonth(),1),N=A=>A.toLocaleDateString("en-US",{month:"long"});return{value:h,label:`${N(c)} ${c.getFullYear()}`,prev:i(v),prevLabel:`${N(v)} ${v.getFullYear()}`,yoy:i(w),yoyLabel:`${N(w)} ${w.getFullYear()}`}}collectMonthValues(t,n){const a=["monthYear","month","period"],r=n.find(l=>l.type==="date")?.key,i=l=>`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`,o=new Set;return t.forEach(l=>{for(const d of a)l[d]&&typeof l[d]=="string"&&o.add(l[d]);if(r&&l[r]){const d=new Date(l[r]);isNaN(d.getTime())||o.add(i(new Date(d.getFullYear(),d.getMonth(),1)))}}),o}async callModelWithRetries(t){const a=o=>new Promise(l=>setTimeout(l,o));let r=0,i=null;for(;r<=2;)try{return(await(await this.model.generateContent({contents:[{role:"user",parts:[{text:t}]}],generationConfig:{temperature:.2,topP:.9,topK:40,maxOutputTokens:2048},safetySettings:[]})).response).text()}catch(o){if(i=o,o?.status===429||o?.status>=500&&o?.status<600){if(r++,r>2)break;await a(500*r*r);continue}throw o}throw i||new Error("AI generation failed")}}const Cs="AIzaSyCy9Z3Sa8KJYY4n9haAmc7QGGaTEE5X0PI",Ne=new Ns(Cs);let ue;try{ue=Ne.getGenerativeModel({model:"gemini-1.5-flash"})}catch{try{ue=Ne.getGenerativeModel({model:"gemini-pro"})}catch{ue=Ne.getGenerativeModel({model:"gemini-flash-latest"})}}const X=new js(ue),ws=()=>{const[s,t]=O.useState({isLoading:!1,result:null,error:null}),n=O.useCallback(async i=>{t(o=>({...o,isLoading:!0,error:null}));try{const o=await X.generateTableSummary(i);return t({isLoading:!1,result:o,error:o.error||null}),o}catch(o){const l=o instanceof Error?o.message:"Analysis failed";throw t({isLoading:!1,result:null,error:l}),o}},[]),a=O.useCallback(async(i,o,l)=>{t(d=>({...d,isLoading:!0,error:null}));try{const d=await X.generateQuickInsights(i,o,l),h=X.resolveFocusPeriod?X.resolveFocusPeriod(i,o):null,y=X.collectMonthValues?X.collectMonthValues(i,o):new Set,E=h?{focus:h.label,comparedAgainst:{mom:y.has(h.prev)?h.prevLabel:"not available",yoy:y.has(h.yoy)?h.yoyLabel:"not available"}}:void 0,c={summary:`Quick analysis of ${i.length} records`,keyInsights:d,trends:[],recommendations:[],diagnostics:E};return t({isLoading:!1,result:c,error:null}),d}catch(d){const h=d instanceof Error?d.message:"Quick analysis failed";throw t({isLoading:!1,result:null,error:h}),d}},[]),r=O.useCallback(()=>{t({isLoading:!1,result:null,error:null})},[]);return{...s,generateSummary:n,generateQuickInsights:a,reset:r}},Rs=()=>{const{activeLocations:s}=et(),{generateQuickInsights:t}=ws(),n=O.useMemo(()=>{const u=new Date,R=new Date(u.getFullYear(),u.getMonth()-3,1),J=new Date(u.getFullYear(),u.getMonth(),0);return{startDate:R.toISOString().split("T")[0],endDate:J.toISOString().split("T")[0]}},[]),{data:a=[],loading:r}=Dt(),{data:i=[],loading:o}=kt(),{data:l=[],isLoading:d}=Ft(),{data:h=[],loading:y}=Pt(),{data:E=[],loading:c}=Gt(),{data:v=[]}=Ut(),{data:w=[],loading:N}=Ht(),{data:A=[],loading:x}=Bt(),L=r||o||d||y||c||N||x,M=s[0]||"All Locations",V=O.useMemo(()=>{const u=m=>{if(M==="All Locations"||s.length===0)return!0;const I=(m.location||m.calculatedLocation||m.studio||"").toLowerCase(),_=M.toLowerCase();return _.includes("kwality")||_.includes("kemps")?I.includes("kwality")||I.includes("kemps"):_.includes("supreme")||_.includes("bandra")?I.includes("supreme")||I.includes("bandra"):_.includes("kenkere")||_.includes("bengaluru")?I.includes("kenkere")||I.includes("bengaluru")||I.includes("bangalore"):!0},R=m=>{if(!m.date&&!m.timestamp&&!m.createdAt)return!0;const I=ee(m.date||m.timestamp||m.createdAt);if(!I)return!0;const _=ee(n.startDate),me=ee(n.endDate);return I>=_&&I<=me},J=a.filter(m=>u(m)&&R(m)),$=i.filter(m=>u(m)&&R(m)),D=l.filter(m=>u(m)&&R(m)),he=h.filter(m=>u(m)&&R(m)),re=E.filter(m=>u(m)&&R(m)),ge=v.filter(m=>u(m)&&R(m)),Y=w.filter(m=>u(m)&&R(m)),oe=A.filter(m=>u(m)&&R(m));return{sales:J,sessions:$,payroll:D,newClients:he,leads:re,discounts:ge,lateCancellations:Y,expirations:oe}},[a,i,l,h,E,v,w,A,M,n,s]),G=O.useCallback(async u=>{if(!u)return null;try{const R=[{metric:"Total Revenue",value:u.totalRevenue,formatted:C(u.totalRevenue),category:"revenue"},{metric:"Fill Rate",value:u.fillRate,formatted:p(u.fillRate),category:"sessions"},{metric:"Retention Rate",value:u.retentionRate,formatted:p(u.retentionRate),category:"retention"},{metric:"Conversion Rate",value:u.conversionRate,formatted:p(u.conversionRate),category:"leads"},{metric:"New Clients",value:u.newClientsAcquired,formatted:j(u.newClientsAcquired),category:"growth"},{metric:"Churn Rate",value:u.churnRate,formatted:p(u.churnRate),category:"retention"},{metric:"Avg Transaction Value",value:u.avgTransactionValue,formatted:C(u.avgTransactionValue),category:"revenue"},{metric:"Discount Rate",value:u.discountRate,formatted:p(u.discountRate),category:"revenue"}],$=await t(R,[{header:"Metric",key:"metric",type:"text"},{header:"Value",key:"value",type:"number"},{header:"Formatted",key:"formatted",type:"text"},{header:"Category",key:"category",type:"text"}],`${M} Location Performance Report`);return{highlights:Array.isArray($)?$.slice(0,3):[],concerns:Array.isArray($)?$.filter(D=>typeof D=="string"&&(D.toLowerCase().includes("concern")||D.toLowerCase().includes("low")||D.toLowerCase().includes("decline"))).slice(0,3):[],recommendations:Array.isArray($)?$.slice(0,3):[]}}catch{return null}},[t,M]),b=O.useMemo(()=>{if(!V)return{totalRevenue:0,netRevenue:0,vatAmount:0,totalTransactions:0,uniqueMembers:0,avgTransactionValue:0,avgSpendPerMember:0,revenueGrowth:0,totalDiscounts:0,discountRate:0,totalSessions:0,totalCheckIns:0,fillRate:0,capacityUtilization:0,powerCycleSessions:0,barreSessions:0,strengthSessions:0,lateCancellations:0,lateCancellationRevenueLoss:0,totalTrainers:0,sessionsPerTrainer:0,avgClassSize:0,revenuePerTrainer:0,topTrainerName:"N/A",topTrainerRevenue:0,newClientsAcquired:0,conversionRate:0,retentionRate:0,averageLTV:0,churnRate:0,churnedMembers:0,totalLeads:0,leadsConverted:0,leadConversionRate:0,avgConversionDays:0,leadsBySource:{},sessionUtilization:0,overallScore:0};const{sales:u,sessions:R,payroll:J,newClients:$,leads:D,discounts:he,lateCancellations:re,expirations:ge}=V,Y=u.reduce((g,f)=>g+(parseFloat(String(f.paymentValue))||0),0),oe=u.reduce((g,f)=>g+(parseFloat(String(f.paymentVAT))||0),0),m=Y-oe,I=u.length,_=new Set(u.map(g=>g.memberId)).size,me=I>0?Y/I:0,lt=_>0?Y/_:0,Ce=he.reduce((g,f)=>g+(parseFloat(String(f.discountAmount))||0),0),ct=Y>0?Ce/Y*100:0,ie=R.length,fe=R.reduce((g,f)=>g+(parseInt(String(f.checkedInCount))||0),0),we=R.reduce((g,f)=>g+(parseInt(String(f.capacity))||0),0),Re=we>0?fe/we*100:0,Ee=Re,dt=R.filter(g=>g.sessionName?.toLowerCase().includes("powercycle")||g.classType?.toLowerCase().includes("powercycle")).length,ut=R.filter(g=>g.sessionName?.toLowerCase().includes("barre")||g.classType?.toLowerCase().includes("barre")).length,ht=R.filter(g=>g.sessionName?.toLowerCase().includes("strength")||g.classType?.toLowerCase().includes("strength")).length,gt=re.length,mt=re.reduce((g,f)=>g+(parseFloat(String(f.revenueImpact))||0),0),ft=J.reduce((g,f)=>{const k=f.teacherId;return k&&(g[k]||(g[k]={name:f.teacherName,sessions:0,revenue:0,customersServed:0}),g[k].sessions+=f.cycleSessions+f.barreSessions+(f.strengthSessions||0),g[k].revenue+=f.cyclePaid+f.barrePaid+(f.strengthPaid||0),g[k].customersServed+=f.cycleCustomers+f.barreCustomers+(f.strengthCustomers||0)),g},{}),Se=Object.values(ft),Z=Se.length,xt=Z>0?ie/Z:0,pt=ie>0?fe/ie:0,vt=Z>0?Y/Z:0,Ae=Se.reduce((g,f)=>f.revenue>(g?.revenue||0)?f:g,null),bt=$.length,Te=D.filter(g=>g.status?.toLowerCase().includes("trial")).length,Ie=D.filter(g=>g.status?.toLowerCase().includes("converted")).length,yt=Te>0?Ie/Te*100:0,Nt=$.reduce((g,f)=>g+(parseFloat(String(f.ltv))||0),0)/($.length||1),Oe=ge.length,_e=_>0?Oe/_*100:0,jt=100-_e,xe=D.length,Le=Ie,Ct=xe>0?Le/xe*100:0,pe=D.filter(g=>g.convertedToCustomerAt&&g.createdAt).map(g=>{const f=ee(g.createdAt),k=ee(g.convertedToCustomerAt);return f&&k?Math.abs(k.getTime()-f.getTime())/(1e3*60*60*24):0}),wt=pe.length>0?pe.reduce((g,f)=>g+f,0)/pe.length:0,Rt=D.reduce((g,f)=>{const k=f.source||"Unknown";return g[k]=(g[k]||0)+1,g},{});return{totalRevenue:Y,netRevenue:m,vatAmount:oe,totalTransactions:I,uniqueMembers:_,avgTransactionValue:me,avgSpendPerMember:lt,revenueGrowth:0,totalDiscounts:Ce,discountRate:ct,totalSessions:ie,totalCheckIns:fe,fillRate:Re,capacityUtilization:Ee,powerCycleSessions:dt,barreSessions:ut,strengthSessions:ht,lateCancellations:gt,lateCancellationRevenueLoss:mt,totalTrainers:Z,sessionsPerTrainer:xt,avgClassSize:pt,revenuePerTrainer:vt,topTrainerName:Ae?.name||"N/A",topTrainerRevenue:Ae?.revenue||0,newClientsAcquired:bt,conversionRate:yt,retentionRate:jt,averageLTV:Nt,churnRate:_e,churnedMembers:Oe,totalLeads:xe,leadsConverted:Le,leadConversionRate:Ct,avgConversionDays:wt,leadsBySource:Rt,sessionUtilization:Ee,overallScore:0}},[V]),S=O.useMemo(()=>{if(!b)return null;let u=0;return b.revenueGrowth>10?u+=25:b.revenueGrowth>5?u+=20:b.revenueGrowth>0?u+=15:b.revenueGrowth>-5&&(u+=10),b.fillRate>80?u+=25:b.fillRate>70?u+=20:b.fillRate>60?u+=15:b.fillRate>50&&(u+=10),b.retentionRate>90?u+=25:b.retentionRate>80?u+=20:b.retentionRate>70?u+=15:b.retentionRate>60&&(u+=10),b.conversionRate>25?u+=25:b.conversionRate>20?u+=20:b.conversionRate>15?u+=15:b.conversionRate>10&&(u+=10),{...b,overallScore:u}},[b]),B=O.useMemo(()=>{if(!S)return null;const u={startDate:n.startDate,endDate:n.endDate,monthName:new Date(n.startDate).toLocaleDateString("en-US",{month:"long",year:"numeric"})},R={highlights:[`Generated ${C(S.totalRevenue)} in total revenue`,`Achieved ${p(S.fillRate)}% class fill rate`,`Acquired ${S.newClientsAcquired} new clients`].filter(Boolean),concerns:[S.churnRate>20?`High churn rate of ${p(S.churnRate)}%`:null,S.fillRate<60?`Low class utilization at ${p(S.fillRate)}%`:null,S.conversionRate<15?`Low conversion rate of ${p(S.conversionRate)}%`:null].filter(Boolean),recommendations:[S.fillRate<70?"Consider optimizing class schedules and capacity":null,S.churnRate>15?"Implement retention strategies and member engagement programs":null,S.discountRate>15?"Review discount strategy to optimize profitability":null].filter(Boolean)};return{reportPeriod:u,location:M,metrics:S,insights:R,comparisons:{monthOverMonth:{},yearOverYear:{}}}},[S,M,n]),it=O.useCallback(async()=>{if(!B||!S)return B;const u=await G(S);return u?{...B,insights:{highlights:u.highlights.length>0?u.highlights:B.insights.highlights,concerns:u.concerns.length>0?u.concerns:B.insights.concerns,recommendations:u.recommendations.length>0?u.recommendations:B.insights.recommendations}}:B},[B,S,G]);return{data:B,metrics:S,isLoading:L,primaryLocation:M,enhanceWithAI:it}},Ze=[{id:"all",name:"All Locations",fullName:"All Studio Locations"},{id:"kwality",name:"Kwality House",fullName:"Kwality House, Kemps Corner"},{id:"supreme",name:"Supreme HQ",fullName:"Supreme HQ, Bandra"},{id:"kenkere",name:"Kenkere House",fullName:"Kenkere House, Bengaluru"}],Es=({onReady:s})=>{const{filters:t,updateFilters:n,clearFilters:a}=et(),[r,i]=O.useState("all"),{metrics:o,isLoading:l}=Rs(),{setLoading:d}=tt();ce.useEffect(()=>{!l&&s&&s()},[l,s]);const h=O.useCallback(c=>{i(c)},[]),y=O.useCallback(c=>{n(c)},[n]),E=O.useCallback(()=>{a()},[a]);return l?e.jsxs("div",{className:"flex justify-center items-center h-96",children:[e.jsx(Mt,{size:"lg"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading location performance data..."})]}):o?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Lt,{filters:t,onFiltersChange:y,onReset:E}),e.jsxs(Tt,{value:r,onValueChange:h,className:"w-full",children:[e.jsx(It,{className:"grid grid-cols-2 lg:grid-cols-4 w-full gap-2 mb-8",children:Ze.map(c=>e.jsxs(Ot,{value:c.id,className:"relative flex items-center justify-center gap-2 px-4 py-3",children:[e.jsx($t,{className:"w-4 h-4"}),e.jsx("span",{className:"whitespace-nowrap",children:c.name})]},c.id))}),Ze.map(c=>e.jsx(_t,{value:c.id,className:"space-y-8 mt-8",children:e.jsx(Ss,{location:c,metrics:o,isAllLocations:c.id==="all"})},c.id))]})]}):e.jsx("div",{className:"flex justify-center items-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xl text-gray-600 mb-2",children:"No data available for location reports"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Try adjusting the date range or check your data sources"})]})})},Ss=({location:s,metrics:t,isAllLocations:n})=>t?e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:s.fullName}),e.jsx("p",{className:"text-gray-600 mt-2 text-lg",children:"Executive Performance Report â€¢ Last 3 Months (Debug Mode)"})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-4 py-2 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Performance Score"}),e.jsxs("div",{className:"text-3xl font-bold",children:[t.overallScore||0,"/100"]})]})})]})}),e.jsx(F,{className:"border-0 shadow-xl bg-gradient-to-r from-slate-900 via-blue-900 to-purple-900 text-white",children:e.jsxs(P,{className:"p-8",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Executive Performance Dashboard"}),e.jsx("p",{className:"text-blue-200",children:"Quick Performance Overview â€¢ Last 3 Months (Debug Mode)"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold",children:C(t.totalRevenue||0)}),e.jsx("div",{className:"text-xs text-blue-200",children:"Revenue"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold",children:j(t.totalSessions||0)}),e.jsx("div",{className:"text-xs text-blue-200",children:"Sessions"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold",children:p(t.fillRate||0)}),e.jsx("div",{className:"text-xs text-blue-200",children:"Fill Rate"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold",children:j(t.newClientsAcquired||0)}),e.jsx("div",{className:"text-xs text-blue-200",children:"New Clients"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold",children:p(t.retentionRate||0)}),e.jsx("div",{className:"text-xs text-blue-200",children:"Retention"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-lg font-bold",children:p(t.leadConversionRate||0)}),e.jsx("div",{className:"text-xs text-blue-200",children:"Conversion"})]})]})]})}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs(F,{className:"border-0 shadow-lg",children:[e.jsx(U,{children:e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(Yt,{className:"w-5 h-5 text-blue-600"}),"Key Performance Indicators"]})}),e.jsxs(P,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 border-l-4 border-emerald-500 pl-3",children:"Revenue & Growth"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-emerald-50 to-green-50 p-6 rounded-lg border border-emerald-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:C(t.totalRevenue||0)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Gross earnings"})]}),e.jsx(ve,{className:"w-8 h-8 text-emerald-200"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-lg border border-green-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Net Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:C(t.netRevenue||0)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"After VAT"})]}),e.jsx(ve,{className:"w-8 h-8 text-green-200"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Revenue/Member"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:C(t.avgSpendPerMember||0)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Per member value"})]}),e.jsx(W,{className:"w-8 h-8 text-blue-200"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 p-6 rounded-lg border border-orange-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Discount Rate"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:p(t.discountRate||0)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[C(t.totalDiscounts||0)," total"]})]}),e.jsx(be,{className:"w-8 h-8 text-orange-200"})]})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 border-l-4 border-blue-500 pl-3",children:"Operations & Efficiency"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-lg border border-purple-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Sessions"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:j(t.totalSessions||0)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[j(t.totalCheckIns||0)," check-ins"]})]}),e.jsx(le,{className:"w-8 h-8 text-purple-200"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-lg border border-blue-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Fill Rate"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:p(t.fillRate||0)}),e.jsx("div",{className:"flex items-center gap-1 mt-1",children:e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${(t.fillRate||0)>=85?"bg-green-100 text-green-800":(t.fillRate||0)>=70?"bg-blue-100 text-blue-800":(t.fillRate||0)>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:(t.fillRate||0)>=85?"Excellent":(t.fillRate||0)>=70?"Good":(t.fillRate||0)>=50?"Fair":"Poor"})})]}),e.jsx(le,{className:"w-8 h-8 text-blue-200"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 p-6 rounded-lg border border-red-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Late Cancellations"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:j(t.lateCancellations||0)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[C(t.lateCancellationRevenueLoss||0)," loss"]})]}),e.jsx(ye,{className:"w-8 h-8 text-red-200"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-lg border border-green-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Class Size"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:j(t.avgClassSize||0)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Participants/session"})]}),e.jsx(W,{className:"w-8 h-8 text-green-200"})]})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4 border-l-4 border-purple-500 pl-3",children:"Client Growth & Retention"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-lg border border-green-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"New Clients"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:j(t.newClientsAcquired||0)}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Acquired this period"})]}),e.jsx(W,{className:"w-8 h-8 text-green-200"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-lg border border-purple-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Retention Rate"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:p(t.retentionRate||0)}),e.jsx("div",{className:"flex items-center gap-1 mt-1",children:e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${(t.retentionRate||0)>=85?"bg-green-100 text-green-800":(t.retentionRate||0)>=75?"bg-blue-100 text-blue-800":(t.retentionRate||0)>=65?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:(t.retentionRate||0)>=85?"Excellent":(t.retentionRate||0)>=75?"Good":(t.retentionRate||0)>=65?"Fair":"Poor"})})]}),e.jsx(Me,{className:"w-8 h-8 text-purple-200"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-teal-50 to-cyan-50 p-6 rounded-lg border border-teal-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Lead Conversion"}),e.jsx("p",{className:"text-2xl font-bold text-teal-600",children:p(t.leadConversionRate||0)}),e.jsx("div",{className:"flex items-center gap-1 mt-1",children:e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${(t.leadConversionRate||0)>=25?"bg-green-100 text-green-800":(t.leadConversionRate||0)>=20?"bg-blue-100 text-blue-800":(t.leadConversionRate||0)>=15?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:(t.leadConversionRate||0)>=25?"Excellent":(t.leadConversionRate||0)>=20?"Good":(t.leadConversionRate||0)>=15?"Fair":"Poor"})})]}),e.jsx(be,{className:"w-8 h-8 text-teal-200"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 p-6 rounded-lg border border-red-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Churn Rate"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:p(t.churnRate||0)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[j(t.churnedMembers||0)," members lost"]})]}),e.jsx(ye,{className:"w-8 h-8 text-red-200"})]})})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(F,{className:"border-0 shadow-lg",children:[e.jsx(U,{children:e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-purple-600"}),"Class Format Distribution"]})}),e.jsx(P,{children:e.jsx("div",{className:"space-y-4",children:[{name:"PowerCycle",count:t.powerCycleSessions||0,color:"bg-purple-500"},{name:"Barre",count:t.barreSessions||0,color:"bg-pink-500"},{name:"Strength",count:t.strengthSessions||0,color:"bg-orange-500"}].map((a,r)=>{const i=(t.powerCycleSessions||0)+(t.barreSessions||0)+(t.strengthSessions||0),o=i>0?a.count/i*100:0;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:a.name}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-sm font-bold text-gray-900",children:j(a.count)}),e.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",p(o),")"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`${a.color} h-3 rounded-full transition-all duration-500`,style:{width:`${o}%`}})})]},r)})})})]}),e.jsxs(F,{className:"border-0 shadow-lg bg-gradient-to-br from-yellow-50 to-orange-50",children:[e.jsx(U,{children:e.jsxs(H,{className:"flex items-center gap-2 text-orange-700",children:[e.jsx(W,{className:"w-5 h-5"}),"ðŸ† Top Performer Spotlight"]})}),e.jsx(P,{children:e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"bg-white p-6 rounded-xl border-2 border-yellow-200 shadow-sm",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:t.topTrainerName||"N/A"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:C(t.topTrainerRevenue||0)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Revenue Generated"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:j(Math.round((t.topTrainerRevenue||0)/(t.avgSpendPerMember||1)))}),e.jsx("p",{className:"text-sm text-gray-600",children:"Sessions Led"})]})]}),e.jsx("div",{className:"mt-4 px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium inline-block",children:"Top Revenue Contributor"})]})})})]})]})]}),e.jsxs(F,{className:"border-0 shadow-lg",children:[e.jsx(U,{children:e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"w-5 h-5 text-green-600"}),"Revenue Performance"]})}),e.jsx(P,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Revenue Breakdown"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Gross Revenue"}),e.jsx("span",{className:"font-bold text-green-700",children:C(t.totalRevenue||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Transactions"}),e.jsx("span",{className:"font-bold",children:j(t.totalTransactions||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Avg Transaction"}),e.jsx("span",{className:"font-bold",children:C(t.avgTransactionValue||0)})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Member Metrics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Unique Members"}),e.jsx("span",{className:"font-bold text-blue-700",children:j(t.uniqueMembers||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Avg Spend/Member"}),e.jsx("span",{className:"font-bold",children:C(t.avgSpendPerMember||0)})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-red-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Discounts"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Total Discounts"}),e.jsx("span",{className:"font-bold text-red-600",children:C(t.totalDiscounts||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Discount Rate"}),e.jsx("span",{className:"font-bold",children:p(t.discountRate||0)})]})]})]})]})})]}),e.jsxs(F,{className:"border-0 shadow-lg",children:[e.jsx(U,{children:e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-purple-600"}),"Session Performance"]})}),e.jsx(P,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Session Overview"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Total Sessions"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:j(t.totalSessions||0)})]}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Fill Rate"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:p(t.fillRate||0)})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-pink-50 to-red-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Class Formats"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"PowerCycle"}),e.jsx("span",{className:"font-bold",children:j(t.powerCycleSessions||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Barre"}),e.jsx("span",{className:"font-bold",children:j(t.barreSessions||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Strength"}),e.jsx("span",{className:"font-bold",children:j(t.strengthSessions||0)})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Late Cancellations"}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-700",children:"Total"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:j(t.lateCancellations||0)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Loss: ",C(t.lateCancellationRevenueLoss||0)]})]})]})]})})]}),e.jsxs(F,{className:"border-0 shadow-lg",children:[e.jsx(U,{children:e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5 text-orange-600"}),"Trainer Performance"]})}),e.jsx(P,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-yellow-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Trainer Metrics"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Trainers"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:j(t.totalTrainers||0)})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sessions/Trainer"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:j(t.sessionsPerTrainer||0)})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-100 to-orange-100 p-6 rounded-lg border-2 border-yellow-300",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"ðŸ† Top Performer"}),e.jsxs("div",{className:"bg-white p-6 rounded-lg text-center",children:[e.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-2",children:t.topTrainerName||"N/A"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:C(t.topTrainerRevenue||0)}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Revenue Generated"})]})]})]})})]}),e.jsxs(F,{className:"border-0 shadow-lg",children:[e.jsx(U,{children:e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5 text-indigo-600"}),"Client Analytics"]})}),e.jsx(P,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Acquisition"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"New Clients"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:j(t.newClientsAcquired||0)})]})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Retention"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Retention Rate"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:p(t.retentionRate||0)})]})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Lifetime Value"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Average LTV"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:C(t.averageLTV||0)})]})})]})]})})]}),e.jsxs(F,{className:"border-0 shadow-lg",children:[e.jsx(U,{children:e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5 text-teal-600"}),"Lead Funnel Analysis"]})}),e.jsx(P,{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Total Leads"}),e.jsx("p",{className:"text-3xl font-bold text-teal-600",children:j(t.totalLeads||0)})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Converted"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:j(t.leadsConverted||0)})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 text-center",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Conversion Rate"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:p(t.leadConversionRate||0)})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(F,{className:"border-0 shadow-lg bg-gradient-to-br from-green-50 to-emerald-50",children:[e.jsx(U,{children:e.jsxs(H,{className:"flex items-center gap-2 text-green-700",children:[e.jsx(Me,{className:"w-5 h-5"}),"Key Achievements"]})}),e.jsx(P,{children:e.jsxs("ul",{className:"space-y-3",children:[[(t.totalRevenue||0)>5e4?`Strong revenue performance: ${C(t.totalRevenue)}`:null,(t.fillRate||0)>=75?`Excellent class utilization: ${p(t.fillRate)} fill rate`:null,(t.retentionRate||0)>=80?`High client retention: ${p(t.retentionRate)}`:null,(t.newClientsAcquired||0)>=20?`Strong client acquisition: ${j(t.newClientsAcquired)} new members`:null,(t.leadConversionRate||0)>=20?`Effective lead conversion: ${p(t.leadConversionRate)}`:null,t.topTrainerName!=="N/A"?`${t.topTrainerName} leading performance with ${C(t.topTrainerRevenue)} revenue`:null].filter(Boolean).slice(0,4).map((a,r)=>e.jsxs("li",{className:"text-sm text-gray-700 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{children:a})]},r)),[(t.totalRevenue||0)>5e4?`Strong revenue performance: ${C(t.totalRevenue)}`:null,(t.fillRate||0)>=75?`Excellent class utilization: ${p(t.fillRate)} fill rate`:null,(t.retentionRate||0)>=80?`High client retention: ${p(t.retentionRate)}`:null,(t.newClientsAcquired||0)>=20?`Strong client acquisition: ${j(t.newClientsAcquired)} new members`:null,(t.leadConversionRate||0)>=20?`Effective lead conversion: ${p(t.leadConversionRate)}`:null,t.topTrainerName!=="N/A"?`${t.topTrainerName} leading performance`:null].filter(Boolean).length===0?e.jsxs("li",{className:"text-sm text-gray-700 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{children:"Location operational with consistent service delivery"})]}):null]})})]}),e.jsxs(F,{className:"border-0 shadow-lg bg-gradient-to-br from-yellow-50 to-orange-50",children:[e.jsx(U,{children:e.jsxs(H,{className:"flex items-center gap-2 text-orange-700",children:[e.jsx(ye,{className:"w-5 h-5"}),"Areas Requiring Attention"]})}),e.jsx(P,{children:e.jsxs("ul",{className:"space-y-3",children:[[(t.fillRate||0)<60?`Low class utilization: ${p(t.fillRate)} fill rate (Target: 70%+)`:null,(t.churnRate||0)>20?`High churn rate: ${p(t.churnRate)} member loss`:null,(t.retentionRate||0)<70?`Retention below target: ${p(t.retentionRate)} (Target: 75%+)`:null,(t.leadConversionRate||0)<15?`Low lead conversion: ${p(t.leadConversionRate)} (Target: 20%+)`:null,(t.lateCancellations||0)>50?`High late cancellations: ${j(t.lateCancellations)} affecting revenue`:null,(t.discountRate||0)>15?`Heavy discount usage: ${p(t.discountRate)} impacting margins`:null].filter(Boolean).slice(0,4).map((a,r)=>e.jsxs("li",{className:"text-sm text-gray-700 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-orange-500 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{children:a})]},r)),[(t.fillRate||0)<60?"Low class utilization":null,(t.churnRate||0)>20?"High churn rate":null,(t.retentionRate||0)<70?"Retention below target":null,(t.leadConversionRate||0)<15?"Low lead conversion":null,(t.lateCancellations||0)>50?"High late cancellations":null,(t.discountRate||0)>15?"Heavy discount usage":null].filter(Boolean).length===0?e.jsxs("li",{className:"text-sm text-gray-700 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{children:"All key metrics performing within acceptable ranges"})]}):null]})})]}),e.jsxs(F,{className:"border-0 shadow-lg bg-gradient-to-br from-blue-50 to-indigo-50",children:[e.jsx(U,{children:e.jsxs(H,{className:"flex items-center gap-2 text-blue-700",children:[e.jsx(qt,{className:"w-5 h-5"}),"Strategic Recommendations"]})}),e.jsx(P,{children:e.jsxs("ul",{className:"space-y-3",children:[[(t.fillRate||0)<70?"Optimize class schedules and capacity management":null,(t.churnRate||0)>15?"Implement enhanced member retention programs":null,(t.discountRate||0)>12?"Review pricing strategy to reduce discount dependency":null,(t.leadConversionRate||0)<18?"Improve lead nurturing and trial conversion process":null,(t.lateCancellations||0)>30?"Strengthen cancellation policy enforcement":null,(t.powerCycleSessions||0)>(t.totalSessions||1)*.7?"Consider diversifying class format offerings":null,(t.avgClassSize||0)<8?"Focus marketing on increasing class attendance":null,(t.newClientsAcquired||0)<15?"Enhance member referral and acquisition programs":null].filter(Boolean).slice(0,4).map((a,r)=>e.jsxs("li",{className:"text-sm text-gray-700 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{children:a})]},r)),[(t.fillRate||0)<70?"Optimize class schedules":null,(t.churnRate||0)>15?"Enhance retention programs":null,(t.discountRate||0)>12?"Review pricing strategy":null,(t.leadConversionRate||0)<18?"Improve lead conversion":null].filter(Boolean).length===0?e.jsxs("li",{className:"text-sm text-gray-700 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{children:"Continue current strategies while monitoring market trends"})]}):null]})})]})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsxs("p",{className:"text-gray-500",children:["No data available for ",s.name]})}),en=()=>{const{setLoading:s}=tt(),[t,n]=ce.useState(!1),a=ce.useCallback(()=>{n(!0),s(!1)},[s]);return ce.useEffect(()=>{s(!0,"Loading location reports...")},[s]),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-indigo-50/20",children:[e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Location Performance Reports"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Detailed analysis for each studio location with comprehensive metrics and insights"})]}),e.jsx(Es,{onReady:a})]}),e.jsx(At,{})]})};export{en as default};
//# sourceMappingURL=LocationReport-BH--HYOt.js.map
