import{r as I,j as e,D,n as T,o as A,q as k,T as P,X as E,C as c,c as o,a as j,b as u}from"./index-Bm67KBkU.js";import{a as m,B as N}from"./index-DkD_C-d1.js";import{T as V,a as W,b as p,c as h,d as X,e as x}from"./table-DhXofKdS.js";import{S as G}from"./scroll-area-BKnEh-kP.js";import{T as J,a as K,b as f,c as v}from"./tabs-BTrhdLSC.js";import{C as Q}from"./dollar-sign-CKqx8kbC.js";import{T as Y}from"./trending-down-B5K1omnR.js";import{U as Z}from"./users-7Ku-1TDB.js";import{M}from"./StudioLocationTabs-BSKYatd_.js";import{C as q}from"./clock-BP1BFskn.js";import{C as R}from"./googleAuth-BGo8ElRc.js";import"./index-BdQq_4o_.js";import"./SalesMotionHero-sGphstF2.js";const xe=({isOpen:w,onClose:g,data:i})=>{if(!i)return null;let b=[];Array.isArray(i)?b=i:i.rawData&&Array.isArray(i.rawData)?b=i.rawData:i.data&&Array.isArray(i.data)?b=i.data:Array.isArray(i.records)&&(b=i.records);const r=b,B=i?.title||i?.name||"Late Cancellations Detail",l=I.useMemo(()=>{if(r.length===0)return{total:0,uniqueMembers:0,uniqueLocations:0,uniqueTrainers:0,uniqueClasses:0,totalRevenue:0,avgPerMember:"0",avgRevenue:"0",timeDistribution:{},dayDistribution:{},locationBreakdown:{},trainerBreakdown:{},classBreakdown:{}};const a=r.length,t=new Set(r.map(s=>s.memberId||s.memberName||s.member)).size,L=new Set(r.map(s=>s.location)).size,S=new Set(r.map(s=>s.teacherName||s.trainer)).size,U=new Set(r.map(s=>s.cleanedClass||s.class)).size,y=r.reduce((s,d)=>s+(parseFloat(d.paidAmount)||parseFloat(d.amount)||0),0),O=r.reduce((s,d)=>{const n=d.time?parseInt(d.time.split(":")[0]):0,C=n<12?"Morning":n<17?"Afternoon":"Evening";return s[C]=(s[C]||0)+1,s},{}),$=r.reduce((s,d)=>{const n=d.dayOfWeek||"Unknown";return s[n]=(s[n]||0)+1,s},{}),z=r.reduce((s,d)=>{const n=d.location||"Unknown";return s[n]=(s[n]||0)+1,s},{}),F=r.reduce((s,d)=>{const n=d.teacherName||"Unknown";return s[n]=(s[n]||0)+1,s},{}),H=r.reduce((s,d)=>{const n=d.cleanedClass||"Unknown";return s[n]=(s[n]||0)+1,s},{});return{total:a,uniqueMembers:t,uniqueLocations:L,uniqueTrainers:S,uniqueClasses:U,totalRevenue:y,avgPerMember:t>0?(a/t).toFixed(1):"0",avgRevenue:a>0?(y/a).toFixed(0):"0",timeDistribution:O,dayDistribution:$,locationBreakdown:z,trainerBreakdown:F,classBreakdown:H}},[r]);return r.length===0?e.jsx(D,{open:w,onOpenChange:g,children:e.jsxs(T,{className:"max-w-md",children:[e.jsx(A,{children:e.jsxs(k,{className:"flex items-center gap-2 text-red-600",children:[e.jsx(P,{className:"w-5 h-5"}),"No Data Available"]})}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-slate-600 mb-4",children:"No late cancellation records found for the selected criteria."}),e.jsx("button",{onClick:g,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Close"})]})]})}):e.jsx(D,{open:w,onOpenChange:g,children:e.jsxs(T,{className:"max-w-6xl max-h-[95vh] overflow-hidden flex flex-col bg-white border-0 shadow-2xl rounded-2xl",children:[e.jsx(A,{className:"bg-gradient-to-r from-red-600 via-red-700 to-orange-600 text-white px-8 py-6 -mx-6 -mt-6 mb-6 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(k,{className:"flex items-center gap-3 text-white text-2xl",children:[e.jsx("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:e.jsx(Q,{className:"w-7 h-7"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-xl",children:B}),e.jsxs("p",{className:"text-red-100 text-base font-normal mt-1",children:["Detailed analysis of ",m(l.total)," late cancellation records"]})]})]}),e.jsx("button",{onClick:g,className:"p-3 hover:bg-white/20 rounded-full transition-colors duration-200 backdrop-blur-sm",children:e.jsx(E,{className:"w-6 h-6"})})]})}),e.jsxs(J,{defaultValue:"overview",className:"flex-1 flex flex-col",children:[e.jsxs(K,{className:"grid w-full grid-cols-3 bg-slate-100 mx-6 mb-6 p-1 rounded-xl border border-slate-200",children:[e.jsx(f,{value:"overview",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-red-600 data-[state=active]:to-orange-600 data-[state=active]:text-white font-semibold rounded-lg",children:"Overview"}),e.jsx(f,{value:"distribution",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-red-600 data-[state=active]:to-orange-600 data-[state=active]:text-white font-semibold rounded-lg",children:"Distribution"}),e.jsx(f,{value:"records",className:"data-[state=active]:bg-gradient-to-r data-[state=active]:from-red-600 data-[state=active]:to-orange-600 data-[state=active]:text-white font-semibold rounded-lg",children:"Records"})]}),e.jsxs(G,{className:"flex-1",children:[e.jsxs(v,{value:"overview",className:"space-y-6 px-6 pb-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(c,{className:"border-l-4 border-l-red-600 shadow-md",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2 font-semibold uppercase",children:"Total Records"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:m(l.total)})]}),e.jsx(Y,{className:"w-8 h-8 text-red-200"})]})})}),e.jsx(c,{className:"border-l-4 border-l-orange-600 shadow-md",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2 font-semibold uppercase",children:"Unique Members"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:m(l.uniqueMembers)})]}),e.jsx(Z,{className:"w-8 h-8 text-orange-200"})]})})}),e.jsx(c,{className:"border-l-4 border-l-blue-600 shadow-md",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2 font-semibold uppercase",children:"Locations"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:m(l.uniqueLocations)})]}),e.jsx(M,{className:"w-8 h-8 text-blue-200"})]})})}),e.jsx(c,{className:"border-l-4 border-l-green-600 shadow-md",children:e.jsx(o,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-2 font-semibold uppercase",children:"Revenue Lost"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["₹",m(Math.round(l.totalRevenue))]})]}),e.jsx(q,{className:"w-8 h-8 text-green-200"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(c,{className:"bg-gradient-to-br from-slate-50 to-slate-100",children:e.jsxs(o,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1 font-semibold uppercase",children:"Avg per Member"}),e.jsx("p",{className:"text-2xl font-bold text-slate-700",children:l.avgPerMember})]})}),e.jsx(c,{className:"bg-gradient-to-br from-slate-50 to-slate-100",children:e.jsxs(o,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1 font-semibold uppercase",children:"Avg Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-slate-700",children:["₹",l.avgRevenue]})]})}),e.jsx(c,{className:"bg-gradient-to-br from-slate-50 to-slate-100",children:e.jsxs(o,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1 font-semibold uppercase",children:"Trainers"}),e.jsx("p",{className:"text-2xl font-bold text-slate-700",children:m(l.uniqueTrainers)})]})}),e.jsx(c,{className:"bg-gradient-to-br from-slate-50 to-slate-100",children:e.jsxs(o,{className:"p-4",children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1 font-semibold uppercase",children:"Classes"}),e.jsx("p",{className:"text-2xl font-bold text-slate-700",children:m(l.uniqueClasses)})]})})]})]}),e.jsx(v,{value:"distribution",className:"space-y-6 px-6 pb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(c,{className:"shadow-md",children:[e.jsx(j,{className:"bg-gradient-to-r from-red-50 to-orange-50 border-b border-red-200",children:e.jsxs(u,{className:"text-base flex items-center gap-2 text-red-700",children:[e.jsx(q,{className:"w-4 h-4"}),"Time Distribution"]})}),e.jsx(o,{className:"p-4 space-y-3",children:Object.entries(l.timeDistribution).map(([a,t])=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:a}),e.jsx(N,{className:"bg-red-100 text-red-700",children:t})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-red-600 to-orange-600 h-2 rounded-full",style:{width:`${t/l.total*100}%`}})})]},a))})]}),e.jsxs(c,{className:"shadow-md",children:[e.jsx(j,{className:"bg-gradient-to-r from-red-50 to-orange-50 border-b border-red-200",children:e.jsxs(u,{className:"text-base flex items-center gap-2 text-red-700",children:[e.jsx(R,{className:"w-4 h-4"}),"Day Distribution"]})}),e.jsx(o,{className:"p-4 space-y-3",children:Object.entries(l.dayDistribution).sort((a,t)=>t[1]-a[1]).map(([a,t])=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:a}),e.jsx(N,{className:"bg-orange-100 text-orange-700",children:t})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-orange-600 to-red-600 h-2 rounded-full",style:{width:`${t/l.total*100}%`}})})]},a))})]}),e.jsxs(c,{className:"shadow-md",children:[e.jsx(j,{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border-b border-blue-200",children:e.jsxs(u,{className:"text-base flex items-center gap-2 text-blue-700",children:[e.jsx(M,{className:"w-4 h-4"}),"By Location"]})}),e.jsx(o,{className:"p-4 space-y-3",children:Object.entries(l.locationBreakdown).sort((a,t)=>t[1]-a[1]).map(([a,t])=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700 truncate",children:a}),e.jsx(N,{className:"bg-blue-100 text-blue-700",children:t})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 h-2 rounded-full",style:{width:`${t/l.total*100}%`}})})]},a))})]}),e.jsxs(c,{className:"shadow-md",children:[e.jsx(j,{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-b border-purple-200",children:e.jsxs(u,{className:"text-base flex items-center gap-2 text-purple-700",children:[e.jsx(R,{className:"w-4 h-4"}),"By Class"]})}),e.jsx(o,{className:"p-4 space-y-3",children:Object.entries(l.classBreakdown).sort((a,t)=>t[1]-a[1]).map(([a,t])=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700 truncate",children:a||"Unknown"}),e.jsx(N,{className:"bg-purple-100 text-purple-700",children:t})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 h-2 rounded-full",style:{width:`${t/l.total*100}%`}})})]},a))})]})]})}),e.jsx(v,{value:"records",className:"space-y-4 px-6 pb-6",children:e.jsxs(c,{className:"shadow-md",children:[e.jsx(j,{className:"bg-gradient-to-r from-red-600 to-orange-600 text-white border-b",children:e.jsxs(u,{className:"text-base",children:["All Records (",m(r.length),")"]})}),e.jsx(o,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(V,{children:[e.jsx(W,{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs(p,{children:[e.jsx(h,{className:"font-bold text-gray-700",children:"Member"}),e.jsx(h,{className:"font-bold text-gray-700",children:"Date"}),e.jsx(h,{className:"font-bold text-gray-700",children:"Class"}),e.jsx(h,{className:"font-bold text-gray-700",children:"Location"}),e.jsx(h,{className:"font-bold text-gray-700",children:"Trainer"}),e.jsx(h,{className:"font-bold text-gray-700 text-right",children:"Amount"})]})}),e.jsx(X,{children:r.length===0?e.jsx(p,{children:e.jsx(x,{colSpan:6,className:"text-center py-8 text-gray-500",children:"No records available"})}):r.map((a,t)=>e.jsxs(p,{className:"hover:bg-red-50/30 transition-colors border-b border-gray-100",children:[e.jsx(x,{className:"font-medium",children:`${a?.firstName||""} ${a?.lastName||""}`.trim()}),e.jsx(x,{className:"text-sm",children:a?.dateIST?new Date(a.dateIST).toLocaleDateString():"N/A"}),e.jsx(x,{className:"text-sm",children:a?.cleanedClass||"N/A"}),e.jsx(x,{className:"text-sm",children:a?.location||"N/A"}),e.jsx(x,{className:"text-sm",children:a?.teacherName||"N/A"}),e.jsxs(x,{className:"text-right font-semibold text-red-700",children:["₹",m(a?.paidAmount||0)]})]},t))})]})})})]})})]})]})]})})};export{xe as LateCancellationsDrillDownModal};
//# sourceMappingURL=LateCancellationsDrillDownModal-CFbK8n_k.js.map
