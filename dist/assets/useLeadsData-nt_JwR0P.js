import{r as f}from"./index-Bm67KBkU.js";import{g as v,c as y}from"./googleAuth-BGo8ElRc.js";const m=y(),E="1mqjZXStj_PeCt_exDSk-1RP-20Jgk0yl1Lmcg3sZty8",o=a=>{if(!a||a.trim()===""||a==="-")return"";try{let s;const n=new Date;if(a.includes("/")){const l=a.split("/");if(l.length===3){const u=parseInt(l[0]),r=parseInt(l[1]),c=parseInt(l[2]);!isNaN(c)&&!isNaN(r)&&!isNaN(u)&&(s=new Date(c,r-1,u))}}else a.includes("-")?s=new Date(a):s=new Date(a);return!s||isNaN(s.getTime())||s>n||s.getFullYear()<2020?"":s.toISOString()}catch{return""}},t=(a,s)=>a&&a[s]!==void 0&&a[s]!==null?String(a[s]).trim():"",U=(a,s)=>{let n=t(a,s);if(!n||n.includes("/")||n.includes("-"))return 0;n=n.replace(/[₹$,]/g,"");const l=parseFloat(n);return isNaN(l)?0:l},D=(a,s)=>{const n=t(a,s);if(!n||n.includes("/")||n.includes("-"))return 0;const l=parseInt(n,10);return isNaN(l)?0:l},k=()=>{const[a,s]=f.useState([]),[n,l]=f.useState(!0),[u,r]=f.useState(null),c=async()=>{try{l(!0),r(null);const i=await v(),N=encodeURIComponent("◉ Leads"),p=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${E}/values/${N}?alt=json`,{headers:{Authorization:`Bearer ${i}`}});if(!p.ok)throw new Error(`Failed to fetch leads data: ${p.statusText}`);const d=(await p.json()).values||[];if(m.info(`Fetched ${d.length} rows from leads sheet`),d.length<2){s([]);return}const h=d.slice(1).map((e,I)=>{try{return!e||e.length===0?null:{id:t(e,0),fullName:t(e,1),phone:t(e,2),email:t(e,3),createdAt:o(t(e,4)),sourceId:t(e,5),source:t(e,6),memberId:t(e,7),convertedToCustomerAt:o(t(e,8)),stage:t(e,9),associate:t(e,10),remarks:t(e,11),followUp1Date:o(t(e,12)),followUpComments1:t(e,13),followUp2Date:o(t(e,14)),followUpComments2:t(e,15),followUp3Date:o(t(e,16)),followUpComments3:t(e,17),followUp4Date:o(t(e,18)),followUpComments4:t(e,19),center:t(e,20),classType:t(e,21),hostId:t(e,22),status:t(e,23),channel:t(e,24),period:t(e,25),purchasesMade:D(e,26),ltv:U(e,27),visits:D(e,28),trialStatus:t(e,29),conversionStatus:t(e,30),retentionStatus:t(e,31)}}catch(g){return m.error(`Error processing row ${I+1}:`,g),null}}).filter(e=>e!==null);m.info(`Processed ${h.length} leads`),s(h),r(null)}catch(i){r(i instanceof Error?i.message:"Failed to load leads data")}finally{l(!1)}};return f.useEffect(()=>{c()},[]),{data:a,loading:n,error:u,refetch:c}};export{o as p,k as u};
//# sourceMappingURL=useLeadsData-nt_JwR0P.js.map
