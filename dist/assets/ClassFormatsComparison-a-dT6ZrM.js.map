{"version":3,"file":"ClassFormatsComparison-a-dT6ZrM.js","sources":["../../src/utils/classTypeUtils.ts","../../src/components/dashboard/OverviewMetricsCard.tsx","../../src/components/dashboard/ClassFormatRankings.tsx","../../src/components/dashboard/DetailedComparisonView.tsx","../../src/components/dashboard/EnhancedComparisonTool.tsx","../../src/components/dashboard/ClassFormatsMoMTable.tsx","../../src/pages/ClassFormatsComparison.tsx"],"sourcesContent":["/**\n * Utility functions for categorizing class types based on class name patterns\n */\n\nexport type ClassFormat = 'PowerCycle' | 'Barre' | 'Strength Lab';\n\n/**\n * Determines the class format based on the class name\n * - PowerCycle: contains \"powerCycle\" (case-insensitive)\n * - Strength Lab: contains \"Strength Lab\" (case-insensitive)\n * - Barre: everything else\n */\nexport const getClassFormat = (className: string | undefined): ClassFormat => {\n  if (!className) return 'Barre';\n  \n  const lower = className.toLowerCase();\n  \n  if (lower.includes('powercycle')) {\n    return 'PowerCycle';\n  }\n  \n  if (lower.includes('strength lab')) {\n    return 'Strength Lab';\n  }\n  \n  return 'Barre';\n};\n\n/**\n * Get all available class formats\n */\nexport const getAllFormats = (): ClassFormat[] => {\n  return ['PowerCycle', 'Barre', 'Strength Lab'];\n};\n\n/**\n * Filters sessions by class format\n */\nexport const filterByFormat = (sessions: any[], format: ClassFormat): any[] => {\n  return sessions.filter(s => {\n    const cls = s?.cleanedClass || s?.classType;\n    return getClassFormat(cls) === format;\n  });\n};\n","import React, { useMemo } from 'react';\nimport { formatCurrency, formatNumber } from '@/utils/formatters';\nimport type { SessionData } from '@/hooks/useSessionsData';\nimport { getAllFormats, getClassFormat } from '@/utils/classTypeUtils';\nimport { TrendingUp, Users, Clock, DollarSign, AlertCircle, CheckCircle } from 'lucide-react';\n\ninterface OverviewMetricsCardProps {\n  data: SessionData[];\n}\n\nconst OverviewMetricsCard: React.FC<OverviewMetricsCardProps> = ({ data }) => {\n  const sessions = Array.isArray(data) ? data : [];\n\n  const formatMetrics = useMemo(() => {\n    const formats = getAllFormats();\n    \n    return formats.map(format => {\n      const rows = sessions.filter(s => getClassFormat(s.cleanedClass || s.classType) === format);\n      \n      if (rows.length === 0) {\n        return {\n          format,\n          totalSessions: 0,\n          totalRevenue: 0,\n          emptyClasses: 0,\n          nonEmptyClasses: 0,\n          classAvgExcludingEmpty: 0,\n          topTrainer: 'N/A',\n          topClass: 'N/A',\n          topTiming: 'N/A',\n          revenueLostCancellations: 0,\n          lateCancelledCount: 0,\n          avgCapacity: 0,\n          avgFillRate: 0,\n        };\n      }\n\n      // Group by uniqueId1 to count classes\n      const classMap = new Map<string, SessionData[]>();\n      rows.forEach(row => {\n        const classId = row.uniqueId1 || 'unknown';\n        if (!classMap.has(classId)) classMap.set(classId, []);\n        classMap.get(classId)!.push(row);\n      });\n\n      // Count empty vs non-empty classes\n      let emptyClasses = 0;\n      let nonEmptyClasses = 0;\n      classMap.forEach((classSessions, classId) => {\n        const hasCheckins = classSessions.some(s => s.checkedInCount > 0);\n        if (hasCheckins) {\n          nonEmptyClasses++;\n        } else {\n          emptyClasses++;\n        }\n      });\n\n      // Calculate class average (sessions per class, excluding empty)\n      const classAvgExcludingEmpty = nonEmptyClasses > 0 ? rows.length / nonEmptyClasses : 0;\n\n      // Find top trainer by revenue\n      const trainerMap = new Map<string, number>();\n      rows.forEach(r => {\n        const trainer = r.trainerName || 'Unknown';\n        trainerMap.set(trainer, (trainerMap.get(trainer) || 0) + (r.totalPaid || 0));\n      });\n      let topTrainer = 'N/A';\n      let maxTrainerRev = 0;\n      trainerMap.forEach((rev, trainer) => {\n        if (rev > maxTrainerRev) {\n          maxTrainerRev = rev;\n          topTrainer = trainer;\n        }\n      });\n\n      // Find top class by revenue\n      const classNameMap = new Map<string, number>();\n      rows.forEach(r => {\n        const className = r.cleanedClass || r.classType || 'Unknown';\n        classNameMap.set(className, (classNameMap.get(className) || 0) + (r.totalPaid || 0));\n      });\n      let topClass = 'N/A';\n      let maxClassRev = 0;\n      classNameMap.forEach((rev, cls) => {\n        if (rev > maxClassRev) {\n          maxClassRev = rev;\n          topClass = cls;\n        }\n      });\n\n      // Find top timing by revenue\n      const timeMap = new Map<string, number>();\n      rows.forEach(r => {\n        const time = r.time || 'Unknown';\n        timeMap.set(time, (timeMap.get(time) || 0) + (r.totalPaid || 0));\n      });\n      let topTiming = 'N/A';\n      let maxTimeRev = 0;\n      timeMap.forEach((rev, time) => {\n        if (rev > maxTimeRev) {\n          maxTimeRev = rev;\n          topTiming = time;\n        }\n      });\n\n      // Revenue lost from cancellations\n      const totalBooked = rows.reduce((sum, r) => sum + (r.bookedCount || 0), 0);\n      const totalCheckins = rows.reduce((sum, r) => sum + (r.checkedInCount || 0), 0);\n      const revenueLostCancellations = 0; // Will be calculated from cancellation metrics\n\n      // Late cancelled count\n      const lateCancelledCount = rows.reduce((sum, r) => sum + (r.lateCancelledCount || 0), 0);\n\n      // Total capacity and fill rate\n      const totalCapacity = rows.reduce((sum, r) => sum + (r.capacity || 0), 0);\n      const avgCapacity = rows.length > 0 ? Math.round(totalCapacity / rows.length) : 0;\n      const avgFillRate = totalCapacity > 0 ? (totalCheckins / totalCapacity) * 100 : 0;\n\n      return {\n        format,\n        totalSessions: rows.length,\n        totalRevenue: rows.reduce((sum, r) => sum + (r.totalPaid || 0), 0),\n        emptyClasses,\n        nonEmptyClasses,\n        classAvgExcludingEmpty: Math.round(classAvgExcludingEmpty * 10) / 10,\n        topTrainer,\n        topClass,\n        topTiming,\n        revenueLostCancellations,\n        lateCancelledCount,\n        avgCapacity,\n        avgFillRate,\n      };\n    });\n  }, [sessions]);\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Format Cards Grid - Tall Gradient Cards */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        {formatMetrics.map(m => (\n          <div\n            key={m.format}\n            className=\"group relative overflow-hidden rounded-3xl bg-gradient-to-br border border-slate-200 hover:border-slate-300 transition-all duration-300 shadow-md hover:shadow-xl p-6 min-h-96 flex flex-col\"\n            style={{\n              backgroundImage: m.format === 'PowerCycle'\n                ? 'linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)'\n                : m.format === 'Strength Lab'\n                ? 'linear-gradient(135deg, #ec4899 0%, #be185d 100%)'\n                : 'linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%)'\n            }}\n          >\n            {/* Gradient Overlay */}\n            <div className=\"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-20\" />\n\n            <div className=\"relative z-10\">\n              {/* Header */}\n              <div className=\"mb-6\">\n                <div className=\"text-white/80 text-sm font-medium mb-2\">Class Format</div>\n                <h2 className=\"text-3xl font-bold text-white mb-1\">{m.format}</h2>\n                <div\n                  className=\"h-1 w-12 rounded-full\"\n                  style={{\n                    background:\n                      m.format === 'PowerCycle'\n                        ? '#fbbf24'\n                        : m.format === 'Strength Lab'\n                        ? '#f472b6'\n                        : '#c084fc'\n                  }}\n                />\n              </div>\n\n              {m.totalSessions === 0 ? (\n                <div className=\"flex-grow flex items-center justify-center text-white/60 text-sm\">\n                  No sessions data\n                </div>\n              ) : (\n                <>\n                  {/* Primary Metrics Grid */}\n                  <div className=\"grid grid-cols-2 gap-4 mb-6\">\n                    <div className=\"bg-white/15 backdrop-blur-md rounded-xl p-3 border border-white/20\">\n                      <div className=\"text-white/70 text-xs font-medium mb-1\">Total Sessions</div>\n                      <div className=\"text-2xl font-bold text-white\">{formatNumber(m.totalSessions)}</div>\n                    </div>\n                    <div className=\"bg-white/15 backdrop-blur-md rounded-xl p-3 border border-white/20\">\n                      <div className=\"text-white/70 text-xs font-medium mb-1\">Revenue</div>\n                      <div className=\"text-2xl font-bold text-white\">{formatCurrency(m.totalRevenue)}</div>\n                    </div>\n                    <div className=\"bg-white/15 backdrop-blur-md rounded-xl p-3 border border-white/20\">\n                      <div className=\"text-white/70 text-xs font-medium mb-1\">Avg Capacity</div>\n                      <div className=\"text-2xl font-bold text-white\">{m.avgCapacity}</div>\n                    </div>\n                    <div className=\"bg-white/15 backdrop-blur-md rounded-xl p-3 border border-white/20\">\n                      <div className=\"text-white/70 text-xs font-medium mb-1\">Fill Rate</div>\n                      <div className=\"text-2xl font-bold text-white\">{m.avgFillRate.toFixed(1)}%</div>\n                    </div>\n                  </div>\n\n                  {/* Key Metrics */}\n                  <div className=\"space-y-3 flex-grow mb-4\">\n                    <div className=\"flex items-center justify-between px-3 py-2 bg-white/10 rounded-lg backdrop-blur-sm border border-white/10\">\n                      <span className=\"text-white/80 text-sm\">Non-Empty Classes</span>\n                      <span className=\"text-lg font-bold text-white\">{m.nonEmptyClasses}</span>\n                    </div>\n                    <div className=\"flex items-center justify-between px-3 py-2 bg-white/10 rounded-lg backdrop-blur-sm border border-white/10\">\n                      <span className=\"text-white/80 text-sm\">Empty Classes</span>\n                      <span className=\"text-lg font-bold text-white\">{m.emptyClasses}</span>\n                    </div>\n                    <div className=\"flex items-center justify-between px-3 py-2 bg-white/10 rounded-lg backdrop-blur-sm border border-white/10\">\n                      <span className=\"text-white/80 text-sm\">Class Avg</span>\n                      <span className=\"text-lg font-bold text-white\">{m.classAvgExcludingEmpty}</span>\n                    </div>\n                    <div className=\"flex items-center justify-between px-3 py-2 bg-white/10 rounded-lg backdrop-blur-sm border border-white/10\">\n                      <span className=\"text-white/80 text-sm\">Late Cancelled</span>\n                      <span className={`text-lg font-bold ${\n                        m.lateCancelledCount <= 5 ? 'text-green-300' : m.lateCancelledCount <= 10 ? 'text-yellow-300' : 'text-red-300'\n                      }`}>\n                        {m.lateCancelledCount}\n                      </span>\n                    </div>\n                  </div>\n\n                  {/* Top Performers Section */}\n                  <div className=\"pt-4 border-t border-white/20\">\n                    <div className=\"text-xs font-semibold text-white/80 uppercase tracking-wider mb-3\">Top Performers</div>\n                    <div className=\"space-y-2 text-xs\">\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-white/70\">Trainer:</span>\n                        <span className=\"font-semibold text-white truncate text-right ml-2\">{m.topTrainer}</span>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-white/70\">Class:</span>\n                        <span className=\"font-semibold text-white truncate text-right ml-2\">{m.topClass}</span>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-white/70\">Timing:</span>\n                        <span className=\"font-semibold text-white\">{m.topTiming}</span>\n                      </div>\n                    </div>\n                  </div>\n                </>\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport default OverviewMetricsCard;\n","import React, { useMemo, useState } from 'react';\nimport { formatCurrency, formatNumber } from '@/utils/formatters';\nimport type { SessionData } from '@/hooks/useSessionsData';\nimport { Crown, AlertTriangle, Calendar, Clock, Zap, Users, BarChart3, Download, RefreshCw, Filter } from 'lucide-react';\n\ninterface ClassFormatRankingsProps {\n  data: SessionData[];\n}\n\ntype SortCriteria = 'revenue' | 'sessions' | 'fill' | 'class-avg' | 'rev-per-seat' | 'rev-per-session' | 'empty-classes';\n\nconst ClassFormatRankings: React.FC<ClassFormatRankingsProps> = ({ data }) => {\n  const sessions = Array.isArray(data) ? data : [];\n  const [sortBy, setSortBy] = useState<SortCriteria>('revenue');\n  const [includeTrainers, setIncludeTrainers] = useState(true);\n  const [excludeHosted, setExcludeHosted] = useState(false);\n  const [minClasses, setMinClasses] = useState(1);\n  const [minVisitors, setMinVisitors] = useState(0);\n\n  const allRankings = useMemo(() => {\n    // Group by uniqueId1 (unique class occurrence)\n    const classMap = new Map<string, SessionData[]>();\n    sessions.forEach(s => {\n      const classId = s.uniqueId1 || s.sessionId || 'unknown';\n      if (!classMap.has(classId)) classMap.set(classId, []);\n      classMap.get(classId)!.push(s);\n    });\n\n    // Build ranking data for each class\n    let rankings = Array.from(classMap.entries()).map(([classId, classSessions]) => {\n      const totalSessions = classSessions.length;\n      const totalRevenue = classSessions.reduce((sum, s) => sum + (s.totalPaid || 0), 0);\n      const totalCapacity = classSessions.reduce((sum, s) => sum + (s.capacity || 0), 0);\n      const totalCheckins = classSessions.reduce((sum, s) => sum + (s.checkedInCount || 0), 0);\n      const fillRate = totalCapacity > 0 ? (totalCheckins / totalCapacity) * 100 : 0;\n      const avgRevPerSession = totalSessions > 0 ? totalRevenue / totalSessions : 0;\n      const avgRevPerSeat = totalCapacity > 0 ? totalRevenue / totalCapacity : 0;\n\n      // Get first session details (class name, day, time)\n      const firstSession = classSessions[0];\n      const className = firstSession?.cleanedClass || firstSession?.classType || 'Unknown';\n      const dayOfWeek = firstSession?.dayOfWeek || 'Unknown';\n      const time = firstSession?.time || 'Unknown';\n\n      // Check if class has any empty sessions (0 checkins)\n      const emptyClassCount = classSessions.filter(s => s.checkedInCount === 0).length;\n      const nonEmptyClassCount = totalSessions - emptyClassCount;\n\n      // Check if class is hosted (contains \"hosted\" in class name)\n      const isHosted = className.toLowerCase().includes('hosted');\n\n      // Top trainer in this class by revenue\n      const trainerMap = new Map<string, number>();\n      classSessions.forEach(s => {\n        const trainer = s.trainerName || 'Unknown';\n        trainerMap.set(trainer, (trainerMap.get(trainer) || 0) + (s.totalPaid || 0));\n      });\n      let topTrainer = 'N/A';\n      let maxTrainerRev = 0;\n      trainerMap.forEach((rev, trainer) => {\n        if (rev > maxTrainerRev) {\n          maxTrainerRev = rev;\n          topTrainer = trainer;\n        }\n      });\n\n      return {\n        classId,\n        className,\n        dayOfWeek,\n        time,\n        totalSessions,\n        totalRevenue,\n        totalCapacity,\n        totalCheckins,\n        fillRate,\n        avgRevPerSession,\n        avgRevPerSeat,\n        emptyClassCount,\n        nonEmptyClassCount,\n        topTrainer,\n        classSessions,\n        isHosted,\n      };\n    });\n\n    // Apply filters\n    rankings = rankings.filter(r => {\n      // Filter by minimum classes\n      if (r.totalSessions < minClasses) return false;\n      // Filter by minimum visitors\n      if (r.totalCheckins < minVisitors) return false;\n      // Filter out hosted classes if enabled\n      if (excludeHosted && r.isHosted) return false;\n      return true;\n    });\n\n    // Sort based on criteria\n    rankings.sort((a, b) => {\n      switch (sortBy) {\n        case 'revenue':\n          return b.totalRevenue - a.totalRevenue;\n        case 'sessions':\n          return b.totalSessions - a.totalSessions;\n        case 'fill':\n          return b.fillRate - a.fillRate;\n        case 'class-avg':\n          return (b.totalSessions / b.nonEmptyClassCount || 0) - (a.totalSessions / a.nonEmptyClassCount || 0);\n        case 'rev-per-seat':\n          return b.avgRevPerSeat - a.avgRevPerSeat;\n        case 'rev-per-session':\n          return b.avgRevPerSession - a.avgRevPerSession;\n        case 'empty-classes':\n          return b.emptyClassCount - a.emptyClassCount;\n        default:\n          return 0;\n      }\n    });\n\n    return rankings;\n  }, [sessions, sortBy, excludeHosted, minClasses, minVisitors]);\n\n  // Split into top and bottom\n  const topCount = Math.ceil(allRankings.length / 2);\n  const topRankings = allRankings.slice(0, topCount);\n  const bottomRankings = allRankings.slice(-topCount).reverse();\n\n  const getMetricLabel = () => {\n    switch (sortBy) {\n      case 'revenue': return 'Revenue';\n      case 'sessions': return 'Sessions';\n      case 'fill': return 'Fill Rate';\n      case 'class-avg': return 'Class Avg';\n      case 'rev-per-seat': return 'Rev/Seat';\n      case 'rev-per-session': return 'Rev/Session';\n      case 'empty-classes': return 'Empty Classes';\n      default: return 'Metric';\n    }\n  };\n\n  const getMetricValue = (item: any) => {\n    switch (sortBy) {\n      case 'revenue': return formatCurrency(item.totalRevenue);\n      case 'sessions': return formatNumber(item.totalSessions);\n      case 'fill': return `${item.fillRate.toFixed(1)}%`;\n      case 'class-avg': return (item.totalSessions / item.nonEmptyClassCount || 0).toFixed(1);\n      case 'rev-per-seat': return formatCurrency(item.avgRevPerSeat);\n      case 'rev-per-session': return formatCurrency(item.avgRevPerSession);\n      case 'empty-classes': return formatNumber(item.emptyClassCount);\n      default: return '‚Äî';\n    }\n  };\n\n  const RankingCard = ({ item, index, isTop }: { item: any; index: number; isTop: boolean }) => (\n    <div className=\"group flex items-center justify-between p-4 rounded-xl bg-white shadow-sm border border-slate-200 hover:shadow-md hover:border-slate-300 transition-all duration-300 cursor-pointer\">\n      <div className=\"flex items-center gap-4 flex-1\">\n        <div\n          className={`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold shadow-sm text-white ${\n            isTop\n              ? 'bg-gradient-to-r from-green-400 to-emerald-600'\n              : 'bg-gradient-to-r from-red-400 to-rose-600'\n          }`}\n        >\n          {index + 1}\n        </div>\n        <div className=\"flex-1\">\n          <p className=\"font-semibold text-slate-900 group-hover:text-blue-600 transition-colors\">{item.className}</p>\n          <div className=\"flex flex-wrap gap-2 mt-2\">\n            <span className=\"inline-block text-xs px-2.5 py-1 rounded-full bg-slate-100 text-slate-700 font-medium\">\n              <Calendar className=\"w-3 h-3 inline mr-1\" />\n              {item.dayOfWeek}\n            </span>\n            <span className=\"inline-block text-xs px-2.5 py-1 rounded-full bg-slate-100 text-slate-700 font-medium\">\n              <Clock className=\"w-3 h-3 inline mr-1\" />\n              {item.time}\n            </span>\n            <span className=\"inline-block text-xs px-2.5 py-1 rounded-full bg-blue-50 text-blue-700 border border-blue-200 font-medium\">\n              {formatNumber(item.totalSessions)} sessions\n            </span>\n            <span className=\"inline-block text-xs px-2.5 py-1 rounded-full bg-purple-50 text-purple-700 border border-purple-200 font-medium\">\n              {item.totalCapacity} capacity\n            </span>\n            <span className={`inline-block text-xs px-2.5 py-1 rounded-full font-medium border ${\n              item.fillRate >= 75 ? 'bg-green-50 text-green-700 border-green-200' :\n              item.fillRate >= 50 ? 'bg-yellow-50 text-yellow-700 border-yellow-200' :\n              'bg-red-50 text-red-700 border-red-200'\n            }`}>\n              {item.fillRate.toFixed(1)}% fill\n            </span>\n            {includeTrainers && (\n              <span className=\"inline-block text-xs px-2.5 py-1 rounded-full bg-slate-100 text-slate-700 border border-slate-200 font-medium\">\n                <Users className=\"w-3 h-3 inline mr-1\" />\n                {item.topTrainer}\n              </span>\n            )}\n            {item.isHosted && (\n              <span className=\"inline-block text-xs px-2.5 py-1 rounded-full bg-orange-50 text-orange-700 border border-orange-200 font-medium\">\n                üé• Hosted\n              </span>\n            )}\n          </div>\n        </div>\n      </div>\n      <div className=\"text-right\">\n        <p className=\"font-bold text-xl text-slate-900 group-hover:text-blue-600 transition-colors\">\n          {getMetricValue(item)}\n        </p>\n        <p className=\"text-sm text-slate-500\">{getMetricLabel()}</p>\n      </div>\n    </div>\n  );\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex flex-col gap-4\">\n        <div>\n          <h3 className=\"text-lg font-semibold text-slate-900\">Individual Class Rankings</h3>\n          <p className=\"text-sm text-slate-500 mt-1\">Performance metrics by class occurrence with advanced filters</p>\n        </div>\n\n        {/* Main Filter and Sort Controls */}\n        <div className=\"bg-gradient-to-r from-slate-50 to-slate-100 rounded-2xl border border-slate-200 p-5 shadow-sm space-y-4\">\n          {/* Row 1: Sort and Toggles */}\n          <div className=\"flex flex-wrap gap-3 items-center\">\n            <select\n              value={sortBy}\n              onChange={(e) => setSortBy(e.target.value as any)}\n              className=\"px-3 py-2 rounded-lg border border-slate-300 bg-white text-sm font-medium text-slate-900 cursor-pointer hover:border-slate-400 transition-all\"\n            >\n              <option value=\"revenue\">Sort by Revenue</option>\n              <option value=\"sessions\">Sort by Sessions</option>\n              <option value=\"fill\">Sort by Fill Rate</option>\n              <option value=\"class-avg\">Sort by Class Avg</option>\n              <option value=\"rev-per-seat\">Sort by Rev/Seat</option>\n              <option value=\"rev-per-session\">Sort by Rev/Session</option>\n              <option value=\"empty-classes\">Sort by Empty Classes</option>\n            </select>\n\n            <div className=\"h-6 w-px bg-slate-300\" />\n\n            {/* Toggle Trainer Inclusion */}\n            <label className=\"flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50 cursor-pointer transition-all\">\n              <input\n                type=\"checkbox\"\n                checked={includeTrainers}\n                onChange={(e) => setIncludeTrainers(e.target.checked)}\n                className=\"w-4 h-4 rounded accent-blue-600\"\n              />\n              <Users className=\"w-4 h-4 text-slate-600\" />\n              <span className=\"text-sm font-medium text-slate-700\">Show Trainers</span>\n            </label>\n\n            {/* Toggle Exclude Hosted */}\n            <label className=\"flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50 cursor-pointer transition-all\">\n              <input\n                type=\"checkbox\"\n                checked={excludeHosted}\n                onChange={(e) => setExcludeHosted(e.target.checked)}\n                className=\"w-4 h-4 rounded accent-blue-600\"\n              />\n              <span className=\"text-sm font-medium text-slate-700\">Exclude Hosted</span>\n            </label>\n          </div>\n\n          {/* Row 2: Min Classes and Min Visitors */}\n          <div className=\"flex flex-wrap gap-3 items-end\">\n            <div className=\"flex flex-col gap-1\">\n              <label className=\"text-xs font-semibold text-slate-700 flex items-center gap-1\">\n                <Filter className=\"w-3 h-3\" />\n                Min Classes\n              </label>\n              <input\n                type=\"number\"\n                value={minClasses}\n                onChange={(e) => setMinClasses(Math.max(1, parseInt(e.target.value) || 1))}\n                min=\"1\"\n                max=\"100\"\n                className=\"w-20 px-2.5 py-2 rounded-lg border border-slate-300 bg-white text-sm font-medium text-slate-900 focus:border-blue-400 focus:ring-1 focus:ring-blue-400\"\n              />\n            </div>\n\n            <div className=\"flex flex-col gap-1\">\n              <label className=\"text-xs font-semibold text-slate-700 flex items-center gap-1\">\n                <Users className=\"w-3 h-3\" />\n                Min Visitors\n              </label>\n              <input\n                type=\"number\"\n                value={minVisitors}\n                onChange={(e) => setMinVisitors(Math.max(0, parseInt(e.target.value) || 0))}\n                min=\"0\"\n                max=\"1000\"\n                className=\"w-20 px-2.5 py-2 rounded-lg border border-slate-300 bg-white text-sm font-medium text-slate-900 focus:border-blue-400 focus:ring-1 focus:ring-blue-400\"\n              />\n            </div>\n\n            {/* Action Buttons */}\n            <div className=\"flex gap-2 ml-auto\">\n              <button\n                onClick={() => {\n                  setSortBy('revenue');\n                  setIncludeTrainers(true);\n                  setExcludeHosted(false);\n                  setMinClasses(1);\n                  setMinVisitors(0);\n                }}\n                className=\"px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50 text-sm font-medium text-slate-700 transition-all flex items-center gap-1\"\n                title=\"Reset all filters to default values\"\n              >\n                <RefreshCw className=\"w-4 h-4\" />\n                Reset\n              </button>\n\n              <button\n                onClick={() => {\n                  const csvData = allRankings.map((item, idx) => ({\n                    rank: (idx + 1),\n                    className: item.className,\n                    trainer: item.topTrainer,\n                    sessions: item.totalSessions,\n                    revenue: item.totalRevenue,\n                    fillRate: item.fillRate.toFixed(1),\n                  }));\n                  const csv = [\n                    ['Rank', 'Class Name', 'Trainer', 'Sessions', 'Revenue', 'Fill Rate %'].join(','),\n                    ...csvData.map(row => [row.rank, row.className, row.trainer, row.sessions, row.revenue, row.fillRate].join(','))\n                  ].join('\\n');\n                  const blob = new Blob([csv], { type: 'text/csv' });\n                  const url = URL.createObjectURL(blob);\n                  const a = document.createElement('a');\n                  a.href = url;\n                  a.download = `class-rankings-${new Date().toISOString().split('T')[0]}.csv`;\n                  a.click();\n                  URL.revokeObjectURL(url);\n                }}\n                className=\"px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50 text-sm font-medium text-slate-700 transition-all flex items-center gap-1\"\n                title=\"Export rankings as CSV\"\n              >\n                <Download className=\"w-4 h-4\" />\n                Export\n              </button>\n\n              <button\n                onClick={() => window.scrollTo({ top: 0, behavior: 'smooth' })}\n                className=\"px-3 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white text-sm font-medium transition-all flex items-center gap-1\"\n                title=\"View analytics and insights\"\n              >\n                <BarChart3 className=\"w-4 h-4\" />\n                Analytics\n              </button>\n            </div>\n          </div>\n\n          {/* Filter Summary */}\n          <div className=\"text-xs text-slate-600 px-3 py-2 bg-white/50 rounded-lg border border-slate-200\">\n            <span className=\"font-semibold\">Active Filters:</span> Min {minClasses}+ classes ‚Ä¢ Min {minVisitors}+ visitors {excludeHosted && '‚Ä¢ Excluding hosted'} {includeTrainers && '‚Ä¢ Trainers visible'}\n          </div>\n        </div>\n      </div>\n\n      {/* Top and Bottom Rankings */}\n      {allRankings.length === 0 ? (\n        <div className=\"rounded-xl border-2 border-dashed border-slate-300 p-8 text-center\">\n          <Zap className=\"w-12 h-12 mx-auto text-slate-400 mb-3\" />\n          <p className=\"text-slate-600 font-medium\">No classes found</p>\n          <p className=\"text-sm text-slate-500 mt-1\">Try adjusting your filters</p>\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {/* Top Performers */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-8 h-8 rounded-full bg-gradient-to-r from-green-400 to-emerald-600 flex items-center justify-center text-white\">\n                <Crown className=\"w-4 h-4\" />\n              </div>\n              <h4 className=\"font-semibold text-slate-900\">Top Performers</h4>\n              <span className=\"ml-auto text-xs text-slate-500 font-medium\">{topRankings.length} classes</span>\n            </div>\n            <div className=\"space-y-3\">\n              {topRankings.map((item, index) => (\n                <RankingCard key={item.classId} item={item} index={index} isTop={true} />\n              ))}\n            </div>\n          </div>\n\n          {/* Bottom Performers */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"w-8 h-8 rounded-full bg-gradient-to-r from-red-400 to-rose-600 flex items-center justify-center text-white\">\n                <AlertTriangle className=\"w-4 h-4\" />\n              </div>\n              <h4 className=\"font-semibold text-slate-900\">Needs Improvement</h4>\n              <span className=\"ml-auto text-xs text-slate-500 font-medium\">{bottomRankings.length} classes</span>\n            </div>\n            <div className=\"space-y-3\">\n              {bottomRankings.map((item, index) => (\n                <RankingCard key={item.classId} item={item} index={index} isTop={false} />\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ClassFormatRankings;\n","import React, { useMemo, useState } from 'react';\nimport { formatCurrency, formatNumber } from '@/utils/formatters';\nimport type { SessionData } from '@/hooks/useSessionsData';\nimport { getAllFormats, getClassFormat } from '@/utils/classTypeUtils';\nimport { BarChart3, TrendingUp, Users, DollarSign, Percent, Activity, User, Clock } from 'lucide-react';\n\ninterface DetailedComparisonViewProps {\n  data: SessionData[];\n}\n\ntype MetricType = 'revenue' | 'sessions' | 'fill' | 'class-avg' | 'rev-per-seat' | 'rev-per-session' | 'empty-classes';\ntype ViewMode = 'trainer' | 'time' | 'day';\n\nconst DetailedComparisonView: React.FC<DetailedComparisonViewProps> = ({ data }) => {\n  const sessions = Array.isArray(data) ? data : [];\n  const [metric, setMetric] = useState<MetricType>('revenue');\n  const [viewMode, setViewMode] = useState<ViewMode>('trainer');\n\n  const formats = useMemo(() => {\n    // Get unique categorized formats instead of raw class names\n    const formatSet = new Set(sessions.map(s => getClassFormat(s.cleanedClass || s.classType)));\n    return Array.from(formatSet);\n  }, [sessions]);\n  \n  const [selectedFormat, setSelectedFormat] = React.useState<string>(() => formats[0] || '');\n\n  const formatData = useMemo(() => {\n    const selected = selectedFormat || formats[0];\n    if (!selected || sessions.length === 0) return null;\n\n    const rows = sessions.filter(s => getClassFormat(s.cleanedClass || s.classType) === selected);\n    const byTrainer = new Map<string, { sessions: number; revenue: number; checkins: number; capacity: number }>();\n    const byTime = new Map<string, { sessions: number; revenue: number; checkins: number; capacity: number }>();\n    const byDay = new Map<string, { sessions: number; revenue: number; checkins: number; capacity: number }>();\n\n    rows.forEach(s => {\n      // By trainer\n      let tk = s.trainerName || 'Unknown';\n      if (!byTrainer.has(tk)) byTrainer.set(tk, { sessions: 0, revenue: 0, checkins: 0, capacity: 0 });\n      const t = byTrainer.get(tk)!;\n      t.sessions++;\n      t.revenue += s.totalPaid || s.revenue || 0;\n      t.checkins += s.checkedInCount || 0;\n      t.capacity += s.capacity || 0;\n\n      // By time\n      let timk = s.time || 'Unknown';\n      if (!byTime.has(timk)) byTime.set(timk, { sessions: 0, revenue: 0, checkins: 0, capacity: 0 });\n      const tm = byTime.get(timk)!;\n      tm.sessions++;\n      tm.revenue += s.totalPaid || s.revenue || 0;\n      tm.checkins += s.checkedInCount || 0;\n      tm.capacity += s.capacity || 0;\n\n      // By day\n      let dk = s.dayOfWeek || 'Unknown';\n      if (!byDay.has(dk)) byDay.set(dk, { sessions: 0, revenue: 0, checkins: 0, capacity: 0 });\n      const d = byDay.get(dk)!;\n      d.sessions++;\n      d.revenue += s.totalPaid || s.revenue || 0;\n      d.checkins += s.checkedInCount || 0;\n      d.capacity += s.capacity || 0;\n    });\n\n    return { byTrainer, byTime, byDay };\n  }, [sessions, selectedFormat, formats]);\n\n  const getTableIcon = (type: string) => {\n    if (type === 'trainer') return <User className=\"w-4 h-4\" />;\n    if (type === 'time') return <Clock className=\"w-4 h-4\" />;\n    return <BarChart3 className=\"w-4 h-4\" />;\n  };\n\n  const renderTable = (data: Map<string, any>, title: string, type: string) => {\n    if (!data || data.size === 0) return null;\n\n    const sorted = Array.from(data.entries()).sort((a, b) => {\n      if (metric === 'revenue') return b[1].revenue - a[1].revenue;\n      if (metric === 'sessions') return b[1].sessions - a[1].sessions;\n      return (b[1].capacity > 0 ? (b[1].checkins / b[1].capacity) * 100 : 0) - (a[1].capacity > 0 ? (a[1].checkins / a[1].capacity) * 100 : 0);\n    });\n\n    return (\n      <div className=\"rounded-2xl border border-slate-200 overflow-hidden shadow-sm bg-white hover:shadow-md transition-all duration-200\">\n        <div className=\"bg-gradient-to-r from-slate-50 to-slate-100 px-6 py-4 border-b border-slate-200\">\n          <h3 className=\"text-sm font-bold text-slate-900 uppercase tracking-wide flex items-center gap-2\">\n            {getTableIcon(type)}\n            {title}\n          </h3>\n        </div>\n        <div className=\"overflow-auto\">\n          <table className=\"w-full text-sm\">\n            <thead className=\"bg-slate-50 border-b border-slate-200\">\n              <tr>\n                <th className=\"px-6 py-3 text-left font-bold text-slate-700\">Name</th>\n                <th className=\"px-6 py-3 text-right font-bold text-slate-700\">Sessions</th>\n                <th className=\"px-6 py-3 text-right font-bold text-slate-700\">Revenue</th>\n                <th className=\"px-6 py-3 text-right font-bold text-slate-700\">Fill Rate</th>\n              </tr>\n            </thead>\n            <tbody className=\"divide-y divide-slate-200\">\n              {sorted.map(([name, stats], idx) => {\n                const fillRate = stats.capacity > 0 ? (stats.checkins / stats.capacity) * 100 : 0;\n                return (\n                  <tr key={name} className=\"hover:bg-slate-50 transition-colors duration-150 group\">\n                    <td className=\"px-6 py-4 font-semibold text-slate-900 group-hover:text-blue-600\">{name}</td>\n                    <td className=\"px-6 py-4 text-right text-slate-600 font-medium\">{formatNumber(stats.sessions)}</td>\n                    <td className=\"px-6 py-4 text-right font-bold text-slate-900\">{formatCurrency(stats.revenue)}</td>\n                    <td className=\"px-6 py-4 text-right\">\n                      <span className={`inline-block px-3 py-1.5 rounded-full text-xs font-bold ${\n                        fillRate >= 80 ? 'bg-blue-800 text-white' : \n                        'bg-rose-600 text-white'\n                      }`}>\n                        {fillRate.toFixed(1)}%\n                      </span>\n                    </td>\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header with Beautiful Typography */}\n      <div className=\"bg-gradient-to-r from-slate-50 via-blue-50 to-slate-100 rounded-2xl border border-slate-200 p-6 shadow-sm\">\n        <div className=\"flex items-start justify-between\">\n          <div>\n            <h3 className=\"text-2xl font-bold text-slate-900 mb-2\">Detailed Performance Breakdown</h3>\n            <p className=\"text-sm text-slate-600\">Deep dive analysis of trainer, time slot, and day of week performance metrics</p>\n          </div>\n          <div className=\"text-3xl opacity-10\">üìä</div>\n        </div>\n      </div>\n\n      {/* Format Selector & Metric Chooser */}\n      <div className=\"bg-gradient-to-r from-slate-50 to-slate-100 rounded-2xl border border-slate-200 p-6 shadow-sm space-y-4\">\n        <div>\n          <label className=\"block text-xs font-bold text-slate-700 mb-3 uppercase tracking-wide flex items-center gap-2\">\n            <BarChart3 className=\"w-4 h-4\" />\n            Select Class Format\n          </label>\n          <div className=\"flex gap-2 flex-wrap\">\n            {formats.map(f => (\n              <button \n                key={f} \n                onClick={() => setSelectedFormat(f)} \n                className={`px-4 py-2.5 rounded-xl font-medium text-sm transition-all duration-200 ${\n                  selectedFormat === f \n                    ? 'bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg scale-105' \n                    : 'bg-white text-slate-700 border border-slate-200 hover:border-slate-300 hover:shadow-md'\n                }`}\n              >\n                {f}\n              </button>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"pt-2 border-t border-slate-200\">\n          <label className=\"block text-xs font-bold text-slate-700 mb-3 uppercase tracking-wide flex items-center gap-2\">\n            <Activity className=\"w-4 h-4\" />\n            Sort by Metric\n          </label>\n          <div className=\"flex gap-2 flex-wrap\">\n            {(['revenue', 'sessions', 'fill'] as const).map(m => (\n              <button \n                key={m} \n                onClick={() => setMetric(m)} \n                className={`px-4 py-2.5 rounded-xl font-medium text-sm transition-all duration-200 flex items-center gap-1 ${\n                  metric === m \n                    ? 'bg-gradient-to-r from-blue-100 to-blue-50 text-blue-700 border border-blue-300 shadow-md' \n                    : 'bg-white text-slate-600 border border-slate-200 hover:border-slate-300'\n                }`}\n              >\n                {m === 'revenue' ? <DollarSign className=\"w-4 h-4\" /> : m === 'sessions' ? <BarChart3 className=\"w-4 h-4\" /> : <Percent className=\"w-4 h-4\" />}\n                {m === 'revenue' ? 'Revenue' : m === 'sessions' ? 'Sessions' : 'Fill Rate'}\n              </button>\n            ))}\n          </div>\n        </div>\n      </div>\n\n      {/* Data Tables */}\n      {formatData && (\n        <div className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-5\">\n            <div>{renderTable(formatData.byTrainer, 'By Trainer', 'trainer')}</div>\n            <div>{renderTable(formatData.byTime, 'By Time', 'time')}</div>\n            <div>{renderTable(formatData.byDay, 'By Day of Week', 'day')}</div>\n          </div>\n\n          {/* Summary Stats */}\n          <div className=\"bg-gradient-to-br from-slate-50 to-slate-100 rounded-2xl border border-slate-200 p-6 shadow-sm\">\n            <div className=\"text-sm font-bold text-slate-900 mb-4 uppercase tracking-wide flex items-center gap-2\">\n              <TrendingUp className=\"w-4 h-4\" />\n              Format Overview: {selectedFormat}\n            </div>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              {(() => {\n                const all = Array.from(formatData.byTrainer.values());\n                const totalSessions = all.reduce((s, r) => s + r.sessions, 0);\n                const totalRevenue = all.reduce((s, r) => s + r.revenue, 0);\n                const totalCheckins = all.reduce((s, r) => s + r.checkins, 0);\n                const totalCapacity = all.reduce((s, r) => s + r.capacity, 0);\n                const avgFill = totalCapacity > 0 ? (totalCheckins / totalCapacity) * 100 : 0;\n\n                return [\n                  { label: 'Total Sessions', value: formatNumber(totalSessions), icon: BarChart3, color: 'from-blue-500 to-blue-600' },\n                  { label: 'Total Revenue', value: formatCurrency(totalRevenue), icon: DollarSign, color: 'from-green-500 to-green-600' },\n                  { label: 'Avg Fill Rate', value: `${avgFill.toFixed(1)}%`, icon: Percent, color: 'from-purple-500 to-purple-600' },\n                  { label: 'Avg Rev/Session', value: formatCurrency(totalSessions > 0 ? totalRevenue / totalSessions : 0), icon: TrendingUp, color: 'from-orange-500 to-orange-600' }\n                ];\n              })().map((s, i) => {\n                const Icon = s.icon;\n                return (\n                  <div key={i} className=\"p-4 bg-white rounded-xl border border-slate-200 hover:shadow-md transition-all duration-200 group\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                      <div className={`w-8 h-8 rounded-lg bg-gradient-to-r ${s.color} flex items-center justify-center text-white`}>\n                        <Icon className=\"w-4 h-4\" />\n                      </div>\n                      <div className=\"text-xs text-slate-600 font-semibold\">{s.label}</div>\n                    </div>\n                    <div className=\"text-xl font-bold text-slate-900 group-hover:text-blue-600 transition-colors\">{s.value}</div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default DetailedComparisonView;\n","import React, { useMemo, useState } from 'react';\nimport { formatCurrency, formatNumber } from '@/utils/formatters';\nimport type { SessionData } from '@/hooks/useSessionsData';\nimport { getClassFormat } from '@/utils/classTypeUtils';\nimport { User, Dumbbell, Clock, TrendingUp, BarChart3, Percent, AlertCircle } from 'lucide-react';\n\ninterface EnhancedComparisonToolProps {\n  data: SessionData[];\n}\n\ntype ComparisonMode = 'trainers' | 'classes' | 'times';\n\nconst EnhancedComparisonTool: React.FC<EnhancedComparisonToolProps> = ({ data }) => {\n  const sessions = Array.isArray(data) ? data : [];\n  const [mode, setMode] = useState<ComparisonMode>('trainers');\n  const [selected, setSelected] = useState<string[]>([]);\n\n\n\n  const items = useMemo(() => {\n    if (mode === 'trainers') return Array.from(new Set(sessions.map(s => s.trainerName).filter(Boolean)));\n    if (mode === 'classes') return Array.from(new Set(sessions.map(s => getClassFormat(s.cleanedClass || s.classType)).filter(Boolean)));\n    return Array.from(new Set(sessions.map(s => s.time).filter(Boolean))).sort();\n  }, [sessions, mode]);\n\n  const toggle = (val: string) => {\n    setSelected(prev => prev.includes(val) ? prev.filter(x => x !== val) : [...prev, val].slice(0, 6));\n  };\n\n  const comparison = useMemo(() => {\n    return selected.map(key => {\n      const rows = sessions.filter(s => {\n        if (mode === 'trainers') return s.trainerName === key;\n        if (mode === 'classes') return getClassFormat(s.cleanedClass || s.classType) === key;\n        return s.time === key;\n      });\n      const totalSessions = rows.length;\n      const totalRevenue = rows.reduce((sum, r) => sum + (r.totalPaid || r.revenue || 0), 0);\n      const totalCapacity = rows.reduce((sum, r) => sum + (r.capacity || 0), 0);\n      const totalCheckins = rows.reduce((sum, r) => sum + (r.checkedInCount || 0), 0);\n      const lateCancelled = rows.reduce((sum, r) => sum + (r.lateCancelledCount || 0), 0);\n      const avgFill = totalCapacity > 0 ? (totalCheckins / totalCapacity) * 100 : 0;\n      const avgRevPerSession = totalSessions > 0 ? totalRevenue / totalSessions : 0;\n      const noShowRate = totalSessions > 0 ? (lateCancelled / totalSessions) * 100 : 0;\n      const avgCapacity = totalSessions > 0 ? Math.round(totalCapacity / totalSessions) : 0;\n      return { key, rows, totalSessions, totalRevenue, totalCapacity, totalCheckins, lateCancelled, avgFill, avgRevPerSession, noShowRate, avgCapacity };\n    });\n  }, [selected, sessions, mode]);\n\n  const modeButtons = [\n    { key: 'trainers' as ComparisonMode, label: 'Trainers', icon: User, color: 'from-blue-500 to-blue-700' },\n    { key: 'classes' as ComparisonMode, label: 'Classes', icon: Dumbbell, color: 'from-purple-500 to-purple-700' },\n    { key: 'times' as ComparisonMode, label: 'Times', icon: Clock, color: 'from-pink-500 to-pink-700' }\n  ];\n\n  return (\n    <div className=\"space-y-6 text-gray-900\">\n      {/* Header with Beautiful Typography */}\n      <div className=\"bg-gradient-to-r from-slate-50 via-purple-50 to-slate-100 rounded-2xl border border-slate-200 p-6 shadow-sm\">\n        <div className=\"flex items-start justify-between\">\n          <div>\n            <h3 className=\"text-2xl font-bold text-slate-900 mb-2\">Advanced Comparison Tool</h3>\n            <p className=\"text-sm text-slate-700\">Side-by-side analysis of up to 6 items with comprehensive metrics and visual insights</p>\n          </div>\n          <div className=\"text-3xl opacity-10\">üîç</div>\n        </div>\n      </div>\n\n      {/* Mode Selector */}\n      <div className=\"bg-gradient-to-r from-slate-50 to-slate-100 rounded-2xl border border-slate-200 p-4 shadow-sm flex flex-wrap gap-2\">\n        {modeButtons.map(btn => {\n          const Icon = btn.icon;\n          return (\n            <button \n              key={btn.key} \n              onClick={() => { setMode(btn.key); setSelected([]); }} \n              className={`px-5 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${\n                mode === btn.key \n                  ? `bg-gradient-to-r ${btn.color} text-white shadow-lg scale-105` \n                  : 'bg-white text-slate-700 border border-slate-200 hover:border-slate-300 hover:shadow-md'\n              }`}\n            >\n              <Icon className=\"w-4 h-4\" />\n              {btn.label}\n            </button>\n          );\n        })}\n      </div>\n\n      {/* Top Selector */}\n      <div className=\"bg-white rounded-2xl border border-slate-200 p-4 shadow-sm\">\n        <div className=\"text-xs font-bold text-slate-900 mb-3 uppercase tracking-wide flex items-center gap-2\">\n          <BarChart3 className=\"w-4 h-4\" />\n          Select up to 6\n        </div>\n        <div className=\"max-h-40 overflow-y-auto flex flex-wrap gap-2\">\n          {items.length === 0 && (\n            <div className=\"text-sm text-slate-400 text-center py-4 w-full\">No items found</div>\n          )}\n          {items.map((item, idx) => {\n            const count = sessions.filter(s => mode === 'trainers' ? s.trainerName === item : mode === 'classes' ? getClassFormat(s.cleanedClass || s.classType) === item : s.time === item).length;\n            return (\n              <label key={item} className={`flex items-center gap-3 px-3 py-2 rounded-lg cursor-pointer transition-all duration-150 border ${\n                selected.includes(item) \n                  ? 'bg-blue-600 text-white border-blue-700 shadow-sm' \n                  : 'bg-white text-slate-700 border-slate-200 hover:border-slate-300'\n              }`}>\n                <input \n                  type=\"checkbox\" \n                  checked={selected.includes(item)} \n                  onChange={() => toggle(item)} \n                  className=\"rounded w-4 h-4 accent-white cursor-pointer\" \n                />\n                <span className={`text-sm font-medium truncate ${selected.includes(item) ? 'text-white' : 'text-slate-700'}`}>{item}</span>\n                <span className={`text-xs font-semibold px-2 py-1 rounded-full ${\n                  selected.includes(item)\n                    ? 'bg-white text-blue-700'\n                    : 'bg-slate-200 text-slate-600'\n                }`}>\n                  {count}\n                </span>\n              </label>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Cards */}\n      <div>\n        {comparison.length > 0 ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6\">\n            {comparison.map((c, idx) => (\n              <div key={c.key} className=\"bg-white rounded-2xl border border-slate-200 shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden\">\n                <div className={`h-2 bg-gradient-to-r ${\n                  idx % 3 === 0 ? 'from-blue-500 to-blue-600' :\n                  idx % 3 === 1 ? 'from-purple-500 to-purple-600' :\n                  'from-pink-500 to-pink-600'\n                }`} />\n                <div className=\"p-6 border-b border-slate-100\">\n                  <div className=\"text-xs text-slate-500 font-bold mb-1 uppercase tracking-wide\">{mode.slice(0, -1)}</div>\n                  <div className=\"text-xl font-bold text-slate-900 truncate\">{c.key}</div>\n                </div>\n                <div className=\"p-6 space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"text-center p-3 bg-blue-50 rounded-lg\">\n                      <div className=\"text-xs text-blue-600 font-bold mb-1\">Sessions</div>\n                      <div className=\"text-lg font-bold text-blue-900\">{formatNumber(c.totalSessions)}</div>\n                    </div>\n                    <div className=\"text-center p-3 bg-green-50 rounded-lg\">\n                      <div className=\"text-xs text-green-600 font-bold mb-1\">Revenue</div>\n                      <div className=\"text-lg font-bold text-green-900\">{formatCurrency(c.totalRevenue)}</div>\n                    </div>\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"text-center p-3 bg-purple-50 rounded-lg\">\n                      <div className=\"text-xs text-purple-600 font-bold mb-1\">Check-ins</div>\n                      <div className=\"text-lg font-bold text-purple-900\">{formatNumber(c.totalCheckins)}</div>\n                    </div>\n                    <div className=\"text-center p-3 bg-orange-50 rounded-lg\">\n                      <div className=\"text-xs text-orange-600 font-bold mb-1\">Capacity</div>\n                      <div className=\"text-lg font-bold text-orange-900\">{formatNumber(c.totalCapacity)}</div>\n                    </div>\n                  </div>\n                  <div className=\"pt-2 space-y-3\">\n                    <div className=\"flex justify-between items-center py-2\">\n                      <span className=\"text-sm text-slate-600 font-medium\">Fill Rate</span>\n                      <span className={`text-sm font-bold px-2 py-1 rounded ${\n                        c.avgFill >= 75 ? 'bg-blue-800 text-white' : \n                        'bg-rose-600 text-white'\n                      }`}>\n                        {c.avgFill.toFixed(1)}%\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between items-center py-2\">\n                      <span className=\"text-sm text-slate-600 font-medium\">Rev/Session</span>\n                      <span className=\"text-sm font-bold text-slate-900\">{formatCurrency(c.avgRevPerSession)}</span>\n                    </div>\n                    <div className=\"flex justify-between items-center py-2\">\n                      <span className=\"text-sm text-slate-600 font-medium\">Late Cancel</span>\n                      <span className={`text-sm font-bold px-2 py-1 rounded ${\n                        c.noShowRate <= 10 ? 'bg-blue-800 text-white' : \n                        'bg-rose-600 text-white'\n                      }`}>\n                        {c.noShowRate.toFixed(1)}%\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between items-center py-2\">\n                      <span className=\"text-sm text-slate-600 font-medium\">Avg Capacity</span>\n                      <span className=\"text-sm font-bold text-slate-900\">{c.avgCapacity}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        ) : (\n          <div className=\"bg-gradient-to-br from-slate-50 via-slate-100 to-slate-200 rounded-2xl border-2 border-dashed border-slate-300 p-12 text-center h-64 flex flex-col items-center justify-center\">\n            <div className=\"text-6xl mb-4 opacity-20\">üëà</div>\n            <div className=\"text-lg font-bold text-slate-600 mb-2\">No Items Selected</div>\n            <div className=\"text-sm text-slate-500\">Select up to 6 items from the selector above to begin comparison</div>\n            <div className=\"text-xs text-slate-400 mt-3\">Side-by-side analysis will appear here</div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default EnhancedComparisonTool;\n","import React, { useMemo, useState } from 'react';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow, TableFooter } from '@/components/ui/table';\nimport { SessionData } from '@/hooks/useSessionsData';\nimport { formatCurrency, formatNumber } from '@/utils/formatters';\nimport { getClassFormat } from '@/utils/classTypeUtils';\nimport { ChevronDown, BarChart3, TrendingUp, Users, Clock, Percent, Activity, DollarSign, AlertTriangle } from 'lucide-react';\n\ntype Canonical = 'powercycle' | 'barre' | 'strength' | 'other';\ntype MetricType = 'sessions' | 'checkins' | 'revenue' | 'fillRate' | 'lateCancelled' | 'classAvg' | 'revPerSeat' | 'cancellationRate';\ntype DimensionType = 'format' | 'className' | 'classType' | 'trainer' | 'location' | 'dayOfWeek' | 'time';\n\nconst toCanonical = (s?: string) => {\n  const t = (s || '').toLowerCase();\n  if (/power|cycle/.test(t)) return 'powercycle' as const;\n  if (/barre/.test(t)) return 'barre' as const;\n  if (/strength/.test(t)) return 'strength' as const;\n  return 'other' as const;\n};\n\ninterface ClassFormatsMoMTableProps {\n  sessions: SessionData[];\n  checkins: any[];\n  onDrillDown?: (data: { format: string; month: string; metric: string; value: number }) => void;\n}\n\nexport const ClassFormatsMoMTable: React.FC<ClassFormatsMoMTableProps> = ({ sessions, checkins, onDrillDown }) => {\n  const [metric, setMetric] = useState<MetricType>('sessions');\n  const [dimension, setDimension] = useState<DimensionType>('format');\n  const [showDimensionMenu, setShowDimensionMenu] = useState(false);\n\n  // Use data as-is since page already applies location and date range filters\n  // MoM table will use all months available in filtered data (ignores global date range, respects location)\n  const filteredSessions = sessions;\n  const filteredCheckins = checkins;\n\n  const handleCellClick = (dimension: string, month: string, value: number) => {\n    if (onDrillDown) {\n      onDrillDown({\n        format: dimension,\n        month,\n        metric,\n        value\n      });\n    }\n  };\n\n  const toYYYYMM = (input?: string): string | null => {\n    if (!input) return null;\n    const s = String(input);\n    if (s.includes('/')) {\n      const parts = s.split('/');\n      if (parts.length >= 3) {\n        const dd = parseInt(parts[0]);\n        const mm = parseInt(parts[1]);\n        const yyyy = parseInt(parts[2]);\n        if (!isNaN(yyyy) && !isNaN(mm) && !isNaN(dd)) {\n          const d = new Date(yyyy, mm - 1, dd);\n          if (!isNaN(d.getTime())) {\n            const y = d.getFullYear();\n            const m = String(d.getMonth() + 1).padStart(2, '0');\n            return `${y}-${m}`;\n          }\n        }\n      }\n    } else {\n      const d = new Date(s);\n      if (!isNaN(d.getTime())) {\n        const y = d.getFullYear();\n        const m = String(d.getMonth() + 1).padStart(2, '0');\n        return `${y}-${m}`;\n      }\n      if (/^\\d{4}-\\d{2}/.test(s)) return s.slice(0,7);\n    }\n    return null;\n  };\n\n  const months = useMemo(() => {\n    const set = new Set<string>();\n    filteredSessions.forEach(s => {\n      const ym = toYYYYMM(s.date);\n      if (ym) set.add(ym);\n    });\n    filteredCheckins.forEach(c => {\n      const d = c.dateIST || c['dateIST'] || c['Date (IST)'];\n      const ym = toYYYYMM(typeof d === 'string' ? d : undefined);\n      if (ym) set.add(ym);\n    });\n    const arr = Array.from(set);\n    arr.sort();\n    return arr.slice(-6);\n  }, [filteredSessions, filteredCheckins]);\n\n  const isTrueish = (val: any): boolean => {\n    const s = String(val ?? '').trim().toLowerCase();\n    return s === 'true' || s === 'yes' || s === '1';\n  };\n\n  // Get dimension values based on selected dimension\n  const dimensionValues = useMemo(() => {\n    const set = new Set<string>();\n    filteredSessions.forEach(s => {\n      let val: string | undefined;\n      switch (dimension) {\n        case 'format': val = getClassFormat(s.cleanedClass || s.classType); break;\n        case 'className': val = s.cleanedClass || s.classType; break;\n        case 'classType': val = s.classType; break;\n        case 'trainer': val = s.trainerName; break;\n        case 'location': val = s.location; break;\n        case 'dayOfWeek': val = s.dayOfWeek; break;\n        case 'time': val = s.time; break;\n      }\n      if (val) set.add(val);\n    });\n    return Array.from(set).sort();\n  }, [filteredSessions, dimension]);\n\n  // Build MoM matrix based on dimension\n  const byMonth = useMemo(() => {\n    const result: Record<string, Record<string, { sessions: number; checkins: number; capacity: number; revenue: number; late: number }>> = {};\n    \n    months.forEach(m => {\n      result[m] = {};\n      dimensionValues.forEach(val => {\n        result[m][val] = { sessions: 0, checkins: 0, capacity: 0, revenue: 0, late: 0 };\n      });\n    });\n\n    const sessionAgg: Record<string, Record<string, { checkins: number; revenue: number; late: number }>> = {};\n    months.forEach(m => {\n      sessionAgg[m] = {};\n      dimensionValues.forEach(val => {\n        sessionAgg[m][val] = { checkins: 0, revenue: 0, late: 0 };\n      });\n    });\n\n    filteredSessions.forEach(s => {\n      const m = toYYYYMM(s.date || undefined);\n      if (!m || !result[m]) return;\n      \n      let dimVal: string | undefined;\n      switch (dimension) {\n        case 'format': dimVal = getClassFormat(s.cleanedClass || s.classType); break;\n        case 'className': dimVal = s.cleanedClass || s.classType; break;\n        case 'classType': dimVal = s.classType; break;\n        case 'trainer': dimVal = s.trainerName; break;\n        case 'location': dimVal = s.location; break;\n        case 'dayOfWeek': dimVal = s.dayOfWeek; break;\n        case 'time': dimVal = s.time; break;\n      }\n      \n      if (!dimVal || !result[m][dimVal]) return;\n      result[m][dimVal].sessions += 1;\n      result[m][dimVal].capacity += s.capacity || 0;\n      sessionAgg[m][dimVal].checkins += s.checkedInCount || 0;\n      sessionAgg[m][dimVal].revenue += s.totalPaid || s.revenue || 0;\n      sessionAgg[m][dimVal].late += s.lateCancelledCount || 0;\n    });\n\n    filteredCheckins.forEach(c => {\n      const d = c.dateIST || c['dateIST'] || c['Date (IST)'];\n      const m = typeof d === 'string' ? toYYYYMM(d) : null;\n      if (!m || !result[m]) return;\n      \n      const checkedIn = isTrueish(c.checkedIn ?? c['Checked In'] ?? c['Checked in']);\n      const late = isTrueish(c.isLateCancelled ?? c['Is Late Cancelled']);\n      const paid = Number(c.paidAmount ?? c['Paid'] ?? 0) || 0;\n\n      let dimVal: string | undefined;\n      switch (dimension) {\n        case 'format': dimVal = getClassFormat(c.cleanedClass || c['Cleaned Class']); break;\n        case 'className': dimVal = c.cleanedClass || c['Cleaned Class']; break;\n        case 'classType': dimVal = c['Class Type']; break;\n        case 'trainer': dimVal = c['Trainer']; break;\n        case 'location': dimVal = c['Location']; break;\n        case 'dayOfWeek': dimVal = c['Day of Week']; break;\n        case 'time': dimVal = c['Time']; break;\n      }\n\n      if (!dimVal || !result[m][dimVal]) return;\n      if (checkedIn) result[m][dimVal].checkins += 1;\n      if (late) result[m][dimVal].late += 1;\n      result[m][dimVal].revenue += paid;\n    });\n\n    // Apply fallback\n    months.forEach(m => {\n      dimensionValues.forEach(val => {\n        if (result[m][val].checkins === 0 && sessionAgg[m][val].checkins > 0) {\n          result[m][val].checkins = sessionAgg[m][val].checkins;\n        }\n        if (result[m][val].revenue === 0 && sessionAgg[m][val].revenue > 0) {\n          result[m][val].revenue = sessionAgg[m][val].revenue;\n        }\n        if (result[m][val].late === 0 && sessionAgg[m][val].late > 0) {\n          result[m][val].late = sessionAgg[m][val].late;\n        }\n      });\n    });\n\n    return result;\n  }, [filteredSessions, filteredCheckins, months, dimension, dimensionValues]);\n\n  const headerMonths = months.map(m => {\n    const [y, mo] = m.split('-');\n    const d = new Date(Number(y), Number(mo)-1, 1);\n    return d.toLocaleDateString('en-IN', { month: 'short', year: '2-digit' });\n  });\n\n  const renderValue = (m: string, val: string) => {\n    const row = byMonth[m]?.[val];\n    if (!row) return '-';\n    switch (metric) {\n      case 'sessions': return formatNumber(row.sessions);\n      case 'checkins': return formatNumber(row.checkins);\n      case 'revenue': return formatCurrency(row.revenue);\n      case 'lateCancelled': return formatNumber(row.late);\n      case 'classAvg': {\n        if (row.sessions === 0) return '-';\n        const avg = row.checkins / row.sessions;\n        return avg.toFixed(1);\n      }\n      case 'revPerSeat': {\n        if (row.capacity === 0) return '-';\n        const rev = row.revenue / row.capacity;\n        return formatCurrency(rev);\n      }\n      case 'cancellationRate': {\n        if (row.sessions === 0) return '-';\n        const rate = (row.late / row.sessions) * 100;\n        return `${rate.toFixed(1)}%`;\n      }\n      case 'fillRate': {\n        const pct = row.capacity > 0 ? (row.checkins / row.capacity) * 100 : 0;\n        return `${pct.toFixed(1)}%`;\n      }\n    }\n  };\n\n  const valueForCalc = (m: string, val: string) => {\n    const row = byMonth[m]?.[val];\n    if (!row) return 0;\n    switch (metric) {\n      case 'sessions': return row.sessions;\n      case 'checkins': return row.checkins;\n      case 'revenue': return row.revenue;\n      case 'lateCancelled': return row.late;\n      case 'classAvg': return row.sessions === 0 ? 0 : row.checkins / row.sessions;\n      case 'revPerSeat': return row.capacity === 0 ? 0 : row.revenue / row.capacity;\n      case 'cancellationRate': return row.sessions === 0 ? 0 : (row.late / row.sessions) * 100;\n      case 'fillRate': return row.capacity > 0 ? (row.checkins / row.capacity) * 100 : 0;\n    }\n  };\n\n  const formatDelta = (delta: number, isPctPoints = false) => {\n    const sign = delta > 0 ? '+' : delta < 0 ? '' : '';\n    if (isPctPoints) return `${sign}${delta.toFixed(1)}pp`;\n    return `${sign}${delta.toFixed(1)}%`;\n  };\n\n  const computeMoMDelta = (val: string) => {\n    if (months.length < 2) return '-';\n    const last = months[months.length - 1];\n    const prev = months[months.length - 2];\n    if (metric === 'fillRate' || metric === 'cancellationRate' || metric === 'classAvg') {\n      const d = valueForCalc(last, val) - valueForCalc(prev, val);\n      return formatDelta(d, true);\n    } else {\n      const vPrev = valueForCalc(prev, val);\n      const vLast = valueForCalc(last, val);\n      if (!vPrev) return '-';\n      const change = ((vLast - vPrev) / vPrev) * 100;\n      return formatDelta(change);\n    }\n  };\n\n  // Totals per month across all dimensions\n  const totalsByMonth = useMemo(() => {\n    const totals: Record<string, { sessions: number; checkins: number; capacity: number; revenue: number; late: number }> = {};\n    months.forEach(m => {\n      const t = { sessions: 0, checkins: 0, capacity: 0, revenue: 0, late: 0 };\n      dimensionValues.forEach(val => {\n        const r = byMonth[m]?.[val];\n        if (!r) return;\n        t.sessions += r.sessions;\n        t.checkins += r.checkins;\n        t.capacity += r.capacity;\n        t.revenue += r.revenue;\n        t.late += r.late;\n      });\n      totals[m] = t;\n    });\n    return totals;\n  }, [byMonth, months, dimensionValues]);\n\n  const renderTotalValue = (m: string) => {\n    const t = totalsByMonth[m];\n    if (!t) return '-';\n    switch (metric) {\n      case 'sessions': return formatNumber(t.sessions);\n      case 'checkins': return formatNumber(t.checkins);\n      case 'revenue': return formatCurrency(t.revenue);\n      case 'lateCancelled': return formatNumber(t.late);\n      case 'classAvg': {\n        if (t.sessions === 0) return '-';\n        const avg = t.checkins / t.sessions;\n        return avg.toFixed(1);\n      }\n      case 'revPerSeat': {\n        if (t.capacity === 0) return '-';\n        const rev = t.revenue / t.capacity;\n        return formatCurrency(rev);\n      }\n      case 'cancellationRate': {\n        if (t.sessions === 0) return '-';\n        const rate = (t.late / t.sessions) * 100;\n        return `${rate.toFixed(1)}%`;\n      }\n      case 'fillRate': {\n        const pct = t.capacity > 0 ? (t.checkins / t.capacity) * 100 : 0;\n        return `${pct.toFixed(1)}%`;\n      }\n    }\n  };\n\n  const dimensionLabel = {\n    format: 'Format',\n    className: 'Class Name',\n    classType: 'Class Type',\n    trainer: 'Trainer',\n    location: 'Location',\n    dayOfWeek: 'Day of Week',\n    time: 'Time'\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <style>{`\n        @keyframes borderPulse {\n          0%, 100% { border-color: rgb(220, 38, 38); opacity: 1; }\n          50% { opacity: 0.5; }\n        }\n\n      `}</style>\n      {/* Header with Title and Controls */}\n      <div className=\"bg-gradient-to-r from-slate-50 via-blue-50 to-slate-100 rounded-2xl border border-slate-200 p-6 shadow-sm\">\n        <div className=\"flex items-start justify-between mb-4\">\n          <div>\n            <h3 className=\"text-2xl font-bold text-slate-900 mb-2 flex items-center gap-2\">\n              <TrendingUp className=\"w-6 h-6 text-blue-600\" />\n              Month-on-Month Analysis\n            </h3>\n            <p className=\"text-sm text-slate-600\">Track performance trends across months with flexible dimension selection</p>\n          </div>\n          <div className=\"text-3xl opacity-10\">üìä</div>\n        </div>\n\n        {/* Dimension Selector */}\n        <div className=\"bg-white rounded-xl border border-slate-200 p-3 mb-4\">\n          <div className=\"relative inline-block w-full sm:w-auto\">\n            <button\n              onClick={() => setShowDimensionMenu(!showDimensionMenu)}\n              className=\"w-full sm:w-auto px-4 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-semibold text-sm flex items-center justify-between gap-2 hover:shadow-lg transition-all duration-200\"\n            >\n              <BarChart3 className=\"w-4 h-4\" />\n              Dimension: {dimensionLabel[dimension]}\n              <ChevronDown className={`w-4 h-4 transition-transform ${showDimensionMenu ? 'rotate-180' : ''}`} />\n            </button>\n            {showDimensionMenu && (\n              <div className=\"absolute top-full left-0 mt-2 w-full sm:w-48 bg-white rounded-xl border border-slate-200 shadow-lg z-10\">\n                {(Object.keys(dimensionLabel) as DimensionType[]).map(dim => (\n                  <button\n                    key={dim}\n                    onClick={() => {\n                      setDimension(dim);\n                      setShowDimensionMenu(false);\n                    }}\n                    className={`w-full text-left px-4 py-3 text-sm font-medium transition-colors ${\n                      dimension === dim\n                        ? 'bg-blue-50 text-blue-700 border-l-4 border-blue-500'\n                        : 'text-slate-700 hover:bg-slate-50'\n                    }`}\n                  >\n                    {dimensionLabel[dim]}\n                  </button>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Metric Buttons */}\n        <div className=\"flex flex-wrap gap-2\">\n          {[\n            { key: 'sessions' as MetricType, label: 'Sessions', icon: BarChart3 },\n            { key: 'checkins' as MetricType, label: 'Check-ins', icon: Users },\n            { key: 'revenue' as MetricType, label: 'Revenue', icon: TrendingUp },\n            { key: 'fillRate' as MetricType, label: 'Fill Rate', icon: Percent },\n            { key: 'classAvg' as MetricType, label: 'Class Avg', icon: Activity },\n            { key: 'revPerSeat' as MetricType, label: 'Rev/Seat', icon: DollarSign },\n            { key: 'cancellationRate' as MetricType, label: 'Cancel %', icon: AlertTriangle },\n            { key: 'lateCancelled' as MetricType, label: 'Late Cancel', icon: Clock }\n          ].map(btn => {\n            const Icon = btn.icon;\n            return (\n              <Button\n                key={btn.key}\n                variant={metric === btn.key ? 'default' : 'outline'}\n                size=\"sm\"\n                onClick={() => setMetric(btn.key)}\n                className={`h-9 px-3 text-xs font-semibold flex items-center gap-1.5 ${\n                  metric === btn.key\n                    ? 'bg-blue-600 text-white shadow-md'\n                    : 'border-slate-200 text-slate-700 hover:bg-slate-50'\n                }`}\n              >\n                <Icon className=\"w-3.5 h-3.5\" />\n                {btn.label}\n              </Button>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Table */}\n      <style>{`\n        .table-border-animate {\n          animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n        }\n        @keyframes borderPulse {\n          0%, 100% { borderColor: rgb(220, 38, 38); }\n          50% { borderColor: rgb(239, 68, 68); }\n        }\n      `}</style>\n      <Card className=\"bg-white shadow-sm border border-slate-200\">\n        <CardContent className=\"p-0\">\n          <div className=\"overflow-x-auto\" style={{ color: '#000' }}>\n            <Table>\n              <TableHeader>\n                <TableRow className=\"bg-slate-100\" style={{ borderBottom: '2px solid rgb(220, 38, 38)', animation: 'borderPulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite' }}>\n                  <TableHead className=\"font-bold text-black py-3\" style={{ color: '#000' }}>{dimensionLabel[dimension]}</TableHead>\n                  {headerMonths.map((hm, idx) => (\n                    <TableHead key={idx} className=\"text-right font-bold text-black py-3\" style={{ color: '#000' }}>{hm}</TableHead>\n                  ))}\n                  <TableHead className=\"text-right font-bold text-black py-3\" style={{ color: '#000' }}>MoM Œî</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {dimensionValues.map((val, idx) => (\n                  <TableRow key={val} className={idx % 2 === 0 ? 'bg-white' : 'bg-slate-50 hover:bg-slate-100'}>\n                    <TableCell className=\"font-semibold text-slate-900 py-3 capitalize\">{val}</TableCell>\n                    {months.map((m, midx) => {\n                      const value = renderValue(m, val);\n                      return (\n                        <TableCell \n                          key={midx} \n                          className=\"text-right py-3 cursor-pointer hover:bg-blue-100 transition-colors font-medium text-slate-700\"\n                          onClick={() => handleCellClick(val, m, parseFloat(String(value).replace(/[^0-9.-]/g, '')) || 0)}\n                        >\n                          {value}\n                        </TableCell>\n                      );\n                    })}\n                    <TableCell className=\"text-right py-3 font-semibold text-slate-900\">{computeMoMDelta(val)}</TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n              <TableFooter>\n                <TableRow className=\"bg-slate-100 font-bold\" style={{ borderTop: '2px solid rgb(220, 38, 38)', animation: 'borderPulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite' }}>\n                  <TableCell className=\"font-bold py-3\" style={{ color: '#000' }}>Total</TableCell>\n                  {months.map((m, idx) => (\n                    <TableCell key={idx} className=\"text-right py-3 font-bold\" style={{ color: '#000' }}>{renderTotalValue(m)}</TableCell>\n                  ))}\n                  <TableCell className=\"text-right py-3 font-bold\" style={{ color: '#000' }}>‚Äî</TableCell>\n                </TableRow>\n              </TableFooter>\n            </Table>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n};\n\nexport default ClassFormatsMoMTable;\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport DashboardMotionHero from '@/components/ui/DashboardMotionHero';\nimport { Footer } from '@/components/ui/footer';\nimport { AdvancedExportButton } from '@/components/ui/AdvancedExportButton';\nimport { useSessionsData } from '@/hooks/useSessionsData';\nimport { useGlobalLoading } from '@/hooks/useGlobalLoading';\nimport { SessionsFiltersProvider } from '@/contexts/SessionsFiltersContext';\nimport { SessionsFilterSection } from '@/components/dashboard/SessionsFilterSection';\nimport { useFilteredSessionsData } from '@/hooks/useFilteredSessionsData';\nimport { formatNumber, formatCurrency } from '@/utils/formatters';\nimport { useLateCancellationsData } from '@/hooks/useLateCancellationsData';\nimport OverviewMetricsCard from '@/components/dashboard/OverviewMetricsCard';\nimport ClassFormatRankings from '@/components/dashboard/ClassFormatRankings';\nimport DetailedComparisonView from '@/components/dashboard/DetailedComparisonView';\nimport EnhancedComparisonTool from '@/components/dashboard/EnhancedComparisonTool';\nimport ClassFormatsMoMTable from '@/components/dashboard/ClassFormatsMoMTable';\nimport ClassFormatsYoYTable from '@/components/dashboard/ClassFormatsYoYTable';\nimport type { SessionData } from '@/hooks/useSessionsData';\nimport { useSessionsFilters } from '@/contexts/SessionsFiltersContext';\nimport { ModernDrillDownModal } from '@/components/dashboard/ModernDrillDownModal';\nimport { InfoPopover } from '@/components/ui/InfoSidebar';\nimport { StudioLocationTabs } from '@/components/ui/StudioLocationTabs';\n\n\nconst locations = [\n  { id: 'all', name: 'All Locations, ', fullName: 'All Locations' },\n  { id: 'kwality', name: 'Kwality House, Kemps Corner', fullName: 'Kwality House, Kemps Corner' },\n  { id: 'supreme', name: 'Supreme HQ, Bandra', fullName: 'Supreme HQ, Bandra' },\n  { id: 'kenkere', name: 'Kenkere House, Bengaluru', fullName: 'Kenkere House' },\n  { id: 'popup', name: 'Pop-up', fullName: 'Pop-up' }\n];\n\nconst ClassFormatsComparison: React.FC = () => {\n  const { data, loading } = useSessionsData();\n  const { allCheckins, loading: checkinsLoading } = useLateCancellationsData();\n  const { setLoading } = useGlobalLoading();\n  const [activeLocation, setActiveLocation] = useState('kwality');\n  const exportRef = React.useRef<{ open: () => void }>(null);\n  const [drill, setDrill] = useState<any | null>(null);\n\n  useEffect(() => {\n    setLoading(loading || checkinsLoading, 'Loading class format comparison data...');\n  }, [loading, checkinsLoading, setLoading, data, allCheckins]);\n\n  // NOTE: We must read filters within the provider. We'll render an inner component below.\n  // Global drilldown event bridge\n  useEffect(() => {\n    const handler = (e: any) => {\n      const detail = e?.detail || {};\n      setDrill((prev: any) => ({ type: 'class', ...detail }));\n    };\n    window.addEventListener('open-drilldown', handler as any);\n    return () => window.removeEventListener('open-drilldown', handler as any);\n  }, []);\n\n  // Inner section that can read filters from context (lives under provider)\n  const FormatTrendsSection: React.FC<{ sessions: SessionData[]; checkins: any[]; activeLocation: string }>\n    = ({ sessions, checkins, activeLocation }) => {\n    const { filters } = useSessionsFilters();\n    const filteredSessionsByFilters = useFilteredSessionsData(sessions || []);\n    const filteredSessionsByLocation = React.useMemo(() => {\n      if (activeLocation === 'all') return filteredSessionsByFilters;\n      return filteredSessionsByFilters.filter(s => {\n        const sl = String(s.location || '').toLowerCase();\n        if (activeLocation === 'kwality') return sl.includes('kwality');\n        if (activeLocation === 'supreme') return sl.includes('supreme');\n        if (activeLocation === 'kenkere') return sl.includes('kenkere');\n        if (activeLocation === 'popup') return sl.includes('pop') || sl.includes('popup') || sl.includes('pop-up');\n        return true;\n      });\n    }, [filteredSessionsByFilters, activeLocation]);\n    const filteredCheckinsByLocation = React.useMemo(() => {\n      const rows = Array.isArray(checkins) ? checkins : [];\n      const passesFilters = (row: any) => {\n        const name = String(row.sessionName || '').toLowerCase();\n        if (name.includes('test') || name.includes('demo')) return false;\n        if (!filters) return true;\n        if (filters.trainers.length > 0 && !filters.trainers.includes(row.teacherName)) return false;\n        if (filters.classTypes.length > 0 && !filters.classTypes.includes(row.cleanedClass)) return false;\n        if (filters.dayOfWeek.length > 0 && !filters.dayOfWeek.includes(row.dayOfWeek)) return false;\n        if (filters.timeSlots.length > 0 && !filters.timeSlots.includes(row.time)) return false;\n        // Intentionally ignore dateRange for MoM/YoY tables per request\n        return true;\n      };\n      const byLoc = rows.filter(r => {\n        if (!passesFilters(r)) return false;\n        if (activeLocation === 'all') return true;\n        const rl = String(r.location || '').toLowerCase();\n        if (activeLocation === 'kwality') return rl.includes('kwality');\n        if (activeLocation === 'supreme') return rl.includes('supreme');\n        if (activeLocation === 'kenkere') return rl.includes('kenkere');\n        if (activeLocation === 'popup') return rl.includes('pop') || rl.includes('popup') || rl.includes('pop-up');\n        return true;\n      });\n      return byLoc;\n    }, [checkins, filters, activeLocation]);\n\n    return (\n      <Tabs defaultValue=\"summary\" className=\"w-full\">\n        <TabsList className=\"bg-white/90 backdrop-blur-sm p-1 rounded-2xl shadow-xl border border-slate-200 grid w-full grid-cols-3 h-auto max-w-2xl mx-auto mb-8\">\n          <TabsTrigger value=\"summary\" className=\"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r\">\n            Summary Tables\n          </TabsTrigger>\n          <TabsTrigger value=\"monthly\" className=\"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r\">\n            Monthly Trends\n          </TabsTrigger>\n          <TabsTrigger value=\"yearly\" className=\"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r\">\n            Yearly Trends\n          </TabsTrigger>\n        </TabsList>\n        \n        <TabsContent value=\"summary\" className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n            <ClassFormatsMoMTable \n              sessions={filteredSessionsByLocation as any} \n              checkins={filteredCheckinsByLocation}\n              onDrillDown={(data) => {\n                window.dispatchEvent(new CustomEvent('open-drilldown', {\n                  detail: { type: 'format-trend', ...data }\n                }));\n              }}\n            />\n            <ClassFormatsYoYTable \n              sessions={filteredSessionsByLocation as any} \n              checkins={filteredCheckinsByLocation}\n              onDrillDown={(data) => {\n                window.dispatchEvent(new CustomEvent('open-drilldown', {\n                  detail: { type: 'format-trend', ...data }\n                }));\n              }}\n            />\n          </div>\n        </TabsContent>\n        \n        <TabsContent value=\"monthly\" className=\"space-y-6\">\n          <ClassFormatsMoMDetails sessions={filteredSessionsByLocation as any} />\n        </TabsContent>\n        \n        <TabsContent value=\"yearly\" className=\"space-y-6\">\n          <ClassFormatsYoYDetails sessions={filteredSessionsByLocation as any} />\n        </TabsContent>\n      </Tabs>\n    );\n  };\n\n  // Inner body rendered under SessionsFiltersProvider so filtering applies globally within page\n  const ClassFormatsBody: React.FC<{ sessions: SessionData[]; allCheckins: any[] }>\n    = ({ sessions, allCheckins }) => {\n    const { filters } = useSessionsFilters();\n    const filteredAll = useFilteredSessionsData(sessions || []);\n    \n    React.useEffect(() => {\n      if (sessions && sessions.length > 0) {\n        const uniqueClasses = new Set(sessions.map(s => s?.cleanedClass || s?.classType));\n\n      }\n    }, [sessions, filteredAll, allCheckins, activeLocation, filters]);\n    \n    // Filter checkins globally with SessionsFilters\n    const filteredAllCheckins = useMemo(() => {\n      return (allCheckins || []).filter((c: any) => {\n        if (!filters) return true;\n        if (filters.trainers.length > 0 && !filters.trainers.includes(c.teacherName)) return false;\n        if (filters.classTypes.length > 0 && !filters.classTypes.includes(c.cleanedClass)) return false;\n        if (filters.dayOfWeek.length > 0 && !filters.dayOfWeek.includes(c.dayOfWeek)) return false;\n        if (filters.timeSlots.length > 0 && !filters.timeSlots.includes(c.time)) return false;\n        return true;\n      });\n    }, [allCheckins, filters]);\n    \n    const filteredByLocation = useMemo(() => {\n      if (activeLocation === 'all') return filteredAll;\n      const loc = locations.find(l => l.id === activeLocation);\n      if (!loc) return filteredAll;\n      return filteredAll.filter(s => {\n        const sl = (s.location || '').toLowerCase();\n        if (activeLocation === 'kwality') return sl.includes('kwality');\n        if (activeLocation === 'supreme') return sl.includes('supreme');\n        if (activeLocation === 'kenkere') return sl.includes('kenkere');\n        if (activeLocation === 'popup') return sl.includes('pop') || sl.includes('popup') || sl.includes('pop-up');\n        return s.location === loc.fullName;\n      });\n    }, [filteredAll, activeLocation]);\n\n    const heroTotals = useMemo(() => {\n      // Use FILTERED data (includes global filters AND location filters)\n      const baseData = filteredByLocation;\n      \n      const sessionsCount = baseData.length;\n      const capacity = baseData.reduce((sum, s) => sum + (s.capacity || 0), 0);\n      const checkIns = baseData.reduce((sum, s) => sum + (s.checkedInCount || 0), 0);\n      const revenue = baseData.reduce((sum, s) => sum + (s.totalPaid || 0), 0);\n      const fill = capacity > 0 ? (checkIns / capacity) * 100 : 0;\n      return { sessions: sessionsCount, revenue, fill };\n    }, [filteredByLocation]);\n\n    const exportButton = (\n      <AdvancedExportButton \n        sessionsData={filteredByLocation as any}\n        defaultFileName={`class-formats-${activeLocation}`}\n        size=\"sm\"\n        variant=\"ghost\"\n        buttonClassName=\"rounded-xl border border-white/30 text-white hover:border-white/50\"\n      />\n    );\n\n    // Build drilldown payload data based on current state\n    const buildDrillData = useMemo(() => {\n      if (!drill) return null;\n      const scope = drill.scope as string | undefined;\n      const row = drill.row || {};\n      const groupBy = drill.groupBy as string | undefined;\n      const item = drill.item;\n\n      // Get the correctly filtered data that matches what components are using\n      const currentLocationFilteredData = activeLocation === 'all' ? filteredAll : filteredAll.filter(s => {\n        const sl = (s.location || '').toLowerCase();\n        if (activeLocation === 'kwality') return sl.includes('kwality');\n        if (activeLocation === 'supreme') return sl.includes('supreme');\n        if (activeLocation === 'kenkere') return sl.includes('kenkere');\n        return false;\n      });\n\n      // For format-trend type drill-downs (from MoM/YoY tables)\n      if (drill.type === 'format-trend') {\n        const format = drill.format;\n        const month = drill.month;\n        const year = drill.year;\n        const metric = drill.metric;\n        \n        // Filter sessions based on format and time period\n        const sessionsFiltered = currentLocationFilteredData.filter(s => {\n          const matchesFormat = format === 'PowerCycle' ? \n            (s.classType === 'PowerCycle' || s.cleanedClass === 'PowerCycle') :\n            format === 'Barre' ? \n            (s.classType === 'Barre' || s.cleanedClass === 'Barre') :\n            format === 'Strength' ?\n            (s.classType === 'Strength' || s.cleanedClass === 'Strength') :\n            true;\n            \n          // Add time period filtering if month/year provided\n          let matchesTime = true;\n          if (month || year) {\n            const sessionDate = new Date(s.date);\n            if (month && sessionDate.getMonth() + 1 !== parseInt(month.split('-')[1])) {\n              matchesTime = false;\n            }\n            if (year && sessionDate.getFullYear() !== parseInt(year)) {\n              matchesTime = false;\n            }\n          }\n          \n          return matchesFormat && matchesTime;\n        });\n\n        return { \n          scope: 'format-trend', \n          format, \n          month, \n          year, \n          metric, \n          sessionsFiltered,\n          totalSessions: sessionsFiltered.length,\n          totalRevenue: sessionsFiltered.reduce((sum, s) => sum + (s.totalPaid || s.revenue || 0), 0),\n          totalCheckins: sessionsFiltered.reduce((sum, s) => sum + (s.checkedInCount || 0), 0)\n        };\n      }\n\n      // For format-summary type drill-downs (from summary cards)\n      if (drill.type === 'format-summary') {\n        const format = drill.format;\n        const sessionsFiltered = currentLocationFilteredData.filter(s => {\n          const matchesFormat = format === 'PowerCycle' ? \n            (s.classType === 'PowerCycle' || s.cleanedClass === 'PowerCycle') :\n            format === 'Barre' ? \n            (s.classType === 'Barre' || s.cleanedClass === 'Barre') :\n            format === 'Strength' ?\n            (s.classType === 'Strength' || s.cleanedClass === 'Strength') :\n            true;\n          return matchesFormat;\n        });\n\n        return { \n          scope: 'format-summary', \n          format, \n          sessionsFiltered,\n          totalSessions: sessionsFiltered.length,\n          totalRevenue: sessionsFiltered.reduce((sum, s) => sum + (s.revenue || 0), 0),\n          totalCheckins: sessionsFiltered.reduce((sum, s) => sum + (s.checkedInCount || 0), 0)\n        };\n      }\n\n      // Focused handling for Detailed Format Analytics (payroll-driven)\n      if (scope === 'detailed-format') {\n        const trainerName = item?.trainer?.teacherName as string | undefined;\n        const rawType = String(item?.type || ''); // e.g., powercycle-trainer\n        const formatKey = rawType.split('-')[0];\n        const map: Record<string, string> = { powercycle: 'PowerCycle', barre: 'Barre', strength: 'Strength' };\n        const targetClassType = map[formatKey];\n\n        const sessionsFiltered = currentLocationFilteredData.filter(s => {\n          const trainerOk = trainerName ? (s.trainerName === trainerName) : true;\n          const classOk = targetClassType ? (s.cleanedClass === targetClassType || s.classType === targetClassType) : true;\n          return trainerOk && classOk;\n        });\n\n        const checkinsFiltered = filteredAllCheckins.filter((c: any) => {\n          const loc = String(c.location || '').toLowerCase();\n          if (activeLocation === 'kwality' && !loc.includes('kwality')) return false;\n          if (activeLocation === 'supreme' && !loc.includes('supreme')) return false;\n          if (activeLocation === 'kenkere' && !loc.includes('kenkere')) return false;\n          if (activeLocation === 'popup' && !loc.includes('pop') && !loc.includes('popup') && !loc.includes('pop-up')) return false;\n          const cls = c.cleanedClass || c['Cleaned Class'];\n          const t = c.teacherName || c['Teacher Name'];\n          const trainerOk = trainerName ? (t === trainerName) : true;\n          const classOk = targetClassType ? (cls === targetClassType) : true;\n          return trainerOk && classOk;\n        });\n\n        return { scope, trainerName, targetClassType, sessionsFiltered, checkinsFiltered, payrollItem: item };\n      }\n\n      // Filter sessions by group and row context\n      const sessionsFiltered = currentLocationFilteredData.filter(s => {\n        const matchesGroup = groupBy === 'uniqueId1' ? (s.uniqueId1 === row.group)\n          : groupBy === 'uniqueId2' ? (s.uniqueId2 === row.group)\n          : groupBy === 'classType' ? (s.classType === row.group || s.cleanedClass === row.group)\n          : (row.group === undefined || s.classType === row.group || s.cleanedClass === row.group);\n        const matchesRow = (\n          (!row.day || s.dayOfWeek === row.day) &&\n          (!row.time || s.time === row.time) &&\n          (!row.cls || s.cleanedClass === row.cls || s.classType === row.cls) &&\n          (!row.trainer || s.trainerName === row.trainer)\n        );\n        return matchesGroup && matchesRow;\n      });\n\n      // Filter checkins similarly (respect active location) when needed\n      const checkinsFiltered = filteredAllCheckins.filter((c: any) => {\n        const loc = String(c.location || '').toLowerCase();\n        if (activeLocation === 'kwality' && !loc.includes('kwality')) return false;\n        if (activeLocation === 'supreme' && !loc.includes('supreme')) return false;\n        if (activeLocation === 'kenkere' && !loc.includes('kenkere')) return false;\n        if (activeLocation === 'popup' && !loc.includes('pop') && !loc.includes('popup') && !loc.includes('pop-up')) return false;\n        // match class and trainer broadly\n        const cls = c.cleanedClass || c['Cleaned Class'];\n        const t = c.teacherName || c['Teacher Name'];\n        const day = c.dayOfWeek || c['Day of Week'];\n        const time = c.time || c['Time'];\n        const groupMatch = groupBy === 'uniqueId1' ? sessionsFiltered.some(s => s.uniqueId1 === (drill?.row?.group))\n          : groupBy === 'uniqueId2' ? sessionsFiltered.some(s => s.uniqueId2 === (drill?.row?.group))\n          : sessionsFiltered.length > 0;\n        const rowMatch = (!row.cls || (cls === row.cls)) && (!row.trainer || (t === row.trainer)) && (!row.day || (day === row.day)) && (!row.time || (time === row.time));\n        return groupMatch && rowMatch;\n      });\n\n      return { scope, row, groupBy, sessionsFiltered, checkinsFiltered };\n    }, [drill, filteredAll, filteredAllCheckins, activeLocation]);\n\n    return (\n      <>\n        <DashboardMotionHero \n          title=\"Class Formats & Performance Analysis\"\n          subtitle=\"Comprehensive PowerCycle vs Barre vs Strength comparison with performance metrics and analytics\"\n          metrics={[\n            { label: 'Total Sessions', value: heroTotals.sessions.toLocaleString() },\n            { label: 'Avg Fill', value: `${heroTotals.fill.toFixed(1)}%` },\n            { label: 'Total Revenue', value: formatNumber(heroTotals.revenue) },\n          ]}\n          extra={exportButton}\n        />\n\n        <div className=\"container mx-auto px-6 py-10\">\n          {/* Location Tabs - Above Filters Section */}\n          <div className=\"mb-8\">\n            <StudioLocationTabs \n              activeLocation={activeLocation}\n              onLocationChange={setActiveLocation}\n              showInfoPopover={true}\n              infoPopoverContext=\"class-formats-overview\"\n            />\n          </div>\n\n          {/* Filters Section - Below Location Tabs and Collapsed by Default */}\n          <div className=\"mb-8\">\n            <SessionsFilterSection data={sessions} defaultCollapsed={true} />\n          </div>\n\n          {/* Location Tab Content */}\n          <div className=\"space-y-8\">{locations.map(location => {\n            // Calculate filtered data specific to THIS location tab\n            const locationFilteredData = location.id === 'all' ? filteredAll : filteredAll.filter(s => {\n              const sl = (s.location || '').toLowerCase();\n              if (location.id === 'kwality') return sl.includes('kwality');\n              if (location.id === 'supreme') return sl.includes('supreme');\n              if (location.id === 'kenkere') return sl.includes('kenkere');\n              if (location.id === 'popup') return sl.includes('pop') || sl.includes('popup') || sl.includes('pop-up');\n              return false;\n            });\n\n            // Filter checkins data to match the location (SessionsFilters already applied globally)\n            const locationFilteredCheckins = location.id === 'all' ? filteredAllCheckins : filteredAllCheckins.filter((c: any) => {\n              const loc = String(c.location || '').toLowerCase();\n              if (location.id === 'kwality') return loc.includes('kwality');\n              if (location.id === 'supreme') return loc.includes('supreme');\n              if (location.id === 'kenkere') return loc.includes('kenkere');\n              if (location.id === 'popup') return loc.includes('pop') || loc.includes('popup') || loc.includes('pop-up');\n              return false;\n            });\n\n            if (activeLocation === location.id) {\n\n\n            }\n\n            return (\n            <div key={location.id} style={{ display: activeLocation === location.id ? 'block' : 'none' }}>\n              {/* Rebuilt Sub-tabs: Overview | Rankings | Detailed | Compare | Trends */}\n              <Tabs defaultValue=\"overview\" className=\"w-full\">\n                <div className=\"flex justify-center mb-6\">\n                  <TabsList className=\"bg-white/90 backdrop-blur-sm p-1 rounded-2xl shadow-xl border border-slate-200 grid grid-cols-5 gap-0 w-full max-w-5xl relative z-20\">\n                    <TabsTrigger value=\"overview\" className=\"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r data-[state=active]:z-30 relative\">Overview</TabsTrigger>\n                    <TabsTrigger value=\"rankings\" className=\"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r data-[state=active]:z-30 relative\">Rankings</TabsTrigger>\n                    <TabsTrigger value=\"detailed\" className=\"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r data-[state=active]:z-30 relative\">Detailed</TabsTrigger>\n                    <TabsTrigger value=\"compare\" className=\"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r data-[state=active]:z-30 relative\">Compare</TabsTrigger>\n                    <TabsTrigger value=\"trends\" className=\"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r data-[state=active]:z-30 relative\">Trends</TabsTrigger>\n                  </TabsList>\n                </div>\n\n                <TabsContent value=\"overview\" className=\"space-y-6 mt-4\">\n                  {locationFilteredData && locationFilteredData.length > 0 ? (\n                    <OverviewMetricsCard data={locationFilteredData as any} />\n                  ) : (\n                    <div className=\"text-center py-8 text-slate-500\">No data available for this location</div>\n                  )}\n                </TabsContent>\n\n                <TabsContent value=\"rankings\" className=\"space-y-6 mt-4\">\n                  {locationFilteredData && locationFilteredData.length > 0 ? (\n                    <ClassFormatRankings data={locationFilteredData as any} />\n                  ) : (\n                    <div className=\"text-center py-8 text-slate-500\">No data available for this location</div>\n                  )}\n                </TabsContent>\n\n                <TabsContent value=\"detailed\" className=\"space-y-6 mt-4\">\n                  {locationFilteredData && locationFilteredData.length > 0 ? (\n                    <DetailedComparisonView data={locationFilteredData as any} />\n                  ) : (\n                    <div className=\"text-center py-8 text-slate-500\">No data available for this location</div>\n                  )}\n                </TabsContent>\n\n                <TabsContent value=\"compare\" className=\"space-y-6 mt-4\">\n                  {locationFilteredData && locationFilteredData.length > 0 ? (\n                    <EnhancedComparisonTool data={locationFilteredData as any} />\n                  ) : (\n                    <div className=\"text-center py-8 text-slate-500\">No data available for this location</div>\n                  )}\n                </TabsContent>\n\n                <TabsContent value=\"trends\" className=\"space-y-6 mt-4\">\n                  {data && data.length > 0 ? (\n                    <>\n                      <div className=\"bg-gradient-to-r from-blue-50 to-slate-100 rounded-2xl border border-slate-200 p-6\">\n                        <h3 className=\"text-lg font-semibold text-slate-900 mb-2\">Month-over-Month Performance Trends</h3>\n                        <p className=\"text-sm text-slate-600\">Historical class format performance comparison across all months</p>\n                      </div>\n                      <ClassFormatsMoMTable sessions={data as any} checkins={allCheckins} />\n                    </>\n                  ) : (\n                    <div className=\"text-center py-8 text-slate-500\">No data available</div>\n                  )}\n                </TabsContent>\n              </Tabs>\n              </div>\n            );\n          })}</div>\n        </div>\n        {drill && (\n          <ModernDrillDownModal\n            isOpen={!!drill}\n            onClose={() => setDrill(null)}\n            data={buildDrillData || drill}\n            type=\"class\"\n          />\n        )}\n      </>\n    );\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-indigo-50/50 via-purple-50/30 to-pink-50/40 relative overflow-hidden\">\n      {/* Enhanced Background Elements */}\n      <div className=\"absolute inset-0 overflow-hidden\">\n        <div className=\"absolute top-20 -left-20 w-96 h-96 bg-gradient-to-r from-indigo-400/20 to-purple-400/20 rounded-full blur-3xl animate-pulse\"></div>\n        <div className=\"absolute bottom-20 -right-20 w-96 h-96 bg-gradient-to-r from-purple-400/20 to-pink-400/20 rounded-full blur-3xl animate-pulse delay-1000\"></div>\n        <div className=\"absolute top-1/2 left-1/3 w-72 h-72 bg-gradient-to-r from-cyan-400/15 to-blue-400/15 rounded-full blur-2xl animate-pulse delay-500\"></div>\n      </div>\n      \n      {/* Subtle grid pattern overlay */}\n      <div className=\"absolute inset-0 bg-[linear-gradient(rgba(99,102,241,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(99,102,241,0.03)_1px,transparent_1px)] bg-[size:64px_64px] [mask-image:radial-gradient(ellipse_80%_50%_at_50%_50%,black,transparent)]\"></div>\n      \n      <div className=\"relative z-10\">\n      <SessionsFiltersProvider>\n        <ClassFormatsBody sessions={data || []} allCheckins={allCheckins || []} />\n      </SessionsFiltersProvider>\n      <Footer />\n      </div>\n    </div>\n  );\n};\n\nexport default ClassFormatsComparison;\n"],"names":["getClassFormat","className","lower","getAllFormats","OverviewMetricsCard","data","sessions","formatMetrics","useMemo","format","rows","s","classMap","row","classId","emptyClasses","nonEmptyClasses","classSessions","classAvgExcludingEmpty","trainerMap","r","trainer","topTrainer","maxTrainerRev","rev","classNameMap","topClass","maxClassRev","cls","timeMap","time","topTiming","maxTimeRev","sum","totalCheckins","revenueLostCancellations","lateCancelledCount","totalCapacity","avgCapacity","avgFillRate","jsx","m","jsxs","Fragment","formatNumber","formatCurrency","ClassFormatRankings","sortBy","setSortBy","useState","includeTrainers","setIncludeTrainers","excludeHosted","setExcludeHosted","minClasses","setMinClasses","minVisitors","setMinVisitors","allRankings","rankings","totalSessions","totalRevenue","fillRate","avgRevPerSession","avgRevPerSeat","firstSession","dayOfWeek","emptyClassCount","nonEmptyClassCount","isHosted","a","b","topCount","topRankings","bottomRankings","getMetricLabel","getMetricValue","item","RankingCard","index","isTop","Calendar","Clock","Users","e","Filter","RefreshCw","csvData","idx","csv","blob","url","Download","BarChart3","Zap","Crown","AlertTriangle","DetailedComparisonView","metric","setMetric","viewMode","setViewMode","formats","formatSet","selectedFormat","setSelectedFormat","React","formatData","selected","byTrainer","byTime","byDay","tk","t","timk","tm","dk","d","getTableIcon","type","User","renderTable","title","sorted","name","stats","f","Activity","DollarSign","Percent","TrendingUp","all","avgFill","i","Icon","EnhancedComparisonTool","mode","setMode","setSelected","items","toggle","val","prev","x","comparison","key","lateCancelled","noShowRate","modeButtons","Dumbbell","btn","count","c","ClassFormatsMoMTable","checkins","onDrillDown","dimension","setDimension","showDimensionMenu","setShowDimensionMenu","filteredSessions","filteredCheckins","handleCellClick","month","value","toYYYYMM","input","parts","dd","mm","yyyy","y","months","set","ym","arr","isTrueish","dimensionValues","byMonth","result","sessionAgg","dimVal","checkedIn","late","paid","headerMonths","mo","renderValue","valueForCalc","formatDelta","delta","isPctPoints","sign","computeMoMDelta","last","vPrev","vLast","change","totalsByMonth","totals","renderTotalValue","dimensionLabel","ChevronDown","dim","Button","Card","CardContent","Table","TableHeader","TableRow","TableHead","hm","TableBody","TableCell","midx","TableFooter","locations","ClassFormatsComparison","loading","useSessionsData","allCheckins","checkinsLoading","useLateCancellationsData","setLoading","useGlobalLoading","activeLocation","setActiveLocation","drill","setDrill","useEffect","handler","detail","ClassFormatsBody","filters","useSessionsFilters","filteredAll","useFilteredSessionsData","filteredAllCheckins","filteredByLocation","loc","l","sl","heroTotals","baseData","sessionsCount","capacity","checkIns","revenue","fill","exportButton","AdvancedExportButton","buildDrillData","scope","groupBy","currentLocationFilteredData","year","sessionsFiltered","matchesFormat","matchesTime","sessionDate","trainerName","formatKey","targetClassType","trainerOk","classOk","checkinsFiltered","matchesGroup","matchesRow","day","groupMatch","rowMatch","DashboardMotionHero","StudioLocationTabs","SessionsFilterSection","location","locationFilteredData","Tabs","TabsList","TabsTrigger","TabsContent","ModernDrillDownModal","SessionsFiltersProvider","Footer"],"mappings":"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"}