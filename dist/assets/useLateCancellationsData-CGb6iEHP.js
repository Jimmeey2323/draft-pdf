import{r as M}from"./index-Bm67KBkU.js";import{c as _,f as B,p as c}from"./googleAuth-BGo8ElRc.js";const o=_(),F="1DSRuJJBhl1Sc9yfY6ki-ZFhdmQ_OeVeGyPDE6n9zpK4",Q=()=>{const[z,P]=M.useState([]),[G,R]=M.useState([]),[U,O]=M.useState(!0),[V,T]=M.useState(null),W=async()=>{try{O(!0),T(null),o.info("Fetching late cancellations data from Google Sheets...");const a=await B(F,"Checkins");if(o.info("Late cancellations fetch result:",{status:"success",rowsReceived:a.length,sheetId:F}),a.length<2){o.warn("No data rows found in Checkins sheet"),P([]),R([]);return}const r=[],b=[],A=a[0];o.info("Checkins sheet headers:",A);const t=n=>A.findIndex(e=>e?.toLowerCase()===n.toLowerCase()),l=t("Member ID"),i=t("First Name"),d=t("Last Name"),m=t("Email"),h=t("Location"),u=t("Session Name"),f=t("Teacher Name"),I=t("Cleaned Product"),C=t("Cleaned Category"),p=t("Cleaned Class"),y=t("Payment Method Name"),g=t("Date (IST)"),x=t("Day of Week"),N=t("Time"),S=t("Duration (Minutes)"),w=t("Capacity"),L=t("Month"),k=t("Year"),E=t("Paid"),D=t("Is New"),s=t("Is Late Cancelled");if(s===-1){o.error("Is Late Cancelled column not found in headers:",A),P([]),R([]);return}o.info("Column indices found:",{memberIdIndex:l,firstNameIndex:i,lastNameIndex:d,emailIndex:m,locationIndex:h,sessionNameIndex:u,teacherNameIndex:f,cleanedProductIndex:I,cleanedCategoryIndex:C,cleanedClassIndex:p,paymentMethodIndex:y,dateIndex:g,dayOfWeekIndex:x,timeIndex:N,durationIndex:S,capacityIndex:w,monthIndex:L,yearIndex:k,paidIndex:E,isNewIndex:D,isLateCancelledIndex:s});for(let n=1;n<a.length;n++){const e=a[n];if(!e||e.length===0)continue;const J={memberId:l>=0?e[l]:"",firstName:i>=0?e[i]:"",lastName:d>=0?e[d]:"",email:m>=0?e[m]:"",location:h>=0?e[h]:"",sessionName:u>=0?e[u]:"",teacherName:f>=0?e[f]:"",cleanedProduct:I>=0?e[I]:"",cleanedCategory:C>=0?e[C]:"",cleanedClass:p>=0?e[p]:"",paymentMethodName:y>=0?e[y]:"",dateIST:g>=0?e[g]:"",dayOfWeek:x>=0?e[x]:"",time:N>=0?e[N]:"",duration:S>=0?c(e[S]):0,capacity:w>=0?c(e[w]):0,month:L>=0?e[L]:"",year:k>=0?c(e[k]):0,paidAmount:E>=0?c(e[E]):0,isNew:D>=0?e[D]:"",isLateCancelled:s>=0?e[s]:"FALSE"};b.push(J);const v=s>=0?String(e[s]).trim().toUpperCase():"";if(n<=10&&o.info(`Row ${n} - Is Late Cancelled value: "${e[s]}" (normalized: "${v}")`),v!=="TRUE")continue;const Y={memberId:l>=0?e[l]:"",firstName:i>=0?e[i]:"",lastName:d>=0?e[d]:"",email:m>=0?e[m]:"",location:h>=0?e[h]:"",sessionName:u>=0?e[u]:"",teacherName:f>=0?e[f]:"",cleanedProduct:I>=0?e[I]:"",cleanedCategory:C>=0?e[C]:"",cleanedClass:p>=0?e[p]:"",paymentMethodName:y>=0?e[y]:"",dateIST:g>=0?e[g]:"",dayOfWeek:x>=0?e[x]:"",time:N>=0?e[N]:"",duration:S>=0?c(e[S]):0,capacity:w>=0?c(e[w]):0,month:L>=0?e[L]:"",year:k>=0?c(e[k]):0,paidAmount:E>=0?c(e[E]):0,isNew:D>=0?e[D]:"",tableType:"checkins"};r.push(Y)}const $=[];for(let n=1;n<Math.min(20,a.length);n++)$.push({row:n,value:a[n][s],normalized:String(a[n][s]).trim().toUpperCase()});o.info("Processed late cancellations data:",{totalRecords:r.length,totalRawCheckins:b.length,isLateCancelledColumnIndex:s,lateCancelledValueSamples:$,sample:r.slice(0,3)}),P(r),R(b),T(null)}catch(a){const r=a instanceof Error?a.message:String(a);o.error("Error fetching late cancellations data:",{error:r,spreadsheetId:F,sheetName:"Checkins",errorType:a instanceof Error?a.constructor.name:typeof a}),T(`Failed to load late cancellations data: ${r}`),P([]),R([])}finally{O(!1)}};return M.useEffect(()=>{W()},[]),{data:z,allCheckins:G,loading:U,error:V,refetch:W}};export{Q as u};
//# sourceMappingURL=useLateCancellationsData-CGb6iEHP.js.map
