import{r as a}from"./index-Bm67KBkU.js";import{c as f,f as m,S as p}from"./googleAuth-BGo8ElRc.js";const s=f(),E="Expirations",D=()=>{const[d,n]=a.useState([]),[l,r]=a.useState(!0),[u,o]=a.useState(null),i=async()=>{try{r(!0),o(null),s.info("Fetching expirations data...");const t=await m(p.EXPIRATIONS,`${E}!A:Z`,{valueRenderOption:"FORMATTED_VALUE"});if(s.info(`Total rows received: ${t.length}`),t.length===0){s.warn("No data found in the sheet"),n([]);return}const c=t.slice(1).map(e=>({uniqueId:e[0]||"",memberId:e[1]||"",firstName:e[2]||"",lastName:e[3]||"",email:e[4]||"",membershipName:e[5]||"",endDate:e[6]||"",homeLocation:e[7]||"",currentUsage:e[8]||"-",id:e[9]||"",orderAt:e[10]||"",soldBy:e[11]||"-",membershipId:e[12]||"-",frozen:e[13]?.toUpperCase()==="TRUE",paid:e[14]||"-",status:e[15]||""}));s.info(`Processed ${c.length} expirations`),n(c)}catch(t){o(t instanceof Error?t.message:"Unknown error occurred")}finally{r(!1)}};return a.useEffect(()=>{i()},[]),{data:d,loading:l,error:u,refetch:i}};export{D as u};
//# sourceMappingURL=useExpirationsData-CHlNy1D0.js.map
