import{i as w}from"./index-Bm67KBkU.js";const L=w("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const k=w("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),u=e=>e==="warn"||e==="error",I=e=>({debug:(t,r)=>{u("debug")},info:(t,r)=>{u("info")},warn:(t,r)=>{u("warn")},error:(t,r)=>{}}),o={CLIENT_ID:"416630995185-g7b0fm679lb4p45p5lou070cqscaalaf.apps.googleusercontent.com",CLIENT_SECRET:"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",REFRESH_TOKEN:"1//04yfYtJTsGbluCgYIARAAGAQSNwF-L9Ir3g0kqAfdV7MLUcncxyc5-U0rp2T4rjHmGaxLUF3PZy7VX8wdumM8_ABdltAqXTsC6sk",TOKEN_URL:"https://oauth2.googleapis.com/token"},N={PAYROLL:"149ILDqovzZA6FRUJKOwzutWdVqmqWBtWPfzG3A0zxTI",SESSIONS:"16wFlke0bHFcmfn-3UyuYlGnImBq0DY7ouVYAlAFTZys",EXPIRATIONS:"1rGMDDvvTbZfNg1dueWtRN3LhOgGQOdLg3Fd7Sn1GCZo",SALES:"12xbYJQrh5wyYDaFhQrq4L0-YkSSlA6z7nMCb66XEbCQ"};let a=null,d=0;const c=[];let l=!1,h=0;const p=1e3,g=async()=>{if(a&&Date.now()<d-3e5)return a;try{const e=await fetch(o.TOKEN_URL,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:o.CLIENT_ID,client_secret:o.CLIENT_SECRET,refresh_token:o.REFRESH_TOKEN,grant_type:"refresh_token"})});if(!e.ok)throw new Error(`Token refresh failed: ${e.status}`);const t=await e.json();return a=t.access_token,d=Date.now()+(t.expires_in||3600)*1e3,a}catch(e){throw e}},m=async()=>{if(!(l||c.length===0)){for(l=!0;c.length>0;){const t=Date.now()-h;t<p&&await new Promise(s=>setTimeout(s,p-t));const r=c.shift();if(r)try{h=Date.now();const s=await r.request();r.resolve(s)}catch(s){r.reject(s)}}l=!1}},R=e=>new Promise((t,r)=>{c.push({resolve:t,reject:r,request:e}),m()}),_=async(e,t,r={})=>{const{valueRenderOption:s="UNFORMATTED_VALUE",dateTimeRenderOption:T="FORMATTED_STRING"}=r;return R(async()=>{const E=await g(),i=new URL(`https://sheets.googleapis.com/v4/spreadsheets/${e}/values/${encodeURIComponent(t)}`);i.searchParams.set("valueRenderOption",s),i.searchParams.set("dateTimeRenderOption",T);const n=await fetch(i.toString(),{headers:{Authorization:`Bearer ${E}`}});if(!n.ok){const f=await n.text();throw new Error(`Failed to fetch sheet data: ${n.status} - ${f}`)}return(await n.json()).values||[]})},A=e=>{if(typeof e=="number")return isNaN(e)?0:e;if(!e||e==="")return 0;const t=e.toString().replace(/[^0-9.-]/g,""),r=parseFloat(t);return isNaN(r)?0:r};export{L as C,N as S,k as T,I as c,_ as f,g,A as p};
//# sourceMappingURL=googleAuth-BGo8ElRc.js.map
