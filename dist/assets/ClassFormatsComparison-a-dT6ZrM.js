import{r as N,j as e,R as ce,T as ne,h as se,B as de,C as me,c as ue,d as xe}from"./index-Bm67KBkU.js";import{T as pe,a as he,b as q,c as _}from"./tabs-BTrhdLSC.js";import{D as fe}from"./DashboardMotionHero-C2yuh4RF.js";import{F as be}from"./footer-BTvMjyAb.js";import{A as ge}from"./AdvancedExportButton-kiFhlv4f.js";import{u as ve}from"./useSessionsData-CuS9CUZY.js";import{S as ye,u as je,a as Ne}from"./useFilteredSessionsData-DTLVtyFE.js";import{S as we}from"./SessionsFilterSection-BUfF1kUV.js";import{a as B,f as O}from"./index-DkD_C-d1.js";import{u as ke}from"./useLateCancellationsData-CGb6iEHP.js";import{U as Y}from"./users-7Ku-1TDB.js";import{F as Ce}from"./select-CM-Birqk.js";import{D as Se}from"./SalesMotionHero-sGphstF2.js";import{C as z,D as te}from"./dollar-sign-CKqx8kbC.js";import{Z as Te}from"./zap-IfyovFNW.js";import{C as Re}from"./crown-Bf6tWe5C.js";import{C as Fe,T as G}from"./googleAuth-BGo8ElRc.js";import{C as Q}from"./clock-BP1BFskn.js";import{A as ie}from"./activity-CeUP9h5f.js";import{P as ae}from"./percent-BAS2Szsf.js";import{U as oe}from"./user-izuMblv0.js";import{D as Me}from"./dumbbell-reskvc3q.js";import{T as Ae,a as Ee,b as X,c as ee,d as Ie,e as H,f as Pe}from"./table-DhXofKdS.js";import{C as Le}from"./chevron-right-CbIMR3DA.js";import"./dropdown-menu-B9zQ9u84.js";import{ModernDrillDownModal as De}from"./ModernDrillDownModal-NFZuytV_.js";import{S as Be}from"./StudioLocationTabs-BSKYatd_.js";import"./label-fD3fdNwH.js";import"./checkbox-ByePFv7I.js";import"./BrandSpinner-CGFi2e0U.js";import"./useAdvancedExport-luHYyrc4.js";import"./file-text-DChZNHsM.js";import"./index-BdQq_4o_.js";import"./star-qy423-d6.js";import"./trending-down-B5K1omnR.js";import"./target-BmxdxojS.js";const W=M=>{if(!M)return"Barre";const C=M.toLowerCase();return C.includes("powercycle")?"PowerCycle":C.includes("strength lab")?"Strength Lab":"Barre"},$e=()=>["PowerCycle","Barre","Strength Lab"],Oe=({data:M})=>{const C=Array.isArray(M)?M:[],k=N.useMemo(()=>$e().map(I=>{const m=C.filter(a=>W(a.cleanedClass||a.classType)===I);if(m.length===0)return{format:I,totalSessions:0,totalRevenue:0,emptyClasses:0,nonEmptyClasses:0,classAvgExcludingEmpty:0,topTrainer:"N/A",topClass:"N/A",topTiming:"N/A",revenueLostCancellations:0,lateCancelledCount:0,avgCapacity:0,avgFillRate:0};const A=new Map;m.forEach(a=>{const t=a.uniqueId1||"unknown";A.has(t)||A.set(t,[]),A.get(t).push(a)});let f=0,P=0;A.forEach((a,t)=>{a.some(l=>l.checkedInCount>0)?P++:f++});const E=P>0?m.length/P:0,i=new Map;m.forEach(a=>{const t=a.trainerName||"Unknown";i.set(t,(i.get(t)||0)+(a.totalPaid||0))});let b="N/A",n=0;i.forEach((a,t)=>{a>n&&(n=a,b=t)});const u=new Map;m.forEach(a=>{const t=a.cleanedClass||a.classType||"Unknown";u.set(t,(u.get(t)||0)+(a.totalPaid||0))});let y="N/A",w=0;u.forEach((a,t)=>{a>w&&(w=a,y=t)});const g=new Map;m.forEach(a=>{const t=a.time||"Unknown";g.set(t,(g.get(t)||0)+(a.totalPaid||0))});let p="N/A",T=0;g.forEach((a,t)=>{a>T&&(T=a,p=t)}),m.reduce((a,t)=>a+(t.bookedCount||0),0);const r=m.reduce((a,t)=>a+(t.checkedInCount||0),0),o=0,c=m.reduce((a,t)=>a+(t.lateCancelledCount||0),0),d=m.reduce((a,t)=>a+(t.capacity||0),0),R=m.length>0?Math.round(d/m.length):0,j=d>0?r/d*100:0;return{format:I,totalSessions:m.length,totalRevenue:m.reduce((a,t)=>a+(t.totalPaid||0),0),emptyClasses:f,nonEmptyClasses:P,classAvgExcludingEmpty:Math.round(E*10)/10,topTrainer:b,topClass:y,topTiming:p,revenueLostCancellations:o,lateCancelledCount:c,avgCapacity:R,avgFillRate:j}}),[C]);return e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:k.map(h=>e.jsxs("div",{className:"group relative overflow-hidden rounded-3xl bg-gradient-to-br border border-slate-200 hover:border-slate-300 transition-all duration-300 shadow-md hover:shadow-xl p-6 min-h-96 flex flex-col",style:{backgroundImage:h.format==="PowerCycle"?"linear-gradient(135deg, #3b82f6 0%, #1e40af 100%)":h.format==="Strength Lab"?"linear-gradient(135deg, #ec4899 0%, #be185d 100%)":"linear-gradient(135deg, #8b5cf6 0%, #6d28d9 100%)"},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent opacity-20"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-white/80 text-sm font-medium mb-2",children:"Class Format"}),e.jsx("h2",{className:"text-3xl font-bold text-white mb-1",children:h.format}),e.jsx("div",{className:"h-1 w-12 rounded-full",style:{background:h.format==="PowerCycle"?"#fbbf24":h.format==="Strength Lab"?"#f472b6":"#c084fc"}})]}),h.totalSessions===0?e.jsx("div",{className:"flex-grow flex items-center justify-center text-white/60 text-sm",children:"No sessions data"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white/15 backdrop-blur-md rounded-xl p-3 border border-white/20",children:[e.jsx("div",{className:"text-white/70 text-xs font-medium mb-1",children:"Total Sessions"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:B(h.totalSessions)})]}),e.jsxs("div",{className:"bg-white/15 backdrop-blur-md rounded-xl p-3 border border-white/20",children:[e.jsx("div",{className:"text-white/70 text-xs font-medium mb-1",children:"Revenue"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:O(h.totalRevenue)})]}),e.jsxs("div",{className:"bg-white/15 backdrop-blur-md rounded-xl p-3 border border-white/20",children:[e.jsx("div",{className:"text-white/70 text-xs font-medium mb-1",children:"Avg Capacity"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:h.avgCapacity})]}),e.jsxs("div",{className:"bg-white/15 backdrop-blur-md rounded-xl p-3 border border-white/20",children:[e.jsx("div",{className:"text-white/70 text-xs font-medium mb-1",children:"Fill Rate"}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[h.avgFillRate.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"space-y-3 flex-grow mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-white/10 rounded-lg backdrop-blur-sm border border-white/10",children:[e.jsx("span",{className:"text-white/80 text-sm",children:"Non-Empty Classes"}),e.jsx("span",{className:"text-lg font-bold text-white",children:h.nonEmptyClasses})]}),e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-white/10 rounded-lg backdrop-blur-sm border border-white/10",children:[e.jsx("span",{className:"text-white/80 text-sm",children:"Empty Classes"}),e.jsx("span",{className:"text-lg font-bold text-white",children:h.emptyClasses})]}),e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-white/10 rounded-lg backdrop-blur-sm border border-white/10",children:[e.jsx("span",{className:"text-white/80 text-sm",children:"Class Avg"}),e.jsx("span",{className:"text-lg font-bold text-white",children:h.classAvgExcludingEmpty})]}),e.jsxs("div",{className:"flex items-center justify-between px-3 py-2 bg-white/10 rounded-lg backdrop-blur-sm border border-white/10",children:[e.jsx("span",{className:"text-white/80 text-sm",children:"Late Cancelled"}),e.jsx("span",{className:`text-lg font-bold ${h.lateCancelledCount<=5?"text-green-300":h.lateCancelledCount<=10?"text-yellow-300":"text-red-300"}`,children:h.lateCancelledCount})]})]}),e.jsxs("div",{className:"pt-4 border-t border-white/20",children:[e.jsx("div",{className:"text-xs font-semibold text-white/80 uppercase tracking-wider mb-3",children:"Top Performers"}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-white/70",children:"Trainer:"}),e.jsx("span",{className:"font-semibold text-white truncate text-right ml-2",children:h.topTrainer})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-white/70",children:"Class:"}),e.jsx("span",{className:"font-semibold text-white truncate text-right ml-2",children:h.topClass})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-white/70",children:"Timing:"}),e.jsx("span",{className:"font-semibold text-white",children:h.topTiming})]})]})]})]})]})]},h.format))})})},Ue=({data:M})=>{const C=Array.isArray(M)?M:[],[k,h]=N.useState("revenue"),[I,m]=N.useState(!0),[A,f]=N.useState(!1),[P,E]=N.useState(1),[i,b]=N.useState(0),n=N.useMemo(()=>{const r=new Map;C.forEach(c=>{const d=c.uniqueId1||c.sessionId||"unknown";r.has(d)||r.set(d,[]),r.get(d).push(c)});let o=Array.from(r.entries()).map(([c,d])=>{const R=d.length,j=d.reduce(($,U)=>$+(U.totalPaid||0),0),a=d.reduce(($,U)=>$+(U.capacity||0),0),t=d.reduce(($,U)=>$+(U.checkedInCount||0),0),s=a>0?t/a*100:0,l=R>0?j/R:0,x=a>0?j/a:0,S=d[0],F=S?.cleanedClass||S?.classType||"Unknown",D=S?.dayOfWeek||"Unknown",v=S?.time||"Unknown",L=d.filter($=>$.checkedInCount===0).length,V=R-L,Z=F.toLowerCase().includes("hosted"),K=new Map;d.forEach($=>{const U=$.trainerName||"Unknown";K.set(U,(K.get(U)||0)+($.totalPaid||0))});let J="N/A",re=0;return K.forEach(($,U)=>{$>re&&(re=$,J=U)}),{classId:c,className:F,dayOfWeek:D,time:v,totalSessions:R,totalRevenue:j,totalCapacity:a,totalCheckins:t,fillRate:s,avgRevPerSession:l,avgRevPerSeat:x,emptyClassCount:L,nonEmptyClassCount:V,topTrainer:J,classSessions:d,isHosted:Z}});return o=o.filter(c=>!(c.totalSessions<P||c.totalCheckins<i||A&&c.isHosted)),o.sort((c,d)=>{switch(k){case"revenue":return d.totalRevenue-c.totalRevenue;case"sessions":return d.totalSessions-c.totalSessions;case"fill":return d.fillRate-c.fillRate;case"class-avg":return(d.totalSessions/d.nonEmptyClassCount||0)-(c.totalSessions/c.nonEmptyClassCount||0);case"rev-per-seat":return d.avgRevPerSeat-c.avgRevPerSeat;case"rev-per-session":return d.avgRevPerSession-c.avgRevPerSession;case"empty-classes":return d.emptyClassCount-c.emptyClassCount;default:return 0}}),o},[C,k,A,P,i]),u=Math.ceil(n.length/2),y=n.slice(0,u),w=n.slice(-u).reverse(),g=()=>{switch(k){case"revenue":return"Revenue";case"sessions":return"Sessions";case"fill":return"Fill Rate";case"class-avg":return"Class Avg";case"rev-per-seat":return"Rev/Seat";case"rev-per-session":return"Rev/Session";case"empty-classes":return"Empty Classes";default:return"Metric"}},p=r=>{switch(k){case"revenue":return O(r.totalRevenue);case"sessions":return B(r.totalSessions);case"fill":return`${r.fillRate.toFixed(1)}%`;case"class-avg":return(r.totalSessions/r.nonEmptyClassCount||0).toFixed(1);case"rev-per-seat":return O(r.avgRevPerSeat);case"rev-per-session":return O(r.avgRevPerSession);case"empty-classes":return B(r.emptyClassCount);default:return"â€”"}},T=({item:r,index:o,isTop:c})=>e.jsxs("div",{className:"group flex items-center justify-between p-4 rounded-xl bg-white shadow-sm border border-slate-200 hover:shadow-md hover:border-slate-300 transition-all duration-300 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold shadow-sm text-white ${c?"bg-gradient-to-r from-green-400 to-emerald-600":"bg-gradient-to-r from-red-400 to-rose-600"}`,children:o+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-slate-900 group-hover:text-blue-600 transition-colors",children:r.className}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsxs("span",{className:"inline-block text-xs px-2.5 py-1 rounded-full bg-slate-100 text-slate-700 font-medium",children:[e.jsx(Fe,{className:"w-3 h-3 inline mr-1"}),r.dayOfWeek]}),e.jsxs("span",{className:"inline-block text-xs px-2.5 py-1 rounded-full bg-slate-100 text-slate-700 font-medium",children:[e.jsx(Q,{className:"w-3 h-3 inline mr-1"}),r.time]}),e.jsxs("span",{className:"inline-block text-xs px-2.5 py-1 rounded-full bg-blue-50 text-blue-700 border border-blue-200 font-medium",children:[B(r.totalSessions)," sessions"]}),e.jsxs("span",{className:"inline-block text-xs px-2.5 py-1 rounded-full bg-purple-50 text-purple-700 border border-purple-200 font-medium",children:[r.totalCapacity," capacity"]}),e.jsxs("span",{className:`inline-block text-xs px-2.5 py-1 rounded-full font-medium border ${r.fillRate>=75?"bg-green-50 text-green-700 border-green-200":r.fillRate>=50?"bg-yellow-50 text-yellow-700 border-yellow-200":"bg-red-50 text-red-700 border-red-200"}`,children:[r.fillRate.toFixed(1),"% fill"]}),I&&e.jsxs("span",{className:"inline-block text-xs px-2.5 py-1 rounded-full bg-slate-100 text-slate-700 border border-slate-200 font-medium",children:[e.jsx(Y,{className:"w-3 h-3 inline mr-1"}),r.topTrainer]}),r.isHosted&&e.jsx("span",{className:"inline-block text-xs px-2.5 py-1 rounded-full bg-orange-50 text-orange-700 border border-orange-200 font-medium",children:"ðŸŽ¥ Hosted"})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-xl text-slate-900 group-hover:text-blue-600 transition-colors",children:p(r)}),e.jsx("p",{className:"text-sm text-slate-500",children:g()})]})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Individual Class Rankings"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Performance metrics by class occurrence with advanced filters"})]}),e.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100 rounded-2xl border border-slate-200 p-5 shadow-sm space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[e.jsxs("select",{value:k,onChange:r=>h(r.target.value),className:"px-3 py-2 rounded-lg border border-slate-300 bg-white text-sm font-medium text-slate-900 cursor-pointer hover:border-slate-400 transition-all",children:[e.jsx("option",{value:"revenue",children:"Sort by Revenue"}),e.jsx("option",{value:"sessions",children:"Sort by Sessions"}),e.jsx("option",{value:"fill",children:"Sort by Fill Rate"}),e.jsx("option",{value:"class-avg",children:"Sort by Class Avg"}),e.jsx("option",{value:"rev-per-seat",children:"Sort by Rev/Seat"}),e.jsx("option",{value:"rev-per-session",children:"Sort by Rev/Session"}),e.jsx("option",{value:"empty-classes",children:"Sort by Empty Classes"})]}),e.jsx("div",{className:"h-6 w-px bg-slate-300"}),e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50 cursor-pointer transition-all",children:[e.jsx("input",{type:"checkbox",checked:I,onChange:r=>m(r.target.checked),className:"w-4 h-4 rounded accent-blue-600"}),e.jsx(Y,{className:"w-4 h-4 text-slate-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Show Trainers"})]}),e.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50 cursor-pointer transition-all",children:[e.jsx("input",{type:"checkbox",checked:A,onChange:r=>f(r.target.checked),className:"w-4 h-4 rounded accent-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Exclude Hosted"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-end",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("label",{className:"text-xs font-semibold text-slate-700 flex items-center gap-1",children:[e.jsx(Ce,{className:"w-3 h-3"}),"Min Classes"]}),e.jsx("input",{type:"number",value:P,onChange:r=>E(Math.max(1,parseInt(r.target.value)||1)),min:"1",max:"100",className:"w-20 px-2.5 py-2 rounded-lg border border-slate-300 bg-white text-sm font-medium text-slate-900 focus:border-blue-400 focus:ring-1 focus:ring-blue-400"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("label",{className:"text-xs font-semibold text-slate-700 flex items-center gap-1",children:[e.jsx(Y,{className:"w-3 h-3"}),"Min Visitors"]}),e.jsx("input",{type:"number",value:i,onChange:r=>b(Math.max(0,parseInt(r.target.value)||0)),min:"0",max:"1000",className:"w-20 px-2.5 py-2 rounded-lg border border-slate-300 bg-white text-sm font-medium text-slate-900 focus:border-blue-400 focus:ring-1 focus:ring-blue-400"})]}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsxs("button",{onClick:()=>{h("revenue"),m(!0),f(!1),E(1),b(0)},className:"px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50 text-sm font-medium text-slate-700 transition-all flex items-center gap-1",title:"Reset all filters to default values",children:[e.jsx(ce,{className:"w-4 h-4"}),"Reset"]}),e.jsxs("button",{onClick:()=>{const r=n.map((j,a)=>({rank:a+1,className:j.className,trainer:j.topTrainer,sessions:j.totalSessions,revenue:j.totalRevenue,fillRate:j.fillRate.toFixed(1)})),o=[["Rank","Class Name","Trainer","Sessions","Revenue","Fill Rate %"].join(","),...r.map(j=>[j.rank,j.className,j.trainer,j.sessions,j.revenue,j.fillRate].join(","))].join(`
`),c=new Blob([o],{type:"text/csv"}),d=URL.createObjectURL(c),R=document.createElement("a");R.href=d,R.download=`class-rankings-${new Date().toISOString().split("T")[0]}.csv`,R.click(),URL.revokeObjectURL(d)},className:"px-3 py-2 rounded-lg border border-slate-300 bg-white hover:bg-slate-50 text-sm font-medium text-slate-700 transition-all flex items-center gap-1",title:"Export rankings as CSV",children:[e.jsx(Se,{className:"w-4 h-4"}),"Export"]}),e.jsxs("button",{onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),className:"px-3 py-2 rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white text-sm font-medium transition-all flex items-center gap-1",title:"View analytics and insights",children:[e.jsx(z,{className:"w-4 h-4"}),"Analytics"]})]})]}),e.jsxs("div",{className:"text-xs text-slate-600 px-3 py-2 bg-white/50 rounded-lg border border-slate-200",children:[e.jsx("span",{className:"font-semibold",children:"Active Filters:"})," Min ",P,"+ classes â€¢ Min ",i,"+ visitors ",A&&"â€¢ Excluding hosted"," ",I&&"â€¢ Trainers visible"]})]})]}),n.length===0?e.jsxs("div",{className:"rounded-xl border-2 border-dashed border-slate-300 p-8 text-center",children:[e.jsx(Te,{className:"w-12 h-12 mx-auto text-slate-400 mb-3"}),e.jsx("p",{className:"text-slate-600 font-medium",children:"No classes found"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Try adjusting your filters"})]}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-green-400 to-emerald-600 flex items-center justify-center text-white",children:e.jsx(Re,{className:"w-4 h-4"})}),e.jsx("h4",{className:"font-semibold text-slate-900",children:"Top Performers"}),e.jsxs("span",{className:"ml-auto text-xs text-slate-500 font-medium",children:[y.length," classes"]})]}),e.jsx("div",{className:"space-y-3",children:y.map((r,o)=>e.jsx(T,{item:r,index:o,isTop:!0},r.classId))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-red-400 to-rose-600 flex items-center justify-center text-white",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx("h4",{className:"font-semibold text-slate-900",children:"Needs Improvement"}),e.jsxs("span",{className:"ml-auto text-xs text-slate-500 font-medium",children:[w.length," classes"]})]}),e.jsx("div",{className:"space-y-3",children:w.map((r,o)=>e.jsx(T,{item:r,index:o,isTop:!1},r.classId))})]})]})]})},We=({data:M})=>{const C=Array.isArray(M)?M:[],[k,h]=N.useState("revenue"),[I,m]=N.useState("trainer"),A=N.useMemo(()=>{const n=new Set(C.map(u=>W(u.cleanedClass||u.classType)));return Array.from(n)},[C]),[f,P]=se.useState(()=>A[0]||""),E=N.useMemo(()=>{const n=f||A[0];if(!n||C.length===0)return null;const u=C.filter(p=>W(p.cleanedClass||p.classType)===n),y=new Map,w=new Map,g=new Map;return u.forEach(p=>{let T=p.trainerName||"Unknown";y.has(T)||y.set(T,{sessions:0,revenue:0,checkins:0,capacity:0});const r=y.get(T);r.sessions++,r.revenue+=p.totalPaid||p.revenue||0,r.checkins+=p.checkedInCount||0,r.capacity+=p.capacity||0;let o=p.time||"Unknown";w.has(o)||w.set(o,{sessions:0,revenue:0,checkins:0,capacity:0});const c=w.get(o);c.sessions++,c.revenue+=p.totalPaid||p.revenue||0,c.checkins+=p.checkedInCount||0,c.capacity+=p.capacity||0;let d=p.dayOfWeek||"Unknown";g.has(d)||g.set(d,{sessions:0,revenue:0,checkins:0,capacity:0});const R=g.get(d);R.sessions++,R.revenue+=p.totalPaid||p.revenue||0,R.checkins+=p.checkedInCount||0,R.capacity+=p.capacity||0}),{byTrainer:y,byTime:w,byDay:g}},[C,f,A]),i=n=>n==="trainer"?e.jsx(oe,{className:"w-4 h-4"}):n==="time"?e.jsx(Q,{className:"w-4 h-4"}):e.jsx(z,{className:"w-4 h-4"}),b=(n,u,y)=>{if(!n||n.size===0)return null;const w=Array.from(n.entries()).sort((g,p)=>k==="revenue"?p[1].revenue-g[1].revenue:k==="sessions"?p[1].sessions-g[1].sessions:(p[1].capacity>0?p[1].checkins/p[1].capacity*100:0)-(g[1].capacity>0?g[1].checkins/g[1].capacity*100:0));return e.jsxs("div",{className:"rounded-2xl border border-slate-200 overflow-hidden shadow-sm bg-white hover:shadow-md transition-all duration-200",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100 px-6 py-4 border-b border-slate-200",children:e.jsxs("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-wide flex items-center gap-2",children:[i(y),u]})}),e.jsx("div",{className:"overflow-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left font-bold text-slate-700",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-right font-bold text-slate-700",children:"Sessions"}),e.jsx("th",{className:"px-6 py-3 text-right font-bold text-slate-700",children:"Revenue"}),e.jsx("th",{className:"px-6 py-3 text-right font-bold text-slate-700",children:"Fill Rate"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:w.map(([g,p],T)=>{const r=p.capacity>0?p.checkins/p.capacity*100:0;return e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors duration-150 group",children:[e.jsx("td",{className:"px-6 py-4 font-semibold text-slate-900 group-hover:text-blue-600",children:g}),e.jsx("td",{className:"px-6 py-4 text-right text-slate-600 font-medium",children:B(p.sessions)}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-slate-900",children:O(p.revenue)}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("span",{className:`inline-block px-3 py-1.5 rounded-full text-xs font-bold ${r>=80?"bg-blue-800 text-white":"bg-rose-600 text-white"}`,children:[r.toFixed(1),"%"]})})]},g)})})]})})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 via-blue-50 to-slate-100 rounded-2xl border border-slate-200 p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Detailed Performance Breakdown"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Deep dive analysis of trainer, time slot, and day of week performance metrics"})]}),e.jsx("div",{className:"text-3xl opacity-10",children:"ðŸ“Š"})]})}),e.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100 rounded-2xl border border-slate-200 p-6 shadow-sm space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-700 mb-3 uppercase tracking-wide flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Select Class Format"]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:A.map(n=>e.jsx("button",{onClick:()=>P(n),className:`px-4 py-2.5 rounded-xl font-medium text-sm transition-all duration-200 ${f===n?"bg-gradient-to-r from-blue-600 to-blue-700 text-white shadow-lg scale-105":"bg-white text-slate-700 border border-slate-200 hover:border-slate-300 hover:shadow-md"}`,children:n},n))})]}),e.jsxs("div",{className:"pt-2 border-t border-slate-200",children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-700 mb-3 uppercase tracking-wide flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4"}),"Sort by Metric"]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:["revenue","sessions","fill"].map(n=>e.jsxs("button",{onClick:()=>h(n),className:`px-4 py-2.5 rounded-xl font-medium text-sm transition-all duration-200 flex items-center gap-1 ${k===n?"bg-gradient-to-r from-blue-100 to-blue-50 text-blue-700 border border-blue-300 shadow-md":"bg-white text-slate-600 border border-slate-200 hover:border-slate-300"}`,children:[n==="revenue"?e.jsx(te,{className:"w-4 h-4"}):n==="sessions"?e.jsx(z,{className:"w-4 h-4"}):e.jsx(ae,{className:"w-4 h-4"}),n==="revenue"?"Revenue":n==="sessions"?"Sessions":"Fill Rate"]},n))})]})]}),E&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-5",children:[e.jsx("div",{children:b(E.byTrainer,"By Trainer","trainer")}),e.jsx("div",{children:b(E.byTime,"By Time","time")}),e.jsx("div",{children:b(E.byDay,"By Day of Week","day")})]}),e.jsxs("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 rounded-2xl border border-slate-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"text-sm font-bold text-slate-900 mb-4 uppercase tracking-wide flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),"Format Overview: ",f]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:(()=>{const n=Array.from(E.byTrainer.values()),u=n.reduce((T,r)=>T+r.sessions,0),y=n.reduce((T,r)=>T+r.revenue,0),w=n.reduce((T,r)=>T+r.checkins,0),g=n.reduce((T,r)=>T+r.capacity,0),p=g>0?w/g*100:0;return[{label:"Total Sessions",value:B(u),icon:z,color:"from-blue-500 to-blue-600"},{label:"Total Revenue",value:O(y),icon:te,color:"from-green-500 to-green-600"},{label:"Avg Fill Rate",value:`${p.toFixed(1)}%`,icon:ae,color:"from-purple-500 to-purple-600"},{label:"Avg Rev/Session",value:O(u>0?y/u:0),icon:G,color:"from-orange-500 to-orange-600"}]})().map((n,u)=>{const y=n.icon;return e.jsxs("div",{className:"p-4 bg-white rounded-xl border border-slate-200 hover:shadow-md transition-all duration-200 group",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg bg-gradient-to-r ${n.color} flex items-center justify-center text-white`,children:e.jsx(y,{className:"w-4 h-4"})}),e.jsx("div",{className:"text-xs text-slate-600 font-semibold",children:n.label})]}),e.jsx("div",{className:"text-xl font-bold text-slate-900 group-hover:text-blue-600 transition-colors",children:n.value})]},u)})})]})]})]})},ze=({data:M})=>{const C=Array.isArray(M)?M:[],[k,h]=N.useState("trainers"),[I,m]=N.useState([]),A=N.useMemo(()=>k==="trainers"?Array.from(new Set(C.map(i=>i.trainerName).filter(Boolean))):k==="classes"?Array.from(new Set(C.map(i=>W(i.cleanedClass||i.classType)).filter(Boolean))):Array.from(new Set(C.map(i=>i.time).filter(Boolean))).sort(),[C,k]),f=i=>{m(b=>b.includes(i)?b.filter(n=>n!==i):[...b,i].slice(0,6))},P=N.useMemo(()=>I.map(i=>{const b=C.filter(c=>k==="trainers"?c.trainerName===i:k==="classes"?W(c.cleanedClass||c.classType)===i:c.time===i),n=b.length,u=b.reduce((c,d)=>c+(d.totalPaid||d.revenue||0),0),y=b.reduce((c,d)=>c+(d.capacity||0),0),w=b.reduce((c,d)=>c+(d.checkedInCount||0),0),g=b.reduce((c,d)=>c+(d.lateCancelledCount||0),0),p=y>0?w/y*100:0,T=n>0?u/n:0,r=n>0?g/n*100:0,o=n>0?Math.round(y/n):0;return{key:i,rows:b,totalSessions:n,totalRevenue:u,totalCapacity:y,totalCheckins:w,lateCancelled:g,avgFill:p,avgRevPerSession:T,noShowRate:r,avgCapacity:o}}),[I,C,k]),E=[{key:"trainers",label:"Trainers",icon:oe,color:"from-blue-500 to-blue-700"},{key:"classes",label:"Classes",icon:Me,color:"from-purple-500 to-purple-700"},{key:"times",label:"Times",icon:Q,color:"from-pink-500 to-pink-700"}];return e.jsxs("div",{className:"space-y-6 text-gray-900",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 via-purple-50 to-slate-100 rounded-2xl border border-slate-200 p-6 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Advanced Comparison Tool"}),e.jsx("p",{className:"text-sm text-slate-700",children:"Side-by-side analysis of up to 6 items with comprehensive metrics and visual insights"})]}),e.jsx("div",{className:"text-3xl opacity-10",children:"ðŸ”"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-slate-100 rounded-2xl border border-slate-200 p-4 shadow-sm flex flex-wrap gap-2",children:E.map(i=>{const b=i.icon;return e.jsxs("button",{onClick:()=>{h(i.key),m([])},className:`px-5 py-3 rounded-xl font-semibold text-sm transition-all duration-200 flex items-center gap-2 ${k===i.key?`bg-gradient-to-r ${i.color} text-white shadow-lg scale-105`:"bg-white text-slate-700 border border-slate-200 hover:border-slate-300 hover:shadow-md"}`,children:[e.jsx(b,{className:"w-4 h-4"}),i.label]},i.key)})}),e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 p-4 shadow-sm",children:[e.jsxs("div",{className:"text-xs font-bold text-slate-900 mb-3 uppercase tracking-wide flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Select up to 6"]}),e.jsxs("div",{className:"max-h-40 overflow-y-auto flex flex-wrap gap-2",children:[A.length===0&&e.jsx("div",{className:"text-sm text-slate-400 text-center py-4 w-full",children:"No items found"}),A.map((i,b)=>{const n=C.filter(u=>k==="trainers"?u.trainerName===i:k==="classes"?W(u.cleanedClass||u.classType)===i:u.time===i).length;return e.jsxs("label",{className:`flex items-center gap-3 px-3 py-2 rounded-lg cursor-pointer transition-all duration-150 border ${I.includes(i)?"bg-blue-600 text-white border-blue-700 shadow-sm":"bg-white text-slate-700 border-slate-200 hover:border-slate-300"}`,children:[e.jsx("input",{type:"checkbox",checked:I.includes(i),onChange:()=>f(i),className:"rounded w-4 h-4 accent-white cursor-pointer"}),e.jsx("span",{className:`text-sm font-medium truncate ${I.includes(i)?"text-white":"text-slate-700"}`,children:i}),e.jsx("span",{className:`text-xs font-semibold px-2 py-1 rounded-full ${I.includes(i)?"bg-white text-blue-700":"bg-slate-200 text-slate-600"}`,children:n})]},i)})]})]}),e.jsx("div",{children:P.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:P.map((i,b)=>e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:`h-2 bg-gradient-to-r ${b%3===0?"from-blue-500 to-blue-600":b%3===1?"from-purple-500 to-purple-600":"from-pink-500 to-pink-600"}`}),e.jsxs("div",{className:"p-6 border-b border-slate-100",children:[e.jsx("div",{className:"text-xs text-slate-500 font-bold mb-1 uppercase tracking-wide",children:k.slice(0,-1)}),e.jsx("div",{className:"text-xl font-bold text-slate-900 truncate",children:i.key})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-blue-600 font-bold mb-1",children:"Sessions"}),e.jsx("div",{className:"text-lg font-bold text-blue-900",children:B(i.totalSessions)})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-green-600 font-bold mb-1",children:"Revenue"}),e.jsx("div",{className:"text-lg font-bold text-green-900",children:O(i.totalRevenue)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-purple-600 font-bold mb-1",children:"Check-ins"}),e.jsx("div",{className:"text-lg font-bold text-purple-900",children:B(i.totalCheckins)})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-xs text-orange-600 font-bold mb-1",children:"Capacity"}),e.jsx("div",{className:"text-lg font-bold text-orange-900",children:B(i.totalCapacity)})]})]}),e.jsxs("div",{className:"pt-2 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm text-slate-600 font-medium",children:"Fill Rate"}),e.jsxs("span",{className:`text-sm font-bold px-2 py-1 rounded ${i.avgFill>=75?"bg-blue-800 text-white":"bg-rose-600 text-white"}`,children:[i.avgFill.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm text-slate-600 font-medium",children:"Rev/Session"}),e.jsx("span",{className:"text-sm font-bold text-slate-900",children:O(i.avgRevPerSession)})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm text-slate-600 font-medium",children:"Late Cancel"}),e.jsxs("span",{className:`text-sm font-bold px-2 py-1 rounded ${i.noShowRate<=10?"bg-blue-800 text-white":"bg-rose-600 text-white"}`,children:[i.noShowRate.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm text-slate-600 font-medium",children:"Avg Capacity"}),e.jsx("span",{className:"text-sm font-bold text-slate-900",children:i.avgCapacity})]})]})]})]},i.key))}):e.jsxs("div",{className:"bg-gradient-to-br from-slate-50 via-slate-100 to-slate-200 rounded-2xl border-2 border-dashed border-slate-300 p-12 text-center h-64 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"text-6xl mb-4 opacity-20",children:"ðŸ‘ˆ"}),e.jsx("div",{className:"text-lg font-bold text-slate-600 mb-2",children:"No Items Selected"}),e.jsx("div",{className:"text-sm text-slate-500",children:"Select up to 6 items from the selector above to begin comparison"}),e.jsx("div",{className:"text-xs text-slate-400 mt-3",children:"Side-by-side analysis will appear here"})]})})]})},He=({sessions:M,checkins:C,onDrillDown:k})=>{const[h,I]=N.useState("sessions"),[m,A]=N.useState("format"),[f,P]=N.useState(!1),E=M,i=C,b=(a,t,s)=>{k&&k({format:a,month:t,metric:h,value:s})},n=a=>{if(!a)return null;const t=String(a);if(t.includes("/")){const s=t.split("/");if(s.length>=3){const l=parseInt(s[0]),x=parseInt(s[1]),S=parseInt(s[2]);if(!isNaN(S)&&!isNaN(x)&&!isNaN(l)){const F=new Date(S,x-1,l);if(!isNaN(F.getTime())){const D=F.getFullYear(),v=String(F.getMonth()+1).padStart(2,"0");return`${D}-${v}`}}}}else{const s=new Date(t);if(!isNaN(s.getTime())){const l=s.getFullYear(),x=String(s.getMonth()+1).padStart(2,"0");return`${l}-${x}`}if(/^\d{4}-\d{2}/.test(t))return t.slice(0,7)}return null},u=N.useMemo(()=>{const a=new Set;E.forEach(s=>{const l=n(s.date);l&&a.add(l)}),i.forEach(s=>{const l=s.dateIST||s.dateIST||s["Date (IST)"],x=n(typeof l=="string"?l:void 0);x&&a.add(x)});const t=Array.from(a);return t.sort(),t.slice(-6)},[E,i]),y=a=>{const t=String(a??"").trim().toLowerCase();return t==="true"||t==="yes"||t==="1"},w=N.useMemo(()=>{const a=new Set;return E.forEach(t=>{let s;switch(m){case"format":s=W(t.cleanedClass||t.classType);break;case"className":s=t.cleanedClass||t.classType;break;case"classType":s=t.classType;break;case"trainer":s=t.trainerName;break;case"location":s=t.location;break;case"dayOfWeek":s=t.dayOfWeek;break;case"time":s=t.time;break}s&&a.add(s)}),Array.from(a).sort()},[E,m]),g=N.useMemo(()=>{const a={};u.forEach(s=>{a[s]={},w.forEach(l=>{a[s][l]={sessions:0,checkins:0,capacity:0,revenue:0,late:0}})});const t={};return u.forEach(s=>{t[s]={},w.forEach(l=>{t[s][l]={checkins:0,revenue:0,late:0}})}),E.forEach(s=>{const l=n(s.date||void 0);if(!l||!a[l])return;let x;switch(m){case"format":x=W(s.cleanedClass||s.classType);break;case"className":x=s.cleanedClass||s.classType;break;case"classType":x=s.classType;break;case"trainer":x=s.trainerName;break;case"location":x=s.location;break;case"dayOfWeek":x=s.dayOfWeek;break;case"time":x=s.time;break}!x||!a[l][x]||(a[l][x].sessions+=1,a[l][x].capacity+=s.capacity||0,t[l][x].checkins+=s.checkedInCount||0,t[l][x].revenue+=s.totalPaid||s.revenue||0,t[l][x].late+=s.lateCancelledCount||0)}),i.forEach(s=>{const l=s.dateIST||s.dateIST||s["Date (IST)"],x=typeof l=="string"?n(l):null;if(!x||!a[x])return;const S=y(s.checkedIn??s["Checked In"]??s["Checked in"]),F=y(s.isLateCancelled??s["Is Late Cancelled"]),D=Number(s.paidAmount??s.Paid??0)||0;let v;switch(m){case"format":v=W(s.cleanedClass||s["Cleaned Class"]);break;case"className":v=s.cleanedClass||s["Cleaned Class"];break;case"classType":v=s["Class Type"];break;case"trainer":v=s.Trainer;break;case"location":v=s.Location;break;case"dayOfWeek":v=s["Day of Week"];break;case"time":v=s.Time;break}!v||!a[x][v]||(S&&(a[x][v].checkins+=1),F&&(a[x][v].late+=1),a[x][v].revenue+=D)}),u.forEach(s=>{w.forEach(l=>{a[s][l].checkins===0&&t[s][l].checkins>0&&(a[s][l].checkins=t[s][l].checkins),a[s][l].revenue===0&&t[s][l].revenue>0&&(a[s][l].revenue=t[s][l].revenue),a[s][l].late===0&&t[s][l].late>0&&(a[s][l].late=t[s][l].late)})}),a},[E,i,u,m,w]),p=u.map(a=>{const[t,s]=a.split("-");return new Date(Number(t),Number(s)-1,1).toLocaleDateString("en-IN",{month:"short",year:"2-digit"})}),T=(a,t)=>{const s=g[a]?.[t];if(!s)return"-";switch(h){case"sessions":return B(s.sessions);case"checkins":return B(s.checkins);case"revenue":return O(s.revenue);case"lateCancelled":return B(s.late);case"classAvg":return s.sessions===0?"-":(s.checkins/s.sessions).toFixed(1);case"revPerSeat":{if(s.capacity===0)return"-";const l=s.revenue/s.capacity;return O(l)}case"cancellationRate":return s.sessions===0?"-":`${(s.late/s.sessions*100).toFixed(1)}%`;case"fillRate":return`${(s.capacity>0?s.checkins/s.capacity*100:0).toFixed(1)}%`}},r=(a,t)=>{const s=g[a]?.[t];if(!s)return 0;switch(h){case"sessions":return s.sessions;case"checkins":return s.checkins;case"revenue":return s.revenue;case"lateCancelled":return s.late;case"classAvg":return s.sessions===0?0:s.checkins/s.sessions;case"revPerSeat":return s.capacity===0?0:s.revenue/s.capacity;case"cancellationRate":return s.sessions===0?0:s.late/s.sessions*100;case"fillRate":return s.capacity>0?s.checkins/s.capacity*100:0}},o=(a,t=!1)=>{const s=a>0?"+":(a<0,"");return t?`${s}${a.toFixed(1)}pp`:`${s}${a.toFixed(1)}%`},c=a=>{if(u.length<2)return"-";const t=u[u.length-1],s=u[u.length-2];if(h==="fillRate"||h==="cancellationRate"||h==="classAvg"){const l=r(t,a)-r(s,a);return o(l,!0)}else{const l=r(s,a),x=r(t,a);if(!l)return"-";const S=(x-l)/l*100;return o(S)}},d=N.useMemo(()=>{const a={};return u.forEach(t=>{const s={sessions:0,checkins:0,capacity:0,revenue:0,late:0};w.forEach(l=>{const x=g[t]?.[l];x&&(s.sessions+=x.sessions,s.checkins+=x.checkins,s.capacity+=x.capacity,s.revenue+=x.revenue,s.late+=x.late)}),a[t]=s}),a},[g,u,w]),R=a=>{const t=d[a];if(!t)return"-";switch(h){case"sessions":return B(t.sessions);case"checkins":return B(t.checkins);case"revenue":return O(t.revenue);case"lateCancelled":return B(t.late);case"classAvg":return t.sessions===0?"-":(t.checkins/t.sessions).toFixed(1);case"revPerSeat":{if(t.capacity===0)return"-";const s=t.revenue/t.capacity;return O(s)}case"cancellationRate":return t.sessions===0?"-":`${(t.late/t.sessions*100).toFixed(1)}%`;case"fillRate":return`${(t.capacity>0?t.checkins/t.capacity*100:0).toFixed(1)}%`}},j={format:"Format",className:"Class Name",classType:"Class Type",trainer:"Trainer",location:"Location",dayOfWeek:"Day of Week",time:"Time"};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("style",{children:`
        @keyframes borderPulse {
          0%, 100% { border-color: rgb(220, 38, 38); opacity: 1; }
          50% { opacity: 0.5; }
        }

      `}),e.jsxs("div",{className:"bg-gradient-to-r from-slate-50 via-blue-50 to-slate-100 rounded-2xl border border-slate-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold text-slate-900 mb-2 flex items-center gap-2",children:[e.jsx(G,{className:"w-6 h-6 text-blue-600"}),"Month-on-Month Analysis"]}),e.jsx("p",{className:"text-sm text-slate-600",children:"Track performance trends across months with flexible dimension selection"})]}),e.jsx("div",{className:"text-3xl opacity-10",children:"ðŸ“Š"})]}),e.jsx("div",{className:"bg-white rounded-xl border border-slate-200 p-3 mb-4",children:e.jsxs("div",{className:"relative inline-block w-full sm:w-auto",children:[e.jsxs("button",{onClick:()=>P(!f),className:"w-full sm:w-auto px-4 py-2.5 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg font-semibold text-sm flex items-center justify-between gap-2 hover:shadow-lg transition-all duration-200",children:[e.jsx(z,{className:"w-4 h-4"}),"Dimension: ",j[m],e.jsx(Le,{className:`w-4 h-4 transition-transform ${f?"rotate-180":""}`})]}),f&&e.jsx("div",{className:"absolute top-full left-0 mt-2 w-full sm:w-48 bg-white rounded-xl border border-slate-200 shadow-lg z-10",children:Object.keys(j).map(a=>e.jsx("button",{onClick:()=>{A(a),P(!1)},className:`w-full text-left px-4 py-3 text-sm font-medium transition-colors ${m===a?"bg-blue-50 text-blue-700 border-l-4 border-blue-500":"text-slate-700 hover:bg-slate-50"}`,children:j[a]},a))})]})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"sessions",label:"Sessions",icon:z},{key:"checkins",label:"Check-ins",icon:Y},{key:"revenue",label:"Revenue",icon:G},{key:"fillRate",label:"Fill Rate",icon:ae},{key:"classAvg",label:"Class Avg",icon:ie},{key:"revPerSeat",label:"Rev/Seat",icon:te},{key:"cancellationRate",label:"Cancel %",icon:ne},{key:"lateCancelled",label:"Late Cancel",icon:Q}].map(a=>{const t=a.icon;return e.jsxs(de,{variant:h===a.key?"default":"outline",size:"sm",onClick:()=>I(a.key),className:`h-9 px-3 text-xs font-semibold flex items-center gap-1.5 ${h===a.key?"bg-blue-600 text-white shadow-md":"border-slate-200 text-slate-700 hover:bg-slate-50"}`,children:[e.jsx(t,{className:"w-3.5 h-3.5"}),a.label]},a.key)})})]}),e.jsx("style",{children:`
        .table-border-animate {
          animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes borderPulse {
          0%, 100% { borderColor: rgb(220, 38, 38); }
          50% { borderColor: rgb(239, 68, 68); }
        }
      `}),e.jsx(me,{className:"bg-white shadow-sm border border-slate-200",children:e.jsx(ue,{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",style:{color:"#000"},children:e.jsxs(Ae,{children:[e.jsx(Ee,{children:e.jsxs(X,{className:"bg-slate-100",style:{borderBottom:"2px solid rgb(220, 38, 38)",animation:"borderPulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"},children:[e.jsx(ee,{className:"font-bold text-black py-3",style:{color:"#000"},children:j[m]}),p.map((a,t)=>e.jsx(ee,{className:"text-right font-bold text-black py-3",style:{color:"#000"},children:a},t)),e.jsx(ee,{className:"text-right font-bold text-black py-3",style:{color:"#000"},children:"MoM Î”"})]})}),e.jsx(Ie,{children:w.map((a,t)=>e.jsxs(X,{className:t%2===0?"bg-white":"bg-slate-50 hover:bg-slate-100",children:[e.jsx(H,{className:"font-semibold text-slate-900 py-3 capitalize",children:a}),u.map((s,l)=>{const x=T(s,a);return e.jsx(H,{className:"text-right py-3 cursor-pointer hover:bg-blue-100 transition-colors font-medium text-slate-700",onClick:()=>b(a,s,parseFloat(String(x).replace(/[^0-9.-]/g,""))||0),children:x},l)}),e.jsx(H,{className:"text-right py-3 font-semibold text-slate-900",children:c(a)})]},a))}),e.jsx(Pe,{children:e.jsxs(X,{className:"bg-slate-100 font-bold",style:{borderTop:"2px solid rgb(220, 38, 38)",animation:"borderPulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"},children:[e.jsx(H,{className:"font-bold py-3",style:{color:"#000"},children:"Total"}),u.map((a,t)=>e.jsx(H,{className:"text-right py-3 font-bold",style:{color:"#000"},children:R(a)},t)),e.jsx(H,{className:"text-right py-3 font-bold",style:{color:"#000"},children:"â€”"})]})})]})})})})]})},le=[{id:"all",name:"All Locations, ",fullName:"All Locations"},{id:"kwality",name:"Kwality House, Kemps Corner",fullName:"Kwality House, Kemps Corner"},{id:"supreme",name:"Supreme HQ, Bandra",fullName:"Supreme HQ, Bandra"},{id:"kenkere",name:"Kenkere House, Bengaluru",fullName:"Kenkere House"},{id:"popup",name:"Pop-up",fullName:"Pop-up"}],Ss=()=>{const{data:M,loading:C}=ve(),{allCheckins:k,loading:h}=ke(),{setLoading:I}=xe(),[m,A]=N.useState("kwality");se.useRef(null);const[f,P]=N.useState(null);N.useEffect(()=>{I(C||h,"Loading class format comparison data...")},[C,h,I,M,k]),N.useEffect(()=>{const i=b=>{const n=b?.detail||{};P(u=>({type:"class",...n}))};return window.addEventListener("open-drilldown",i),()=>window.removeEventListener("open-drilldown",i)},[]);const E=({sessions:i,allCheckins:b})=>{const{filters:n}=je(),u=Ne(i||[]);se.useEffect(()=>{i&&i.length>0&&new Set(i.map(r=>r?.cleanedClass||r?.classType))},[i,u,b,m,n]);const y=N.useMemo(()=>(b||[]).filter(r=>n?!(n.trainers.length>0&&!n.trainers.includes(r.teacherName)||n.classTypes.length>0&&!n.classTypes.includes(r.cleanedClass)||n.dayOfWeek.length>0&&!n.dayOfWeek.includes(r.dayOfWeek)||n.timeSlots.length>0&&!n.timeSlots.includes(r.time)):!0),[b,n]),w=N.useMemo(()=>{if(m==="all")return u;const r=le.find(o=>o.id===m);return r?u.filter(o=>{const c=(o.location||"").toLowerCase();return m==="kwality"?c.includes("kwality"):m==="supreme"?c.includes("supreme"):m==="kenkere"?c.includes("kenkere"):m==="popup"?c.includes("pop")||c.includes("popup")||c.includes("pop-up"):o.location===r.fullName}):u},[u,m]),g=N.useMemo(()=>{const r=w,o=r.length,c=r.reduce((a,t)=>a+(t.capacity||0),0),d=r.reduce((a,t)=>a+(t.checkedInCount||0),0),R=r.reduce((a,t)=>a+(t.totalPaid||0),0),j=c>0?d/c*100:0;return{sessions:o,revenue:R,fill:j}},[w]),p=e.jsx(ge,{sessionsData:w,defaultFileName:`class-formats-${m}`,size:"sm",variant:"ghost",buttonClassName:"rounded-xl border border-white/30 text-white hover:border-white/50"}),T=N.useMemo(()=>{if(!f)return null;const r=f.scope,o=f.row||{},c=f.groupBy,d=f.item,R=m==="all"?u:u.filter(t=>{const s=(t.location||"").toLowerCase();return m==="kwality"?s.includes("kwality"):m==="supreme"?s.includes("supreme"):m==="kenkere"?s.includes("kenkere"):!1});if(f.type==="format-trend"){const t=f.format,s=f.month,l=f.year,x=f.metric,S=R.filter(F=>{const D=t==="PowerCycle"?F.classType==="PowerCycle"||F.cleanedClass==="PowerCycle":t==="Barre"?F.classType==="Barre"||F.cleanedClass==="Barre":t==="Strength"?F.classType==="Strength"||F.cleanedClass==="Strength":!0;let v=!0;if(s||l){const L=new Date(F.date);s&&L.getMonth()+1!==parseInt(s.split("-")[1])&&(v=!1),l&&L.getFullYear()!==parseInt(l)&&(v=!1)}return D&&v});return{scope:"format-trend",format:t,month:s,year:l,metric:x,sessionsFiltered:S,totalSessions:S.length,totalRevenue:S.reduce((F,D)=>F+(D.totalPaid||D.revenue||0),0),totalCheckins:S.reduce((F,D)=>F+(D.checkedInCount||0),0)}}if(f.type==="format-summary"){const t=f.format,s=R.filter(l=>t==="PowerCycle"?l.classType==="PowerCycle"||l.cleanedClass==="PowerCycle":t==="Barre"?l.classType==="Barre"||l.cleanedClass==="Barre":t==="Strength"?l.classType==="Strength"||l.cleanedClass==="Strength":!0);return{scope:"format-summary",format:t,sessionsFiltered:s,totalSessions:s.length,totalRevenue:s.reduce((l,x)=>l+(x.revenue||0),0),totalCheckins:s.reduce((l,x)=>l+(x.checkedInCount||0),0)}}if(r==="detailed-format"){const t=d?.trainer?.teacherName,l=String(d?.type||"").split("-")[0],S={powercycle:"PowerCycle",barre:"Barre",strength:"Strength"}[l],F=R.filter(v=>{const L=t?v.trainerName===t:!0,V=S?v.cleanedClass===S||v.classType===S:!0;return L&&V}),D=y.filter(v=>{const L=String(v.location||"").toLowerCase();if(m==="kwality"&&!L.includes("kwality")||m==="supreme"&&!L.includes("supreme")||m==="kenkere"&&!L.includes("kenkere")||m==="popup"&&!L.includes("pop")&&!L.includes("popup")&&!L.includes("pop-up"))return!1;const V=v.cleanedClass||v["Cleaned Class"],Z=v.teacherName||v["Teacher Name"];return(t?Z===t:!0)&&(S?V===S:!0)});return{scope:r,trainerName:t,targetClassType:S,sessionsFiltered:F,checkinsFiltered:D,payrollItem:d}}const j=R.filter(t=>{const s=c==="uniqueId1"?t.uniqueId1===o.group:c==="uniqueId2"?t.uniqueId2===o.group:c==="classType"?t.classType===o.group||t.cleanedClass===o.group:o.group===void 0||t.classType===o.group||t.cleanedClass===o.group,l=(!o.day||t.dayOfWeek===o.day)&&(!o.time||t.time===o.time)&&(!o.cls||t.cleanedClass===o.cls||t.classType===o.cls)&&(!o.trainer||t.trainerName===o.trainer);return s&&l}),a=y.filter(t=>{const s=String(t.location||"").toLowerCase();if(m==="kwality"&&!s.includes("kwality")||m==="supreme"&&!s.includes("supreme")||m==="kenkere"&&!s.includes("kenkere")||m==="popup"&&!s.includes("pop")&&!s.includes("popup")&&!s.includes("pop-up"))return!1;const l=t.cleanedClass||t["Cleaned Class"],x=t.teacherName||t["Teacher Name"],S=t.dayOfWeek||t["Day of Week"],F=t.time||t.Time,D=c==="uniqueId1"?j.some(L=>L.uniqueId1===f?.row?.group):c==="uniqueId2"?j.some(L=>L.uniqueId2===f?.row?.group):j.length>0,v=(!o.cls||l===o.cls)&&(!o.trainer||x===o.trainer)&&(!o.day||S===o.day)&&(!o.time||F===o.time);return D&&v});return{scope:r,row:o,groupBy:c,sessionsFiltered:j,checkinsFiltered:a}},[f,u,y,m]);return e.jsxs(e.Fragment,{children:[e.jsx(fe,{title:"Class Formats & Performance Analysis",subtitle:"Comprehensive PowerCycle vs Barre vs Strength comparison with performance metrics and analytics",metrics:[{label:"Total Sessions",value:g.sessions.toLocaleString()},{label:"Avg Fill",value:`${g.fill.toFixed(1)}%`},{label:"Total Revenue",value:B(g.revenue)}],extra:p}),e.jsxs("div",{className:"container mx-auto px-6 py-10",children:[e.jsx("div",{className:"mb-8",children:e.jsx(Be,{activeLocation:m,onLocationChange:A,showInfoPopover:!0,infoPopoverContext:"class-formats-overview"})}),e.jsx("div",{className:"mb-8",children:e.jsx(we,{data:i,defaultCollapsed:!0})}),e.jsx("div",{className:"space-y-8",children:le.map(r=>{const o=r.id==="all"?u:u.filter(c=>{const d=(c.location||"").toLowerCase();return r.id==="kwality"?d.includes("kwality"):r.id==="supreme"?d.includes("supreme"):r.id==="kenkere"?d.includes("kenkere"):r.id==="popup"?d.includes("pop")||d.includes("popup")||d.includes("pop-up"):!1});return r.id==="all"||y.filter(c=>{const d=String(c.location||"").toLowerCase();return r.id==="kwality"?d.includes("kwality"):r.id==="supreme"?d.includes("supreme"):r.id==="kenkere"?d.includes("kenkere"):r.id==="popup"?d.includes("pop")||d.includes("popup")||d.includes("pop-up"):!1}),r.id,e.jsx("div",{style:{display:m===r.id?"block":"none"},children:e.jsxs(pe,{defaultValue:"overview",className:"w-full",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsxs(he,{className:"bg-white/90 backdrop-blur-sm p-1 rounded-2xl shadow-xl border border-slate-200 grid grid-cols-5 gap-0 w-full max-w-5xl relative z-20",children:[e.jsx(q,{value:"overview",className:"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r data-[state=active]:z-30 relative",children:"Overview"}),e.jsx(q,{value:"rankings",className:"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r data-[state=active]:z-30 relative",children:"Rankings"}),e.jsx(q,{value:"detailed",className:"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r data-[state=active]:z-30 relative",children:"Detailed"}),e.jsx(q,{value:"compare",className:"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r data-[state=active]:z-30 relative",children:"Compare"}),e.jsx(q,{value:"trends",className:"flex-1 text-center py-3 data-[state=active]:from-blue-600 data-[state=active]:to-blue-800 data-[state=active]:text-white data-[state=active]:bg-gradient-to-r data-[state=active]:z-30 relative",children:"Trends"})]})}),e.jsx(_,{value:"overview",className:"space-y-6 mt-4",children:o&&o.length>0?e.jsx(Oe,{data:o}):e.jsx("div",{className:"text-center py-8 text-slate-500",children:"No data available for this location"})}),e.jsx(_,{value:"rankings",className:"space-y-6 mt-4",children:o&&o.length>0?e.jsx(Ue,{data:o}):e.jsx("div",{className:"text-center py-8 text-slate-500",children:"No data available for this location"})}),e.jsx(_,{value:"detailed",className:"space-y-6 mt-4",children:o&&o.length>0?e.jsx(We,{data:o}):e.jsx("div",{className:"text-center py-8 text-slate-500",children:"No data available for this location"})}),e.jsx(_,{value:"compare",className:"space-y-6 mt-4",children:o&&o.length>0?e.jsx(ze,{data:o}):e.jsx("div",{className:"text-center py-8 text-slate-500",children:"No data available for this location"})}),e.jsx(_,{value:"trends",className:"space-y-6 mt-4",children:M&&M.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-slate-100 rounded-2xl border border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Month-over-Month Performance Trends"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Historical class format performance comparison across all months"})]}),e.jsx(He,{sessions:M,checkins:b})]}):e.jsx("div",{className:"text-center py-8 text-slate-500",children:"No data available"})})]})},r.id)})})]}),f&&e.jsx(De,{isOpen:!!f,onClose:()=>P(null),data:T||f,type:"class"})]})};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50/50 via-purple-50/30 to-pink-50/40 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute top-20 -left-20 w-96 h-96 bg-gradient-to-r from-indigo-400/20 to-purple-400/20 rounded-full blur-3xl animate-pulse"}),e.jsx("div",{className:"absolute bottom-20 -right-20 w-96 h-96 bg-gradient-to-r from-purple-400/20 to-pink-400/20 rounded-full blur-3xl animate-pulse delay-1000"}),e.jsx("div",{className:"absolute top-1/2 left-1/3 w-72 h-72 bg-gradient-to-r from-cyan-400/15 to-blue-400/15 rounded-full blur-2xl animate-pulse delay-500"})]}),e.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(rgba(99,102,241,0.03)_1px,transparent_1px),linear-gradient(90deg,rgba(99,102,241,0.03)_1px,transparent_1px)] bg-[size:64px_64px] [mask-image:radial-gradient(ellipse_80%_50%_at_50%_50%,black,transparent)]"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx(ye,{children:e.jsx(E,{sessions:M||[],allCheckins:k||[]})}),e.jsx(be,{})]})]})};export{Ss as default};
//# sourceMappingURL=ClassFormatsComparison-a-dT6ZrM.js.map
