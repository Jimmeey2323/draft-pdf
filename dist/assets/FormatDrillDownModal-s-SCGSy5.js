import{r as Y,j as e,D as B,l as V,B as H,n as O,o as Z,q,C as x,a as y,b,c as h}from"./index-Bm67KBkU.js";import{T as G,a as I,b as T,c as E}from"./tabs-BTrhdLSC.js";import{a as r,b as o,f as p}from"./index-DkD_C-d1.js";import{E as J}from"./SalesMotionHero-sGphstF2.js";import{Z as K}from"./zap-IfyovFNW.js";import{A as Q}from"./activity-CeUP9h5f.js";import{T as W}from"./googleAuth-BGo8ElRc.js";import{C as X,D as _}from"./dollar-sign-CKqx8kbC.js";import{U as ee}from"./users-7Ku-1TDB.js";import{T as se}from"./target-BmxdxojS.js";const xe=({data:M,formatType:R,filters:f,trigger:z})=>{const[$,F]=Y.useState(!1),l={cycle:{name:"PowerCycle",color:"blue",sessions:"cycleSessions",emptySessions:"emptyCycleSessions",customers:"cycleCustomers",paid:"cyclePaid"},barre:{name:"Barre",color:"pink",sessions:"barreSessions",emptySessions:"emptyBarreSessions",customers:"barreCustomers",paid:"barrePaid"},strength:{name:"Strength",color:"orange",sessions:"strengthSessions",emptySessions:"emptyStrengthSessions",customers:"strengthCustomers",paid:"strengthPaid"}}[R],n=Y.useMemo(()=>{let s=M.filter(a=>a[l.sessions]>0);f?.locations&&f.locations.length>0&&(s=s.filter(a=>f.locations.includes(a.location)));const t={sessions:0,emptySessions:0,nonEmptySessions:0,customers:0,revenue:0,teachers:new Set,locations:new Set,months:new Set},i=new Map,d=new Map,m=new Map;s.forEach(a=>{const c=a[l.sessions]||0,j=a[l.emptySessions]||0,w=a[l.customers]||0,D=a[l.paid]||0;t.sessions+=c,t.emptySessions+=j,t.nonEmptySessions+=c-j,t.customers+=w,t.revenue+=D,t.teachers.add(a.teacherName),t.locations.add(a.location),t.months.add(a.monthYear),i.has(a.monthYear)||i.set(a.monthYear,{monthYear:a.monthYear,sessions:0,emptySessions:0,customers:0,revenue:0});const P=i.get(a.monthYear);P.sessions+=c,P.emptySessions+=j,P.customers+=w,P.revenue+=D,d.has(a.location)||d.set(a.location,{location:a.location,sessions:0,emptySessions:0,customers:0,revenue:0,teachers:new Set});const g=d.get(a.location);g.sessions+=c,g.emptySessions+=j,g.customers+=w,g.revenue+=D,g.teachers.add(a.teacherName),m.has(a.teacherName)||m.set(a.teacherName,{teacherName:a.teacherName,sessions:0,emptySessions:0,customers:0,revenue:0,locations:new Set});const N=m.get(a.teacherName);N.sessions+=c,N.emptySessions+=j,N.customers+=w,N.revenue+=D,N.locations.add(a.location)});const S=t.sessions>0?t.nonEmptySessions/t.sessions*100:0,A=t.sessions>0?t.customers/t.sessions:0,C=t.nonEmptySessions>0?t.customers/t.nonEmptySessions:0,u=t.customers>0?t.revenue/t.customers:0,U=t.sessions>0?t.revenue/t.sessions:0,k=t.sessions*20,L=k>0?t.customers/k*100:0;return{totals:{...t,fillRate:S,avgCustomersPerSession:A,avgCustomersPerNonEmpty:C,revenuePerCustomer:u,revenuePerSession:U,capacityUtilization:L,totalCapacity:k},monthly:Array.from(i.values()).sort((a,c)=>a.monthYear.localeCompare(c.monthYear)),locations:Array.from(d.values()).sort((a,c)=>c.revenue-a.revenue),teachers:Array.from(m.values()).sort((a,c)=>c.revenue-a.revenue)}},[M,l,f]),v=({title:s,value:t,subtitle:i,format:d="number",icon:m,color:S="blue"})=>{const A=u=>{switch(d){case"currency":return p(u);case"percentage":return o(u);default:return r(u)}},C={blue:"from-blue-500 to-blue-600 bg-blue-50 border-blue-200",pink:"from-pink-500 to-pink-600 bg-pink-50 border-pink-200",orange:"from-orange-500 to-orange-600 bg-orange-50 border-orange-200"};return e.jsx(x,{className:`border-2 ${C[S].split(" ").slice(2).join(" ")}`,children:e.jsxs(h,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-r ${C[S].split(" ").slice(0,2).join(" ")}`,children:e.jsx(m,{className:"h-5 w-5 text-white"})}),e.jsx("span",{className:"font-medium text-gray-700",children:s})]}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-1",children:A(t)}),i&&e.jsx("div",{className:"text-sm text-gray-600",children:i})]})})};return e.jsxs(B,{open:$,onOpenChange:F,children:[e.jsx(V,{asChild:!0,children:z||e.jsxs(H,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),"View Details"]})}),e.jsxs(O,{className:"max-w-7xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Z,{children:e.jsxs(q,{className:"flex items-center gap-3 text-xl",children:[e.jsx("div",{className:`p-2 rounded-lg bg-gradient-to-r ${l.color==="blue"?"from-blue-500 to-blue-600":l.color==="pink"?"from-pink-500 to-pink-600":"from-orange-500 to-orange-600"}`,children:R==="cycle"?e.jsx(K,{className:"h-6 w-6 text-white"}):R==="barre"?e.jsx(Q,{className:"h-6 w-6 text-white"}):e.jsx(W,{className:"h-6 w-6 text-white"})}),e.jsxs("span",{className:`bg-gradient-to-r ${l.color==="blue"?"from-blue-600 to-blue-800":l.color==="pink"?"from-pink-600 to-pink-800":"from-orange-600 to-orange-800"} bg-clip-text text-transparent`,children:[l.name," Detailed Analysis"]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(v,{title:"Total Sessions",value:n.totals.sessions,subtitle:`${n.totals.nonEmptySessions} non-empty`,icon:X,color:l.color}),e.jsx(v,{title:"Total Customers",value:n.totals.customers,subtitle:`Avg: ${r(n.totals.avgCustomersPerSession)}/session`,icon:ee,color:l.color}),e.jsx(v,{title:"Total Revenue",value:n.totals.revenue,subtitle:`â‚¹${r(n.totals.revenuePerCustomer)}/customer`,format:"currency",icon:_,color:l.color}),e.jsx(v,{title:"Fill Rate",value:n.totals.fillRate,subtitle:`${o(n.totals.capacityUtilization)} capacity used`,format:"percentage",icon:se,color:l.color})]}),e.jsxs(G,{defaultValue:"metrics",className:"w-full",children:[e.jsxs(I,{className:"grid w-full grid-cols-4",children:[e.jsx(T,{value:"metrics",children:"Metrics"}),e.jsx(T,{value:"monthly",children:"Monthly"}),e.jsx(T,{value:"locations",children:"Locations"}),e.jsx(T,{value:"teachers",children:"Teachers"})]}),e.jsx(E,{value:"metrics",className:"mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(x,{children:[e.jsx(y,{children:e.jsx(b,{children:"Performance Metrics"})}),e.jsx(h,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Sessions Scheduled:"}),e.jsx("span",{className:"font-semibold",children:r(n.totals.sessions)})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Empty Sessions:"}),e.jsx("span",{className:"font-semibold text-red-600",children:r(n.totals.emptySessions)})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Non-Empty Sessions:"}),e.jsx("span",{className:"font-semibold text-green-600",children:r(n.totals.nonEmptySessions)})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Fill Rate:"}),e.jsx("span",{className:"font-semibold",children:o(n.totals.fillRate)})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Total Capacity:"}),e.jsx("span",{className:"font-semibold",children:r(n.totals.totalCapacity)})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Capacity Used:"}),e.jsx("span",{className:"font-semibold",children:o(n.totals.capacityUtilization)})]})]})})]}),e.jsxs(x,{children:[e.jsx(y,{children:e.jsx(b,{children:"Financial Metrics"})}),e.jsx(h,{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Revenue per Customer:"}),e.jsx("span",{className:"font-semibold",children:p(n.totals.revenuePerCustomer)})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Revenue per Session:"}),e.jsx("span",{className:"font-semibold",children:p(n.totals.revenuePerSession)})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Avg Customers/Session (All):"}),e.jsx("span",{className:"font-semibold",children:r(n.totals.avgCustomersPerSession)})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Avg Customers/Session (Non-Empty):"}),e.jsx("span",{className:"font-semibold",children:r(n.totals.avgCustomersPerNonEmpty)})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Active Teachers:"}),e.jsx("span",{className:"font-semibold",children:n.totals.teachers.size})]}),e.jsxs("div",{className:"flex justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{children:"Active Locations:"}),e.jsx("span",{className:"font-semibold",children:n.totals.locations.size})]})]})})]})]})}),e.jsx(E,{value:"monthly",className:"mt-6",children:e.jsxs(x,{children:[e.jsx(y,{children:e.jsx(b,{children:"Monthly Performance"})}),e.jsx(h,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-200 bg-gray-50",children:[e.jsx("th",{className:"text-left p-3",children:"Month"}),e.jsx("th",{className:"text-center p-3",children:"Sessions"}),e.jsx("th",{className:"text-center p-3",children:"Empty"}),e.jsx("th",{className:"text-center p-3",children:"Fill Rate"}),e.jsx("th",{className:"text-center p-3",children:"Customers"}),e.jsx("th",{className:"text-center p-3",children:"Revenue"}),e.jsx("th",{className:"text-center p-3",children:"Avg/Session"})]})}),e.jsx("tbody",{children:n.monthly.map(s=>{const t=s.sessions>0?(s.sessions-s.emptySessions)/s.sessions*100:0,i=s.sessions>0?s.customers/s.sessions:0;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 font-medium",children:s.monthYear}),e.jsx("td",{className:"text-center p-3",children:r(s.sessions)}),e.jsx("td",{className:"text-center p-3 text-red-600",children:r(s.emptySessions)}),e.jsx("td",{className:"text-center p-3",children:o(t)}),e.jsx("td",{className:"text-center p-3",children:r(s.customers)}),e.jsx("td",{className:"text-center p-3",children:p(s.revenue)}),e.jsx("td",{className:"text-center p-3",children:r(i)})]},s.monthYear)})})]})})})]})}),e.jsx(E,{value:"locations",className:"mt-6",children:e.jsxs(x,{children:[e.jsx(y,{children:e.jsx(b,{children:"Location Performance"})}),e.jsx(h,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-200 bg-gray-50",children:[e.jsx("th",{className:"text-left p-3",children:"Location"}),e.jsx("th",{className:"text-center p-3",children:"Sessions"}),e.jsx("th",{className:"text-center p-3",children:"Fill Rate"}),e.jsx("th",{className:"text-center p-3",children:"Customers"}),e.jsx("th",{className:"text-center p-3",children:"Revenue"}),e.jsx("th",{className:"text-center p-3",children:"Teachers"})]})}),e.jsx("tbody",{children:n.locations.map(s=>{const t=s.sessions>0?(s.sessions-s.emptySessions)/s.sessions*100:0;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 font-medium",children:s.location}),e.jsx("td",{className:"text-center p-3",children:r(s.sessions)}),e.jsx("td",{className:"text-center p-3",children:o(t)}),e.jsx("td",{className:"text-center p-3",children:r(s.customers)}),e.jsx("td",{className:"text-center p-3",children:p(s.revenue)}),e.jsx("td",{className:"text-center p-3",children:s.teachers.size})]},s.location)})})]})})})]})}),e.jsx(E,{value:"teachers",className:"mt-6",children:e.jsxs(x,{children:[e.jsx(y,{children:e.jsx(b,{children:"Teacher Performance"})}),e.jsx(h,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-200 bg-gray-50",children:[e.jsx("th",{className:"text-left p-3",children:"Teacher"}),e.jsx("th",{className:"text-center p-3",children:"Sessions"}),e.jsx("th",{className:"text-center p-3",children:"Fill Rate"}),e.jsx("th",{className:"text-center p-3",children:"Customers"}),e.jsx("th",{className:"text-center p-3",children:"Revenue"}),e.jsx("th",{className:"text-center p-3",children:"Locations"})]})}),e.jsx("tbody",{children:n.teachers.map(s=>{const t=s.sessions>0?(s.sessions-s.emptySessions)/s.sessions*100:0;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 font-medium",children:s.teacherName}),e.jsx("td",{className:"text-center p-3",children:r(s.sessions)}),e.jsx("td",{className:"text-center p-3",children:o(t)}),e.jsx("td",{className:"text-center p-3",children:r(s.customers)}),e.jsx("td",{className:"text-center p-3",children:p(s.revenue)}),e.jsx("td",{className:"text-center p-3",children:s.locations.size})]},s.teacherName)})})]})})})]})})]})]})]})]})};export{xe as FormatDrillDownModal};
//# sourceMappingURL=FormatDrillDownModal-s-SCGSy5.js.map
