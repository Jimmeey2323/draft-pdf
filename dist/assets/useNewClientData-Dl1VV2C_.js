import{r as i,p as c}from"./index-Bm67KBkU.js";import{c as E,f as F,S as L}from"./googleAuth-BGo8ElRc.js";const h=E(),C=()=>{const[p,l]=i.useState([]),[g,u]=i.useState(!0),[S,f]=i.useState(null),[r,m]=i.useState(!1),N=(s,e)=>{if(!s||!e)return 0;const t=c(s),a=c(e);if(!t||!a)return 0;const o=a.getTime()-t.getTime(),n=Math.ceil(o/(1e3*60*60*24));return Math.max(0,n)},y=(s="")=>{const e=c(s);if(!e)return"";const t=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0");return`${t}-${a}`},d=async()=>{try{r&&u(!0),h.info("Fetching new client data...");const s=await F(L.PAYROLL,"New",{valueRenderOption:"FORMATTED_VALUE"});if(s.length<2){l([]);return}const e=s.slice(1).map(t=>{const a=t[5]||"",o=t[21]||"",n=typeof t[23]<"u"?Number(t[23]):void 0,T=t[24]||"",v=typeof t[22]<"u"?Number(t[22]):void 0,D=n&&!isNaN(n)?n:N(a,o);return{memberId:t[0]||"",firstName:t[1]||"",lastName:t[2]||"",email:t[3]||"",phoneNumber:t[4]||"",firstVisitDate:a,firstVisitEntityName:t[6]||"",firstVisitType:t[7]||"",firstVisitLocation:t[8]||"",paymentMethod:t[9]||"",membershipUsed:t[10]||"",homeLocation:t[11]||"",classNo:parseFloat(t[12])||0,trainerName:t[13]||"",isNew:t[14]||"",visitsPostTrial:parseFloat(t[15])||0,membershipsBoughtPostTrial:t[16]||"",purchaseCountPostTrial:parseFloat(t[17])||0,ltv:parseFloat(t[18])||0,retentionStatus:t[19]||"",conversionStatus:t[20]||"",firstPurchase:o,monthYear:T||y(a),conversionSpan:D,noOfVisits:v}});h.info(`New client data loaded: ${e.length} records`),l(e),f(null),m(!0)}catch{f("Failed to load new client data"),m(!0)}finally{u(!1)}};return i.useEffect(()=>{r||d()},[r]),{data:p,loading:g,error:S,refetch:d}};export{C as u};
//# sourceMappingURL=useNewClientData-Dl1VV2C_.js.map
